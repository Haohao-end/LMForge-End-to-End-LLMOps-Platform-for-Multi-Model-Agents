[2025-05-18 21:07:15,026.026] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-05-18 21:07:15,028.028] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-05-18 21:07:15,034.034] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-18 21:08:13,372.372] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-18 21:08:13,394.394] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-18 21:09:32,033.033] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-18 21:09:32,035.035] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-18 21:09:32,043.043] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-18 21:09:32,043.043] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-18 21:09:32,046.046] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-18 21:09:32,046.046] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-18 21:09:32,048.048] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:09:32,061.061] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:09:32,061.061] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00081s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-18 21:09:32,082.082] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-18 21:09:32,082.082] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00051s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-18 21:09:32,093.093] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app SET debug_conversation_id=%(debug_conversation_id)s::UUID WHERE app.id = %(app_id)s::UUID
[2025-05-18 21:09:32,093.093] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00041s] {'debug_conversation_id': None, 'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-18 21:09:32,099.099] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:09:32,109.109] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [18/May/2025 21:09:32] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations/delete-debug-conversation HTTP/1.1" 200 -
[2025-05-18 21:10:03,343.343] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:10:03,344.344] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:10:03,344.344] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.28s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-18 21:10:03,358.358] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: exceptions must derive from BaseException
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 140, in debug_chat
    raise validate_error_json(req.errors)
TypeError: exceptions must derive from BaseException
[2025-05-18 21:10:03,368.368] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-18 21:10:03,393.393] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [18/May/2025 21:10:03] "[35m[1mPOST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1[0m" 500 -
[2025-05-18 21:10:34,877.877] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:10:34,878.878] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:10:34,878.878] base.py -> _exec_single_context line:1901 [INFO]: [cached since 62.82s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-18 21:10:34,881.881] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-18 21:10:34,883.883] base.py -> _exec_single_context line:1901 [INFO]: [cached since 62.8s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-18 21:10:34,891.891] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-18 21:10:34,892.892] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00094s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-18 21:10:34,906.906] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-18 21:10:34,907.907] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00214s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-18 21:10:34,916.916] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO conversation (app_id, name, invoke_from, created_by) VALUES (%(app_id)s::UUID, %(name)s, %(invoke_from)s, %(created_by)s::UUID) RETURNING conversation.id, conversation.summary, conversation.is_pinned, conversation.is_deleted, conversation.updated_at, conversation.created_at
[2025-05-18 21:10:34,917.917] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00071s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'name': 'New Conversation', 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-18 21:10:34,938.938] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app SET debug_conversation_id=%(debug_conversation_id)s::UUID WHERE app.id = %(app_id)s::UUID
[2025-05-18 21:10:34,938.938] base.py -> _exec_single_context line:1901 [INFO]: [cached since 62.84s ago] {'debug_conversation_id': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9'), 'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-18 21:10:34,939.939] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:10:34,941.941] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:10:34,942.942] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:10:34,943.943] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00075s] {'pk_1': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9')}
[2025-05-18 21:10:34,945.945] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:10:34,945.945] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00027s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-18 21:10:34,948.948] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-18 21:10:34,948.948] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00083s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½,æˆ‘æ˜¯å¥½å„¿', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-18 21:10:34,956.956] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:10:35,076.076] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:10:35,077.077] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:10:35,077.077] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.1347s ago] {'pk_1': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9')}
[2025-05-18 21:10:35,083.083] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-18 21:10:35,083.083] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00048s] {'conversation_id_1': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 3}
[2025-05-18 21:10:35,094.094] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:10:35,095.095] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.1496s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-18 21:10:35,117.117] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-18 21:10:35,145.145] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [18/May/2025 21:10:35] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-18 21:12:04,612.612] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\app_service.py', reloading
[2025-05-18 21:12:07,129.129] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-18 21:12:51,268.268] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-18 21:12:51,286.286] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-18 21:13:49,670.670] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\core\\agent\\agents\\base_agent.py', reloading
[2025-05-18 21:13:52,745.745] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-18 21:14:38,468.468] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-18 21:14:38,484.484] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-18 21:14:39,435.435] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-18 21:14:39,437.437] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-18 21:14:39,441.441] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-18 21:14:39,442.442] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-18 21:14:39,444.444] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-18 21:14:39,444.444] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-18 21:14:39,445.445] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:14:39,456.456] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:14:39,456.456] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00083s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-18 21:14:39,474.474] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-18 21:14:39,474.474] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00040s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-18 21:14:39,482.482] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-18 21:14:39,482.482] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00060s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-18 21:14:39,489.489] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-18 21:14:39,490.490] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00108s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-18 21:14:39,494.494] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-18 21:14:39,494.494] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00049s] {'id_1': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-18 21:14:39,503.503] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-18 21:14:39,503.503] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00043s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½,æˆ‘æ˜¯å¥½å„¿', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-18 21:14:39,529.529] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:14:39,600.600] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:14:39,600.600] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:14:39,601.601] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00034s] {'pk_1': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9')}
[2025-05-18 21:14:39,607.607] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-18 21:14:39,607.607] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00055s] {'conversation_id_1': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 3}
[2025-05-18 21:14:39,615.615] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:14:39,616.616] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00052s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-18 21:14:39,635.635] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-18 21:14:39,657.657] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [18/May/2025 21:14:39] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-18 21:16:37,028.028] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\app_service.py', reloading
[2025-05-18 21:16:39,794.794] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-18 21:17:18,168.168] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-18 21:17:18,183.183] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-18 21:17:36,142.142] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\core\\agent\\agents\\function_call_agent.py', reloading
[2025-05-18 21:17:39,003.003] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-18 21:18:16,446.446] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-18 21:18:16,460.460] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-18 21:18:17,631.631] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-18 21:18:17,633.633] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-18 21:18:17,639.639] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-18 21:18:17,640.640] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-18 21:18:17,642.642] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-18 21:18:17,642.642] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-18 21:18:17,644.644] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:18:17,659.659] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:18:17,660.660] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00082s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-18 21:18:17,686.686] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-18 21:18:17,687.687] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00070s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-18 21:18:17,696.696] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-18 21:18:17,697.697] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00053s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-18 21:18:17,706.706] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-18 21:18:17,706.706] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00086s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-18 21:18:17,711.711] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-18 21:18:17,711.711] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00051s] {'id_1': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-18 21:18:17,725.725] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-18 21:18:17,726.726] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00062s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½,æˆ‘æ˜¯å¥½å„¿', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-18 21:18:17,746.746] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:18:17,855.855] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:18:17,855.855] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:18:17,856.856] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00054s] {'pk_1': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9')}
[2025-05-18 21:18:17,862.862] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-18 21:18:17,862.862] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00049s] {'conversation_id_1': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 3}
[2025-05-18 21:18:17,873.873] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:18:17,874.874] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00048s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-18 21:18:17,916.916] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-18 21:18:17,957.957] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [18/May/2025 21:18:17] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-18 21:22:02,422.422] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\core\\agent\\agents\\base_agent.py', reloading
[2025-05-18 21:22:05,576.576] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-18 21:22:44,442.442] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-18 21:22:44,457.457] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-18 21:25:15,634.634] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-18 21:25:15,636.636] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-18 21:25:15,642.642] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-18 21:25:15,643.643] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-18 21:25:15,644.644] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-18 21:25:15,645.645] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-18 21:25:15,647.647] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:25:15,658.658] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:25:15,659.659] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00080s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-18 21:25:15,679.679] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-18 21:25:15,679.679] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00055s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-18 21:25:15,687.687] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-18 21:25:15,688.688] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00108s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-18 21:25:15,696.696] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-18 21:25:15,696.696] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00073s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-18 21:25:15,703.703] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-18 21:25:15,704.704] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [18/May/2025 21:25:15] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-18 21:26:10,309.309] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\app_service.py', reloading
[2025-05-18 21:26:13,342.342] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-18 21:26:53,310.310] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-18 21:26:53,344.344] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-18 21:26:55,242.242] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-18 21:26:55,243.243] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-18 21:26:55,247.247] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-18 21:26:55,247.247] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-18 21:26:55,248.248] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-18 21:26:55,249.249] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-18 21:26:55,249.249] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:26:55,256.256] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:26:55,257.257] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00060s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-18 21:26:55,267.267] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-18 21:26:55,268.268] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00040s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-18 21:26:55,274.274] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-18 21:26:55,275.275] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00108s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-18 21:26:55,282.282] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-18 21:26:55,283.283] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00073s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-18 21:26:55,286.286] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-18 21:26:55,286.286] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00093s] {'id_1': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-18 21:26:55,298.298] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-18 21:26:55,299.299] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00094s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½,æˆ‘æ˜¯å¥½å„¿', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-18 21:26:55,325.325] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:26:55,454.454] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:26:55,455.455] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:26:55,455.455] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00042s] {'pk_1': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9')}
[2025-05-18 21:26:55,459.459] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-18 21:26:55,459.459] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00041s] {'conversation_id_1': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 3}
[2025-05-18 21:26:55,469.469] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:26:55,470.470] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00059s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-18 21:26:56,761.761] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:26:56,762.762] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00073s] {'pk_1': UUID('35a93163-bba5-43d8-9a83-33a2114a6c24')}
[2025-05-18 21:26:56,769.769] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [18/May/2025 21:26:56] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-18 21:27:03,157.157] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-18 21:27:03,204.204] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:27:03,205.205] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:27:03,206.206] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00040s] {'pk_1': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9')}
[2025-05-18 21:27:03,208.208] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:27:03,209.209] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00044s] {'pk_1': UUID('35a93163-bba5-43d8-9a83-33a2114a6c24')}
[2025-05-18 21:27:03,213.213] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-18 21:27:03,215.215] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00179s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9'), 'message_id': UUID('35a93163-bba5-43d8-9a83-33a2114a6c24'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-05-18 21:27:03,224.224] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:27:03,225.225] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:27:03,226.226] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:27:03,226.226] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.771s ago] {'pk_1': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9')}
[2025-05-18 21:27:03,228.228] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:27:03,228.228] base.py -> _exec_single_context line:1901 [INFO]: [cached since 6.467s ago] {'pk_1': UUID('35a93163-bba5-43d8-9a83-33a2114a6c24')}
[2025-05-18 21:27:03,229.229] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-18 21:27:03,230.230] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01671s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9'), 'message_id': UUID('35a93163-bba5-43d8-9a83-33a2114a6c24'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 2, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': 'ä½ å¥½ï¼Œå¥½å„¿ï¼æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (2889 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "1663fa51-560d-4604-8229-d92697b96182", "example": false}}]', 'answer': 'ä½ å¥½ï¼Œå¥½å„¿ï¼æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ', 'latency': 6.383276900000006}
[2025-05-18 21:27:03,235.235] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:27:03,236.236] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:27:03,236.236] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:27:03,236.236] base.py -> _exec_single_context line:1901 [INFO]: [cached since 6.475s ago] {'pk_1': UUID('35a93163-bba5-43d8-9a83-33a2114a6c24')}
[2025-05-18 21:27:03,238.238] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s WHERE message.id = %(message_id)s::UUID
[2025-05-18 21:27:03,238.238] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00035s] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (2889 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "1663fa51-560d-4604-8229-d92697b96182", "example": false}}]', 'answer': 'ä½ å¥½ï¼Œå¥½å„¿ï¼æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ', 'message_id': UUID('35a93163-bba5-43d8-9a83-33a2114a6c24')}
[2025-05-18 21:27:03,240.240] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:27:03,241.241] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:27:03,242.242] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:27:03,242.242] base.py -> _exec_single_context line:1901 [INFO]: [cached since 6.481s ago] {'pk_1': UUID('35a93163-bba5-43d8-9a83-33a2114a6c24')}
[2025-05-18 21:27:03,243.243] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:27:03,243.243] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.789s ago] {'pk_1': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9')}
[2025-05-18 21:27:06,625.625] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(message.id) AS count_1 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID
[2025-05-18 21:27:06,625.625] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00038s] {'conversation_id_1': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9')}
[2025-05-18 21:27:06,631.631] base.py -> _exec_single_context line:1896 [INFO]: UPDATE conversation SET summary=%(summary)s WHERE conversation.id = %(conversation_id)s::UUID
[2025-05-18 21:27:06,631.631] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00049s] {'summary': 'å¥½å„¿å‘AIæ‰“æ‹›å‘¼ï¼ŒAIå›žåº”å¹¶è¯¢é—®æ˜¯å¦éœ€è¦å¸®åŠ©ã€‚', 'conversation_id': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9')}
[2025-05-18 21:27:06,633.633] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:29:20,934.934] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:29:20,934.934] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:29:20,935.935] base.py -> _exec_single_context line:1901 [INFO]: [cached since 145.7s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-18 21:29:20,938.938] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-18 21:29:20,938.938] base.py -> _exec_single_context line:1901 [INFO]: [cached since 145.7s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-18 21:29:20,941.941] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-18 21:29:20,941.941] base.py -> _exec_single_context line:1901 [INFO]: [cached since 145.7s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-18 21:29:20,943.943] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-18 21:29:20,944.944] base.py -> _exec_single_context line:1901 [INFO]: [cached since 145.7s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-18 21:29:20,946.946] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-18 21:29:20,946.946] base.py -> _exec_single_context line:1901 [INFO]: [cached since 145.7s ago] {'id_1': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-18 21:29:20,947.947] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-18 21:29:20,948.948] base.py -> _exec_single_context line:1901 [INFO]: [cached since 145.6s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ çŸ¥é“æˆ‘æ˜¯è°å—?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-18 21:29:20,958.958] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:29:21,010.010] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:29:21,012.012] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:29:21,012.012] base.py -> _exec_single_context line:1901 [INFO]: [cached since 145.6s ago] {'pk_1': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9')}
[2025-05-18 21:29:21,014.014] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-18 21:29:21,014.014] base.py -> _exec_single_context line:1901 [INFO]: [cached since 145.6s ago] {'conversation_id_1': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 3}
[2025-05-18 21:29:21,205.205] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:29:21,205.205] base.py -> _exec_single_context line:1901 [INFO]: [cached since 145.7s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-18 21:29:23,896.896] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:29:23,899.899] base.py -> _exec_single_context line:1901 [INFO]: [cached since 147.1s ago] {'pk_1': UUID('614800b6-a5d6-4df5-bc56-ca4769758fcd')}
[2025-05-18 21:29:23,900.900] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [18/May/2025 21:29:23] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-18 21:29:23,924.924] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-18 21:29:23,924.924] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:29:23,925.925] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:29:23,926.926] base.py -> _exec_single_context line:1901 [INFO]: [cached since 140.7s ago] {'pk_1': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9')}
[2025-05-18 21:29:23,927.927] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:29:23,928.928] base.py -> _exec_single_context line:1901 [INFO]: [cached since 140.7s ago] {'pk_1': UUID('614800b6-a5d6-4df5-bc56-ca4769758fcd')}
[2025-05-18 21:29:23,929.929] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-18 21:29:23,931.931] base.py -> _exec_single_context line:1901 [INFO]: [cached since 140.7s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9'), 'message_id': UUID('614800b6-a5d6-4df5-bc56-ca4769758fcd'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': 'æ˜¯çš„ï¼Œä½ æ˜¯å¥½å„¿ï¼å¦‚æžœæœ‰ä»»ä½•é—®é¢˜æˆ–éœ€è¦å¸®åŠ©çš„åœ°æ–¹ï¼Œè¯·éšæ—¶å‘Šè¯‰æˆ‘ã€‚', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (3642 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "f7c89e47-0d3c-4eef-bd46-ee0bd6c84908", "example": false}}]', 'answer': 'æ˜¯çš„ï¼Œä½ æ˜¯å¥½å„¿ï¼å¦‚æžœæœ‰ä»»ä½•é—®é¢˜æˆ–éœ€è¦å¸®åŠ©çš„åœ°æ–¹ï¼Œè¯·éšæ—¶å‘Šè¯‰æˆ‘ã€‚', 'latency': 2.6697077999999976}
[2025-05-18 21:29:23,938.938] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:29:23,939.939] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:29:23,940.940] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:29:23,940.940] base.py -> _exec_single_context line:1901 [INFO]: [cached since 147.2s ago] {'pk_1': UUID('614800b6-a5d6-4df5-bc56-ca4769758fcd')}
[2025-05-18 21:29:23,942.942] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s WHERE message.id = %(message_id)s::UUID
[2025-05-18 21:29:23,942.942] base.py -> _exec_single_context line:1901 [INFO]: [cached since 140.7s ago] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (3642 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "f7c89e47-0d3c-4eef-bd46-ee0bd6c84908", "example": false}}]', 'answer': 'æ˜¯çš„ï¼Œä½ æ˜¯å¥½å„¿ï¼å¦‚æžœæœ‰ä»»ä½•é—®é¢˜æˆ–éœ€è¦å¸®åŠ©çš„åœ°æ–¹ï¼Œè¯·éšæ—¶å‘Šè¯‰æˆ‘ã€‚', 'message_id': UUID('614800b6-a5d6-4df5-bc56-ca4769758fcd')}
[2025-05-18 21:29:23,945.945] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:29:23,946.946] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:29:23,946.946] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:29:23,946.946] base.py -> _exec_single_context line:1901 [INFO]: [cached since 147.2s ago] {'pk_1': UUID('614800b6-a5d6-4df5-bc56-ca4769758fcd')}
[2025-05-18 21:29:23,948.948] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:29:23,950.950] base.py -> _exec_single_context line:1901 [INFO]: [cached since 148.5s ago] {'pk_1': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9')}
[2025-05-18 21:29:28,021.021] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(message.id) AS count_1 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID
[2025-05-18 21:29:28,021.021] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.4s ago] {'conversation_id_1': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9')}
[2025-05-18 21:29:28,022.022] base.py -> _exec_single_context line:1896 [INFO]: UPDATE conversation SET summary=%(summary)s WHERE conversation.id = %(conversation_id)s::UUID
[2025-05-18 21:29:28,023.023] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.4s ago] {'summary': 'å¥½å„¿å‘AIæ‰“æ‹›å‘¼ï¼ŒAIå›žåº”å¹¶è¯¢é—®æ˜¯å¦éœ€è¦å¸®åŠ©ã€‚å¥½å„¿è¯¢é—®AIæ˜¯å¦çŸ¥é“è‡ªå·±çš„èº«ä»½ï¼ŒAIç¡®è®¤äº†å¥½å„¿çš„èº«ä»½å¹¶è¡¨ç¤ºéšæ—¶æ„¿æ„æä¾›å¸®åŠ©ã€‚', 'conversation_id': UUID('6ddbc7e6-3132-4146-8556-deb47fa645b9')}
[2025-05-18 21:29:28,024.024] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:33:38,150.150] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\app_service.py', reloading
[2025-05-18 21:33:39,682.682] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-18 21:34:28,048.048] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-18 21:34:28,066.066] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-18 21:34:30,112.112] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-18 21:34:30,113.113] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-18 21:34:30,116.116] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-18 21:34:30,116.116] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-18 21:34:30,117.117] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-18 21:34:30,117.117] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-18 21:34:30,118.118] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:34:30,124.124] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:34:30,125.125] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00040s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-18 21:34:30,133.133] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-18 21:34:30,134.134] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00035s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-18 21:34:30,138.138] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app SET debug_conversation_id=%(debug_conversation_id)s::UUID WHERE app.id = %(app_id)s::UUID
[2025-05-18 21:34:30,138.138] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00037s] {'debug_conversation_id': None, 'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-18 21:34:30,141.141] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:34:30,144.144] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [18/May/2025 21:34:30] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations/delete-debug-conversation HTTP/1.1" 200 -
[2025-05-18 21:37:25,511.511] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\app_service.py', reloading
[2025-05-18 21:37:28,274.274] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-18 21:37:55,508.508] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-18 21:37:55,522.522] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-18 21:38:05,989.989] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\app_service.py', reloading
[2025-05-18 21:38:09,285.285] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-18 21:38:47,647.647] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-18 21:38:47,671.671] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-18 21:38:50,365.365] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-18 21:38:50,366.366] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-18 21:38:50,374.374] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-18 21:38:50,375.375] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-18 21:38:50,376.376] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-18 21:38:50,377.377] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-18 21:38:50,378.378] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:38:50,390.390] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:38:50,390.390] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00100s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-18 21:38:50,423.423] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-18 21:38:50,424.424] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00063s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-18 21:38:50,433.433] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-18 21:38:50,434.434] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00115s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-18 21:38:50,444.444] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-18 21:38:50,445.445] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00079s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-18 21:38:50,455.455] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO conversation (app_id, name, invoke_from, created_by) VALUES (%(app_id)s::UUID, %(name)s, %(invoke_from)s, %(created_by)s::UUID) RETURNING conversation.id, conversation.summary, conversation.is_pinned, conversation.is_deleted, conversation.updated_at, conversation.created_at
[2025-05-18 21:38:50,456.456] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00092s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'name': 'New Conversation', 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-18 21:38:50,479.479] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app SET debug_conversation_id=%(debug_conversation_id)s::UUID WHERE app.id = %(app_id)s::UUID
[2025-05-18 21:38:50,479.479] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00068s] {'debug_conversation_id': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-18 21:38:50,483.483] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:38:50,486.486] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:38:50,488.488] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:38:50,488.488] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00060s] {'pk_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:38:50,491.491] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:38:50,492.492] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00060s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-18 21:38:50,495.495] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-18 21:38:50,496.496] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00047s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½,æˆ‘æ˜¯å¥½å„¿', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-18 21:38:50,502.502] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:38:50,614.614] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:38:50,614.614] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:38:50,615.615] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.1275s ago] {'pk_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:38:50,619.619] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-18 21:38:51,797.797] base.py -> _exec_single_context line:1901 [INFO]: [generated in 1.17795s] {'conversation_id_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 3}
[2025-05-18 21:38:51,861.861] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:38:51,861.861] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.37s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-18 21:38:53,375.375] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:38:53,380.380] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00445s] {'pk_1': UUID('1efc044b-8d30-47cc-a56d-e1f67b95c51b')}
[2025-05-18 21:38:53,388.388] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [18/May/2025 21:38:53] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-18 21:38:56,811.811] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-18 21:38:56,969.969] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:38:56,970.970] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:38:56,971.971] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00042s] {'pk_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:38:56,974.974] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:38:56,974.974] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00045s] {'pk_1': UUID('1efc044b-8d30-47cc-a56d-e1f67b95c51b')}
[2025-05-18 21:38:56,979.979] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-18 21:38:56,980.980] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00096s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'message_id': UUID('1efc044b-8d30-47cc-a56d-e1f67b95c51b'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-05-18 21:38:56,988.988] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:38:56,989.989] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:38:56,990.990] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:38:56,990.990] base.py -> _exec_single_context line:1901 [INFO]: [cached since 6.502s ago] {'pk_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:38:56,991.991] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:38:56,992.992] base.py -> _exec_single_context line:1901 [INFO]: [cached since 3.617s ago] {'pk_1': UUID('1efc044b-8d30-47cc-a56d-e1f67b95c51b')}
[2025-05-18 21:38:56,993.993] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-18 21:38:56,994.994] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01452s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'message_id': UUID('1efc044b-8d30-47cc-a56d-e1f67b95c51b'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 2, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': 'ä½ å¥½ï¼Œå¥½å„¿ï¼å¾ˆé«˜å…´è§åˆ°ä½ ã€‚æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (2889 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "198406da-60b0-4d6d-a6bd-03e09b6f7b1f", "example": false}}]', 'answer': 'ä½ å¥½ï¼Œå¥½å„¿ï¼å¾ˆé«˜å…´è§åˆ°ä½ ã€‚æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ', 'latency': 3.4182005999999987}
[2025-05-18 21:38:57,001.001] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:38:57,002.002] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:38:57,002.002] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:38:57,002.002] base.py -> _exec_single_context line:1901 [INFO]: [cached since 3.628s ago] {'pk_1': UUID('1efc044b-8d30-47cc-a56d-e1f67b95c51b')}
[2025-05-18 21:38:57,004.004] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s, latency=%(latency)s WHERE message.id = %(message_id)s::UUID
[2025-05-18 21:38:57,005.005] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00051s] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (2889 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "198406da-60b0-4d6d-a6bd-03e09b6f7b1f", "example": false}}]', 'answer': 'ä½ å¥½ï¼Œå¥½å„¿ï¼å¾ˆé«˜å…´è§åˆ°ä½ ã€‚æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ', 'latency': 3.4182005999999987, 'message_id': UUID('1efc044b-8d30-47cc-a56d-e1f67b95c51b')}
[2025-05-18 21:38:57,006.006] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:38:57,007.007] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:38:57,007.007] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:38:57,007.007] base.py -> _exec_single_context line:1901 [INFO]: [cached since 3.633s ago] {'pk_1': UUID('1efc044b-8d30-47cc-a56d-e1f67b95c51b')}
[2025-05-18 21:38:57,009.009] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:38:57,012.012] base.py -> _exec_single_context line:1901 [INFO]: [cached since 6.525s ago] {'pk_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:38:59,903.903] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(message.id) AS count_1 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID
[2025-05-18 21:38:59,903.903] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00058s] {'conversation_id_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:39:02,412.412] base.py -> _exec_single_context line:1896 [INFO]: UPDATE conversation SET name=%(name)s WHERE conversation.id = %(conversation_id)s::UUID
[2025-05-18 21:39:02,413.413] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00052s] {'name': 'ç”¨æˆ·è‡ªæˆ‘ä»‹ç»', 'conversation_id': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:39:02,414.414] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:39:02,415.415] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:39:02,416.416] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:39:02,416.416] base.py -> _exec_single_context line:1901 [INFO]: [cached since 9.042s ago] {'pk_1': UUID('1efc044b-8d30-47cc-a56d-e1f67b95c51b')}
[2025-05-18 21:39:04,650.650] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:39:04,650.650] base.py -> _exec_single_context line:1901 [INFO]: [cached since 14.16s ago] {'pk_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:39:04,651.651] base.py -> _exec_single_context line:1896 [INFO]: UPDATE conversation SET summary=%(summary)s WHERE conversation.id = %(conversation_id)s::UUID
[2025-05-18 21:39:04,652.652] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00041s] {'summary': 'å¥½å„¿å‘AIæ‰“æ‹›å‘¼ï¼ŒAIå›žåº”å¹¶è¡¨ç¤ºå¾ˆé«˜å…´è§åˆ°å¥½å„¿ï¼Œè¯¢é—®æœ‰ä»€ä¹ˆå¯ä»¥å¸®å¿™çš„ã€‚', 'conversation_id': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:39:04,653.653] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:41:03,570.570] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:41:03,571.571] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:41:03,571.571] base.py -> _exec_single_context line:1901 [INFO]: [cached since 133.2s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-18 21:41:03,573.573] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-18 21:41:03,574.574] base.py -> _exec_single_context line:1901 [INFO]: [cached since 133.1s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-18 21:41:03,575.575] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-18 21:41:03,575.575] base.py -> _exec_single_context line:1901 [INFO]: [cached since 133.1s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-18 21:41:03,577.577] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-18 21:41:03,577.577] base.py -> _exec_single_context line:1901 [INFO]: [cached since 133.1s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-18 21:41:03,579.579] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-18 21:41:03,579.579] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00053s] {'id_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-18 21:41:03,581.581] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-18 21:41:03,581.581] base.py -> _exec_single_context line:1901 [INFO]: [cached since 133.1s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ çŸ¥é“æˆ‘æ˜¯è°å—?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-18 21:41:03,583.583] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:41:03,653.653] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:41:03,666.666] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:41:03,666.666] base.py -> _exec_single_context line:1901 [INFO]: [cached since 133.2s ago] {'pk_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:41:03,668.668] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-18 21:41:03,669.669] base.py -> _exec_single_context line:1901 [INFO]: [cached since 133s ago] {'conversation_id_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 3}
[2025-05-18 21:41:03,828.828] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:41:03,828.828] base.py -> _exec_single_context line:1901 [INFO]: [cached since 133.3s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-18 21:41:06,550.550] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:41:06,550.550] base.py -> _exec_single_context line:1901 [INFO]: [cached since 133.2s ago] {'pk_1': UUID('e7c9980e-6c45-415a-bc8e-25063be462bf')}
[2025-05-18 21:41:06,551.551] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [18/May/2025 21:41:06] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-18 21:41:06,573.573] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-18 21:41:06,574.574] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:41:06,574.574] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:41:06,575.575] base.py -> _exec_single_context line:1901 [INFO]: [cached since 129.6s ago] {'pk_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:41:06,577.577] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:41:06,577.577] base.py -> _exec_single_context line:1901 [INFO]: [cached since 129.6s ago] {'pk_1': UUID('e7c9980e-6c45-415a-bc8e-25063be462bf')}
[2025-05-18 21:41:06,578.578] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-18 21:41:06,578.578] base.py -> _exec_single_context line:1901 [INFO]: [cached since 129.6s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'message_id': UUID('e7c9980e-6c45-415a-bc8e-25063be462bf'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': 'æ˜¯çš„ï¼Œæˆ‘çŸ¥é“ä½ æ˜¯å¥½å„¿ï¼å¦‚æžœä½ æœ‰ä»»ä½•é—®é¢˜æˆ–éœ€è¦å¸®åŠ©çš„åœ°æ–¹ï¼Œè¯·éšæ—¶å‘Šè¯‰æˆ‘ã€‚', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (3775 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "4ff22b08-b06f-45da-8b39-ac34a43669c5", "example": false}}]', 'answer': 'æ˜¯çš„ï¼Œæˆ‘çŸ¥é“ä½ æ˜¯å¥½å„¿ï¼å¦‚æžœä½ æœ‰ä»»ä½•é—®é¢˜æˆ–éœ€è¦å¸®åŠ©çš„åœ°æ–¹ï¼Œè¯·éšæ—¶å‘Šè¯‰æˆ‘ã€‚', 'latency': 2.693864000000019}
[2025-05-18 21:41:06,581.581] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:41:06,582.582] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:41:06,583.583] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:41:06,583.583] base.py -> _exec_single_context line:1901 [INFO]: [cached since 133.2s ago] {'pk_1': UUID('e7c9980e-6c45-415a-bc8e-25063be462bf')}
[2025-05-18 21:41:06,584.584] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s, latency=%(latency)s WHERE message.id = %(message_id)s::UUID
[2025-05-18 21:41:06,585.585] base.py -> _exec_single_context line:1901 [INFO]: [cached since 129.6s ago] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (3775 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "4ff22b08-b06f-45da-8b39-ac34a43669c5", "example": false}}]', 'answer': 'æ˜¯çš„ï¼Œæˆ‘çŸ¥é“ä½ æ˜¯å¥½å„¿ï¼å¦‚æžœä½ æœ‰ä»»ä½•é—®é¢˜æˆ–éœ€è¦å¸®åŠ©çš„åœ°æ–¹ï¼Œè¯·éšæ—¶å‘Šè¯‰æˆ‘ã€‚', 'latency': 2.693864000000019, 'message_id': UUID('e7c9980e-6c45-415a-bc8e-25063be462bf')}
[2025-05-18 21:41:06,586.586] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:41:06,587.587] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:41:06,587.587] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:41:06,588.588] base.py -> _exec_single_context line:1901 [INFO]: [cached since 133.2s ago] {'pk_1': UUID('e7c9980e-6c45-415a-bc8e-25063be462bf')}
[2025-05-18 21:41:06,589.589] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:41:06,595.595] base.py -> _exec_single_context line:1901 [INFO]: [cached since 136.1s ago] {'pk_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:41:10,226.226] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(message.id) AS count_1 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID
[2025-05-18 21:41:10,227.227] base.py -> _exec_single_context line:1901 [INFO]: [cached since 130.3s ago] {'conversation_id_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:41:13,072.072] base.py -> _exec_single_context line:1896 [INFO]: UPDATE conversation SET name=%(name)s, summary=%(summary)s WHERE conversation.id = %(conversation_id)s::UUID
[2025-05-18 21:41:13,073.073] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00065s] {'name': 'è¯¢é—®å¯¹æ–¹æ˜¯å¦çŸ¥é“è‡ªå·±çš„èº«ä»½', 'summary': 'å¥½å„¿å‘AIæ‰“æ‹›å‘¼ï¼ŒAIå›žåº”å¹¶è¡¨ç¤ºå¾ˆé«˜å…´è§åˆ°å¥½å„¿ï¼Œè¯¢é—®æœ‰ä»€ä¹ˆå¯ä»¥å¸®å¿™çš„ã€‚å¥½å„¿è¯¢é—®AIæ˜¯å¦è®¤è¯†è‡ªå·±ï¼ŒAIç¡®è®¤çŸ¥é“å¯¹æ–¹æ˜¯å¥½å„¿ï¼Œå¹¶è¡¨ç¤ºæ„¿æ„éšæ—¶æä¾›å¸®åŠ©ã€‚', 'conversation_id': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:41:13,075.075] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:41:48,275.275] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:41:48,276.276] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:41:48,276.276] base.py -> _exec_single_context line:1901 [INFO]: [cached since 177.9s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-18 21:41:48,278.278] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-18 21:41:48,279.279] base.py -> _exec_single_context line:1901 [INFO]: [cached since 177.9s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-18 21:41:48,281.281] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-18 21:41:48,282.282] base.py -> _exec_single_context line:1901 [INFO]: [cached since 177.8s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-18 21:41:48,284.284] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-18 21:41:48,284.284] base.py -> _exec_single_context line:1901 [INFO]: [cached since 177.8s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-18 21:41:48,292.292] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-18 21:41:48,293.293] base.py -> _exec_single_context line:1901 [INFO]: [cached since 44.71s ago] {'id_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-18 21:41:48,294.294] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-18 21:41:48,295.295] base.py -> _exec_single_context line:1901 [INFO]: [cached since 177.8s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'æ•æ„Ÿè¯1', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-18 21:41:48,297.297] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:41:48,369.369] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:41:48,370.370] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:41:48,370.370] base.py -> _exec_single_context line:1901 [INFO]: [cached since 177.9s ago] {'pk_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:41:48,371.371] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-18 21:41:48,372.372] base.py -> _exec_single_context line:1901 [INFO]: [cached since 177.8s ago] {'conversation_id_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 3}
[2025-05-18 21:41:48,374.374] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:41:48,374.374] base.py -> _exec_single_context line:1901 [INFO]: [cached since 177.9s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-18 21:41:51,811.811] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:41:51,812.812] base.py -> _exec_single_context line:1901 [INFO]: [cached since 178.4s ago] {'pk_1': UUID('4b1dbba8-b28d-4fdb-9aa4-3875c1e9fcf4')}
[2025-05-18 21:41:51,813.813] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [18/May/2025 21:41:51] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-18 21:41:51,840.840] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-18 21:41:51,840.840] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:41:51,841.841] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:41:51,841.841] base.py -> _exec_single_context line:1901 [INFO]: [cached since 174.9s ago] {'pk_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:41:51,842.842] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:41:51,843.843] base.py -> _exec_single_context line:1901 [INFO]: [cached since 174.9s ago] {'pk_1': UUID('4b1dbba8-b28d-4fdb-9aa4-3875c1e9fcf4')}
[2025-05-18 21:41:51,844.844] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-18 21:41:51,845.845] base.py -> _exec_single_context line:1901 [INFO]: [cached since 174.9s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'message_id': UUID('4b1dbba8-b28d-4fdb-9aa4-3875c1e9fcf4'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': 'è¯·é—®ä½ æƒ³äº†è§£å…³äºŽâ€œæ•æ„Ÿè¯â€çš„ä»€ä¹ˆå†…å®¹ï¼Ÿæ˜¯å¦éœ€è¦æˆ‘æä¾›ç›¸å…³çš„ä¿¡æ¯æˆ–è§£é‡Šï¼Ÿ', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (4717 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "a67b1f96-2d79-46c3-9620-31bd45cfd16f", "example": false}}]', 'answer': 'è¯·é—®ä½ æƒ³äº†è§£å…³äºŽâ€œæ•æ„Ÿè¯â€çš„ä»€ä¹ˆå†…å®¹ï¼Ÿæ˜¯å¦éœ€è¦æˆ‘æä¾›ç›¸å…³çš„ä¿¡æ¯æˆ–è§£é‡Šï¼Ÿ', 'latency': 3.4169734000000176}
[2025-05-18 21:41:51,852.852] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:41:51,853.853] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:41:51,854.854] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:41:51,854.854] base.py -> _exec_single_context line:1901 [INFO]: [cached since 178.5s ago] {'pk_1': UUID('4b1dbba8-b28d-4fdb-9aa4-3875c1e9fcf4')}
[2025-05-18 21:41:51,856.856] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s, latency=%(latency)s WHERE message.id = %(message_id)s::UUID
[2025-05-18 21:41:51,856.856] base.py -> _exec_single_context line:1901 [INFO]: [cached since 174.9s ago] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (4717 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "a67b1f96-2d79-46c3-9620-31bd45cfd16f", "example": false}}]', 'answer': 'è¯·é—®ä½ æƒ³äº†è§£å…³äºŽâ€œæ•æ„Ÿè¯â€çš„ä»€ä¹ˆå†…å®¹ï¼Ÿæ˜¯å¦éœ€è¦æˆ‘æä¾›ç›¸å…³çš„ä¿¡æ¯æˆ–è§£é‡Šï¼Ÿ', 'latency': 3.4169734000000176, 'message_id': UUID('4b1dbba8-b28d-4fdb-9aa4-3875c1e9fcf4')}
[2025-05-18 21:41:51,859.859] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:41:51,860.860] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:41:51,861.861] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:41:51,861.861] base.py -> _exec_single_context line:1901 [INFO]: [cached since 178.5s ago] {'pk_1': UUID('4b1dbba8-b28d-4fdb-9aa4-3875c1e9fcf4')}
[2025-05-18 21:41:51,862.862] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:41:51,864.864] base.py -> _exec_single_context line:1901 [INFO]: [cached since 181.4s ago] {'pk_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:41:57,370.370] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(message.id) AS count_1 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID
[2025-05-18 21:41:57,371.371] base.py -> _exec_single_context line:1901 [INFO]: [cached since 177.5s ago] {'conversation_id_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:42:00,311.311] base.py -> _exec_single_context line:1896 [INFO]: UPDATE conversation SET name=%(name)s, summary=%(summary)s WHERE conversation.id = %(conversation_id)s::UUID
[2025-05-18 21:42:00,312.312] base.py -> _exec_single_context line:1901 [INFO]: [cached since 47.24s ago] {'name': 'æ•æ„Ÿè¯', 'summary': 'å¥½å„¿å‘AIæ‰“æ‹›å‘¼ï¼ŒAIå›žåº”å¹¶è¡¨ç¤ºå¾ˆé«˜å…´è§åˆ°å¥½å„¿ï¼Œè¯¢é—®æœ‰ä»€ä¹ˆå¯ä»¥å¸®å¿™çš„ã€‚å¥½å„¿è¯¢é—®AIæ˜¯å¦è®¤è¯†è‡ªå·±ï¼ŒAIç¡®è®¤çŸ¥é“å¯¹æ–¹æ˜¯å¥½å„¿ï¼Œå¹¶è¡¨ç¤ºæ„¿æ„éšæ—¶æä¾›å¸®åŠ©ã€‚éšåŽå¥½å„¿æåŠä¸€ä¸ªæ•æ„Ÿè¯ï¼ŒAIè°¨æ…Žåœ°è¯¢é—®å¯¹æ–¹å…·ä½“æƒ³äº†è§£çš„å†…å®¹ï¼Œå¹¶ä¸»åŠ¨æå‡ºå¯ä»¥æä¾›ç›¸å…³ä¿¡æ¯æˆ–è§£é‡Šã€‚', 'conversation_id': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:42:00,313.313] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:42:54,358.358] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:42:54,358.358] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:42:54,359.359] base.py -> _exec_single_context line:1901 [INFO]: [cached since 244s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-18 21:42:54,360.360] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 'AppService' object has no attribute 'udate_draft_app_config'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
AttributeError: 'AppService' object has no attribute 'udate_draft_app_config'
[2025-05-18 21:42:54,363.363] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-18 21:42:54,383.383] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [18/May/2025 21:42:54] "[35m[1mPOST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1[0m" 500 -
[2025-05-18 21:43:26,843.843] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\handler\\app_handler.py', reloading
[2025-05-18 21:43:28,323.323] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-18 21:43:59,507.507] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-18 21:43:59,527.527] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-18 21:44:01,607.607] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-18 21:44:01,609.609] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-18 21:44:01,619.619] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-18 21:44:01,619.619] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-18 21:44:01,622.622] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-18 21:44:01,623.623] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-18 21:44:01,625.625] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:44:01,625.625] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:44:01,650.650] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:44:01,651.651] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:44:01,651.651] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00232s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-18 21:44:01,651.651] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.002706s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-18 21:44:01,675.675] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-18 21:44:01,676.676] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-18 21:44:01,676.676] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00185s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-18 21:44:01,676.676] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.00224s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-18 21:44:01,689.689] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-18 21:44:01,690.690] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-18 21:44:01,691.691] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00210s] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-18 21:44:01,691.691] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.002492s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-18 21:44:01,699.699] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-18 21:44:01,699.699] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-18 21:44:01,700.700] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00118s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-18 21:44:01,700.700] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.001609s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-18 21:44:01,733.733] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET dialog_round=%(dialog_round)s, long_term_memory=%(long_term_memory)s::JSONB, review_config=%(review_config)s::JSONB, updated_at=%(updated_at)s WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-18 21:44:01,733.733] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET dialog_round=%(dialog_round)s, long_term_memory=%(long_term_memory)s::JSONB, review_config=%(review_config)s::JSONB, updated_at=%(updated_at)s WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-18 21:44:01,734.734] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00137s] {'dialog_round': 10, 'long_term_memory': '{"enable": false}', 'review_config': '{"enable": true, "keywords": ["\\u654f\\u611f\\u8bcd1", "\\u654f\\u611f\\u8bcd2"], "inputs_config": {"enable": true, "preset_response": "\\u654f\\u611f\\u8bcd\\u9884\\u8bbe\\u63d0\\u793a\\u56de\\u590d"}, "outputs_config": {"enable": false}}', 'updated_at': datetime.datetime(2025, 5, 18, 21, 44, 1, 725811), 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-18 21:44:01,734.734] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.001821s ago] {'dialog_round': 10, 'long_term_memory': '{"enable": false}', 'review_config': '{"enable": true, "keywords": ["\\u654f\\u611f\\u8bcd1", "\\u654f\\u611f\\u8bcd2"], "inputs_config": {"enable": true, "preset_response": "\\u654f\\u611f\\u8bcd\\u9884\\u8bbe\\u63d0\\u793a\\u56de\\u590d"}, "outputs_config": {"enable": false}}', 'updated_at': datetime.datetime(2025, 5, 18, 21, 44, 1, 720324), 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-18 21:44:01,744.744] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:44:01,753.753] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [18/May/2025 21:44:01] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-18 21:44:01,754.754] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:44:01,756.756] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [18/May/2025 21:44:01] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-18 21:44:09,687.687] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:44:09,688.688] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:44:09,688.688] base.py -> _exec_single_context line:1901 [INFO]: [cached since 8.039s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-18 21:44:09,693.693] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-18 21:44:09,694.694] base.py -> _exec_single_context line:1901 [INFO]: [cached since 8.019s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-18 21:44:09,695.695] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-18 21:44:09,696.696] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.997s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-18 21:44:09,698.698] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-18 21:44:09,698.698] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00054s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-18 21:44:09,701.701] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-18 21:44:09,703.703] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00174s] {'id_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-18 21:44:09,711.711] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-18 21:44:09,713.713] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00058s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'æ•æ„Ÿè¯1', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-18 21:44:09,740.740] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:44:09,834.834] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:44:09,836.836] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:44:09,836.836] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00054s] {'pk_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:44:09,841.841] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-18 21:44:09,841.841] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00068s] {'conversation_id_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-18 21:44:10,548.548] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:44:10,549.549] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00036s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-18 21:44:10,720.720] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:44:10,721.721] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00059s] {'pk_1': UUID('0551bf75-899e-4d70-be05-a9e06b97f704')}
[2025-05-18 21:44:10,721.721] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [18/May/2025 21:44:10] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-18 21:44:10,727.727] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-18 21:44:10,728.728] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:44:10,729.729] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:44:10,730.730] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00052s] {'pk_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:44:10,731.731] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:44:10,732.732] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00045s] {'pk_1': UUID('0551bf75-899e-4d70-be05-a9e06b97f704')}
[2025-05-18 21:44:10,735.735] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-18 21:44:10,736.736] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00154s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'message_id': UUID('0551bf75-899e-4d70-be05-a9e06b97f704'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': 'æ•æ„Ÿè¯é¢„è®¾æç¤ºå›žå¤', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "human", "data": {"content": "\\u654f\\u611f\\u8bcd1", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "e3f64083-bc57-43ab-bf3d-aba7e158e3ef", "example": false}}]', 'answer': 'æ•æ„Ÿè¯é¢„è®¾æç¤ºå›žå¤', 'latency': 0.0}
[2025-05-18 21:44:10,742.742] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:44:10,743.743] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:44:10,743.743] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:44:10,744.744] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02403s ago] {'pk_1': UUID('0551bf75-899e-4d70-be05-a9e06b97f704')}
[2025-05-18 21:44:10,746.746] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s WHERE message.id = %(message_id)s::UUID
[2025-05-18 21:44:10,746.746] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00059s] {'message': '[{"type": "human", "data": {"content": "\\u654f\\u611f\\u8bcd1", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "e3f64083-bc57-43ab-bf3d-aba7e158e3ef", "example": false}}]', 'answer': 'æ•æ„Ÿè¯é¢„è®¾æç¤ºå›žå¤', 'message_id': UUID('0551bf75-899e-4d70-be05-a9e06b97f704')}
[2025-05-18 21:44:10,749.749] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:45:42,551.551] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-05-18 21:45:42,573.573] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-05-18 21:45:42,578.578] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-18 21:46:23,646.646] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-18 21:46:23,694.694] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-18 21:46:29,713.713] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-18 21:46:29,722.722] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-18 21:46:29,751.751] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-18 21:46:29,751.751] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-18 21:46:29,757.757] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-18 21:46:29,757.757] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-18 21:46:29,760.760] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:46:29,821.821] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:46:29,821.821] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00469s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-18 21:46:30,053.053] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-18 21:46:30,054.054] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00095s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-18 21:46:30,152.152] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-18 21:46:30,152.152] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00046s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-18 21:46:30,171.171] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-18 21:46:30,172.172] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00156s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-18 21:46:30,179.179] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-18 21:46:30,180.180] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00058s] {'id_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-18 21:46:30,240.240] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-18 21:46:30,242.242] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00140s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'æ˜Žå¤©æ·„åšå¤©æ°”å¦‚ä½•', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-18 21:46:30,291.291] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:46:30,554.554] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:46:30,556.556] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:46:30,556.556] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00034s] {'pk_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:46:30,567.567] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-18 21:46:30,572.572] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00534s] {'conversation_id_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-18 21:46:33,760.760] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:46:33,765.765] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.01501s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-18 21:46:37,087.087] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:46:37,088.088] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00138s] {'pk_1': UUID('c560e4f5-5a0f-41f2-a626-164367a0e12d')}
[2025-05-18 21:46:37,090.090] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [18/May/2025 21:46:37] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-18 21:46:40,916.916] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-18 21:46:40,974.974] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:46:40,975.975] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:46:40,975.975] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00036s] {'pk_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:46:40,979.979] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:46:40,979.979] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00039s] {'pk_1': UUID('c560e4f5-5a0f-41f2-a626-164367a0e12d')}
[2025-05-18 21:46:40,984.984] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-18 21:46:40,984.984] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00054s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'message_id': UUID('c560e4f5-5a0f-41f2-a626-164367a0e12d'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.AGENT_THOUGHT: 'agent_thought'>, 'thought': '[{"name": "google_serper", "args": {"query": "\\u6dc4\\u535a\\u5929\\u6c14\\u9884\\u62a5"}, "id": "call_J6y7EOU6lf964S6lzOXCKNsr", "type": "tool_call"}]', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (5527 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "142a371b-746c-4f50-98d3-ff02fc4ff63d", "example": false}}]', 'answer': '', 'latency': 3.0017162999999982}
[2025-05-18 21:46:41,002.002] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:46:41,003.003] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:46:41,004.004] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:46:41,004.004] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.45s ago] {'pk_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:46:41,005.005] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:46:41,006.006] base.py -> _exec_single_context line:1901 [INFO]: [cached since 3.919s ago] {'pk_1': UUID('c560e4f5-5a0f-41f2-a626-164367a0e12d')}
[2025-05-18 21:46:41,007.007] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-18 21:46:41,007.007] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02366s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'message_id': UUID('c560e4f5-5a0f-41f2-a626-164367a0e12d'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 2, 'event': <QueueEvent.AGENT_ACTION: 'agent_action'>, 'thought': '', 'observation': '"73\\u00b0F"', 'tool': 'google_serper', 'tool_input': '{"query": "\\u6dc4\\u535a\\u5929\\u6c14\\u9884\\u62a5"}', 'message': '{}', 'answer': '', 'latency': 1.401199400000003}
[2025-05-18 21:46:41,011.011] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:46:41,012.012] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:46:41,013.013] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:46:41,013.013] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.46s ago] {'pk_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:46:41,014.014] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:46:41,014.014] base.py -> _exec_single_context line:1901 [INFO]: [cached since 3.928s ago] {'pk_1': UUID('c560e4f5-5a0f-41f2-a626-164367a0e12d')}
[2025-05-18 21:46:41,016.016] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-18 21:46:41,016.016] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03297s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'message_id': UUID('c560e4f5-5a0f-41f2-a626-164367a0e12d'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 3, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': 'æ˜Žå¤©æ·„åšçš„å¤©æ°”é¢„æŠ¥æ˜¾ç¤ºæ°”æ¸©ä¸º73Â°Fï¼ˆçº¦23Â°Cï¼‰ã€‚å¦‚æžœä½ éœ€è¦æ›´è¯¦ç»†çš„ä¿¡æ¯ï¼Œæ¯”å¦‚é™æ°´æ¦‚çŽ‡æˆ–é£Žé€Ÿï¼Œè¯·å‘Šè¯‰æˆ‘ï¼', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (6531 characters truncated) ... ogle_serper", "id": "7dc6627b-1bf8-4392-b650-ccfa2410468f", "tool_call_id": "call_J6y7EOU6lf964S6lzOXCKNsr", "artifact": null, "status": "success"}}]', 'answer': 'æ˜Žå¤©æ·„åšçš„å¤©æ°”é¢„æŠ¥æ˜¾ç¤ºæ°”æ¸©ä¸º73Â°Fï¼ˆçº¦23Â°Cï¼‰ã€‚å¦‚æžœä½ éœ€è¦æ›´è¯¦ç»†çš„ä¿¡æ¯ï¼Œæ¯”å¦‚é™æ°´æ¦‚çŽ‡æˆ–é£Žé€Ÿï¼Œè¯·å‘Šè¯‰æˆ‘ï¼', 'latency': 2.372879300000001}
[2025-05-18 21:46:41,023.023] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:46:41,024.024] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:46:41,025.025] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:46:41,025.025] base.py -> _exec_single_context line:1901 [INFO]: [cached since 3.939s ago] {'pk_1': UUID('c560e4f5-5a0f-41f2-a626-164367a0e12d')}
[2025-05-18 21:46:41,030.030] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s, latency=%(latency)s WHERE message.id = %(message_id)s::UUID
[2025-05-18 21:46:41,030.030] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00048s] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (6531 characters truncated) ... ogle_serper", "id": "7dc6627b-1bf8-4392-b650-ccfa2410468f", "tool_call_id": "call_J6y7EOU6lf964S6lzOXCKNsr", "artifact": null, "status": "success"}}]', 'answer': 'æ˜Žå¤©æ·„åšçš„å¤©æ°”é¢„æŠ¥æ˜¾ç¤ºæ°”æ¸©ä¸º73Â°Fï¼ˆçº¦23Â°Cï¼‰ã€‚å¦‚æžœä½ éœ€è¦æ›´è¯¦ç»†çš„ä¿¡æ¯ï¼Œæ¯”å¦‚é™æ°´æ¦‚çŽ‡æˆ–é£Žé€Ÿï¼Œè¯·å‘Šè¯‰æˆ‘ï¼', 'latency': 6.775795000000002, 'message_id': UUID('c560e4f5-5a0f-41f2-a626-164367a0e12d')}
[2025-05-18 21:46:41,036.036] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:48:12,239.239] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:48:12,239.239] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:48:12,239.239] base.py -> _exec_single_context line:1901 [INFO]: [cached since 102.4s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-18 21:48:12,243.243] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-18 21:48:12,243.243] base.py -> _exec_single_context line:1901 [INFO]: [cached since 102.2s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-18 21:48:12,245.245] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-18 21:48:12,245.245] base.py -> _exec_single_context line:1901 [INFO]: [cached since 102.1s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-18 21:48:12,248.248] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-18 21:48:12,248.248] base.py -> _exec_single_context line:1901 [INFO]: [cached since 102.1s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-18 21:48:12,249.249] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-18 21:48:12,249.249] base.py -> _exec_single_context line:1901 [INFO]: [cached since 102.1s ago] {'id_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-18 21:48:12,250.250] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-18 21:48:12,256.256] base.py -> _exec_single_context line:1901 [INFO]: [cached since 102s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'å¸®æˆ‘æ£€ç´¢æ¿€æ´»å‡½æ•°ç¯‡çš„å†…å®¹', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-18 21:48:12,259.259] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:48:12,315.315] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:48:12,315.315] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:48:12,315.315] base.py -> _exec_single_context line:1901 [INFO]: [cached since 101.8s ago] {'pk_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:48:12,318.318] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-18 21:48:12,318.318] base.py -> _exec_single_context line:1901 [INFO]: [cached since 101.8s ago] {'conversation_id_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-18 21:48:12,321.321] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:48:12,321.321] base.py -> _exec_single_context line:1901 [INFO]: [cached since 98.57s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-18 21:48:15,214.214] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:48:15,215.215] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:48:15,216.216] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-18 21:48:15,217.217] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00071s] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-18 21:48:15,216.216] base.py -> _exec_single_context line:1901 [INFO]: [cached since 98.13s ago] {'pk_1': UUID('907bc255-327c-4087-95a6-7c9cbd5a18f9')}
[2025-05-18 21:48:15,218.218] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [18/May/2025 21:48:15] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-18 21:48:15,678.678] base.py -> similarity_search_with_relevance_scores line:575 [WARNING]: No relevant docs were retrieved using the relevance score threshold 0.7
[2025-05-18 21:48:15,680.680] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (NULL) AND (1 != 1)
[2025-05-18 21:48:15,681.681] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00050s] {'hit_count_1': 1}
[2025-05-18 21:48:15,686.686] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:48:17,662.662] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-18 21:48:17,662.662] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:48:17,663.663] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:48:17,663.663] base.py -> _exec_single_context line:1901 [INFO]: [cached since 96.69s ago] {'pk_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:48:17,664.664] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:48:17,665.665] base.py -> _exec_single_context line:1901 [INFO]: [cached since 96.69s ago] {'pk_1': UUID('907bc255-327c-4087-95a6-7c9cbd5a18f9')}
[2025-05-18 21:48:17,667.667] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-18 21:48:17,667.667] base.py -> _exec_single_context line:1901 [INFO]: [cached since 96.68s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'message_id': UUID('907bc255-327c-4087-95a6-7c9cbd5a18f9'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.AGENT_THOUGHT: 'agent_thought'>, 'thought': '[{"name": "dataset_retrieval", "args": {"query": "\\u6fc0\\u6d3b\\u51fd\\u6570"}, "id": "call_BPVkrMnEYxNpsbIj3IEFKo1Z", "type": "tool_call"}]', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (6386 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "af4d2778-0d28-4a8d-9874-9579ce3efb8e", "example": false}}]', 'answer': '', 'latency': 2.8734357999999816}
[2025-05-18 21:48:17,678.678] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:48:17,679.679] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:48:17,679.679] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:48:17,680.680] base.py -> _exec_single_context line:1901 [INFO]: [cached since 107.1s ago] {'pk_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:48:17,681.681] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:48:17,682.682] base.py -> _exec_single_context line:1901 [INFO]: [cached since 100.6s ago] {'pk_1': UUID('907bc255-327c-4087-95a6-7c9cbd5a18f9')}
[2025-05-18 21:48:17,683.683] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-18 21:48:17,684.684] base.py -> _exec_single_context line:1901 [INFO]: [cached since 96.7s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'message_id': UUID('907bc255-327c-4087-95a6-7c9cbd5a18f9'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 2, 'event': <QueueEvent.DATASET_RETRIEVAL: 'dataset_retrieval'>, 'thought': '', 'observation': '"\\u77e5\\u8bc6\\u5e93\\u5185\\u6ca1\\u6709\\u68c0\\u7d22\\u5230\\u5bf9\\u5e94\\u5185\\u5bb9"', 'tool': 'dataset_retrieval', 'tool_input': '{"query": "\\u6fc0\\u6d3b\\u51fd\\u6570"}', 'message': '{}', 'answer': '', 'latency': 0.4740235999999811}
[2025-05-18 21:48:17,686.686] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:48:17,687.687] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:48:17,688.688] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:48:17,695.695] base.py -> _exec_single_context line:1901 [INFO]: [cached since 107.1s ago] {'pk_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:48:17,695.695] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:48:17,696.696] base.py -> _exec_single_context line:1901 [INFO]: [cached since 100.6s ago] {'pk_1': UUID('907bc255-327c-4087-95a6-7c9cbd5a18f9')}
[2025-05-18 21:48:17,697.697] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-18 21:48:17,697.697] base.py -> _exec_single_context line:1901 [INFO]: [cached since 96.71s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'message_id': UUID('907bc255-327c-4087-95a6-7c9cbd5a18f9'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 3, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': 'æˆ‘æ²¡æœ‰æ‰¾åˆ°å…³äºŽâ€œæ¿€æ´»å‡½æ•°â€çš„å…·ä½“å†…å®¹ã€‚å¦‚æžœä½ éœ€è¦ç‰¹å®šçš„ä¿¡æ¯æˆ–æœ‰å…¶ä»–é—®é¢˜ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼Œæˆ‘ä¼šå°½åŠ›å¸®åŠ©ä½ ï¼', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (7479 characters truncated) ... t_retrieval", "id": "21017478-9bc0-494e-ab48-cf0bf68b6113", "tool_call_id": "call_BPVkrMnEYxNpsbIj3IEFKo1Z", "artifact": null, "status": "success"}}]', 'answer': 'æˆ‘æ²¡æœ‰æ‰¾åˆ°å…³äºŽâ€œæ¿€æ´»å‡½æ•°â€çš„å…·ä½“å†…å®¹ã€‚å¦‚æžœä½ éœ€è¦ç‰¹å®šçš„ä¿¡æ¯æˆ–æœ‰å…¶ä»–é—®é¢˜ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼Œæˆ‘ä¼šå°½åŠ›å¸®åŠ©ä½ ï¼', 'latency': 1.9374694999999917}
[2025-05-18 21:48:17,709.709] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:48:17,710.710] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:48:17,711.711] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:48:17,711.711] base.py -> _exec_single_context line:1901 [INFO]: [cached since 100.6s ago] {'pk_1': UUID('907bc255-327c-4087-95a6-7c9cbd5a18f9')}
[2025-05-18 21:48:17,712.712] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s, latency=%(latency)s WHERE message.id = %(message_id)s::UUID
[2025-05-18 21:48:17,712.712] base.py -> _exec_single_context line:1901 [INFO]: [cached since 96.68s ago] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (7479 characters truncated) ... t_retrieval", "id": "21017478-9bc0-494e-ab48-cf0bf68b6113", "tool_call_id": "call_BPVkrMnEYxNpsbIj3IEFKo1Z", "artifact": null, "status": "success"}}]', 'answer': 'æˆ‘æ²¡æœ‰æ‰¾åˆ°å…³äºŽâ€œæ¿€æ´»å‡½æ•°â€çš„å…·ä½“å†…å®¹ã€‚å¦‚æžœä½ éœ€è¦ç‰¹å®šçš„ä¿¡æ¯æˆ–æœ‰å…¶ä»–é—®é¢˜ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼Œæˆ‘ä¼šå°½åŠ›å¸®åŠ©ä½ ï¼', 'latency': 5.284928899999954, 'message_id': UUID('907bc255-327c-4087-95a6-7c9cbd5a18f9')}
[2025-05-18 21:48:17,714.714] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:50:02,613.613] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:50:02,613.613] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:50:02,614.614] base.py -> _exec_single_context line:1901 [INFO]: [cached since 212.8s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-18 21:50:02,615.615] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-18 21:50:02,616.616] base.py -> _exec_single_context line:1901 [INFO]: [cached since 212.6s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-18 21:50:02,617.617] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-18 21:50:02,617.617] base.py -> _exec_single_context line:1901 [INFO]: [cached since 107.4s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-05-18 21:50:02,618.618] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-18 21:50:02,619.619] base.py -> _exec_single_context line:1901 [INFO]: [cached since 212.5s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-18 21:50:02,620.620] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET datasets=%(datasets)s::JSONB, updated_at=%(updated_at)s WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-18 21:50:02,621.621] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00043s] {'datasets': '["059c1cbc-5230-4056-a44a-4537779922cd"]', 'updated_at': datetime.datetime(2025, 5, 18, 21, 50, 2, 619436), 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-18 21:50:02,627.627] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:50:02,628.628] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [18/May/2025 21:50:02] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-18 21:50:04,902.902] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:50:04,902.902] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:50:04,902.902] base.py -> _exec_single_context line:1901 [INFO]: [cached since 215.1s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-18 21:50:04,904.904] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-18 21:50:04,904.904] base.py -> _exec_single_context line:1901 [INFO]: [cached since 214.8s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-18 21:50:04,905.905] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-18 21:50:04,905.905] base.py -> _exec_single_context line:1901 [INFO]: [cached since 214.8s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-18 21:50:04,907.907] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-18 21:50:04,907.907] base.py -> _exec_single_context line:1901 [INFO]: [cached since 214.7s ago] {'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-05-18 21:50:04,908.908] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-18 21:50:04,916.916] base.py -> _exec_single_context line:1901 [INFO]: [cached since 214.7s ago] {'id_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-18 21:50:04,918.918] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-18 21:50:04,919.919] base.py -> _exec_single_context line:1901 [INFO]: [cached since 214.7s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'å¸®æˆ‘æ£€ç´¢æ¿€æ´»å‡½æ•°ç¯‡çš„å†…å®¹', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-18 21:50:04,920.920] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:50:04,996.996] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:50:04,997.997] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:50:04,997.997] base.py -> _exec_single_context line:1901 [INFO]: [cached since 214.4s ago] {'pk_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:50:05,000.000] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-18 21:50:05,000.000] base.py -> _exec_single_context line:1901 [INFO]: [cached since 214.4s ago] {'conversation_id_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-18 21:50:05,004.004] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:50:05,005.005] base.py -> _exec_single_context line:1901 [INFO]: [cached since 211.3s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-18 21:50:07,561.561] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:50:07,561.561] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:50:07,562.562] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-18 21:50:07,562.562] base.py -> _exec_single_context line:1901 [INFO]: [cached since 210.5s ago] {'pk_1': UUID('a983e87c-a2d0-46ad-842c-427215361dd2')}
[2025-05-18 21:50:07,562.562] base.py -> _exec_single_context line:1901 [INFO]: [cached since 112.3s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-05-18 21:50:07,563.563] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [18/May/2025 21:50:07] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-18 21:50:07,622.622] base.py -> similarity_search_with_relevance_scores line:575 [WARNING]: No relevant docs were retrieved using the relevance score threshold 0.7
[2025-05-18 21:50:07,623.623] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (NULL) AND (1 != 1)
[2025-05-18 21:50:07,623.623] base.py -> _exec_single_context line:1901 [INFO]: [cached since 111.9s ago] {'hit_count_1': 1}
[2025-05-18 21:50:07,626.626] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:50:10,932.932] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-18 21:50:10,932.932] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:50:10,933.933] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:50:10,934.934] base.py -> _exec_single_context line:1901 [INFO]: [cached since 210s ago] {'pk_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:50:10,936.936] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:50:10,936.936] base.py -> _exec_single_context line:1901 [INFO]: [cached since 210s ago] {'pk_1': UUID('a983e87c-a2d0-46ad-842c-427215361dd2')}
[2025-05-18 21:50:10,938.938] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-18 21:50:10,940.940] base.py -> _exec_single_context line:1901 [INFO]: [cached since 210s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'message_id': UUID('a983e87c-a2d0-46ad-842c-427215361dd2'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.AGENT_THOUGHT: 'agent_thought'>, 'thought': '[{"name": "dataset_retrieval", "args": {"query": "\\u6fc0\\u6d3b\\u51fd\\u6570"}, "id": "call_Pdcshyi3pKUu0CzHFXo7T4Or", "type": "tool_call"}]', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (7253 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "a569159e-d279-4470-9be8-1e4cb3ea0fe3", "example": false}}]', 'answer': '', 'latency': 2.5285365000000297}
[2025-05-18 21:50:10,951.951] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:50:10,953.953] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:50:10,953.953] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:50:10,954.954] base.py -> _exec_single_context line:1901 [INFO]: [cached since 220.4s ago] {'pk_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:50:10,955.955] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:50:10,956.956] base.py -> _exec_single_context line:1901 [INFO]: [cached since 213.9s ago] {'pk_1': UUID('a983e87c-a2d0-46ad-842c-427215361dd2')}
[2025-05-18 21:50:10,957.957] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-18 21:50:10,957.957] base.py -> _exec_single_context line:1901 [INFO]: [cached since 210s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'message_id': UUID('a983e87c-a2d0-46ad-842c-427215361dd2'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 2, 'event': <QueueEvent.DATASET_RETRIEVAL: 'dataset_retrieval'>, 'thought': '', 'observation': '"\\u77e5\\u8bc6\\u5e93\\u5185\\u6ca1\\u6709\\u68c0\\u7d22\\u5230\\u5bf9\\u5e94\\u5185\\u5bb9"', 'tool': 'dataset_retrieval', 'tool_input': '{"query": "\\u6fc0\\u6d3b\\u51fd\\u6570"}', 'message': '{}', 'answer': '', 'latency': 0.06724360000004026}
[2025-05-18 21:50:10,959.959] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:50:10,960.960] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:50:10,961.961] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:50:10,961.961] base.py -> _exec_single_context line:1901 [INFO]: [cached since 220.4s ago] {'pk_1': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44')}
[2025-05-18 21:50:10,963.963] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:50:10,963.963] base.py -> _exec_single_context line:1901 [INFO]: [cached since 213.9s ago] {'pk_1': UUID('a983e87c-a2d0-46ad-842c-427215361dd2')}
[2025-05-18 21:50:10,965.965] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-18 21:50:10,965.965] base.py -> _exec_single_context line:1901 [INFO]: [cached since 210s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('d598d8cf-7c1b-4d4d-b48e-0633cd851d44'), 'message_id': UUID('a983e87c-a2d0-46ad-842c-427215361dd2'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 3, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': 'æŠ±æ­‰ï¼Œæˆ‘åœ¨çŸ¥è¯†åº“ä¸­æ²¡æœ‰æ‰¾åˆ°å…³äºŽâ€œæ¿€æ´»å‡½æ•°â€çš„ç›¸å…³å†…å®¹ã€‚å¦‚æžœä½ æœ‰å…·ä½“çš„é—®é¢˜æˆ–è€…éœ€è¦äº†è§£æŸä¸ªæ–¹é¢çš„ä¿¡æ¯ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼Œæˆ‘ä¼šå°½åŠ›å¸®åŠ©ä½ ï¼', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (8346 characters truncated) ... t_retrieval", "id": "6a00aec0-b1c0-4caf-bf25-ce062fa3ae96", "tool_call_id": "call_Pdcshyi3pKUu0CzHFXo7T4Or", "artifact": null, "status": "success"}}]', 'answer': 'æŠ±æ­‰ï¼Œæˆ‘åœ¨çŸ¥è¯†åº“ä¸­æ²¡æœ‰æ‰¾åˆ°å…³äºŽâ€œæ¿€æ´»å‡½æ•°â€çš„ç›¸å…³å†…å®¹ã€‚å¦‚æžœä½ æœ‰å…·ä½“çš„é—®é¢˜æˆ–è€…éœ€è¦äº†è§£æŸä¸ªæ–¹é¢çš„ä¿¡æ¯ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼Œæˆ‘ä¼šå°½åŠ›å¸®åŠ©ä½ ï¼', 'latency': 3.24900150000002}
[2025-05-18 21:50:10,980.980] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:50:10,982.982] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:50:10,982.982] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:50:10,982.982] base.py -> _exec_single_context line:1901 [INFO]: [cached since 213.9s ago] {'pk_1': UUID('a983e87c-a2d0-46ad-842c-427215361dd2')}
[2025-05-18 21:50:10,984.984] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s, latency=%(latency)s WHERE message.id = %(message_id)s::UUID
[2025-05-18 21:50:10,985.985] base.py -> _exec_single_context line:1901 [INFO]: [cached since 210s ago] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (8346 characters truncated) ... t_retrieval", "id": "6a00aec0-b1c0-4caf-bf25-ce062fa3ae96", "tool_call_id": "call_Pdcshyi3pKUu0CzHFXo7T4Or", "artifact": null, "status": "success"}}]', 'answer': 'æŠ±æ­‰ï¼Œæˆ‘åœ¨çŸ¥è¯†åº“ä¸­æ²¡æœ‰æ‰¾åˆ°å…³äºŽâ€œæ¿€æ´»å‡½æ•°â€çš„ç›¸å…³å†…å®¹ã€‚å¦‚æžœä½ æœ‰å…·ä½“çš„é—®é¢˜æˆ–è€…éœ€è¦äº†è§£æŸä¸ªæ–¹é¢çš„ä¿¡æ¯ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼Œæˆ‘ä¼šå°½åŠ›å¸®åŠ©ä½ ï¼', 'latency': 5.84478160000009, 'message_id': UUID('a983e87c-a2d0-46ad-842c-427215361dd2')}
[2025-05-18 21:50:10,987.987] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:50:31,608.608] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:50:31,608.608] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:50:31,609.609] base.py -> _exec_single_context line:1901 [INFO]: [cached since 241.8s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-18 21:50:31,610.610] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-18 21:50:31,610.610] base.py -> _exec_single_context line:1901 [INFO]: [cached since 241.6s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-18 21:50:31,611.611] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app SET debug_conversation_id=%(debug_conversation_id)s::UUID WHERE app.id = %(app_id)s::UUID
[2025-05-18 21:50:31,612.612] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00030s] {'debug_conversation_id': None, 'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-18 21:50:31,613.613] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:50:31,619.619] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [18/May/2025 21:50:31] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations/delete-debug-conversation HTTP/1.1" 200 -
[2025-05-18 21:50:33,732.732] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:50:33,732.732] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:50:33,733.733] base.py -> _exec_single_context line:1901 [INFO]: [cached since 243.9s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-18 21:50:33,735.735] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-18 21:50:33,735.735] base.py -> _exec_single_context line:1901 [INFO]: [cached since 243.7s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-18 21:50:33,738.738] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-18 21:50:33,738.738] base.py -> _exec_single_context line:1901 [INFO]: [cached since 243.6s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-18 21:50:33,739.739] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-18 21:50:33,739.739] base.py -> _exec_single_context line:1901 [INFO]: [cached since 243.6s ago] {'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-05-18 21:50:33,740.740] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO conversation (app_id, name, invoke_from, created_by) VALUES (%(app_id)s::UUID, %(name)s, %(invoke_from)s, %(created_by)s::UUID) RETURNING conversation.id, conversation.summary, conversation.is_pinned, conversation.is_deleted, conversation.updated_at, conversation.created_at
[2025-05-18 21:50:33,741.741] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00032s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'name': 'New Conversation', 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-18 21:50:33,742.742] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app SET debug_conversation_id=%(debug_conversation_id)s::UUID WHERE app.id = %(app_id)s::UUID
[2025-05-18 21:50:33,742.742] base.py -> _exec_single_context line:1901 [INFO]: [cached since 2.131s ago] {'debug_conversation_id': UUID('8be0e800-6015-4cab-88bc-6281c1d2540b'), 'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-18 21:50:33,743.743] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:50:33,744.744] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:50:33,744.744] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:50:33,745.745] base.py -> _exec_single_context line:1901 [INFO]: [cached since 243.2s ago] {'pk_1': UUID('8be0e800-6015-4cab-88bc-6281c1d2540b')}
[2025-05-18 21:50:33,746.746] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:50:33,746.746] base.py -> _exec_single_context line:1901 [INFO]: [cached since 240s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-18 21:50:33,747.747] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-18 21:50:33,747.747] base.py -> _exec_single_context line:1901 [INFO]: [cached since 243.5s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('8be0e800-6015-4cab-88bc-6281c1d2540b'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'å¸®æˆ‘æ£€ç´¢æ¿€æ´»å‡½æ•°ç¯‡çš„å†…å®¹', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-18 21:50:33,750.750] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:50:33,802.802] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:50:33,803.803] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:50:33,803.803] base.py -> _exec_single_context line:1901 [INFO]: [cached since 243.2s ago] {'pk_1': UUID('8be0e800-6015-4cab-88bc-6281c1d2540b')}
[2025-05-18 21:50:33,804.804] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-18 21:50:33,805.805] base.py -> _exec_single_context line:1901 [INFO]: [cached since 243.2s ago] {'conversation_id_1': UUID('8be0e800-6015-4cab-88bc-6281c1d2540b'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-18 21:50:33,806.806] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:50:33,806.806] base.py -> _exec_single_context line:1901 [INFO]: [cached since 240.1s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-18 21:50:37,300.300] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:50:37,300.300] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:50:37,301.301] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-18 21:50:37,301.301] base.py -> _exec_single_context line:1901 [INFO]: [cached since 240.2s ago] {'pk_1': UUID('cfbd7f27-5258-42a9-843a-3aa55992bebe')}
[2025-05-18 21:50:37,301.301] base.py -> _exec_single_context line:1901 [INFO]: [cached since 142.1s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-05-18 21:50:37,302.302] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [18/May/2025 21:50:37] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-18 21:50:37,348.348] base.py -> similarity_search_with_relevance_scores line:575 [WARNING]: No relevant docs were retrieved using the relevance score threshold 0.7
[2025-05-18 21:50:37,350.350] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (NULL) AND (1 != 1)
[2025-05-18 21:50:37,350.350] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.7s ago] {'hit_count_1': 1}
[2025-05-18 21:50:37,352.352] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:50:39,935.935] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-18 21:50:39,935.935] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:50:39,936.936] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:50:39,936.936] base.py -> _exec_single_context line:1901 [INFO]: [cached since 239s ago] {'pk_1': UUID('8be0e800-6015-4cab-88bc-6281c1d2540b')}
[2025-05-18 21:50:39,938.938] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:50:39,939.939] base.py -> _exec_single_context line:1901 [INFO]: [cached since 239s ago] {'pk_1': UUID('cfbd7f27-5258-42a9-843a-3aa55992bebe')}
[2025-05-18 21:50:39,940.940] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-18 21:50:39,941.941] base.py -> _exec_single_context line:1901 [INFO]: [cached since 239s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('8be0e800-6015-4cab-88bc-6281c1d2540b'), 'message_id': UUID('cfbd7f27-5258-42a9-843a-3aa55992bebe'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.AGENT_THOUGHT: 'agent_thought'>, 'thought': '[{"name": "dataset_retrieval", "args": {"query": "\\u6fc0\\u6d3b\\u51fd\\u6570"}, "id": "call_KS1F1o1O0jsfG44YOwt1AV1g", "type": "tool_call"}]', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (2930 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "7708159b-bd3c-4d64-891a-5fd40327e522", "example": false}}]', 'answer': '', 'latency': 3.4735840000000167}
[2025-05-18 21:50:39,947.947] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:50:39,949.949] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:50:39,949.949] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:50:39,950.950] base.py -> _exec_single_context line:1901 [INFO]: [cached since 249.4s ago] {'pk_1': UUID('8be0e800-6015-4cab-88bc-6281c1d2540b')}
[2025-05-18 21:50:39,951.951] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:50:39,952.952] base.py -> _exec_single_context line:1901 [INFO]: [cached since 242.9s ago] {'pk_1': UUID('cfbd7f27-5258-42a9-843a-3aa55992bebe')}
[2025-05-18 21:50:39,953.953] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-18 21:50:39,954.954] base.py -> _exec_single_context line:1901 [INFO]: [cached since 239s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('8be0e800-6015-4cab-88bc-6281c1d2540b'), 'message_id': UUID('cfbd7f27-5258-42a9-843a-3aa55992bebe'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 2, 'event': <QueueEvent.DATASET_RETRIEVAL: 'dataset_retrieval'>, 'thought': '', 'observation': '"\\u77e5\\u8bc6\\u5e93\\u5185\\u6ca1\\u6709\\u68c0\\u7d22\\u5230\\u5bf9\\u5e94\\u5185\\u5bb9"', 'tool': 'dataset_retrieval', 'tool_input': '{"query": "\\u6fc0\\u6d3b\\u51fd\\u6570"}', 'message': '{}', 'answer': '', 'latency': 0.05494570000001886}
[2025-05-18 21:50:39,956.956] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:50:39,957.957] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:50:39,958.958] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:50:39,960.960] base.py -> _exec_single_context line:1901 [INFO]: [cached since 249.4s ago] {'pk_1': UUID('8be0e800-6015-4cab-88bc-6281c1d2540b')}
[2025-05-18 21:50:39,961.961] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:50:39,962.962] base.py -> _exec_single_context line:1901 [INFO]: [cached since 242.9s ago] {'pk_1': UUID('cfbd7f27-5258-42a9-843a-3aa55992bebe')}
[2025-05-18 21:50:39,963.963] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-18 21:50:39,963.963] base.py -> _exec_single_context line:1901 [INFO]: [cached since 239s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('8be0e800-6015-4cab-88bc-6281c1d2540b'), 'message_id': UUID('cfbd7f27-5258-42a9-843a-3aa55992bebe'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 3, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': 'å¾ˆæŠ±æ­‰ï¼Œæˆ‘æœªèƒ½æ‰¾åˆ°å…³äºŽæ¿€æ´»å‡½æ•°çš„ç›¸å…³å†…å®¹ã€‚è¯·é—®æ‚¨éœ€è¦äº†è§£æ¿€æ´»å‡½æ•°çš„å“ªäº›å…·ä½“æ–¹é¢ï¼Ÿæ¯”å¦‚å¸¸è§ç±»åž‹ã€åº”ç”¨åœºæ™¯æˆ–æ•°å­¦æ€§è´¨ç­‰ï¼Ÿè¿™æ ·æˆ‘å¯ä»¥æ›´å¥½åœ°ä¸ºæ‚¨æä¾›ä¿¡æ¯ã€‚', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (4023 characters truncated) ... t_retrieval", "id": "239f3aac-3b09-4869-b4ef-2cc18d384750", "tool_call_id": "call_KS1F1o1O0jsfG44YOwt1AV1g", "artifact": null, "status": "success"}}]', 'answer': 'å¾ˆæŠ±æ­‰ï¼Œæˆ‘æœªèƒ½æ‰¾åˆ°å…³äºŽæ¿€æ´»å‡½æ•°çš„ç›¸å…³å†…å®¹ã€‚è¯·é—®æ‚¨éœ€è¦äº†è§£æ¿€æ´»å‡½æ•°çš„å“ªäº›å…·ä½“æ–¹é¢ï¼Ÿæ¯”å¦‚å¸¸è§ç±»åž‹ã€åº”ç”¨åœºæ™¯æˆ–æ•°å­¦æ€§è´¨ç­‰ï¼Ÿè¿™æ ·æˆ‘å¯ä»¥æ›´å¥½åœ°ä¸ºæ‚¨æä¾›ä¿¡æ¯ã€‚', 'latency': 2.5674971000000255}
[2025-05-18 21:50:39,965.965] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:50:39,966.966] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:50:39,967.967] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:50:39,975.975] base.py -> _exec_single_context line:1901 [INFO]: [cached since 242.9s ago] {'pk_1': UUID('cfbd7f27-5258-42a9-843a-3aa55992bebe')}
[2025-05-18 21:50:39,977.977] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s, latency=%(latency)s WHERE message.id = %(message_id)s::UUID
[2025-05-18 21:50:39,977.977] base.py -> _exec_single_context line:1901 [INFO]: [cached since 238.9s ago] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (4023 characters truncated) ... t_retrieval", "id": "239f3aac-3b09-4869-b4ef-2cc18d384750", "tool_call_id": "call_KS1F1o1O0jsfG44YOwt1AV1g", "artifact": null, "status": "success"}}]', 'answer': 'å¾ˆæŠ±æ­‰ï¼Œæˆ‘æœªèƒ½æ‰¾åˆ°å…³äºŽæ¿€æ´»å‡½æ•°çš„ç›¸å…³å†…å®¹ã€‚è¯·é—®æ‚¨éœ€è¦äº†è§£æ¿€æ´»å‡½æ•°çš„å“ªäº›å…·ä½“æ–¹é¢ï¼Ÿæ¯”å¦‚å¸¸è§ç±»åž‹ã€åº”ç”¨åœºæ™¯æˆ–æ•°å­¦æ€§è´¨ç­‰ï¼Ÿè¿™æ ·æˆ‘å¯ä»¥æ›´å¥½åœ°ä¸ºæ‚¨æä¾›ä¿¡æ¯ã€‚', 'latency': 6.096026800000061, 'message_id': UUID('cfbd7f27-5258-42a9-843a-3aa55992bebe')}
[2025-05-18 21:50:39,979.979] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:53:46,941.941] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:53:46,942.942] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:53:46,942.942] base.py -> _exec_single_context line:1901 [INFO]: [cached since 437.1s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-18 21:53:46,944.944] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-18 21:53:46,944.944] base.py -> _exec_single_context line:1901 [INFO]: [cached since 436.9s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-18 21:53:46,946.946] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-18 21:53:46,946.946] base.py -> _exec_single_context line:1901 [INFO]: [cached since 331.7s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '2ac819a6-484a-4f18-b251-7cb713955c21'}
[2025-05-18 21:53:46,947.947] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-18 21:53:46,947.947] base.py -> _exec_single_context line:1901 [INFO]: [cached since 436.8s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-18 21:53:46,949.949] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET datasets=%(datasets)s::JSONB, updated_at=%(updated_at)s WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-18 21:53:46,949.949] base.py -> _exec_single_context line:1901 [INFO]: [cached since 224.3s ago] {'datasets': '[]', 'updated_at': datetime.datetime(2025, 5, 18, 21, 53, 46, 948781), 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-18 21:53:46,951.951] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:53:46,952.952] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [18/May/2025 21:53:46] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-18 21:53:49,303.303] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:53:49,303.303] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:53:49,304.304] base.py -> _exec_single_context line:1901 [INFO]: [cached since 439.5s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-18 21:53:49,306.306] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-18 21:53:49,307.307] base.py -> _exec_single_context line:1901 [INFO]: [cached since 439.3s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-18 21:53:49,308.308] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-18 21:53:49,309.309] base.py -> _exec_single_context line:1901 [INFO]: [cached since 439.2s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-18 21:53:49,310.310] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (NULL) AND (1 != 1)
[2025-05-18 21:53:49,311.311] base.py -> _exec_single_context line:1901 [INFO]: [cached since 439.1s ago] {}
[2025-05-18 21:53:49,312.312] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-18 21:53:49,312.312] base.py -> _exec_single_context line:1901 [INFO]: [cached since 439.1s ago] {'id_1': UUID('8be0e800-6015-4cab-88bc-6281c1d2540b'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-18 21:53:49,313.313] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-18 21:53:49,314.314] base.py -> _exec_single_context line:1901 [INFO]: [cached since 439.1s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('8be0e800-6015-4cab-88bc-6281c1d2540b'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'å¸®æˆ‘æ£€ç´¢æ¿€æ´»å‡½æ•°ç¯‡çš„å†…å®¹', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-18 21:53:49,317.317] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:53:49,389.389] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:53:49,389.389] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:53:49,390.390] base.py -> _exec_single_context line:1901 [INFO]: [cached since 438.8s ago] {'pk_1': UUID('8be0e800-6015-4cab-88bc-6281c1d2540b')}
[2025-05-18 21:53:49,392.392] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-18 21:53:49,392.392] base.py -> _exec_single_context line:1901 [INFO]: [cached since 438.8s ago] {'conversation_id_1': UUID('8be0e800-6015-4cab-88bc-6281c1d2540b'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-18 21:53:49,395.395] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:53:49,396.396] base.py -> _exec_single_context line:1901 [INFO]: [cached since 435.6s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-18 21:53:51,993.993] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:53:51,994.994] base.py -> _exec_single_context line:1901 [INFO]: [cached since 434.9s ago] {'pk_1': UUID('9ceceadc-4c47-4170-b5d0-21bdd4554a8b')}
[2025-05-18 21:53:51,995.995] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [18/May/2025 21:53:51] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-18 21:54:01,304.304] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-18 21:54:01,304.304] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:54:01,305.305] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:54:01,305.305] base.py -> _exec_single_context line:1901 [INFO]: [cached since 440.3s ago] {'pk_1': UUID('8be0e800-6015-4cab-88bc-6281c1d2540b')}
[2025-05-18 21:54:01,306.306] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:54:01,306.306] base.py -> _exec_single_context line:1901 [INFO]: [cached since 440.3s ago] {'pk_1': UUID('9ceceadc-4c47-4170-b5d0-21bdd4554a8b')}
[2025-05-18 21:54:01,309.309] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-18 21:54:01,309.309] base.py -> _exec_single_context line:1901 [INFO]: [cached since 440.3s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('8be0e800-6015-4cab-88bc-6281c1d2540b'), 'message_id': UUID('9ceceadc-4c47-4170-b5d0-21bdd4554a8b'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.AGENT_THOUGHT: 'agent_thought'>, 'thought': '[{"name": "google_serper", "args": {"query": "\\u6fc0\\u6d3b\\u51fd\\u6570 \\u4ecb\\u7ecd \\u6587\\u7ae0"}, "id": "call_JePyXK4MySQM5HMmh2Sd96YZ", "type": "tool_call"}]', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (3965 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "734be2c7-ef2f-4e75-bb0b-987f3a66b123", "example": false}}]', 'answer': '', 'latency': 2.577757399999996}
[2025-05-18 21:54:01,311.311] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:54:01,312.312] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:54:01,313.313] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:54:01,313.313] base.py -> _exec_single_context line:1901 [INFO]: [cached since 450.8s ago] {'pk_1': UUID('8be0e800-6015-4cab-88bc-6281c1d2540b')}
[2025-05-18 21:54:01,314.314] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:54:01,314.314] base.py -> _exec_single_context line:1901 [INFO]: [cached since 444.2s ago] {'pk_1': UUID('9ceceadc-4c47-4170-b5d0-21bdd4554a8b')}
[2025-05-18 21:54:01,315.315] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-18 21:54:01,316.316] base.py -> _exec_single_context line:1901 [INFO]: [cached since 440.3s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('8be0e800-6015-4cab-88bc-6281c1d2540b'), 'message_id': UUID('9ceceadc-4c47-4170-b5d0-21bdd4554a8b'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 2, 'event': <QueueEvent.AGENT_ACTION: 'agent_action'>, 'thought': '', 'observation': '"\\u9996\\u5148\\uff0c\\u6211\\u4eec\\u77e5\\u9053\\u795e\\u7ecf\\u7f51\\u7edc\\u6a21\\u62df\\u4e86\\u4eba\\u7c7b\\u795e\\u7ecf\\u5143\\u7684\\u5de5\ ... (4426 characters truncated) ... 8ba8\\u8bba\\u6fc0\\u6d3b\\u51fd\\u6570\\u8f93\\u51fa\\u662f\\u5426\\u4ee5\\u96f6\\u4e3a\\u4e2d\\u5fc3\\u7684\\u95ee\\u9898\\uff0c\\u56e0\\u800c ..."', 'tool': 'google_serper', 'tool_input': '{"query": "\\u6fc0\\u6d3b\\u51fd\\u6570 \\u4ecb\\u7ecd \\u6587\\u7ae0"}', 'message': '{}', 'answer': '', 'latency': 1.2961109000000306}
[2025-05-18 21:54:01,317.317] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:54:01,318.318] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:54:01,319.319] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:54:01,319.319] base.py -> _exec_single_context line:1901 [INFO]: [cached since 450.8s ago] {'pk_1': UUID('8be0e800-6015-4cab-88bc-6281c1d2540b')}
[2025-05-18 21:54:01,320.320] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:54:01,321.321] base.py -> _exec_single_context line:1901 [INFO]: [cached since 444.2s ago] {'pk_1': UUID('9ceceadc-4c47-4170-b5d0-21bdd4554a8b')}
[2025-05-18 21:54:01,321.321] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-18 21:54:01,323.323] base.py -> _exec_single_context line:1901 [INFO]: [cached since 440.3s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('8be0e800-6015-4cab-88bc-6281c1d2540b'), 'message_id': UUID('9ceceadc-4c47-4170-b5d0-21bdd4554a8b'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 3, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': 'æˆ‘æ‰¾åˆ°äº†ä¸€äº›å…³äºŽæ¿€æ´»å‡½æ•°çš„å†…å®¹ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›å…³é”®ç‚¹ï¼š\n\n1. **æ¿€æ´»å‡½æ•°å®šä¹‰**ï¼šæ¿€æ´»å‡½æ•°ï¼ˆActivation Functionï¼‰æ˜¯åœ¨ç¥žç»ç½‘ç»œä¸­ç”¨äºŽå¼•å…¥éžçº¿æ€§ç‰¹æ€§çš„å‡½æ•°ã€‚å®ƒçš„ä½œç”¨æ˜¯å°†è¾“å…¥ä¿¡å·è½¬æ¢ä¸ºè¾“å‡ºä¿¡å·ï¼Œä½¿å¾—ç¥žç»ç½‘ç»œèƒ½å¤Ÿå­¦ä¹ å’Œè¡¨ç¤ºå¤æ‚çš„éžçº¿æ€§å…³ç³»ã€‚\n\n2. **å¸¸è§æ¿€æ´»å‡½æ•°**ï¼š\n  ... (235 characters truncated) ... ntial Linear Unitsï¼‰**ï¼šåœ¨è¾“å…¥ä¸ºè´Ÿæ—¶ï¼Œè¾“å‡ºæŒ‡æ•°è¡°å‡ï¼Œæœ‰åŠ©äºŽæé«˜æ¨¡åž‹çš„æ”¶æ•›é€Ÿåº¦ã€‚\n\n3. **æ¿€æ´»å‡½æ•°çš„é‡è¦æ€§**ï¼šæ¿€æ´»å‡½æ•°åœ¨ç¥žç»ç½‘ç»œä¸­çš„é‡è¦æ€§ä¸è¨€è€Œå–»ï¼Œå®ƒä»¬å¸®åŠ©ç½‘ç»œå­¦ä¹ å¤æ‚çš„æ¨¡å¼å’Œç‰¹å¾ï¼Œæ˜¯æž„å»ºæ·±å±‚ç¥žç»ç½‘ç»œçš„å…³é”®ç»„ä»¶ã€‚\n\nå¦‚æžœæ‚¨éœ€è¦æ›´è¯¦ç»†çš„ä¿¡æ¯æˆ–ç‰¹å®šæ–¹é¢çš„èµ„æ–™ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (10975 characters truncated) ... ogle_serper", "id": "d7e68b15-3ae8-419d-8494-453b8d1441e4", "tool_call_id": "call_JePyXK4MySQM5HMmh2Sd96YZ", "artifact": null, "status": "success"}}]', 'answer': 'æˆ‘æ‰¾åˆ°äº†ä¸€äº›å…³äºŽæ¿€æ´»å‡½æ•°çš„å†…å®¹ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›å…³é”®ç‚¹ï¼š\n\n1. **æ¿€æ´»å‡½æ•°å®šä¹‰**ï¼šæ¿€æ´»å‡½æ•°ï¼ˆActivation Functionï¼‰æ˜¯åœ¨ç¥žç»ç½‘ç»œä¸­ç”¨äºŽå¼•å…¥éžçº¿æ€§ç‰¹æ€§çš„å‡½æ•°ã€‚å®ƒçš„ä½œç”¨æ˜¯å°†è¾“å…¥ä¿¡å·è½¬æ¢ä¸ºè¾“å‡ºä¿¡å·ï¼Œä½¿å¾—ç¥žç»ç½‘ç»œèƒ½å¤Ÿå­¦ä¹ å’Œè¡¨ç¤ºå¤æ‚çš„éžçº¿æ€§å…³ç³»ã€‚\n\n2. **å¸¸è§æ¿€æ´»å‡½æ•°**ï¼š\n  ... (235 characters truncated) ... ntial Linear Unitsï¼‰**ï¼šåœ¨è¾“å…¥ä¸ºè´Ÿæ—¶ï¼Œè¾“å‡ºæŒ‡æ•°è¡°å‡ï¼Œæœ‰åŠ©äºŽæé«˜æ¨¡åž‹çš„æ”¶æ•›é€Ÿåº¦ã€‚\n\n3. **æ¿€æ´»å‡½æ•°çš„é‡è¦æ€§**ï¼šæ¿€æ´»å‡½æ•°åœ¨ç¥žç»ç½‘ç»œä¸­çš„é‡è¦æ€§ä¸è¨€è€Œå–»ï¼Œå®ƒä»¬å¸®åŠ©ç½‘ç»œå­¦ä¹ å¤æ‚çš„æ¨¡å¼å’Œç‰¹å¾ï¼Œæ˜¯æž„å»ºæ·±å±‚ç¥žç»ç½‘ç»œçš„å…³é”®ç»„ä»¶ã€‚\n\nå¦‚æžœæ‚¨éœ€è¦æ›´è¯¦ç»†çš„ä¿¡æ¯æˆ–ç‰¹å®šæ–¹é¢çš„èµ„æ–™ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼', 'latency': 7.976768400000026}
[2025-05-18 21:54:01,326.326] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:54:01,327.327] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:54:01,327.327] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 21:54:01,328.328] base.py -> _exec_single_context line:1901 [INFO]: [cached since 444.2s ago] {'pk_1': UUID('9ceceadc-4c47-4170-b5d0-21bdd4554a8b')}
[2025-05-18 21:54:01,329.329] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s, latency=%(latency)s WHERE message.id = %(message_id)s::UUID
[2025-05-18 21:54:01,329.329] base.py -> _exec_single_context line:1901 [INFO]: [cached since 440.3s ago] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (10975 characters truncated) ... ogle_serper", "id": "d7e68b15-3ae8-419d-8494-453b8d1441e4", "tool_call_id": "call_JePyXK4MySQM5HMmh2Sd96YZ", "artifact": null, "status": "success"}}]', 'answer': 'æˆ‘æ‰¾åˆ°äº†ä¸€äº›å…³äºŽæ¿€æ´»å‡½æ•°çš„å†…å®¹ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›å…³é”®ç‚¹ï¼š\n\n1. **æ¿€æ´»å‡½æ•°å®šä¹‰**ï¼šæ¿€æ´»å‡½æ•°ï¼ˆActivation Functionï¼‰æ˜¯åœ¨ç¥žç»ç½‘ç»œä¸­ç”¨äºŽå¼•å…¥éžçº¿æ€§ç‰¹æ€§çš„å‡½æ•°ã€‚å®ƒçš„ä½œç”¨æ˜¯å°†è¾“å…¥ä¿¡å·è½¬æ¢ä¸ºè¾“å‡ºä¿¡å·ï¼Œä½¿å¾—ç¥žç»ç½‘ç»œèƒ½å¤Ÿå­¦ä¹ å’Œè¡¨ç¤ºå¤æ‚çš„éžçº¿æ€§å…³ç³»ã€‚\n\n2. **å¸¸è§æ¿€æ´»å‡½æ•°**ï¼š\n  ... (235 characters truncated) ... ntial Linear Unitsï¼‰**ï¼šåœ¨è¾“å…¥ä¸ºè´Ÿæ—¶ï¼Œè¾“å‡ºæŒ‡æ•°è¡°å‡ï¼Œæœ‰åŠ©äºŽæé«˜æ¨¡åž‹çš„æ”¶æ•›é€Ÿåº¦ã€‚\n\n3. **æ¿€æ´»å‡½æ•°çš„é‡è¦æ€§**ï¼šæ¿€æ´»å‡½æ•°åœ¨ç¥žç»ç½‘ç»œä¸­çš„é‡è¦æ€§ä¸è¨€è€Œå–»ï¼Œå®ƒä»¬å¸®åŠ©ç½‘ç»œå­¦ä¹ å¤æ‚çš„æ¨¡å¼å’Œç‰¹å¾ï¼Œæ˜¯æž„å»ºæ·±å±‚ç¥žç»ç½‘ç»œçš„å…³é”®ç»„ä»¶ã€‚\n\nå¦‚æžœæ‚¨éœ€è¦æ›´è¯¦ç»†çš„ä¿¡æ¯æˆ–ç‰¹å®šæ–¹é¢çš„èµ„æ–™ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼', 'latency': 11.850636700000052, 'message_id': UUID('9ceceadc-4c47-4170-b5d0-21bdd4554a8b')}
[2025-05-18 21:54:01,331.331] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:56:43,969.969] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\core\\agent\\agents\\base_agent.py', reloading
[2025-05-18 21:56:45,491.491] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-18 21:57:36,968.968] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-18 21:57:36,999.999] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-18 21:59:57,476.476] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-18 21:59:57,476.476] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-18 21:59:57,480.480] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-18 21:59:57,480.480] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-18 21:59:57,481.481] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-18 21:59:57,482.482] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-18 21:59:57,482.482] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:59:57,489.489] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:59:57,490.490] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00063s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-18 21:59:57,507.507] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-18 21:59:57,509.509] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00040s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-18 21:59:57,514.514] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-18 21:59:57,515.515] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00046s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-18 21:59:57,521.521] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (NULL) AND (1 != 1)
[2025-05-18 21:59:57,522.522] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00089s] {}
[2025-05-18 21:59:57,525.525] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-18 21:59:57,526.526] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00055s] {'id_1': UUID('8be0e800-6015-4cab-88bc-6281c1d2540b'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-18 21:59:57,533.533] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-18 21:59:57,534.534] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00058s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('8be0e800-6015-4cab-88bc-6281c1d2540b'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-18 21:59:57,548.548] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 21:59:57,650.650] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 21:59:57,650.650] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 21:59:57,650.650] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00045s] {'pk_1': UUID('8be0e800-6015-4cab-88bc-6281c1d2540b')}
[2025-05-18 21:59:57,655.655] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-18 21:59:57,656.656] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00062s] {'conversation_id_1': UUID('8be0e800-6015-4cab-88bc-6281c1d2540b'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-18 21:59:58,625.625] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-18 21:59:58,625.625] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00061s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-18 22:00:03,484.484] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 22:00:03,489.489] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00454s] {'pk_1': UUID('2d424184-df82-4f94-a7be-7d20fd15d93d')}
[2025-05-18 22:00:03,490.490] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [18/May/2025 22:00:03] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-18 22:00:03,502.502] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-18 22:00:03,553.553] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 22:00:03,554.554] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-18 22:00:03,554.554] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00048s] {'pk_1': UUID('8be0e800-6015-4cab-88bc-6281c1d2540b')}
[2025-05-18 22:00:03,558.558] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 22:00:03,563.563] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00460s] {'pk_1': UUID('2d424184-df82-4f94-a7be-7d20fd15d93d')}
[2025-05-18 22:00:03,568.568] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-18 22:00:03,569.569] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00074s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('8be0e800-6015-4cab-88bc-6281c1d2540b'), 'message_id': UUID('2d424184-df82-4f94-a7be-7d20fd15d93d'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': 'ä½ å¥½ï¼æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (6945 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "550e7649-d3f9-470e-91c7-9fb3cc21c782", "example": false}}]', 'answer': 'ä½ å¥½ï¼æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ', 'latency': 4.665544099999977}
[2025-05-18 22:00:03,580.580] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-18 22:00:03,581.581] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-18 22:00:03,581.581] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-18 22:00:03,582.582] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.09829s ago] {'pk_1': UUID('2d424184-df82-4f94-a7be-7d20fd15d93d')}
[2025-05-18 22:00:03,584.584] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s, latency=%(latency)s WHERE message.id = %(message_id)s::UUID
[2025-05-18 22:00:03,584.584] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00058s] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (6945 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "550e7649-d3f9-470e-91c7-9fb3cc21c782", "example": false}}]', 'answer': 'ä½ å¥½ï¼æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ', 'latency': 4.665544099999977, 'message_id': UUID('2d424184-df82-4f94-a7be-7d20fd15d93d')}
[2025-05-18 22:00:03,588.588] base.py -> _commit_impl line:1140 [INFO]: COMMIT
