[2025-05-11 10:34:46,108.108] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-05-11 10:34:46,111.111] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-05-11 10:34:46,121.121] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-11 10:35:14,481.481] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-11 10:35:14,494.494] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-11 10:35:16,003.003] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 10:35:16] "OPTIONS /datasets?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 10:35:16,483.483] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-11 10:35:16,484.484] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-11 10:35:16,486.486] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-11 10:35:16,486.486] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-11 10:35:16,487.487] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-11 10:35:16,487.487] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-11 10:35:16,488.488] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 10:35:16,497.497] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.account_id = %(account_id_1)s::UUID ORDER BY dataset.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 10:35:16,498.498] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00051s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'param_1': 20, 'param_2': 0}
[2025-05-11 10:35:16,510.510] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT dataset.id AS id, dataset.account_id AS account_id, dataset.name AS name, dataset.icon AS icon, dataset.description AS description, dataset.updated_at AS updated_at, dataset.created_at AS created_at 
FROM dataset 
WHERE dataset.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-05-11 10:35:16,511.511] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00045s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-11 10:35:16,516.516] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,517.517] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00038s] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 10:35:16,520.520] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,521.521] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00034s] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 10:35:16,524.524] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,524.524] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00027s] {'coalesce_2': 0, 'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 10:35:16,526.526] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,526.526] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.009464s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 10:35:16,526.526] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,526.526] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.005969s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 10:35:16,527.527] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,527.527] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.004008s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 10:35:16,528.528] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,528.528] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01233s ago] {'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-05-11 10:35:16,529.529] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,529.529] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.008705s ago] {'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-05-11 10:35:16,530.530] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,530.530] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.006838s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-05-11 10:35:16,531.531] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,531.531] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01518s ago] {'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-05-11 10:35:16,532.532] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,532.532] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01153s ago] {'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-05-11 10:35:16,533.533] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,533.533] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.009477s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-05-11 10:35:16,533.533] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,534.534] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01759s ago] {'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-05-11 10:35:16,534.534] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,534.534] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01389s ago] {'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-05-11 10:35:16,535.535] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,535.535] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01171s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-05-11 10:35:16,536.536] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,536.536] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02s ago] {'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-05-11 10:35:16,537.537] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,537.537] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01647s ago] {'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-05-11 10:35:16,538.538] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,538.538] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01434s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-05-11 10:35:16,538.538] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,538.538] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02241s ago] {'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-05-11 10:35:16,539.539] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,539.539] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01877s ago] {'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-05-11 10:35:16,540.540] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,540.540] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01659s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-05-11 10:35:16,541.541] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,541.541] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02467s ago] {'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-05-11 10:35:16,541.541] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,541.541] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0209s ago] {'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-05-11 10:35:16,542.542] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,542.542] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01882s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-05-11 10:35:16,543.543] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,543.543] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02707s ago] {'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-05-11 10:35:16,544.544] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,544.544] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02348s ago] {'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-05-11 10:35:16,545.545] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,545.545] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02137s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-05-11 10:35:16,545.545] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,546.546] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02974s ago] {'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-05-11 10:35:16,546.546] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,546.546] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02619s ago] {'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-05-11 10:35:16,547.547] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,547.547] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02403s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-05-11 10:35:16,548.548] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,548.548] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03219s ago] {'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-05-11 10:35:16,549.549] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,549.549] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0285s ago] {'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-05-11 10:35:16,549.549] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,550.550] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02632s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-05-11 10:35:16,550.550] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,550.550] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0344s ago] {'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-05-11 10:35:16,551.551] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,551.551] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03071s ago] {'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-05-11 10:35:16,552.552] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,552.552] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02863s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-05-11 10:35:16,553.553] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,553.553] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03708s ago] {'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-05-11 10:35:16,554.554] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,554.554] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0335s ago] {'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-05-11 10:35:16,555.555] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,555.555] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03134s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-05-11 10:35:16,556.556] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,556.556] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03954s ago] {'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-05-11 10:35:16,556.556] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,556.556] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0358s ago] {'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-05-11 10:35:16,557.557] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,557.557] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03364s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-05-11 10:35:16,558.558] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,558.558] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04172s ago] {'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-05-11 10:35:16,558.558] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,559.559] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03803s ago] {'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-05-11 10:35:16,559.559] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,560.560] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03601s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-05-11 10:35:16,560.560] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,560.560] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04413s ago] {'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-05-11 10:35:16,561.561] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,563.563] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04207s ago] {'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-05-11 10:35:16,564.564] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,564.564] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0403s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-05-11 10:35:16,565.565] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,565.565] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04848s ago] {'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-05-11 10:35:16,565.565] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,565.565] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04478s ago] {'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-05-11 10:35:16,566.566] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,566.566] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04263s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-05-11 10:35:16,567.567] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,567.567] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05076s ago] {'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-05-11 10:35:16,568.568] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,568.568] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04709s ago] {'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-05-11 10:35:16,568.568] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,568.568] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04498s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-05-11 10:35:16,570.570] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,570.570] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0535s ago] {'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-05-11 10:35:16,570.570] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,571.571] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05023s ago] {'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-05-11 10:35:16,571.571] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,571.571] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04822s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-05-11 10:35:16,572.572] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,572.572] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0564s ago] {'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-05-11 10:35:16,572.572] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,574.574] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05276s ago] {'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-05-11 10:35:16,574.574] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:16,574.574] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05063s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-05-11 10:35:16,577.577] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 10:35:16,577.577] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 10:35:16] "GET /datasets?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 10:35:23,459.459] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 10:35:23] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f HTTP/1.1" 200 -
[2025-05-11 10:35:23,460.460] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 10:35:23] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 10:35:23,466.466] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 10:35:23,468.468] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 10:35:23,468.468] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00026s] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 10:35:23,470.470] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:23,470.470] base.py -> _exec_single_context line:1901 [INFO]: [cached since 6.954s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 10:35:23,472.472] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:23,472.472] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00033s] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 10:35:23,475.475] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:23,475.475] base.py -> _exec_single_context line:1901 [INFO]: [cached since 6.955s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 10:35:23,476.476] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 10:35:23,476.476] base.py -> _exec_single_context line:1901 [INFO]: [cached since 6.953s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 10:35:23,477.477] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 10:35:23,478.478] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 10:35:23] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f HTTP/1.1" 200 -
[2025-05-11 10:35:23,771.771] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 10:35:23,773.773] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 10:35:23,773.773] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.3049s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 10:35:23,775.775] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 10:35:23,775.775] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00032s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'param_1': 20, 'param_2': 0}
[2025-05-11 10:35:23,777.777] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2025-05-11 10:35:23,778.778] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00026s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 10:35:23,779.779] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 10:35:23,779.779] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 10:35:23] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 10:35:33,074.074] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 10:35:33,076.076] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO upload_file (account_id, name, key, size, extension, mime_type, hash) VALUES (%(account_id)s::UUID, %(name)s, %(key)s, %(size)s, %(extension)s, %(mime_type)s, %(hash)s) RETURNING upload_file.id, upload_file.updated_at, upload_file.created_at
[2025-05-11 10:35:33,076.076] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00031s] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'name': '5-transformers 操作篇.docx', 'key': '2025/05/11/564184a3-66ff-4320-ba66-734c20c0095f.docx', 'size': 28936, 'extension': 'docx', 'mime_type': 'application/vnd.openxmlformats-officedocument.wordprocessingml.document', 'hash': '84b1de39202a0572980935e2c682c3b88860e7ddb1fc074b16dcd403808ea028'}
[2025-05-11 10:35:33,089.089] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 10:35:33,091.091] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 10:35:33,092.092] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2025-05-11 10:35:33,092.092] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00031s] {'pk_1': UUID('d34b03c1-e980-42fb-bf97-8bbbac4662d9')}
[2025-05-11 10:35:33,093.093] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 10:35:33,094.094] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 10:35:33] "POST /upload-files/file HTTP/1.1" 200 -
[2025-05-11 10:35:35,870.870] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 10:35:35] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents HTTP/1.1" 200 -
[2025-05-11 10:35:35,876.876] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 10:35:35,876.876] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 10:35:35,877.877] base.py -> _exec_single_context line:1901 [INFO]: [cached since 12.41s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 10:35:35,878.878] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.account_id = %(account_id_1)s::UUID AND upload_file.id IN (%(id_1_1)s::UUID)
[2025-05-11 10:35:35,879.879] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00044s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'id_1_1': 'd34b03c1-e980-42fb-bf97-8bbbac4662d9'}
[2025-05-11 10:35:35,881.881] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO process_rule (account_id, dataset_id, mode, rule) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(mode)s, %(rule)s::JSONB) RETURNING process_rule.id, process_rule.updated_at, process_rule.created_at
[2025-05-11 10:35:35,882.882] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00049s] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'mode': 'automatic', 'rule': '{"pre_process_rules": [{"id": "remove_extra_space", "enabled": true}, {"id": "remove_url_and_email", "enabled": true}], "segment": {"separators": ["\ ... (15 characters truncated) ... "\\u3002|\\uff01|\\uff1f", "\\\\.\\\\s|\\\\!\\\\s|\\\\?\\\\s", "\\uff1b|;\\\\s", "\\uff0c|,\\\\s", " ", ""], "chunk_size": 500, "chunk_overlap": 50}}'}
[2025-05-11 10:35:35,888.888] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 10:35:35,889.889] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 10:35:35,890.890] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.position DESC 
 LIMIT %(param_1)s
[2025-05-11 10:35:35,890.890] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00022s] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'param_1': 1}
[2025-05-11 10:35:35,892.892] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2025-05-11 10:35:35,892.892] base.py -> _exec_single_context line:1901 [INFO]: [cached since 2.8s ago] {'pk_1': UUID('d34b03c1-e980-42fb-bf97-8bbbac4662d9')}
[2025-05-11 10:35:35,894.894] base.py -> _exec_single_context line:1896 [INFO]: SELECT process_rule.id AS process_rule_id, process_rule.account_id AS process_rule_account_id, process_rule.dataset_id AS process_rule_dataset_id, process_rule.mode AS process_rule_mode, process_rule.rule AS process_rule_rule, process_rule.updated_at AS process_rule_updated_at, process_rule.created_at AS process_rule_created_at 
FROM process_rule 
WHERE process_rule.id = %(pk_1)s::UUID
[2025-05-11 10:35:35,894.894] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00032s] {'pk_1': UUID('bacc97f1-e2b3-4e69-bbb2-ba40e1cb63c5')}
[2025-05-11 10:35:35,897.897] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO document (account_id, dataset_id, upload_file_id, process_rule_id, batch, name, position, processing_started_at, parsing_completed_at, splitting_completed_at, indexing_completed_at, completed_at, stopped_at, disabled_at) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(upload_file_id)s::UUID, %(process_rule_id)s::UUID, %(batch)s, %(name)s, %(position)s, %(processing_started_at)s, %(parsing_completed_at)s, %(splitting_completed_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(disabled_at)s) RETURNING document.id, document.character_count, document.token_count, document.error, document.enabled, document.status, document.updated_at, document.created_at
[2025-05-11 10:35:35,899.899] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00041s] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'upload_file_id': UUID('d34b03c1-e980-42fb-bf97-8bbbac4662d9'), 'process_rule_id': UUID('bacc97f1-e2b3-4e69-bbb2-ba40e1cb63c5'), 'batch': '20250511103535783803', 'name': '5-transformers 操作篇.docx', 'position': 1, 'processing_started_at': None, 'parsing_completed_at': None, 'splitting_completed_at': None, 'indexing_completed_at': None, 'completed_at': None, 'stopped_at': None, 'disabled_at': None}
[2025-05-11 10:35:35,902.902] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 10:35:35,907.907] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 10:35:35,908.908] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 10:35:35,908.908] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00026s] {'pk_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 10:35:36,033.033] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 10:35:36,034.034] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 10:35:36] "POST /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents HTTP/1.1" 200 -
[2025-05-11 10:35:36,355.355] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 10:35:36] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/batch/20250511103535783803 HTTP/1.1" 200 -
[2025-05-11 10:35:36,665.665] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 10:35:36,665.665] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 10:35:36,665.665] base.py -> _exec_single_context line:1901 [INFO]: [cached since 13.2s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 10:35:36,670.670] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.batch = %(batch_1)s ORDER BY document.position ASC
[2025-05-11 10:35:36,670.670] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00093s] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'batch_1': '20250511103535783803'}
[2025-05-11 10:35:36,675.675] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 10:35:36,675.675] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00044s] {'document_id_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 10:35:36,677.677] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.status = %(status_1)s
[2025-05-11 10:35:36,677.677] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00052s] {'document_id_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5'), 'status_1': <SegmentStatus.COMPLETED: 'completed'>}
[2025-05-11 10:35:36,680.680] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-11 10:35:36,680.680] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00042s] {'id_1': UUID('d34b03c1-e980-42fb-bf97-8bbbac4662d9')}
[2025-05-11 10:35:36,682.682] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 10:35:36,683.683] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 10:35:36] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/batch/20250511103535783803 HTTP/1.1" 200 -
[2025-05-11 10:35:41,691.691] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 10:35:41] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/batch/20250511103535783803 HTTP/1.1" 200 -
[2025-05-11 10:35:41,694.694] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 10:35:41,695.695] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 10:35:41,695.695] base.py -> _exec_single_context line:1901 [INFO]: [cached since 18.23s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 10:35:41,698.698] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.batch = %(batch_1)s ORDER BY document.position ASC
[2025-05-11 10:35:41,698.698] base.py -> _exec_single_context line:1901 [INFO]: [cached since 5.029s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'batch_1': '20250511103535783803'}
[2025-05-11 10:35:41,699.699] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 10:35:41,699.699] base.py -> _exec_single_context line:1901 [INFO]: [cached since 5.024s ago] {'document_id_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 10:35:41,700.700] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.status = %(status_1)s
[2025-05-11 10:35:41,700.700] base.py -> _exec_single_context line:1901 [INFO]: [cached since 5.023s ago] {'document_id_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5'), 'status_1': <SegmentStatus.COMPLETED: 'completed'>}
[2025-05-11 10:35:41,701.701] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-11 10:35:41,701.701] base.py -> _exec_single_context line:1901 [INFO]: [cached since 5.021s ago] {'id_1': UUID('d34b03c1-e980-42fb-bf97-8bbbac4662d9')}
[2025-05-11 10:35:41,702.702] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 10:35:41,702.702] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 10:35:41] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/batch/20250511103535783803 HTTP/1.1" 200 -
[2025-05-11 10:35:47,013.013] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 10:35:47] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/batch/20250511103535783803 HTTP/1.1" 200 -
[2025-05-11 10:35:47,326.326] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 10:35:47,326.326] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 10:35:47,326.326] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.86s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 10:35:47,328.328] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.batch = %(batch_1)s ORDER BY document.position ASC
[2025-05-11 10:35:47,328.328] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.66s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'batch_1': '20250511103535783803'}
[2025-05-11 10:35:47,328.328] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 10:35:47,328.328] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.65s ago] {'document_id_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 10:35:47,329.329] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.status = %(status_1)s
[2025-05-11 10:35:47,329.329] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.65s ago] {'document_id_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5'), 'status_1': <SegmentStatus.COMPLETED: 'completed'>}
[2025-05-11 10:35:47,330.330] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-11 10:35:47,330.330] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.65s ago] {'id_1': UUID('d34b03c1-e980-42fb-bf97-8bbbac4662d9')}
[2025-05-11 10:35:47,331.331] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 10:35:47,331.331] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 10:35:47] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/batch/20250511103535783803 HTTP/1.1" 200 -
[2025-05-11 10:35:51,693.693] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 10:35:51,693.693] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 10:35:51,694.694] base.py -> _exec_single_context line:1901 [INFO]: [cached since 28.23s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 10:35:51,695.695] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.batch = %(batch_1)s ORDER BY document.position ASC
[2025-05-11 10:35:51,695.695] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.03s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'batch_1': '20250511103535783803'}
[2025-05-11 10:35:51,696.696] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 10:35:51,697.697] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.02s ago] {'document_id_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 10:35:51,697.697] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.status = %(status_1)s
[2025-05-11 10:35:51,698.698] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.02s ago] {'document_id_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5'), 'status_1': <SegmentStatus.COMPLETED: 'completed'>}
[2025-05-11 10:35:51,698.698] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-11 10:35:51,699.699] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.02s ago] {'id_1': UUID('d34b03c1-e980-42fb-bf97-8bbbac4662d9')}
[2025-05-11 10:35:51,699.699] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 10:35:51,700.700] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 10:35:51] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/batch/20250511103535783803 HTTP/1.1" 200 -
[2025-05-11 11:36:57,836.836] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-05-11 11:36:57,837.837] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-05-11 11:36:57,843.843] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-11 11:37:30,864.864] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-11 11:37:30,874.874] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-11 11:37:32,052.052] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:37:32] "OPTIONS /datasets?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:37:32,632.632] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-11 11:37:32,633.633] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-11 11:37:32,637.637] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-11 11:37:32,637.637] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-11 11:37:32,638.638] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-11 11:37:32,639.639] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-11 11:37:32,639.639] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:37:32,648.648] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.account_id = %(account_id_1)s::UUID ORDER BY dataset.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:37:32,648.648] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00061s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'param_1': 20, 'param_2': 0}
[2025-05-11 11:37:32,663.663] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT dataset.id AS id, dataset.account_id AS account_id, dataset.name AS name, dataset.icon AS icon, dataset.description AS description, dataset.updated_at AS updated_at, dataset.created_at AS created_at 
FROM dataset 
WHERE dataset.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-05-11 11:37:32,664.664] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00058s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-11 11:37:32,672.672] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,673.673] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00053s] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:37:32,680.680] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,680.680] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00040s] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:37:32,684.684] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,684.684] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00042s] {'coalesce_2': 0, 'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:37:32,686.686] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,687.687] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01479s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:37:32,688.688] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,688.688] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.008346s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:37:32,689.689] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,689.689] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.005808s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:37:32,690.690] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,691.691] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0189s ago] {'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-05-11 11:37:32,692.692] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,692.692] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01249s ago] {'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-05-11 11:37:32,693.693] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,693.693] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.009812s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-05-11 11:37:32,694.694] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,694.694] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0223s ago] {'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-05-11 11:37:32,695.695] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,695.695] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01541s ago] {'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-05-11 11:37:32,696.696] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,696.696] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01221s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-05-11 11:37:32,696.696] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,697.697] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02481s ago] {'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-05-11 11:37:32,697.697] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,697.697] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01787s ago] {'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-05-11 11:37:32,698.698] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,698.698] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01463s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-05-11 11:37:32,699.699] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,699.699] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0271s ago] {'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-05-11 11:37:32,700.700] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,700.700] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02049s ago] {'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-05-11 11:37:32,701.701] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,701.701] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01784s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-05-11 11:37:32,702.702] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,703.703] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0307s ago] {'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-05-11 11:37:32,703.703] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,703.703] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02389s ago] {'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-05-11 11:37:32,704.704] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,705.705] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02119s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-05-11 11:37:32,706.706] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,706.706] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03397s ago] {'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-05-11 11:37:32,707.707] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,707.707] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02723s ago] {'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-05-11 11:37:32,708.708] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,708.708] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02428s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-05-11 11:37:32,709.709] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,709.709] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03743s ago] {'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-05-11 11:37:32,710.710] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,710.710] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03099s ago] {'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-05-11 11:37:32,711.711] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,712.712] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02804s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-05-11 11:37:32,712.712] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,713.713] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04098s ago] {'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-05-11 11:37:32,713.713] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,714.714] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03417s ago] {'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-05-11 11:37:32,715.715] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,715.715] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03167s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-05-11 11:37:32,716.716] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,716.716] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04453s ago] {'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-05-11 11:37:32,717.717] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,718.718] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03819s ago] {'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-05-11 11:37:32,719.719] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,719.719] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03525s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-05-11 11:37:32,719.719] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,720.720] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04808s ago] {'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-05-11 11:37:32,721.721] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,721.721] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04138s ago] {'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-05-11 11:37:32,722.722] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,722.722] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03834s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-05-11 11:37:32,723.723] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,723.723] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05103s ago] {'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-05-11 11:37:32,724.724] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,724.724] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04427s ago] {'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-05-11 11:37:32,724.724] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,725.725] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04115s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-05-11 11:37:32,725.725] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,726.726] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05377s ago] {'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-05-11 11:37:32,726.726] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,727.727] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04712s ago] {'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-05-11 11:37:32,728.728] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,728.728] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04455s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-05-11 11:37:32,729.729] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,729.729] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0572s ago] {'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-05-11 11:37:32,730.730] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,730.730] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05036s ago] {'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-05-11 11:37:32,731.731] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,731.731] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04725s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-05-11 11:37:32,731.731] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,732.732] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05976s ago] {'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-05-11 11:37:32,732.732] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,732.732] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05295s ago] {'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-05-11 11:37:32,733.733] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,734.734] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05013s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-05-11 11:37:32,735.735] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,735.735] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.06322s ago] {'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-05-11 11:37:32,736.736] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,736.736] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05657s ago] {'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-05-11 11:37:32,737.737] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,737.737] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05364s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-05-11 11:37:32,738.738] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,738.738] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.06637s ago] {'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-05-11 11:37:32,739.739] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,739.739] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05957s ago] {'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-05-11 11:37:32,740.740] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,740.740] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05647s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-05-11 11:37:32,741.741] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,741.741] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.069s ago] {'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-05-11 11:37:32,741.741] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,742.742] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.06216s ago] {'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-05-11 11:37:32,742.742] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,743.743] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05914s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-05-11 11:37:32,743.743] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,744.744] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.07204s ago] {'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-05-11 11:37:32,745.745] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,745.745] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0654s ago] {'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-05-11 11:37:32,746.746] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:32,746.746] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0623s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-05-11 11:37:32,749.749] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:37:32,750.750] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:37:32] "GET /datasets?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:37:52,202.202] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:37:52] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f HTTP/1.1" 200 -
[2025-05-11 11:37:52,204.204] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:37:52] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:37:52,208.208] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:37:52,211.211] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:37:52,211.211] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00041s] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:37:52,213.213] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:52,214.214] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.54s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:37:52,215.215] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:52,215.215] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00029s] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:37:52,218.218] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:52,218.218] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.54s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:37:52,219.219] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:37:52,220.220] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.54s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:37:52,221.221] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:37:52,221.221] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:37:52] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f HTTP/1.1" 200 -
[2025-05-11 11:37:52,515.515] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:37:52,515.515] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:37:52,515.515] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.3047s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:37:52,518.518] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:37:52,518.518] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00032s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'param_1': 20, 'param_2': 0}
[2025-05-11 11:37:52,521.521] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2025-05-11 11:37:52,521.521] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00026s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:37:52,522.522] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count)) AS coalesce_1, 0 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:37:52,523.523] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00023s] {'document_id_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 11:37:52,524.524] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:37:52,524.524] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:37:52] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:38:19,125.125] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:38:19] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/40640321-d3d0-4fd8-a77b-e16fc92b80c5 HTTP/1.1" 200 -
[2025-05-11 11:38:19,438.438] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:38:19,440.440] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:38:19,440.440] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00028s] {'pk_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 11:38:19,442.442] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:38:19,443.443] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00031s] {'document_id_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 11:38:19,444.444] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count)) AS coalesce_1, 0 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:38:19,444.444] base.py -> _exec_single_context line:1901 [INFO]: [cached since 26.92s ago] {'document_id_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 11:38:19,445.445] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:38:19,445.445] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:38:19] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/40640321-d3d0-4fd8-a77b-e16fc92b80c5 HTTP/1.1" 200 -
[2025-05-11 11:38:22,547.547] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:38:22,547.547] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:38:22,548.548] base.py -> _exec_single_context line:1901 [INFO]: [cached since 3.108s ago] {'pk_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 11:38:22,549.549] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:38:22,549.549] base.py -> _exec_single_context line:1901 [INFO]: [cached since 3.107s ago] {'document_id_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 11:38:22,550.550] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count)) AS coalesce_1, 0 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:38:22,550.550] base.py -> _exec_single_context line:1901 [INFO]: [cached since 30.03s ago] {'document_id_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 11:38:22,551.551] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:38:22,551.551] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:38:22] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/40640321-d3d0-4fd8-a77b-e16fc92b80c5 HTTP/1.1" 200 -
[2025-05-11 11:38:26,634.634] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:38:26] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/40640321-d3d0-4fd8-a77b-e16fc92b80c5/name HTTP/1.1" 200 -
[2025-05-11 11:38:26,953.953] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:38:26,953.953] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:38:26,953.953] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.513s ago] {'pk_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 11:38:26,956.956] base.py -> _exec_single_context line:1896 [INFO]: UPDATE document SET name=%(name)s WHERE document.id = %(document_id)s::UUID
[2025-05-11 11:38:26,956.956] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00024s] {'name': '1111transformers 操作篇.docx', 'document_id': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 11:38:26,959.959] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:38:26,961.961] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:38:26] "POST /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/40640321-d3d0-4fd8-a77b-e16fc92b80c5/name HTTP/1.1" 200 -
[2025-05-11 11:38:26,968.968] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:38:26] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:38:27,212.212] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:38:27,213.213] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:38:27,213.213] base.py -> _exec_single_context line:1901 [INFO]: [cached since 35s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:38:27,214.214] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:38:27,215.215] base.py -> _exec_single_context line:1901 [INFO]: [cached since 34.7s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'param_1': 20, 'param_2': 0}
[2025-05-11 11:38:27,216.216] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2025-05-11 11:38:27,216.216] base.py -> _exec_single_context line:1901 [INFO]: [cached since 34.7s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:38:27,217.217] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count)) AS coalesce_1, 0 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:38:27,218.218] base.py -> _exec_single_context line:1901 [INFO]: [cached since 34.69s ago] {'document_id_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 11:38:27,219.219] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:38:27,219.219] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:38:27] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:39:29,015.015] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:39:29] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f HTTP/1.1" 200 -
[2025-05-11 11:39:29,015.015] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:39:29] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:39:29,324.324] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:39:29,326.326] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:39:29,326.326] base.py -> _exec_single_context line:1901 [INFO]: [cached since 97.11s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:39:29,328.328] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:29,328.328] base.py -> _exec_single_context line:1901 [INFO]: [cached since 116.7s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:39:29,329.329] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:29,330.330] base.py -> _exec_single_context line:1901 [INFO]: [cached since 97.11s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:39:29,330.330] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:29,331.331] base.py -> _exec_single_context line:1901 [INFO]: [cached since 116.7s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:39:29,331.331] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:29,332.332] base.py -> _exec_single_context line:1901 [INFO]: [cached since 116.6s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:39:29,332.332] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:39:29,333.333] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:39:29] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f HTTP/1.1" 200 -
[2025-05-11 11:39:29,369.369] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:39:29,370.370] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:39:29,370.370] base.py -> _exec_single_context line:1901 [INFO]: [cached since 97.16s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:39:29,373.373] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:39:29,374.374] base.py -> _exec_single_context line:1901 [INFO]: [cached since 96.85s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'param_1': 20, 'param_2': 0}
[2025-05-11 11:39:29,376.376] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2025-05-11 11:39:29,376.376] base.py -> _exec_single_context line:1901 [INFO]: [cached since 96.86s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:39:29,377.377] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count)) AS coalesce_1, 0 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:39:29,378.378] base.py -> _exec_single_context line:1901 [INFO]: [cached since 96.85s ago] {'document_id_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 11:39:29,380.380] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:39:29,380.380] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:39:29] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:39:54,458.458] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:39:54] "OPTIONS /datasets?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:39:54,461.461] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:39:54,462.462] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.account_id = %(account_id_1)s::UUID ORDER BY dataset.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:39:54,463.463] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'param_1': 20, 'param_2': 0}
[2025-05-11 11:39:54,464.464] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT dataset.id AS id, dataset.account_id AS account_id, dataset.name AS name, dataset.icon AS icon, dataset.description AS description, dataset.updated_at AS updated_at, dataset.created_at AS created_at 
FROM dataset 
WHERE dataset.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-05-11 11:39:54,464.464] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-11 11:39:54,465.465] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,465.465] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:39:54,466.466] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,467.467] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:39:54,467.467] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,467.467] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:39:54,468.468] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,469.469] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:39:54,471.471] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,472.472] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:39:54,474.474] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,475.475] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:39:54,477.477] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,477.477] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-05-11 11:39:54,479.479] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,480.480] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-05-11 11:39:54,481.481] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,482.482] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-05-11 11:39:54,484.484] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,484.484] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-05-11 11:39:54,485.485] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,486.486] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-05-11 11:39:54,487.487] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,487.487] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-05-11 11:39:54,489.489] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,490.490] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-05-11 11:39:54,491.491] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,491.491] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-05-11 11:39:54,492.492] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,492.492] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-05-11 11:39:54,493.493] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,494.494] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-05-11 11:39:54,494.494] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,496.496] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-05-11 11:39:54,497.497] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,498.498] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-05-11 11:39:54,499.499] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,499.499] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-05-11 11:39:54,500.500] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,501.501] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-05-11 11:39:54,501.501] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,502.502] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-05-11 11:39:54,503.503] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,503.503] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-05-11 11:39:54,504.504] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,505.505] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-05-11 11:39:54,506.506] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,507.507] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-05-11 11:39:54,508.508] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,509.509] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-05-11 11:39:54,510.510] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,511.511] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-05-11 11:39:54,512.512] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,512.512] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-05-11 11:39:54,514.514] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,514.514] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-05-11 11:39:54,516.516] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,516.516] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-05-11 11:39:54,518.518] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,519.519] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-05-11 11:39:54,520.520] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,521.521] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-05-11 11:39:54,522.522] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,522.522] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-05-11 11:39:54,523.523] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,524.524] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-05-11 11:39:54,525.525] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,525.525] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.9s ago] {'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-05-11 11:39:54,527.527] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,527.527] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-05-11 11:39:54,529.529] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,529.529] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.8s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-05-11 11:39:54,531.531] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,531.531] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.9s ago] {'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-05-11 11:39:54,532.532] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,533.533] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.9s ago] {'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-05-11 11:39:54,534.534] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,534.534] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.9s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-05-11 11:39:54,535.535] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,535.535] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.9s ago] {'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-05-11 11:39:54,536.536] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,536.536] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.9s ago] {'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-05-11 11:39:54,537.537] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,538.538] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.9s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-05-11 11:39:54,539.539] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,539.539] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.9s ago] {'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-05-11 11:39:54,541.541] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,541.541] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.9s ago] {'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-05-11 11:39:54,542.542] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,543.543] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.9s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-05-11 11:39:54,544.544] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,544.544] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.9s ago] {'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-05-11 11:39:54,546.546] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,546.546] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.9s ago] {'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-05-11 11:39:54,547.547] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,548.548] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.9s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-05-11 11:39:54,549.549] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,549.549] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.9s ago] {'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-05-11 11:39:54,551.551] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,551.551] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.9s ago] {'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-05-11 11:39:54,552.552] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,552.552] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.9s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-05-11 11:39:54,554.554] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,554.554] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.9s ago] {'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-05-11 11:39:54,555.555] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,556.556] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.9s ago] {'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-05-11 11:39:54,556.556] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,556.556] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.9s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-05-11 11:39:54,558.558] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,558.558] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.9s ago] {'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-05-11 11:39:54,559.559] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,559.559] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.9s ago] {'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-05-11 11:39:54,561.561] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,561.561] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.9s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-05-11 11:39:54,563.563] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,563.563] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.9s ago] {'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-05-11 11:39:54,564.564] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,564.564] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.9s ago] {'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-05-11 11:39:54,565.565] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:54,566.566] base.py -> _exec_single_context line:1901 [INFO]: [cached since 141.9s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-05-11 11:39:54,568.568] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:39:54,568.568] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:39:54] "GET /datasets?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:39:57,981.981] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:39:57] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f HTTP/1.1" 200 -
[2025-05-11 11:39:57,984.984] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:39:57] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:39:58,293.293] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:39:58,294.294] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:39:58,295.295] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:39:58,295.295] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.1s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:39:58,297.297] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:39:58,297.297] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.1s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:39:58,298.298] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:58,300.300] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:39:58,300.300] base.py -> _exec_single_context line:1901 [INFO]: [cached since 145.6s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:39:58,300.300] base.py -> _exec_single_context line:1901 [INFO]: [cached since 125.8s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'param_1': 20, 'param_2': 0}
[2025-05-11 11:39:58,301.301] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:58,301.301] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2025-05-11 11:39:58,302.302] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.1s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:39:58,302.302] base.py -> _exec_single_context line:1901 [INFO]: [cached since 125.8s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:39:58,303.303] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:58,305.305] base.py -> _exec_single_context line:1901 [INFO]: [cached since 145.6s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:39:58,305.305] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count)) AS coalesce_1, 0 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:39:58,306.306] base.py -> _exec_single_context line:1901 [INFO]: [cached since 125.8s ago] {'document_id_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 11:39:58,306.306] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:39:58,307.307] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:39:58,308.308] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:39:58] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:39:58,308.308] base.py -> _exec_single_context line:1901 [INFO]: [cached since 145.6s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:39:58,309.309] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:39:58,310.310] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:39:58] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f HTTP/1.1" 200 -
[2025-05-11 11:40:34,821.821] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:40:34] "OPTIONS /api-tools?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:40:34,828.828] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:40:34,830.830] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool_provider.id AS api_tool_provider_id, api_tool_provider.account_id AS api_tool_provider_account_id, api_tool_provider.name AS api_tool_provider_name, api_tool_provider.icon AS api_tool_provider_icon, api_tool_provider.description AS api_tool_provider_description, api_tool_provider.openapi_schema AS api_tool_provider_openapi_schema, api_tool_provider.headers AS api_tool_provider_headers, api_tool_provider.updated_at AS api_tool_provider_updated_at, api_tool_provider.created_at AS api_tool_provider_created_at 
FROM api_tool_provider 
WHERE api_tool_provider.account_id = %(account_id_1)s::UUID ORDER BY api_tool_provider.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:40:34,830.830] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00059s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'param_1': 20, 'param_2': 0}
[2025-05-11 11:40:34,838.838] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT api_tool_provider.id AS id, api_tool_provider.account_id AS account_id, api_tool_provider.name AS name, api_tool_provider.icon AS icon, api_tool_provider.description AS description, api_tool_provider.openapi_schema AS openapi_schema, api_tool_provider.headers AS headers, api_tool_provider.updated_at AS updated_at, api_tool_provider.created_at AS created_at 
FROM api_tool_provider 
WHERE api_tool_provider.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-05-11 11:40:34,839.839] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00067s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-11 11:40:34,842.842] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-05-11 11:40:34,842.842] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00041s] {'provider_id_1': UUID('7e41e2e9-5940-4853-ac4d-fb92bcd7840a')}
[2025-05-11 11:40:34,845.845] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-05-11 11:40:34,845.845] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.005573s ago] {'provider_id_1': UUID('ee453518-8819-43b8-9693-fbb0ec025b6b')}
[2025-05-11 11:40:34,849.849] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-05-11 11:40:34,850.850] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.008787s ago] {'provider_id_1': UUID('5c706d2f-1e5d-4a1e-a87d-7e284d7d69fd')}
[2025-05-11 11:40:34,852.852] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-05-11 11:40:34,853.853] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01132s ago] {'provider_id_1': UUID('bed074e4-c5af-4bd4-88f7-81251eb95a6c')}
[2025-05-11 11:40:34,854.854] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-05-11 11:40:34,855.855] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01331s ago] {'provider_id_1': UUID('1bd06d2b-1d4c-4bf5-8812-f94a0fa8cd0e')}
[2025-05-11 11:40:34,856.856] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-05-11 11:40:34,857.857] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01531s ago] {'provider_id_1': UUID('e9780583-c578-42e4-84ef-e3c2c1069de9')}
[2025-05-11 11:40:34,858.858] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-05-11 11:40:34,861.861] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01938s ago] {'provider_id_1': UUID('94cef19d-3df1-457e-8f1f-5e6ecec2df39')}
[2025-05-11 11:40:34,863.863] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-05-11 11:40:34,863.863] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02193s ago] {'provider_id_1': UUID('a9fd691c-c789-45b4-af05-1df914542bad')}
[2025-05-11 11:40:34,865.865] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-05-11 11:40:34,866.866] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02417s ago] {'provider_id_1': UUID('db13bc34-1d40-49e5-92d8-d22c7418cf7d')}
[2025-05-11 11:40:34,868.868] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-05-11 11:40:34,869.869] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02692s ago] {'provider_id_1': UUID('bbd73f46-4891-4f18-a8cf-065e1639809f')}
[2025-05-11 11:40:34,870.870] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-05-11 11:40:34,871.871] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02884s ago] {'provider_id_1': UUID('8229ae9b-a334-472e-af36-8c1e36b85356')}
[2025-05-11 11:40:34,872.872] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-05-11 11:40:34,872.872] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03047s ago] {'provider_id_1': UUID('e1afb674-e985-4f45-9416-04c8457ef621')}
[2025-05-11 11:40:34,873.873] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-05-11 11:40:34,873.873] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03206s ago] {'provider_id_1': UUID('eb23d087-cfac-4b07-b348-0ce7e019e481')}
[2025-05-11 11:40:34,873.873] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-05-11 11:40:34,873.873] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03374s ago] {'provider_id_1': UUID('4a3b1d5e-7eba-4d5e-a903-08bc4e381ddf')}
[2025-05-11 11:40:34,873.873] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-05-11 11:40:34,873.873] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03541s ago] {'provider_id_1': UUID('c7fd1c86-ad90-4011-aa6f-37af7dd7c123')}
[2025-05-11 11:40:34,873.873] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-05-11 11:40:34,873.873] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03761s ago] {'provider_id_1': UUID('79f0585f-48e8-4612-ac04-8742e6eb849d')}
[2025-05-11 11:40:34,873.873] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-05-11 11:40:34,873.873] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03914s ago] {'provider_id_1': UUID('bce415bd-bdca-4976-b519-35c4c9af2b99')}
[2025-05-11 11:40:34,873.873] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-05-11 11:40:34,888.888] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04651s ago] {'provider_id_1': UUID('f7190437-4704-4f73-9871-a786624778be')}
[2025-05-11 11:40:34,890.890] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-05-11 11:40:34,890.890] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04851s ago] {'provider_id_1': UUID('a93b42f1-9d6d-4d7b-9687-cfa76eee2ff2')}
[2025-05-11 11:40:34,891.891] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-05-11 11:40:34,892.892] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05005s ago] {'provider_id_1': UUID('e9b3b8ee-b6fb-4217-8c3e-57b3c0175c3c')}
[2025-05-11 11:40:34,897.897] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:40:34,898.898] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:40:34] "GET /api-tools?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:40:36,261.261] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:40:36] "OPTIONS /datasets?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:40:36,575.575] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:40:36,575.575] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.account_id = %(account_id_1)s::UUID ORDER BY dataset.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:40:36,575.575] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'param_1': 20, 'param_2': 0}
[2025-05-11 11:40:36,577.577] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT dataset.id AS id, dataset.account_id AS account_id, dataset.name AS name, dataset.icon AS icon, dataset.description AS description, dataset.updated_at AS updated_at, dataset.created_at AS created_at 
FROM dataset 
WHERE dataset.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-05-11 11:40:36,578.578] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-11 11:40:36,579.579] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,579.579] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:40:36,579.579] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,579.579] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:40:36,581.581] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,581.581] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:40:36,581.581] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,581.581] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:40:36,582.582] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,582.582] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:40:36,584.584] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,584.584] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:40:36,585.585] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,585.585] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-05-11 11:40:36,586.586] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,586.586] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-05-11 11:40:36,587.587] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,587.587] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-05-11 11:40:36,587.587] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,588.588] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-05-11 11:40:36,588.588] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,588.588] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-05-11 11:40:36,589.589] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,589.589] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-05-11 11:40:36,590.590] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,590.590] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-05-11 11:40:36,590.590] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,591.591] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-05-11 11:40:36,591.591] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,591.591] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-05-11 11:40:36,592.592] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,592.592] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-05-11 11:40:36,594.594] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,595.595] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-05-11 11:40:36,595.595] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,595.595] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-05-11 11:40:36,596.596] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,596.596] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-05-11 11:40:36,597.597] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,597.597] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-05-11 11:40:36,599.599] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,599.599] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-05-11 11:40:36,600.600] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,600.600] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-05-11 11:40:36,601.601] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,601.601] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-05-11 11:40:36,601.601] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,602.602] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-05-11 11:40:36,602.602] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,602.602] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-05-11 11:40:36,603.603] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,603.603] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-05-11 11:40:36,603.603] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,604.604] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-05-11 11:40:36,609.609] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,610.610] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-05-11 11:40:36,611.611] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,611.611] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-05-11 11:40:36,612.612] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,612.612] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-05-11 11:40:36,613.613] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,613.613] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-05-11 11:40:36,613.613] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,614.614] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-05-11 11:40:36,614.614] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,614.614] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-05-11 11:40:36,615.615] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,615.615] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-05-11 11:40:36,617.617] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,617.617] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-05-11 11:40:36,618.618] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,618.618] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-05-11 11:40:36,619.619] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,619.619] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-05-11 11:40:36,620.620] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,620.620] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-05-11 11:40:36,621.621] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,621.621] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-05-11 11:40:36,621.621] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,621.621] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-05-11 11:40:36,622.622] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,622.622] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-05-11 11:40:36,623.623] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,623.623] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-05-11 11:40:36,624.624] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,624.624] base.py -> _exec_single_context line:1901 [INFO]: [cached since 184s ago] {'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-05-11 11:40:36,625.625] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,625.625] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-05-11 11:40:36,625.625] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,626.626] base.py -> _exec_single_context line:1901 [INFO]: [cached since 183.9s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-05-11 11:40:36,633.633] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,633.633] base.py -> _exec_single_context line:1901 [INFO]: [cached since 184s ago] {'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-05-11 11:40:36,634.634] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,635.635] base.py -> _exec_single_context line:1901 [INFO]: [cached since 184s ago] {'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-05-11 11:40:36,636.636] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,636.636] base.py -> _exec_single_context line:1901 [INFO]: [cached since 184s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-05-11 11:40:36,636.636] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,637.637] base.py -> _exec_single_context line:1901 [INFO]: [cached since 184s ago] {'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-05-11 11:40:36,637.637] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,637.637] base.py -> _exec_single_context line:1901 [INFO]: [cached since 184s ago] {'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-05-11 11:40:36,638.638] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,638.638] base.py -> _exec_single_context line:1901 [INFO]: [cached since 184s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-05-11 11:40:36,639.639] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,640.640] base.py -> _exec_single_context line:1901 [INFO]: [cached since 184s ago] {'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-05-11 11:40:36,640.640] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,641.641] base.py -> _exec_single_context line:1901 [INFO]: [cached since 184s ago] {'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-05-11 11:40:36,642.642] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,643.643] base.py -> _exec_single_context line:1901 [INFO]: [cached since 184s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-05-11 11:40:36,644.644] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,645.645] base.py -> _exec_single_context line:1901 [INFO]: [cached since 184s ago] {'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-05-11 11:40:36,646.646] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,646.646] base.py -> _exec_single_context line:1901 [INFO]: [cached since 184s ago] {'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-05-11 11:40:36,647.647] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,648.648] base.py -> _exec_single_context line:1901 [INFO]: [cached since 184s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-05-11 11:40:36,648.648] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,649.649] base.py -> _exec_single_context line:1901 [INFO]: [cached since 184s ago] {'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-05-11 11:40:36,650.650] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,650.650] base.py -> _exec_single_context line:1901 [INFO]: [cached since 184s ago] {'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-05-11 11:40:36,651.651] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:36,651.651] base.py -> _exec_single_context line:1901 [INFO]: [cached since 184s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-05-11 11:40:36,653.653] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:40:36,653.653] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:40:36] "GET /datasets?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:40:37,530.530] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:40:37] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f HTTP/1.1" 200 -
[2025-05-11 11:40:37,533.533] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:40:37,533.533] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:40:37,534.534] base.py -> _exec_single_context line:1901 [INFO]: [cached since 165.3s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:40:37,536.536] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:37,536.536] base.py -> _exec_single_context line:1901 [INFO]: [cached since 184.9s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:40:37,537.537] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:37,538.538] base.py -> _exec_single_context line:1901 [INFO]: [cached since 165.3s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:40:37,539.539] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:37,540.540] base.py -> _exec_single_context line:1901 [INFO]: [cached since 184.9s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:40:37,541.541] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:37,541.541] base.py -> _exec_single_context line:1901 [INFO]: [cached since 184.9s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:40:37,543.543] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:40:37,543.543] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:40:37] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f HTTP/1.1" 200 -
[2025-05-11 11:40:37,844.844] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:40:37] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:40:38,162.162] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:40:38,162.162] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:40:38,163.163] base.py -> _exec_single_context line:1901 [INFO]: [cached since 166s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:40:38,165.165] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:40:38,165.165] base.py -> _exec_single_context line:1901 [INFO]: [cached since 165.6s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'param_1': 20, 'param_2': 0}
[2025-05-11 11:40:38,167.167] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2025-05-11 11:40:38,167.167] base.py -> _exec_single_context line:1901 [INFO]: [cached since 165.6s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:40:38,167.167] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count)) AS coalesce_1, 0 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:40:38,167.167] base.py -> _exec_single_context line:1901 [INFO]: [cached since 165.6s ago] {'document_id_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 11:40:38,170.170] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:40:38,170.170] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:40:38] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:40:47,978.978] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:40:47] "OPTIONS /datasets?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:40:47,981.981] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:40:47,982.982] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.account_id = %(account_id_1)s::UUID ORDER BY dataset.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:40:47,983.983] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.3s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'param_1': 20, 'param_2': 0}
[2025-05-11 11:40:47,983.983] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT dataset.id AS id, dataset.account_id AS account_id, dataset.name AS name, dataset.icon AS icon, dataset.description AS description, dataset.updated_at AS updated_at, dataset.created_at AS created_at 
FROM dataset 
WHERE dataset.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-05-11 11:40:47,985.985] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.3s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-11 11:40:47,985.985] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:47,985.985] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.3s ago] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:40:47,987.987] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:47,987.987] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.3s ago] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:40:47,989.989] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:47,989.989] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.3s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:40:47,989.989] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:47,991.991] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.3s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:40:47,991.991] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:47,993.993] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.3s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:40:47,993.993] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:47,993.993] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.3s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:40:47,997.997] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:47,997.997] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.3s ago] {'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-05-11 11:40:47,997.997] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:47,999.999] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.3s ago] {'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-05-11 11:40:48,001.001] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,001.001] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.3s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-05-11 11:40:48,003.003] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,003.003] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.3s ago] {'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-05-11 11:40:48,005.005] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,005.005] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.3s ago] {'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-05-11 11:40:48,007.007] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,007.007] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.3s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-05-11 11:40:48,009.009] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,009.009] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.3s ago] {'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-05-11 11:40:48,010.010] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,010.010] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.3s ago] {'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-05-11 11:40:48,012.012] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,012.012] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.3s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-05-11 11:40:48,014.014] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,014.014] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.3s ago] {'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-05-11 11:40:48,015.015] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,015.015] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.3s ago] {'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-05-11 11:40:48,017.017] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,017.017] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.3s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-05-11 11:40:48,018.018] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,019.019] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.3s ago] {'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-05-11 11:40:48,019.019] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,019.019] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.3s ago] {'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-05-11 11:40:48,019.019] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,019.019] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.3s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-05-11 11:40:48,019.019] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,019.019] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-05-11 11:40:48,019.019] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,019.019] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.3s ago] {'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-05-11 11:40:48,019.019] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,019.019] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.3s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-05-11 11:40:48,028.028] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,028.028] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-05-11 11:40:48,028.028] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,028.028] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-05-11 11:40:48,031.031] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,031.031] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.3s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-05-11 11:40:48,033.033] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,034.034] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-05-11 11:40:48,034.034] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,035.035] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-05-11 11:40:48,035.035] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,036.036] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-05-11 11:40:48,036.036] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,036.036] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-05-11 11:40:48,037.037] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,037.037] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-05-11 11:40:48,039.039] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,039.039] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-05-11 11:40:48,039.039] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,040.040] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-05-11 11:40:48,040.040] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,040.040] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-05-11 11:40:48,044.044] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,044.044] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-05-11 11:40:48,046.046] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,046.046] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-05-11 11:40:48,047.047] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,047.047] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-05-11 11:40:48,048.048] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,049.049] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-05-11 11:40:48,050.050] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,051.051] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-05-11 11:40:48,052.052] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,052.052] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-05-11 11:40:48,053.053] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,053.053] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-05-11 11:40:48,054.054] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,054.054] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-05-11 11:40:48,054.054] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,055.055] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-05-11 11:40:48,055.055] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,056.056] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-05-11 11:40:48,056.056] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,056.056] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-05-11 11:40:48,060.060] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,060.060] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-05-11 11:40:48,062.062] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,062.062] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-05-11 11:40:48,063.063] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,063.063] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-05-11 11:40:48,064.064] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,064.064] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-05-11 11:40:48,065.065] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,065.065] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-05-11 11:40:48,067.067] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,068.068] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-05-11 11:40:48,069.069] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,069.069] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-05-11 11:40:48,070.070] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,071.071] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-05-11 11:40:48,071.071] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,072.072] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-05-11 11:40:48,072.072] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,073.073] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-05-11 11:40:48,074.074] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,074.074] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-05-11 11:40:48,075.075] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,075.075] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-05-11 11:40:48,076.076] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,077.077] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-05-11 11:40:48,078.078] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:48,078.078] base.py -> _exec_single_context line:1901 [INFO]: [cached since 195.4s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-05-11 11:40:48,080.080] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:40:48,080.080] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:40:48] "GET /datasets?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:40:49,280.280] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:40:49] "OPTIONS /datasets/e9315438-563c-44e2-99a0-a60e0ba4b76e HTTP/1.1" 200 -
[2025-05-11 11:40:49,594.594] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:40:49] "OPTIONS /datasets/e9315438-563c-44e2-99a0-a60e0ba4b76e/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:40:49,595.595] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:40:49,595.595] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:40:49,596.596] base.py -> _exec_single_context line:1901 [INFO]: [cached since 177.4s ago] {'pk_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:40:49,597.597] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:49,598.598] base.py -> _exec_single_context line:1901 [INFO]: [cached since 196.9s ago] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:40:49,599.599] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:49,599.599] base.py -> _exec_single_context line:1901 [INFO]: [cached since 177.4s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:40:49,600.600] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:49,600.600] base.py -> _exec_single_context line:1901 [INFO]: [cached since 196.9s ago] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:40:49,601.601] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:40:49,601.601] base.py -> _exec_single_context line:1901 [INFO]: [cached since 196.9s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:40:49,602.602] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:40:49,602.602] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:40:49] "GET /datasets/e9315438-563c-44e2-99a0-a60e0ba4b76e HTTP/1.1" 200 -
[2025-05-11 11:40:49,859.859] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:40:49,860.860] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:40:49,860.860] base.py -> _exec_single_context line:1901 [INFO]: [cached since 177.7s ago] {'pk_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:40:49,864.864] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:40:49,865.865] base.py -> _exec_single_context line:1901 [INFO]: [cached since 177.3s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e'), 'param_1': 20, 'param_2': 0}
[2025-05-11 11:40:49,866.866] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2025-05-11 11:40:49,866.866] base.py -> _exec_single_context line:1901 [INFO]: [cached since 177.3s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:40:49,868.868] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count)) AS coalesce_1, 0 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:40:49,873.873] base.py -> _exec_single_context line:1901 [INFO]: [cached since 177.4s ago] {'document_id_1': UUID('0a9d6d6a-0c8e-47b1-a3e6-441c58730038')}
[2025-05-11 11:40:49,874.874] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:40:49,874.874] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:40:49] "GET /datasets/e9315438-563c-44e2-99a0-a60e0ba4b76e/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:41:24,095.095] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:41:24] "OPTIONS /datasets/e9315438-563c-44e2-99a0-a60e0ba4b76e HTTP/1.1" 200 -
[2025-05-11 11:41:24,100.100] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:41:24] "OPTIONS /datasets/e9315438-563c-44e2-99a0-a60e0ba4b76e/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:41:24,102.102] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:41:24,103.103] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:41:24,103.103] base.py -> _exec_single_context line:1901 [INFO]: [cached since 211.9s ago] {'pk_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:41:24,106.106] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:41:24,106.106] base.py -> _exec_single_context line:1901 [INFO]: [cached since 231.4s ago] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:41:24,107.107] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:41:24,108.108] base.py -> _exec_single_context line:1901 [INFO]: [cached since 211.9s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:41:24,109.109] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:41:24,109.109] base.py -> _exec_single_context line:1901 [INFO]: [cached since 231.4s ago] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:41:24,110.110] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:41:24,110.110] base.py -> _exec_single_context line:1901 [INFO]: [cached since 231.4s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:41:24,112.112] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:41:24,112.112] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:41:24] "GET /datasets/e9315438-563c-44e2-99a0-a60e0ba4b76e HTTP/1.1" 200 -
[2025-05-11 11:41:24,410.410] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:41:24,412.412] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:41:24,412.412] base.py -> _exec_single_context line:1901 [INFO]: [cached since 212.2s ago] {'pk_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:41:24,414.414] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:41:24,414.414] base.py -> _exec_single_context line:1901 [INFO]: [cached since 211.9s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e'), 'param_1': 20, 'param_2': 0}
[2025-05-11 11:41:24,415.415] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2025-05-11 11:41:24,415.415] base.py -> _exec_single_context line:1901 [INFO]: [cached since 211.9s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:41:24,416.416] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count)) AS coalesce_1, 0 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:41:24,426.426] base.py -> _exec_single_context line:1901 [INFO]: [cached since 211.9s ago] {'document_id_1': UUID('0a9d6d6a-0c8e-47b1-a3e6-441c58730038')}
[2025-05-11 11:41:24,426.426] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:41:24,426.426] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:41:24] "GET /datasets/e9315438-563c-44e2-99a0-a60e0ba4b76e/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:42:27,360.360] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:42:27] "OPTIONS /datasets/e9315438-563c-44e2-99a0-a60e0ba4b76e HTTP/1.1" 200 -
[2025-05-11 11:42:27,360.360] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:42:27] "OPTIONS /datasets/e9315438-563c-44e2-99a0-a60e0ba4b76e/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:42:27,668.668] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:42:27,669.669] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:42:27,670.670] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:42:27,670.670] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:42:27,670.670] base.py -> _exec_single_context line:1901 [INFO]: [cached since 275.5s ago] {'pk_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:42:27,670.670] base.py -> _exec_single_context line:1901 [INFO]: [cached since 275.5s ago] {'pk_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:42:27,672.672] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:42:27,673.673] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:42:27,674.674] base.py -> _exec_single_context line:1901 [INFO]: [cached since 295s ago] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:42:27,674.674] base.py -> _exec_single_context line:1901 [INFO]: [cached since 275.2s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e'), 'param_1': 20, 'param_2': 0}
[2025-05-11 11:42:27,675.675] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:42:27,675.675] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2025-05-11 11:42:27,675.675] base.py -> _exec_single_context line:1901 [INFO]: [cached since 275.5s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:42:27,676.676] base.py -> _exec_single_context line:1901 [INFO]: [cached since 275.2s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:42:27,676.676] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:42:27,678.678] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count)) AS coalesce_1, 0 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:42:27,678.678] base.py -> _exec_single_context line:1901 [INFO]: [cached since 295s ago] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:42:27,678.678] base.py -> _exec_single_context line:1901 [INFO]: [cached since 275.2s ago] {'document_id_1': UUID('0a9d6d6a-0c8e-47b1-a3e6-441c58730038')}
[2025-05-11 11:42:27,678.678] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:42:27,678.678] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:42:27,678.678] base.py -> _exec_single_context line:1901 [INFO]: [cached since 295s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:42:27,678.678] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:42:27] "GET /datasets/e9315438-563c-44e2-99a0-a60e0ba4b76e/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:42:27,678.678] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:42:27,678.678] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:42:27] "GET /datasets/e9315438-563c-44e2-99a0-a60e0ba4b76e HTTP/1.1" 200 -
[2025-05-11 11:44:04,435.435] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:44:04] "OPTIONS /datasets?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:44:04,746.746] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:44:04,746.746] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.account_id = %(account_id_1)s::UUID ORDER BY dataset.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:44:04,746.746] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'param_1': 20, 'param_2': 0}
[2025-05-11 11:44:04,748.748] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT dataset.id AS id, dataset.account_id AS account_id, dataset.name AS name, dataset.icon AS icon, dataset.description AS description, dataset.updated_at AS updated_at, dataset.created_at AS created_at 
FROM dataset 
WHERE dataset.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-05-11 11:44:04,748.748] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-11 11:44:04,750.750] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,750.750] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:44:04,751.751] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,751.751] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:44:04,752.752] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,752.752] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:44:04,753.753] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,753.753] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:04,753.753] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,754.754] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:04,754.754] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,754.754] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:04,760.760] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,760.760] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-05-11 11:44:04,761.761] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,761.761] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-05-11 11:44:04,762.762] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,762.762] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-05-11 11:44:04,762.762] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,763.763] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-05-11 11:44:04,763.763] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,763.763] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-05-11 11:44:04,764.764] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,765.765] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-05-11 11:44:04,766.766] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,766.766] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-05-11 11:44:04,767.767] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,767.767] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-05-11 11:44:04,768.768] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,768.768] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-05-11 11:44:04,768.768] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,768.768] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-05-11 11:44:04,769.769] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,769.769] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-05-11 11:44:04,775.775] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,775.775] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-05-11 11:44:04,776.776] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,776.776] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-05-11 11:44:04,777.777] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,777.777] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-05-11 11:44:04,778.778] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,778.778] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-05-11 11:44:04,778.778] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,779.779] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-05-11 11:44:04,779.779] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,779.779] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-05-11 11:44:04,780.780] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,780.780] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-05-11 11:44:04,782.782] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,782.782] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-05-11 11:44:04,783.783] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,783.783] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-05-11 11:44:04,784.784] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,784.784] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-05-11 11:44:04,785.785] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,785.785] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-05-11 11:44:04,790.790] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,790.790] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-05-11 11:44:04,792.792] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,792.792] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-05-11 11:44:04,793.793] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,793.793] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-05-11 11:44:04,794.794] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,794.794] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-05-11 11:44:04,794.794] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,795.795] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-05-11 11:44:04,796.796] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,796.796] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-05-11 11:44:04,796.796] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,797.797] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-05-11 11:44:04,797.797] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,797.797] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-05-11 11:44:04,798.798] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,798.798] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-05-11 11:44:04,799.799] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,799.799] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-05-11 11:44:04,800.800] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,800.800] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-05-11 11:44:04,806.806] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,807.807] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-05-11 11:44:04,807.807] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,807.807] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-05-11 11:44:04,808.808] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,808.808] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-05-11 11:44:04,808.808] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,808.808] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-05-11 11:44:04,810.810] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,810.810] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-05-11 11:44:04,811.811] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,811.811] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-05-11 11:44:04,811.811] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,812.812] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-05-11 11:44:04,812.812] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,812.812] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-05-11 11:44:04,813.813] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,813.813] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-05-11 11:44:04,814.814] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,814.814] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-05-11 11:44:04,814.814] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,814.814] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-05-11 11:44:04,822.822] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,822.822] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-05-11 11:44:04,823.823] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,823.823] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.2s ago] {'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-05-11 11:44:04,824.824] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,824.824] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-05-11 11:44:04,825.825] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,825.825] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-05-11 11:44:04,826.826] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,826.826] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.2s ago] {'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-05-11 11:44:04,827.827] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,827.827] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-05-11 11:44:04,828.828] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,828.828] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-05-11 11:44:04,828.828] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,829.829] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.2s ago] {'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-05-11 11:44:04,830.830] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,830.830] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.2s ago] {'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-05-11 11:44:04,831.831] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:04,831.831] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392.1s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-05-11 11:44:04,832.832] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:44:04,833.833] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:44:04] "GET /datasets?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:44:06,797.797] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:44:06] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f HTTP/1.1" 200 -
[2025-05-11 11:44:06,801.801] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:44:06,802.802] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:44:06,802.802] base.py -> _exec_single_context line:1901 [INFO]: [cached since 374.6s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:06,804.804] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:06,804.804] base.py -> _exec_single_context line:1901 [INFO]: [cached since 394.1s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:06,805.805] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:06,805.805] base.py -> _exec_single_context line:1901 [INFO]: [cached since 374.6s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:06,806.806] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:06,806.806] base.py -> _exec_single_context line:1901 [INFO]: [cached since 394.1s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:06,807.807] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:06,807.807] base.py -> _exec_single_context line:1901 [INFO]: [cached since 394.1s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:06,807.807] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:44:06,808.808] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:44:06] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f HTTP/1.1" 200 -
[2025-05-11 11:44:07,112.112] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:44:07] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:44:07,423.423] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:44:07,424.424] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:44:07,424.424] base.py -> _exec_single_context line:1901 [INFO]: [cached since 375.2s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:07,425.425] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:44:07,425.425] base.py -> _exec_single_context line:1901 [INFO]: [cached since 374.9s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'param_1': 20, 'param_2': 0}
[2025-05-11 11:44:07,426.426] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2025-05-11 11:44:07,426.426] base.py -> _exec_single_context line:1901 [INFO]: [cached since 374.9s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:07,427.427] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count)) AS coalesce_1, 0 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:44:07,437.437] base.py -> _exec_single_context line:1901 [INFO]: [cached since 374.9s ago] {'document_id_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 11:44:07,438.438] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:44:07,439.439] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:44:07] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:44:09,507.507] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:44:09] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/40640321-d3d0-4fd8-a77b-e16fc92b80c5 HTTP/1.1" 200 -
[2025-05-11 11:44:09,508.508] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:44:09] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/40640321-d3d0-4fd8-a77b-e16fc92b80c5/segments?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:44:09,511.511] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:44:09,512.512] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:44:09,513.513] base.py -> _exec_single_context line:1901 [INFO]: [cached since 350.1s ago] {'pk_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 11:44:09,514.514] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:44:09,514.514] base.py -> _exec_single_context line:1901 [INFO]: [cached since 350.1s ago] {'document_id_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 11:44:09,515.515] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count)) AS coalesce_1, 0 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:44:09,515.515] base.py -> _exec_single_context line:1901 [INFO]: [cached since 377s ago] {'document_id_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 11:44:09,516.516] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:44:09,516.516] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:44:09] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/40640321-d3d0-4fd8-a77b-e16fc92b80c5 HTTP/1.1" 200 -
[2025-05-11 11:44:09,820.820] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:44:09,820.820] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:44:09,820.820] base.py -> _exec_single_context line:1901 [INFO]: [cached since 350.4s ago] {'pk_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 11:44:09,823.823] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:44:09,823.823] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00030s] {'document_id_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5'), 'param_1': 20, 'param_2': 0}
[2025-05-11 11:44:09,826.826] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2025-05-11 11:44:09,834.834] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00697s] {'document_id_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 11:44:09,835.835] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:44:09,836.836] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:44:09] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/40640321-d3d0-4fd8-a77b-e16fc92b80c5/segments?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:44:29,493.493] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:44:29] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f HTTP/1.1" 200 -
[2025-05-11 11:44:29,809.809] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:44:29] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:44:29,810.810] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:44:29,811.811] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:44:29,811.811] base.py -> _exec_single_context line:1901 [INFO]: [cached since 397.6s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:29,813.813] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:29,813.813] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.1s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:29,814.814] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:29,815.815] base.py -> _exec_single_context line:1901 [INFO]: [cached since 397.6s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:29,815.815] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:29,816.816] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.1s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:29,816.816] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:29,816.816] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.1s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:29,817.817] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:44:29,818.818] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:44:29] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f HTTP/1.1" 200 -
[2025-05-11 11:44:30,078.078] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:44:30,078.078] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:44:30,080.080] base.py -> _exec_single_context line:1901 [INFO]: [cached since 397.9s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:30,082.082] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:44:30,082.082] base.py -> _exec_single_context line:1901 [INFO]: [cached since 397.6s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'param_1': 20, 'param_2': 0}
[2025-05-11 11:44:30,084.084] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2025-05-11 11:44:30,084.084] base.py -> _exec_single_context line:1901 [INFO]: [cached since 397.6s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:30,085.085] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count)) AS coalesce_1, 0 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:44:30,088.088] base.py -> _exec_single_context line:1901 [INFO]: [cached since 397.6s ago] {'document_id_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 11:44:30,089.089] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:44:30,089.089] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:44:30] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:44:30,388.388] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:44:30] "OPTIONS /datasets?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:44:30,392.392] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:44:30,393.393] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.account_id = %(account_id_1)s::UUID ORDER BY dataset.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:44:30,393.393] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.7s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'param_1': 20, 'param_2': 0}
[2025-05-11 11:44:30,395.395] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT dataset.id AS id, dataset.account_id AS account_id, dataset.name AS name, dataset.icon AS icon, dataset.description AS description, dataset.updated_at AS updated_at, dataset.created_at AS created_at 
FROM dataset 
WHERE dataset.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-05-11 11:44:30,395.395] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.7s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-11 11:44:30,395.395] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,395.395] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.7s ago] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:44:30,396.396] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,396.396] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.7s ago] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:44:30,397.397] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,398.398] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.7s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-05-11 11:44:30,398.398] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,398.398] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.7s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:30,400.400] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,400.400] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.7s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:30,400.400] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,402.402] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.7s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:30,403.403] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,403.403] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.7s ago] {'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-05-11 11:44:30,404.404] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,404.404] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.7s ago] {'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-05-11 11:44:30,404.404] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,405.405] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.7s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-05-11 11:44:30,405.405] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,405.405] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.7s ago] {'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-05-11 11:44:30,406.406] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,406.406] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.7s ago] {'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-05-11 11:44:30,407.407] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,407.407] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.7s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-05-11 11:44:30,407.407] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,407.407] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.7s ago] {'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-05-11 11:44:30,408.408] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,408.408] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.7s ago] {'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-05-11 11:44:30,408.408] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,408.408] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.7s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-05-11 11:44:30,410.410] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,410.410] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.7s ago] {'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-05-11 11:44:30,411.411] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,418.418] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.7s ago] {'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-05-11 11:44:30,419.419] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,419.419] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.7s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-05-11 11:44:30,420.420] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,420.420] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.7s ago] {'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-05-11 11:44:30,421.421] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,421.421] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.7s ago] {'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-05-11 11:44:30,421.421] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,422.422] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.7s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-05-11 11:44:30,422.422] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,422.422] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-05-11 11:44:30,423.423] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,423.423] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.7s ago] {'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-05-11 11:44:30,424.424] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,424.424] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.7s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-05-11 11:44:30,425.425] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,425.425] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-05-11 11:44:30,425.425] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,425.425] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.7s ago] {'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-05-11 11:44:30,426.426] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,426.426] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.7s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-05-11 11:44:30,427.427] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,433.433] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-05-11 11:44:30,434.434] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,434.434] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-05-11 11:44:30,435.435] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,435.435] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-05-11 11:44:30,435.435] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,435.435] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-05-11 11:44:30,436.436] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,436.436] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-05-11 11:44:30,437.437] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,437.437] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-05-11 11:44:30,437.437] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,438.438] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-05-11 11:44:30,438.438] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,438.438] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-05-11 11:44:30,438.438] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,440.440] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-05-11 11:44:30,440.440] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,440.440] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-05-11 11:44:30,441.441] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,441.441] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-05-11 11:44:30,442.442] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,449.449] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-05-11 11:44:30,450.450] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,450.450] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-05-11 11:44:30,450.450] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,450.450] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-05-11 11:44:30,451.451] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,451.451] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-05-11 11:44:30,452.452] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,452.452] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-05-11 11:44:30,453.453] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,453.453] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-05-11 11:44:30,454.454] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,454.454] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-05-11 11:44:30,454.454] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,454.454] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-05-11 11:44:30,455.455] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,455.455] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-05-11 11:44:30,456.456] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,456.456] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-05-11 11:44:30,456.456] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,457.457] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-05-11 11:44:30,457.457] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,465.465] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-05-11 11:44:30,466.466] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,466.466] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-05-11 11:44:30,467.467] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,467.467] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-05-11 11:44:30,467.467] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,468.468] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-05-11 11:44:30,468.468] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,468.468] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-05-11 11:44:30,469.469] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,469.469] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-05-11 11:44:30,470.470] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,470.470] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-05-11 11:44:30,470.470] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,470.470] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-05-11 11:44:30,471.471] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,471.471] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-05-11 11:44:30,472.472] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,472.472] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-05-11 11:44:30,472.472] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:30,473.473] base.py -> _exec_single_context line:1901 [INFO]: [cached since 417.8s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-05-11 11:44:30,474.474] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:44:30,481.481] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:44:30] "GET /datasets?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:44:33,752.752] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:44:33,753.753] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:44:33,753.753] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:44:33,754.754] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:44:33,754.754] base.py -> _exec_single_context line:1901 [INFO]: [cached since 401.5s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:33,754.754] base.py -> _exec_single_context line:1901 [INFO]: [cached since 401.5s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:33,755.755] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:33,756.756] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:44:33,756.756] base.py -> _exec_single_context line:1901 [INFO]: [cached since 421.1s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:33,756.756] base.py -> _exec_single_context line:1901 [INFO]: [cached since 401.2s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'param_1': 20, 'param_2': 0}
[2025-05-11 11:44:33,757.757] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:33,758.758] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2025-05-11 11:44:33,758.758] base.py -> _exec_single_context line:1901 [INFO]: [cached since 401.5s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:33,765.765] base.py -> _exec_single_context line:1901 [INFO]: [cached since 401.2s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:33,766.766] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:33,767.767] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count)) AS coalesce_1, 0 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:44:33,767.767] base.py -> _exec_single_context line:1901 [INFO]: [cached since 421.1s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:33,767.767] base.py -> _exec_single_context line:1901 [INFO]: [cached since 401.2s ago] {'document_id_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 11:44:33,769.769] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:44:33,769.769] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:44:33,769.769] base.py -> _exec_single_context line:1901 [INFO]: [cached since 421.1s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:33,770.770] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:44:33] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:44:33,770.770] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:44:33,771.771] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:44:33] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f HTTP/1.1" 200 -
[2025-05-11 11:44:43,471.471] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:44:43,472.472] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO upload_file (account_id, name, key, size, extension, mime_type, hash) VALUES (%(account_id)s::UUID, %(name)s, %(key)s, %(size)s, %(extension)s, %(mime_type)s, %(hash)s) RETURNING upload_file.id, upload_file.updated_at, upload_file.created_at
[2025-05-11 11:44:43,473.473] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00035s] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'name': '16-LLM文档对话 —— pdf解析关键问题.docx', 'key': '2025/05/11/eb7b5aaa-5a4e-43ea-9cb0-a522b19e6301.docx', 'size': 478379, 'extension': 'docx', 'mime_type': 'application/vnd.openxmlformats-officedocument.wordprocessingml.document', 'hash': '1080b59fa00c2e5a3fcde5891a572caae40a38e6c1161398d3f55853c28e463e'}
[2025-05-11 11:44:43,484.484] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:44:43,486.486] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:44:43,487.487] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2025-05-11 11:44:43,487.487] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00027s] {'pk_1': UUID('b9bd487e-aaec-4362-8d42-ad24101a6cc9')}
[2025-05-11 11:44:43,489.489] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:44:43,489.489] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:44:43] "POST /upload-files/file HTTP/1.1" 200 -
[2025-05-11 11:44:46,803.803] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:44:46] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents HTTP/1.1" 200 -
[2025-05-11 11:44:47,114.114] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:44:47,116.116] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:44:47,116.116] base.py -> _exec_single_context line:1901 [INFO]: [cached since 414.9s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:47,118.118] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.account_id = %(account_id_1)s::UUID AND upload_file.id IN (%(id_1_1)s::UUID)
[2025-05-11 11:44:47,118.118] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00056s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'id_1_1': 'b9bd487e-aaec-4362-8d42-ad24101a6cc9'}
[2025-05-11 11:44:47,121.121] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO process_rule (account_id, dataset_id, mode, rule) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(mode)s, %(rule)s::JSONB) RETURNING process_rule.id, process_rule.updated_at, process_rule.created_at
[2025-05-11 11:44:47,121.121] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00036s] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'mode': 'automatic', 'rule': '{"pre_process_rules": [{"id": "remove_extra_space", "enabled": true}, {"id": "remove_url_and_email", "enabled": true}], "segment": {"separators": ["\ ... (15 characters truncated) ... "\\u3002|\\uff01|\\uff1f", "\\\\.\\\\s|\\\\!\\\\s|\\\\?\\\\s", "\\uff1b|;\\\\s", "\\uff0c|,\\\\s", " ", ""], "chunk_size": 500, "chunk_overlap": 50}}'}
[2025-05-11 11:44:47,124.124] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:44:47,125.125] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:44:47,125.125] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.position DESC 
 LIMIT %(param_1)s
[2025-05-11 11:44:47,125.125] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00022s] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'param_1': 1}
[2025-05-11 11:44:47,127.127] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(pk_1)s::UUID
[2025-05-11 11:44:47,127.127] base.py -> _exec_single_context line:1901 [INFO]: [cached since 3.641s ago] {'pk_1': UUID('b9bd487e-aaec-4362-8d42-ad24101a6cc9')}
[2025-05-11 11:44:47,128.128] base.py -> _exec_single_context line:1896 [INFO]: SELECT process_rule.id AS process_rule_id, process_rule.account_id AS process_rule_account_id, process_rule.dataset_id AS process_rule_dataset_id, process_rule.mode AS process_rule_mode, process_rule.rule AS process_rule_rule, process_rule.updated_at AS process_rule_updated_at, process_rule.created_at AS process_rule_created_at 
FROM process_rule 
WHERE process_rule.id = %(pk_1)s::UUID
[2025-05-11 11:44:47,128.128] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00023s] {'pk_1': UUID('490bc498-2fef-454d-8ede-f22b569dce22')}
[2025-05-11 11:44:47,131.131] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO document (account_id, dataset_id, upload_file_id, process_rule_id, batch, name, position, processing_started_at, parsing_completed_at, splitting_completed_at, indexing_completed_at, completed_at, stopped_at, disabled_at) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(upload_file_id)s::UUID, %(process_rule_id)s::UUID, %(batch)s, %(name)s, %(position)s, %(processing_started_at)s, %(parsing_completed_at)s, %(splitting_completed_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(disabled_at)s) RETURNING document.id, document.character_count, document.token_count, document.error, document.enabled, document.status, document.updated_at, document.created_at
[2025-05-11 11:44:47,132.132] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00038s] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'upload_file_id': UUID('b9bd487e-aaec-4362-8d42-ad24101a6cc9'), 'process_rule_id': UUID('490bc498-2fef-454d-8ede-f22b569dce22'), 'batch': '20250511114447615720', 'name': '16-LLM文档对话 —— pdf解析关键问题.docx', 'position': 2, 'processing_started_at': None, 'parsing_completed_at': None, 'splitting_completed_at': None, 'indexing_completed_at': None, 'completed_at': None, 'stopped_at': None, 'disabled_at': None}
[2025-05-11 11:44:47,137.137] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:44:47,144.144] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:44:47,145.145] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:44:47,145.145] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00024s] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:44:47,275.275] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:44:47,275.275] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:44:47] "POST /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents HTTP/1.1" 200 -
[2025-05-11 11:44:47,582.582] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:44:47] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/batch/20250511114447615720 HTTP/1.1" 200 -
[2025-05-11 11:44:47,586.586] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:44:47,586.586] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:44:47,587.587] base.py -> _exec_single_context line:1901 [INFO]: [cached since 415.4s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:47,589.589] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.batch = %(batch_1)s ORDER BY document.position ASC
[2025-05-11 11:44:47,589.589] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00031s] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'batch_1': '20250511114447615720'}
[2025-05-11 11:44:47,592.592] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:44:47,592.592] base.py -> _exec_single_context line:1901 [INFO]: [cached since 388.1s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:44:47,593.593] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.status = %(status_1)s
[2025-05-11 11:44:47,594.594] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00030s] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159'), 'status_1': <SegmentStatus.COMPLETED: 'completed'>}
[2025-05-11 11:44:47,596.596] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-11 11:44:47,596.596] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00040s] {'id_1': UUID('b9bd487e-aaec-4362-8d42-ad24101a6cc9')}
[2025-05-11 11:44:47,598.598] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:44:47,598.598] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:44:47] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/batch/20250511114447615720 HTTP/1.1" 200 -
[2025-05-11 11:44:52,610.610] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:44:52] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/batch/20250511114447615720 HTTP/1.1" 200 -
[2025-05-11 11:44:52,921.921] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:44:52,921.921] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:44:52,921.921] base.py -> _exec_single_context line:1901 [INFO]: [cached since 420.7s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:52,923.923] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.batch = %(batch_1)s ORDER BY document.position ASC
[2025-05-11 11:44:52,923.923] base.py -> _exec_single_context line:1901 [INFO]: [cached since 5.335s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'batch_1': '20250511114447615720'}
[2025-05-11 11:44:52,925.925] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:44:52,925.925] base.py -> _exec_single_context line:1901 [INFO]: [cached since 393.5s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:44:52,926.926] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.status = %(status_1)s
[2025-05-11 11:44:52,926.926] base.py -> _exec_single_context line:1901 [INFO]: [cached since 5.333s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159'), 'status_1': <SegmentStatus.COMPLETED: 'completed'>}
[2025-05-11 11:44:52,927.927] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-11 11:44:52,927.927] base.py -> _exec_single_context line:1901 [INFO]: [cached since 5.331s ago] {'id_1': UUID('b9bd487e-aaec-4362-8d42-ad24101a6cc9')}
[2025-05-11 11:44:52,928.928] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:44:52,928.928] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:44:52] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/batch/20250511114447615720 HTTP/1.1" 200 -
[2025-05-11 11:44:57,607.607] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:44:57,608.608] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:44:57,608.608] base.py -> _exec_single_context line:1901 [INFO]: [cached since 425.4s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:44:57,610.610] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.batch = %(batch_1)s ORDER BY document.position ASC
[2025-05-11 11:44:57,611.611] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.02s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'batch_1': '20250511114447615720'}
[2025-05-11 11:44:57,612.612] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:44:57,612.612] base.py -> _exec_single_context line:1901 [INFO]: [cached since 398.2s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:44:57,612.612] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.status = %(status_1)s
[2025-05-11 11:44:57,613.613] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.02s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159'), 'status_1': <SegmentStatus.COMPLETED: 'completed'>}
[2025-05-11 11:44:57,613.613] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-11 11:44:57,613.613] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.02s ago] {'id_1': UUID('b9bd487e-aaec-4362-8d42-ad24101a6cc9')}
[2025-05-11 11:44:57,614.614] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:44:57,615.615] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:44:57] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/batch/20250511114447615720 HTTP/1.1" 200 -
[2025-05-11 11:45:02,915.915] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:45:02] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/batch/20250511114447615720 HTTP/1.1" 200 -
[2025-05-11 11:45:03,237.237] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:45:03,238.238] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:45:03,238.238] base.py -> _exec_single_context line:1901 [INFO]: [cached since 431s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:45:03,241.241] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.batch = %(batch_1)s ORDER BY document.position ASC
[2025-05-11 11:45:03,241.241] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.65s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'batch_1': '20250511114447615720'}
[2025-05-11 11:45:03,243.243] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:45:03,243.243] base.py -> _exec_single_context line:1901 [INFO]: [cached since 403.8s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:45:03,246.246] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.status = %(status_1)s
[2025-05-11 11:45:03,247.247] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.65s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159'), 'status_1': <SegmentStatus.COMPLETED: 'completed'>}
[2025-05-11 11:45:03,249.249] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-11 11:45:03,249.249] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.65s ago] {'id_1': UUID('b9bd487e-aaec-4362-8d42-ad24101a6cc9')}
[2025-05-11 11:45:03,251.251] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:45:03,252.252] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:45:03] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/batch/20250511114447615720 HTTP/1.1" 200 -
[2025-05-11 11:45:07,618.618] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:45:07,619.619] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:45:07,619.619] base.py -> _exec_single_context line:1901 [INFO]: [cached since 435.4s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:45:07,620.620] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID AND document.batch = %(batch_1)s ORDER BY document.position ASC
[2025-05-11 11:45:07,621.621] base.py -> _exec_single_context line:1901 [INFO]: [cached since 20.03s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'batch_1': '20250511114447615720'}
[2025-05-11 11:45:07,622.622] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:45:07,622.622] base.py -> _exec_single_context line:1901 [INFO]: [cached since 408.2s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:45:07,623.623] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID AND segment.status = %(status_1)s
[2025-05-11 11:45:07,623.623] base.py -> _exec_single_context line:1901 [INFO]: [cached since 20.03s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159'), 'status_1': <SegmentStatus.COMPLETED: 'completed'>}
[2025-05-11 11:45:07,624.624] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-11 11:45:07,624.624] base.py -> _exec_single_context line:1901 [INFO]: [cached since 20.03s ago] {'id_1': UUID('b9bd487e-aaec-4362-8d42-ad24101a6cc9')}
[2025-05-11 11:45:07,625.625] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:45:07,626.626] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:45:07] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/batch/20250511114447615720 HTTP/1.1" 200 -
[2025-05-11 11:45:38,663.663] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:45:38] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f HTTP/1.1" 200 -
[2025-05-11 11:45:38,973.973] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:45:38] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:45:38,975.975] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:45:38,975.975] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:45:38,975.975] base.py -> _exec_single_context line:1901 [INFO]: [cached since 466.8s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:45:38,977.977] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:45:38,978.978] base.py -> _exec_single_context line:1901 [INFO]: [cached since 486.3s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:45:38,979.979] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:45:38,980.980] base.py -> _exec_single_context line:1901 [INFO]: [cached since 466.8s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:45:38,980.980] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:45:38,980.980] base.py -> _exec_single_context line:1901 [INFO]: [cached since 486.3s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:45:38,981.981] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:45:38,981.981] base.py -> _exec_single_context line:1901 [INFO]: [cached since 486.3s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:45:38,982.982] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:45:38,983.983] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:45:38] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f HTTP/1.1" 200 -
[2025-05-11 11:45:39,235.235] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:45:39,236.236] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:45:39,236.236] base.py -> _exec_single_context line:1901 [INFO]: [cached since 467s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:45:39,238.238] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:45:39,238.238] base.py -> _exec_single_context line:1901 [INFO]: [cached since 466.7s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'param_1': 20, 'param_2': 0}
[2025-05-11 11:45:39,239.239] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2025-05-11 11:45:39,240.240] base.py -> _exec_single_context line:1901 [INFO]: [cached since 466.7s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:45:39,241.241] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count)) AS coalesce_1, 0 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:45:39,250.250] base.py -> _exec_single_context line:1901 [INFO]: [cached since 466.7s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:45:39,251.251] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count)) AS coalesce_1, 0 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:45:39,251.251] base.py -> _exec_single_context line:1901 [INFO]: [cached since 466.7s ago] {'document_id_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 11:45:39,253.253] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:45:39,253.253] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:45:39] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:45:42,302.302] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:45:42] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159 HTTP/1.1" 200 -
[2025-05-11 11:45:42,304.304] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:45:42] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:45:42,305.305] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:45:42,306.306] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:45:42,306.306] base.py -> _exec_single_context line:1901 [INFO]: [cached since 442.9s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:45:42,308.308] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:45:42,309.309] base.py -> _exec_single_context line:1901 [INFO]: [cached since 442.9s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:45:42,309.309] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count)) AS coalesce_1, 0 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:45:42,309.309] base.py -> _exec_single_context line:1901 [INFO]: [cached since 469.8s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:45:42,310.310] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:45:42,311.311] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:45:42] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159 HTTP/1.1" 200 -
[2025-05-11 11:45:42,616.616] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:45:42,616.616] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:45:42,617.617] base.py -> _exec_single_context line:1901 [INFO]: [cached since 443.2s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:45:42,618.618] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:45:42,618.618] base.py -> _exec_single_context line:1901 [INFO]: [cached since 92.8s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159'), 'param_1': 20, 'param_2': 0}
[2025-05-11 11:45:42,619.619] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2025-05-11 11:45:42,628.628] base.py -> _exec_single_context line:1901 [INFO]: [cached since 92.8s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:45:42,629.629] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:45:42,630.630] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:45:42] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:46:30,415.415] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:46:30] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments/0bab51e4-84f9-4ca7-8d96-0f319cae6e86/enabled HTTP/1.1" 200 -
[2025-05-11 11:46:30,729.729] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:46:30,729.729] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-11 11:46:30,730.730] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00028s] {'pk_1': UUID('0bab51e4-84f9-4ca7-8d96-0f319cae6e86')}
[2025-05-11 11:46:30,740.740] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE segment.id = %(segment_id)s::UUID
[2025-05-11 11:46:30,740.740] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00039s] {'enabled': False, 'disabled_at': datetime.datetime(2025, 5, 11, 11, 46, 30, 739701), 'segment_id': UUID('0bab51e4-84f9-4ca7-8d96-0f319cae6e86')}
[2025-05-11 11:46:30,742.742] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:46:30,743.743] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:46:30,744.744] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-11 11:46:30,745.745] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00084s] {'pk_1': UUID('0bab51e4-84f9-4ca7-8d96-0f319cae6e86')}
[2025-05-11 11:46:30,748.748] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:46:30,748.748] base.py -> _exec_single_context line:1901 [INFO]: [cached since 491.3s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:46:30,752.752] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:46:30,752.752] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00033s] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:46:30,755.755] base.py -> _exec_single_context line:1896 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s::JSONB WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2025-05-11 11:46:30,755.755] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00032s] {'keyword_table': '{"PP": ["5c616378-9616-4b8c-980b-42cb3e5fe6f2"], "x1": ["5c616378-9616-4b8c-980b-42cb3e5fe6f2"], "x2": ["5c616378-9616-4b8c-980b-42cb3e5fe6f2"], "GPU ... (3558 characters truncated) ... 78-9616-4b8c-980b-42cb3e5fe6f2"], "transformers": ["0be1239c-e04c-4fb4-852b-5132a4cab303"], "unstructured": ["7258af3b-fdc0-473e-89a7-8b9110865109"]}', 'keyword_table_id': UUID('ba32e876-737b-4f74-998a-9806e8ae96e3')}
[2025-05-11 11:46:30,759.759] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:46:30,768.768] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:46:30,768.768] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-11 11:46:30,769.769] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02514s ago] {'pk_1': UUID('0bab51e4-84f9-4ca7-8d96-0f319cae6e86')}
[2025-05-11 11:46:31,057.057] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:46:31,058.058] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:46:31] "POST /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments/0bab51e4-84f9-4ca7-8d96-0f319cae6e86/enabled HTTP/1.1" 200 -
[2025-05-11 11:46:45,816.816] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:46:45] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments/0bab51e4-84f9-4ca7-8d96-0f319cae6e86/enabled HTTP/1.1" 200 -
[2025-05-11 11:46:45,820.820] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:46:45,820.820] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-11 11:46:45,820.820] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.09s ago] {'pk_1': UUID('0bab51e4-84f9-4ca7-8d96-0f319cae6e86')}
[2025-05-11 11:46:45,825.825] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE segment.id = %(segment_id)s::UUID
[2025-05-11 11:46:45,825.825] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.09s ago] {'enabled': True, 'disabled_at': None, 'segment_id': UUID('0bab51e4-84f9-4ca7-8d96-0f319cae6e86')}
[2025-05-11 11:46:45,825.825] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:46:45,827.827] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:46:45,827.827] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-11 11:46:45,827.827] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.08s ago] {'pk_1': UUID('0bab51e4-84f9-4ca7-8d96-0f319cae6e86')}
[2025-05-11 11:46:45,828.828] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:46:45,829.829] base.py -> _exec_single_context line:1901 [INFO]: [cached since 506.4s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:46:45,830.830] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:46:45,831.831] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.08s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:46:45,833.833] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.keywords AS segment_keywords 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2025-05-11 11:46:45,833.833] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00028s] {'id_1_1': UUID('0bab51e4-84f9-4ca7-8d96-0f319cae6e86')}
[2025-05-11 11:46:45,835.835] base.py -> _exec_single_context line:1896 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s::JSONB WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2025-05-11 11:46:45,835.835] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.08s ago] {'keyword_table': '{"PP": ["5c616378-9616-4b8c-980b-42cb3e5fe6f2"], "x1": ["5c616378-9616-4b8c-980b-42cb3e5fe6f2"], "x2": ["5c616378-9616-4b8c-980b-42cb3e5fe6f2"], "GPU ... (4006 characters truncated) ... 4f9-4ca7-8d96-0f319cae6e86"], "\\u5bf9\\u8bdd": ["0bab51e4-84f9-4ca7-8d96-0f319cae6e86"], "\\u7528\\u6237": ["0bab51e4-84f9-4ca7-8d96-0f319cae6e86"]}', 'keyword_table_id': UUID('ba32e876-737b-4f74-998a-9806e8ae96e3')}
[2025-05-11 11:46:45,836.836] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:46:45,837.837] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:46:45,838.838] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-11 11:46:45,838.838] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.09s ago] {'pk_1': UUID('0bab51e4-84f9-4ca7-8d96-0f319cae6e86')}
[2025-05-11 11:46:46,099.099] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:46:46,100.100] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:46:46] "POST /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments/0bab51e4-84f9-4ca7-8d96-0f319cae6e86/enabled HTTP/1.1" 200 -
[2025-05-11 11:47:02,831.831] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:47:02] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments HTTP/1.1" 200 -
[2025-05-11 11:47:04,103.103] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:47:04,104.104] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:47:04,104.104] base.py -> _exec_single_context line:1901 [INFO]: [cached since 524.7s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:47:04,106.106] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(max(segment.position), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:47:04,106.106] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00026s] {'coalesce_2': 0, 'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:47:04,107.107] __init__.py -> initialize line:113 [DEBUG]: Building prefix dict from the default dictionary ...
[2025-05-11 11:47:04,107.107] __init__.py -> initialize line:132 [DEBUG]: Loading model from cache C:\Users\Lenovo\AppData\Local\Temp\jieba.cache
[2025-05-11 11:47:04,482.482] __init__.py -> initialize line:164 [DEBUG]: Loading model cost 0.375 seconds.
[2025-05-11 11:47:04,483.483] __init__.py -> initialize line:166 [DEBUG]: Prefix dict has been built successfully.
[2025-05-11 11:47:04,492.492] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO segment (account_id, dataset_id, document_id, node_id, position, content, character_count, token_count, keywords, hash, enabled, disabled_at, processing_started_at, indexing_completed_at, completed_at, stopped_at, status) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(document_id)s::UUID, %(node_id)s::UUID, %(position)s, %(content)s, %(character_count)s, %(token_count)s, %(keywords)s::JSONB, %(hash)s, %(enabled)s, %(disabled_at)s, %(processing_started_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(status)s) RETURNING segment.id, segment.hit_count, segment.error, segment.updated_at, segment.created_at
[2025-05-11 11:47:04,492.492] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00045s] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'document_id': UUID('5cd65806-5587-43fa-b3a5-66458c355159'), 'node_id': UUID('9069b10e-215c-4501-8999-c041dfc501d5'), 'position': 8, 'content': 'haohao好好好美haoer', 'character_count': 15, 'token_count': 10, 'keywords': '["\\u597d\\u7f8e", "haohao", "haoer", "\\u597d\\u597d"]', 'hash': '280577d54d3ebe85fad0d7ee99a1daeb39c3ac45ab5b8b54542cc679debf7da9', 'enabled': True, 'disabled_at': None, 'processing_started_at': datetime.datetime(2025, 5, 11, 11, 47, 4, 490978), 'indexing_completed_at': datetime.datetime(2025, 5, 11, 11, 47, 4, 490978), 'completed_at': datetime.datetime(2025, 5, 11, 11, 47, 4, 490978), 'stopped_at': None, 'status': <SegmentStatus.COMPLETED: 'completed'>}
[2025-05-11 11:47:04,495.495] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:47:04,496.496] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:47:04,496.496] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:47:04,497.497] base.py -> _exec_single_context line:1901 [INFO]: [cached since 137.4s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:47:04,498.498] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-11 11:47:04,505.505] base.py -> _exec_single_context line:1901 [INFO]: [cached since 33.76s ago] {'pk_1': UUID('6fa55b0e-3ebf-4eb8-861a-a778c921e1a4')}
[2025-05-11 11:47:05,254.254] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.character_count), %(coalesce_2)s) AS coalesce_1, coalesce(sum(segment.token_count), %(coalesce_4)s) AS coalesce_3 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID 
 LIMIT %(param_1)s
[2025-05-11 11:47:05,255.255] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00050s] {'coalesce_2': 0, 'coalesce_4': 0, 'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159'), 'param_1': 1}
[2025-05-11 11:47:05,257.257] base.py -> _exec_single_context line:1896 [INFO]: UPDATE document SET character_count=%(character_count)s, token_count=%(token_count)s WHERE document.id = %(document_id)s::UUID
[2025-05-11 11:47:05,257.257] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00040s] {'character_count': 3140, 'token_count': 2777, 'document_id': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:47:05,258.258] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:47:05,259.259] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:47:05,259.259] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:47:05,259.259] base.py -> _exec_single_context line:1901 [INFO]: [cached since 138.1s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:47:05,260.260] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-11 11:47:05,261.261] base.py -> _exec_single_context line:1901 [INFO]: [cached since 34.52s ago] {'pk_1': UUID('6fa55b0e-3ebf-4eb8-861a-a778c921e1a4')}
[2025-05-11 11:47:05,263.263] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:47:05,263.263] base.py -> _exec_single_context line:1901 [INFO]: [cached since 34.51s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:47:05,269.269] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.keywords AS segment_keywords 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2025-05-11 11:47:05,269.269] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.44s ago] {'id_1_1': UUID('6fa55b0e-3ebf-4eb8-861a-a778c921e1a4')}
[2025-05-11 11:47:05,270.270] base.py -> _exec_single_context line:1896 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s::JSONB WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2025-05-11 11:47:05,272.272] base.py -> _exec_single_context line:1901 [INFO]: [cached since 34.52s ago] {'keyword_table': '{"AI": ["0bab51e4-84f9-4ca7-8d96-0f319cae6e86"], "PP": ["5c616378-9616-4b8c-980b-42cb3e5fe6f2"], "x1": ["5c616378-9616-4b8c-980b-42cb3e5fe6f2"], "x2" ... (4229 characters truncated) ... fa55b0e-3ebf-4eb8-861a-a778c921e1a4"], "haoer": ["6fa55b0e-3ebf-4eb8-861a-a778c921e1a4"], "\\u597d\\u597d": ["6fa55b0e-3ebf-4eb8-861a-a778c921e1a4"]}', 'keyword_table_id': UUID('ba32e876-737b-4f74-998a-9806e8ae96e3')}
[2025-05-11 11:47:05,273.273] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:47:05,275.275] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:47:05] "POST /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments HTTP/1.1" 200 -
[2025-05-11 11:47:05,583.583] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:47:05] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:47:05,586.586] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:47:05,586.586] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:47:05,586.586] base.py -> _exec_single_context line:1901 [INFO]: [cached since 526.1s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:47:05,589.589] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:47:05,589.589] base.py -> _exec_single_context line:1901 [INFO]: [cached since 175.8s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159'), 'param_1': 20, 'param_2': 0}
[2025-05-11 11:47:05,590.590] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2025-05-11 11:47:05,596.596] base.py -> _exec_single_context line:1901 [INFO]: [cached since 175.8s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:47:05,598.598] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:47:05,599.599] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:47:05] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:47:07,723.723] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:47:07] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments/6fa55b0e-3ebf-4eb8-861a-a778c921e1a4 HTTP/1.1" 200 -
[2025-05-11 11:47:08,031.031] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:47:08,032.032] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-11 11:47:08,032.032] base.py -> _exec_single_context line:1901 [INFO]: [cached since 37.3s ago] {'pk_1': UUID('6fa55b0e-3ebf-4eb8-861a-a778c921e1a4')}
[2025-05-11 11:47:08,034.034] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:47:08,034.034] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:47:08] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments/6fa55b0e-3ebf-4eb8-861a-a778c921e1a4 HTTP/1.1" 200 -
[2025-05-11 11:47:50,001.001] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:47:50] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments/6fa55b0e-3ebf-4eb8-861a-a778c921e1a4 HTTP/1.1" 200 -
[2025-05-11 11:47:50,005.005] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:47:50,006.006] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-11 11:47:50,006.006] base.py -> _exec_single_context line:1901 [INFO]: [cached since 79.28s ago] {'pk_1': UUID('6fa55b0e-3ebf-4eb8-861a-a778c921e1a4')}
[2025-05-11 11:47:50,007.007] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:47:50,007.007] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:47:50] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments/6fa55b0e-3ebf-4eb8-861a-a778c921e1a4 HTTP/1.1" 200 -
[2025-05-11 11:47:54,643.643] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:47:54,643.643] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-11 11:47:54,644.644] base.py -> _exec_single_context line:1901 [INFO]: [cached since 83.91s ago] {'pk_1': UUID('6fa55b0e-3ebf-4eb8-861a-a778c921e1a4')}
[2025-05-11 11:47:54,646.646] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET keywords=%(keywords)s::JSONB WHERE segment.id = %(segment_id)s::UUID
[2025-05-11 11:47:54,646.646] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00024s] {'keywords': '["\\u597d\\u7f8e", "haohao", "haoer", "\\u597d\\u597d", "\\u597d"]', 'segment_id': UUID('6fa55b0e-3ebf-4eb8-861a-a778c921e1a4')}
[2025-05-11 11:47:54,647.647] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:47:54,649.649] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:47:54,649.649] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:47:54,649.649] base.py -> _exec_single_context line:1901 [INFO]: [cached since 83.9s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:47:54,651.651] base.py -> _exec_single_context line:1896 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s::JSONB WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2025-05-11 11:47:54,651.651] base.py -> _exec_single_context line:1901 [INFO]: [cached since 83.9s ago] {'keyword_table': '{"AI": ["0bab51e4-84f9-4ca7-8d96-0f319cae6e86"], "PP": ["5c616378-9616-4b8c-980b-42cb3e5fe6f2"], "x1": ["5c616378-9616-4b8c-980b-42cb3e5fe6f2"], "x2" ... (4006 characters truncated) ... 78-9616-4b8c-980b-42cb3e5fe6f2"], "transformers": ["0be1239c-e04c-4fb4-852b-5132a4cab303"], "unstructured": ["7258af3b-fdc0-473e-89a7-8b9110865109"]}', 'keyword_table_id': UUID('ba32e876-737b-4f74-998a-9806e8ae96e3')}
[2025-05-11 11:47:54,652.652] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:47:54,655.655] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:47:54,655.655] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:47:54,655.655] base.py -> _exec_single_context line:1901 [INFO]: [cached since 83.9s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:47:54,656.656] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.keywords AS segment_keywords 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2025-05-11 11:47:54,656.656] base.py -> _exec_single_context line:1901 [INFO]: [cached since 68.82s ago] {'id_1_1': UUID('6fa55b0e-3ebf-4eb8-861a-a778c921e1a4')}
[2025-05-11 11:47:54,657.657] base.py -> _exec_single_context line:1896 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s::JSONB WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2025-05-11 11:47:54,657.657] base.py -> _exec_single_context line:1901 [INFO]: [cached since 83.9s ago] {'keyword_table': '{"AI": ["0bab51e4-84f9-4ca7-8d96-0f319cae6e86"], "PP": ["5c616378-9616-4b8c-980b-42cb3e5fe6f2"], "x1": ["5c616378-9616-4b8c-980b-42cb3e5fe6f2"], "x2" ... (4282 characters truncated) ... 55b0e-3ebf-4eb8-861a-a778c921e1a4"], "\\u597d\\u597d": ["6fa55b0e-3ebf-4eb8-861a-a778c921e1a4"], "\\u597d": ["6fa55b0e-3ebf-4eb8-861a-a778c921e1a4"]}', 'keyword_table_id': UUID('ba32e876-737b-4f74-998a-9806e8ae96e3')}
[2025-05-11 11:47:54,657.657] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:47:54,659.659] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:47:54] "POST /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments/6fa55b0e-3ebf-4eb8-861a-a778c921e1a4 HTTP/1.1" 200 -
[2025-05-11 11:47:54,663.663] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:47:54] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:47:54,907.907] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:47:54,907.907] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:47:54,908.908] base.py -> _exec_single_context line:1901 [INFO]: [cached since 575.5s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:47:54,909.909] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:47:54,909.909] base.py -> _exec_single_context line:1901 [INFO]: [cached since 225.1s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159'), 'param_1': 20, 'param_2': 0}
[2025-05-11 11:47:54,910.910] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2025-05-11 11:47:54,922.922] base.py -> _exec_single_context line:1901 [INFO]: [cached since 225.1s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:47:54,924.924] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:47:54,925.925] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:47:54] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:47:56,385.385] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:47:56] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments/6fa55b0e-3ebf-4eb8-861a-a778c921e1a4 HTTP/1.1" 200 -
[2025-05-11 11:47:56,389.389] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:47:56,390.390] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-11 11:47:56,390.390] base.py -> _exec_single_context line:1901 [INFO]: [cached since 85.66s ago] {'pk_1': UUID('6fa55b0e-3ebf-4eb8-861a-a778c921e1a4')}
[2025-05-11 11:47:56,391.391] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:47:56,392.392] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:47:56] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments/6fa55b0e-3ebf-4eb8-861a-a778c921e1a4 HTTP/1.1" 200 -
[2025-05-11 11:48:01,688.688] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:48:01] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f HTTP/1.1" 200 -
[2025-05-11 11:48:02,009.009] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:48:02] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:48:02,011.011] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:48:02,012.012] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:48:02,012.012] base.py -> _exec_single_context line:1901 [INFO]: [cached since 609.8s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:02,014.014] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:48:02,014.014] base.py -> _exec_single_context line:1901 [INFO]: [cached since 629.3s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:02,015.015] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:48:02,015.015] base.py -> _exec_single_context line:1901 [INFO]: [cached since 609.8s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:02,016.016] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:48:02,016.016] base.py -> _exec_single_context line:1901 [INFO]: [cached since 629.3s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:02,018.018] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:48:02,018.018] base.py -> _exec_single_context line:1901 [INFO]: [cached since 629.3s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:02,018.018] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:48:02,019.019] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:48:02] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f HTTP/1.1" 200 -
[2025-05-11 11:48:02,272.272] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:48:02,272.272] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:48:02,272.272] base.py -> _exec_single_context line:1901 [INFO]: [cached since 610.1s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:02,274.274] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:48:02,274.274] base.py -> _exec_single_context line:1901 [INFO]: [cached since 609.8s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'param_1': 20, 'param_2': 0}
[2025-05-11 11:48:02,275.275] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2025-05-11 11:48:02,276.276] base.py -> _exec_single_context line:1901 [INFO]: [cached since 609.8s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:02,277.277] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count)) AS coalesce_1, 0 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:48:02,285.285] base.py -> _exec_single_context line:1901 [INFO]: [cached since 609.8s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:48:02,286.286] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count)) AS coalesce_1, 0 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:48:02,287.287] base.py -> _exec_single_context line:1901 [INFO]: [cached since 609.8s ago] {'document_id_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 11:48:02,287.287] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:48:02,288.288] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:48:02] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:48:03,409.409] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:48:03] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/queries HTTP/1.1" 200 -
[2025-05-11 11:48:03,413.413] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:48:03,414.414] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:48:03,414.414] base.py -> _exec_single_context line:1901 [INFO]: [cached since 611.2s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:03,416.416] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset_query.id AS dataset_query_id, dataset_query.dataset_id AS dataset_query_dataset_id, dataset_query.query AS dataset_query_query, dataset_query.source AS dataset_query_source, dataset_query.source_app_id AS dataset_query_source_app_id, dataset_query.created_by AS dataset_query_created_by, dataset_query.updated_at AS dataset_query_updated_at, dataset_query.created_at AS dataset_query_created_at 
FROM dataset_query 
WHERE dataset_query.dataset_id = %(dataset_id_1)s::UUID ORDER BY dataset_query.created_at DESC 
 LIMIT %(param_1)s
[2025-05-11 11:48:03,417.417] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00036s] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'param_1': 10}
[2025-05-11 11:48:03,419.419] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:48:03,419.419] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:48:03] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/queries HTTP/1.1" 200 -
[2025-05-11 11:48:20,276.276] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:48:20] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/hit HTTP/1.1" 200 -
[2025-05-11 11:48:20,591.591] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:48:20,591.591] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:48:20,592.592] base.py -> _exec_single_context line:1901 [INFO]: [cached since 628.4s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:20,593.593] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-11 11:48:20,593.593] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00025s] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'id_1_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:20,669.669] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.keyword_table AS keyword_table_keyword_table 
FROM keyword_table 
WHERE keyword_table.dataset_id IN (%(dataset_id_1_1)s::UUID)
[2025-05-11 11:48:20,669.669] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00038s] {'dataset_id_1_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:20,671.671] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (NULL) AND (1 != 1)
[2025-05-11 11:48:20,671.671] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00032s] {}
[2025-05-11 11:48:20,674.674] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (NULL) AND (1 != 1)
[2025-05-11 11:48:20,674.674] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00026s] {'hit_count_1': 1}
[2025-05-11 11:48:20,675.675] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:48:20,675.675] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:48:20,676.676] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (NULL) AND (1 != 1)
[2025-05-11 11:48:20,676.676] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.004848s ago] {}
[2025-05-11 11:48:20,677.677] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:48:20,677.677] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:48:20] "POST /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/hit HTTP/1.1" 200 -
[2025-05-11 11:48:21,007.007] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:48:21] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/queries HTTP/1.1" 200 -
[2025-05-11 11:48:21,010.010] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:48:21,011.011] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:48:21,011.011] base.py -> _exec_single_context line:1901 [INFO]: [cached since 628.8s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:21,012.012] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset_query.id AS dataset_query_id, dataset_query.dataset_id AS dataset_query_dataset_id, dataset_query.query AS dataset_query_query, dataset_query.source AS dataset_query_source, dataset_query.source_app_id AS dataset_query_source_app_id, dataset_query.created_by AS dataset_query_created_by, dataset_query.updated_at AS dataset_query_updated_at, dataset_query.created_at AS dataset_query_created_at 
FROM dataset_query 
WHERE dataset_query.dataset_id = %(dataset_id_1)s::UUID ORDER BY dataset_query.created_at DESC 
 LIMIT %(param_1)s
[2025-05-11 11:48:21,012.012] base.py -> _exec_single_context line:1901 [INFO]: [cached since 17.6s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'param_1': 10}
[2025-05-11 11:48:21,014.014] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:48:21,015.015] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:48:21] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/queries HTTP/1.1" 200 -
[2025-05-11 11:48:25,834.834] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:48:25] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/hit HTTP/1.1" 200 -
[2025-05-11 11:48:26,150.150] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:48:26,151.151] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:48:26,151.151] base.py -> _exec_single_context line:1901 [INFO]: [cached since 633.9s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:26,152.152] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-11 11:48:26,152.152] base.py -> _exec_single_context line:1901 [INFO]: [cached since 5.559s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'id_1_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:26,155.155] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.keyword_table AS keyword_table_keyword_table 
FROM keyword_table 
WHERE keyword_table.dataset_id IN (%(dataset_id_1_1)s::UUID)
[2025-05-11 11:48:26,155.155] base.py -> _exec_single_context line:1901 [INFO]: [cached since 5.486s ago] {'dataset_id_1_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:26,156.156] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (NULL) AND (1 != 1)
[2025-05-11 11:48:26,156.156] base.py -> _exec_single_context line:1901 [INFO]: [cached since 5.485s ago] {}
[2025-05-11 11:48:26,157.157] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (NULL) AND (1 != 1)
[2025-05-11 11:48:26,158.158] base.py -> _exec_single_context line:1901 [INFO]: [cached since 5.484s ago] {'hit_count_1': 1}
[2025-05-11 11:48:26,158.158] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:48:26,158.158] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:48:26,159.159] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (NULL) AND (1 != 1)
[2025-05-11 11:48:26,165.165] base.py -> _exec_single_context line:1901 [INFO]: [cached since 5.493s ago] {}
[2025-05-11 11:48:26,166.166] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:48:26,166.166] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:48:26] "POST /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/hit HTTP/1.1" 200 -
[2025-05-11 11:48:26,478.478] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:48:26] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/queries HTTP/1.1" 200 -
[2025-05-11 11:48:26,482.482] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:48:26,483.483] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:48:26,483.483] base.py -> _exec_single_context line:1901 [INFO]: [cached since 634.3s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:26,484.484] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset_query.id AS dataset_query_id, dataset_query.dataset_id AS dataset_query_dataset_id, dataset_query.query AS dataset_query_query, dataset_query.source AS dataset_query_source, dataset_query.source_app_id AS dataset_query_source_app_id, dataset_query.created_by AS dataset_query_created_by, dataset_query.updated_at AS dataset_query_updated_at, dataset_query.created_at AS dataset_query_created_at 
FROM dataset_query 
WHERE dataset_query.dataset_id = %(dataset_id_1)s::UUID ORDER BY dataset_query.created_at DESC 
 LIMIT %(param_1)s
[2025-05-11 11:48:26,484.484] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.07s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'param_1': 10}
[2025-05-11 11:48:26,485.485] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:48:26,486.486] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:48:26] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/queries HTTP/1.1" 200 -
[2025-05-11 11:48:31,530.530] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:48:31] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/hit HTTP/1.1" 200 -
[2025-05-11 11:48:31,837.837] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:48:31,837.837] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:48:31,837.837] base.py -> _exec_single_context line:1901 [INFO]: [cached since 639.6s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:31,839.839] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-11 11:48:31,839.839] base.py -> _exec_single_context line:1901 [INFO]: [cached since 11.25s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'id_1_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:31,841.841] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.keyword_table AS keyword_table_keyword_table 
FROM keyword_table 
WHERE keyword_table.dataset_id IN (%(dataset_id_1_1)s::UUID)
[2025-05-11 11:48:31,841.841] base.py -> _exec_single_context line:1901 [INFO]: [cached since 11.17s ago] {'dataset_id_1_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:31,842.842] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (NULL) AND (1 != 1)
[2025-05-11 11:48:31,842.842] base.py -> _exec_single_context line:1901 [INFO]: [cached since 11.17s ago] {}
[2025-05-11 11:48:31,843.843] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (NULL) AND (1 != 1)
[2025-05-11 11:48:31,844.844] base.py -> _exec_single_context line:1901 [INFO]: [cached since 11.17s ago] {'hit_count_1': 1}
[2025-05-11 11:48:31,844.844] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:48:31,845.845] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:48:31,845.845] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (NULL) AND (1 != 1)
[2025-05-11 11:48:31,850.850] base.py -> _exec_single_context line:1901 [INFO]: [cached since 11.18s ago] {}
[2025-05-11 11:48:31,850.850] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:48:31,851.851] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:48:31] "POST /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/hit HTTP/1.1" 200 -
[2025-05-11 11:48:32,162.162] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:48:32] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/queries HTTP/1.1" 200 -
[2025-05-11 11:48:32,166.166] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:48:32,166.166] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:48:32,167.167] base.py -> _exec_single_context line:1901 [INFO]: [cached since 640s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:32,168.168] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset_query.id AS dataset_query_id, dataset_query.dataset_id AS dataset_query_dataset_id, dataset_query.query AS dataset_query_query, dataset_query.source AS dataset_query_source, dataset_query.source_app_id AS dataset_query_source_app_id, dataset_query.created_by AS dataset_query_created_by, dataset_query.updated_at AS dataset_query_updated_at, dataset_query.created_at AS dataset_query_created_at 
FROM dataset_query 
WHERE dataset_query.dataset_id = %(dataset_id_1)s::UUID ORDER BY dataset_query.created_at DESC 
 LIMIT %(param_1)s
[2025-05-11 11:48:32,168.168] base.py -> _exec_single_context line:1901 [INFO]: [cached since 28.75s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'param_1': 10}
[2025-05-11 11:48:32,169.169] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:48:32,169.169] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:48:32] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/queries HTTP/1.1" 200 -
[2025-05-11 11:48:39,486.486] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:48:39] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/hit HTTP/1.1" 200 -
[2025-05-11 11:48:39,801.801] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:48:39,802.802] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:48:39,802.802] base.py -> _exec_single_context line:1901 [INFO]: [cached since 647.6s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:39,803.803] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-11 11:48:39,803.803] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.21s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'id_1_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:39,806.806] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.keyword_table AS keyword_table_keyword_table 
FROM keyword_table 
WHERE keyword_table.dataset_id IN (%(dataset_id_1_1)s::UUID)
[2025-05-11 11:48:39,806.806] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.14s ago] {'dataset_id_1_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:39,807.807] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (NULL) AND (1 != 1)
[2025-05-11 11:48:39,807.807] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.14s ago] {}
[2025-05-11 11:48:39,808.808] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (NULL) AND (1 != 1)
[2025-05-11 11:48:39,808.808] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.13s ago] {'hit_count_1': 1}
[2025-05-11 11:48:39,809.809] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:48:39,809.809] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:48:39,809.809] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (NULL) AND (1 != 1)
[2025-05-11 11:48:39,816.816] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.14s ago] {}
[2025-05-11 11:48:39,817.817] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:48:39,817.817] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:48:39] "POST /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/hit HTTP/1.1" 200 -
[2025-05-11 11:48:40,131.131] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:48:40] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/queries HTTP/1.1" 200 -
[2025-05-11 11:48:40,135.135] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:48:40,135.135] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:48:40,136.136] base.py -> _exec_single_context line:1901 [INFO]: [cached since 647.9s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:40,137.137] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset_query.id AS dataset_query_id, dataset_query.dataset_id AS dataset_query_dataset_id, dataset_query.query AS dataset_query_query, dataset_query.source AS dataset_query_source, dataset_query.source_app_id AS dataset_query_source_app_id, dataset_query.created_by AS dataset_query_created_by, dataset_query.updated_at AS dataset_query_updated_at, dataset_query.created_at AS dataset_query_created_at 
FROM dataset_query 
WHERE dataset_query.dataset_id = %(dataset_id_1)s::UUID ORDER BY dataset_query.created_at DESC 
 LIMIT %(param_1)s
[2025-05-11 11:48:40,137.137] base.py -> _exec_single_context line:1901 [INFO]: [cached since 36.72s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'param_1': 10}
[2025-05-11 11:48:40,138.138] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:48:40,138.138] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:48:40] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/queries HTTP/1.1" 200 -
[2025-05-11 11:48:47,018.018] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:48:47] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/hit HTTP/1.1" 200 -
[2025-05-11 11:48:47,332.332] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:48:47,333.333] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:48:47,333.333] base.py -> _exec_single_context line:1901 [INFO]: [cached since 655.1s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:47,334.334] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-11 11:48:47,334.334] base.py -> _exec_single_context line:1901 [INFO]: [cached since 26.74s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'id_1_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:47,828.828] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO dataset_query (dataset_id, query, source, source_app_id, created_by) VALUES (%(dataset_id)s::UUID, %(query)s, %(source)s, %(source_app_id)s::UUID, %(created_by)s::UUID) RETURNING dataset_query.id, dataset_query.updated_at, dataset_query.created_at
[2025-05-11 11:48:47,828.828] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00040s] {'dataset_id': 'e9af1e9e-fc18-4521-b222-79303a3a949f', 'query': 'hao', 'source': <RetrievalSource.HIT_TESTING: 'hit_testing'>, 'source_app_id': None, 'created_by': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-11 11:48:47,830.830] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:48:47,831.831] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:48:47,831.831] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (%(id_1_1)s::UUID, %(id_1_2)s::UUID, %(id_1_3)s::UUID, %(id_1_4)s::UUID, %(id_1_5)s::UUID)
[2025-05-11 11:48:47,831.831] base.py -> _exec_single_context line:1901 [INFO]: [cached since 27.16s ago] {'hit_count_1': 1, 'id_1_1': UUID('6fa55b0e-3ebf-4eb8-861a-a778c921e1a4'), 'id_1_2': UUID('1ee87c29-76f0-4991-8115-83b8d555dcd3'), 'id_1_3': UUID('f62b8dc5-5ec2-4e1b-9b7a-e1d7bf0bcd65'), 'id_1_4': UUID('0be1239c-e04c-4fb4-852b-5132a4cab303'), 'id_1_5': UUID('0bab51e4-84f9-4ca7-8d96-0f319cae6e86')}
[2025-05-11 11:48:47,834.834] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:48:47,835.835] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:48:47,835.835] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID, %(id_1_2)s::UUID, %(id_1_3)s::UUID, %(id_1_4)s::UUID, %(id_1_5)s::UUID)
[2025-05-11 11:48:47,835.835] base.py -> _exec_single_context line:1901 [INFO]: [cached since 27.16s ago] {'id_1_1': '6fa55b0e-3ebf-4eb8-861a-a778c921e1a4', 'id_1_2': '1ee87c29-76f0-4991-8115-83b8d555dcd3', 'id_1_3': 'f62b8dc5-5ec2-4e1b-9b7a-e1d7bf0bcd65', 'id_1_4': '0be1239c-e04c-4fb4-852b-5132a4cab303', 'id_1_5': '0bab51e4-84f9-4ca7-8d96-0f319cae6e86'}
[2025-05-11 11:48:47,836.836] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:48:47,841.841] base.py -> _exec_single_context line:1901 [INFO]: [cached since 628.4s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:48:47,841.841] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-11 11:48:47,842.842] base.py -> _exec_single_context line:1901 [INFO]: [cached since 240.2s ago] {'id_1': UUID('b9bd487e-aaec-4362-8d42-ad24101a6cc9')}
[2025-05-11 11:48:47,843.843] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-11 11:48:47,843.843] base.py -> _exec_single_context line:1901 [INFO]: [cached since 240.2s ago] {'id_1': UUID('b9bd487e-aaec-4362-8d42-ad24101a6cc9')}
[2025-05-11 11:48:47,844.844] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-11 11:48:47,844.844] base.py -> _exec_single_context line:1901 [INFO]: [cached since 240.2s ago] {'id_1': UUID('b9bd487e-aaec-4362-8d42-ad24101a6cc9')}
[2025-05-11 11:48:47,844.844] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:48:47,845.845] base.py -> _exec_single_context line:1901 [INFO]: [cached since 628.4s ago] {'pk_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 11:48:47,845.845] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-11 11:48:47,856.856] base.py -> _exec_single_context line:1901 [INFO]: [cached since 240.3s ago] {'id_1': UUID('d34b03c1-e980-42fb-bf97-8bbbac4662d9')}
[2025-05-11 11:48:47,858.858] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:48:47,858.858] base.py -> _exec_single_context line:1901 [INFO]: [cached since 628.4s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:48:47,859.859] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-11 11:48:47,859.859] base.py -> _exec_single_context line:1901 [INFO]: [cached since 240.3s ago] {'id_1': UUID('b9bd487e-aaec-4362-8d42-ad24101a6cc9')}
[2025-05-11 11:48:47,861.861] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:48:47,862.862] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:48:47] "POST /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/hit HTTP/1.1" 200 -
[2025-05-11 11:48:48,183.183] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:48:48] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/queries HTTP/1.1" 200 -
[2025-05-11 11:48:48,186.186] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:48:48,188.188] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:48:48,188.188] base.py -> _exec_single_context line:1901 [INFO]: [cached since 656s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:48,189.189] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset_query.id AS dataset_query_id, dataset_query.dataset_id AS dataset_query_dataset_id, dataset_query.query AS dataset_query_query, dataset_query.source AS dataset_query_source, dataset_query.source_app_id AS dataset_query_source_app_id, dataset_query.created_by AS dataset_query_created_by, dataset_query.updated_at AS dataset_query_updated_at, dataset_query.created_at AS dataset_query_created_at 
FROM dataset_query 
WHERE dataset_query.dataset_id = %(dataset_id_1)s::UUID ORDER BY dataset_query.created_at DESC 
 LIMIT %(param_1)s
[2025-05-11 11:48:48,189.189] base.py -> _exec_single_context line:1901 [INFO]: [cached since 44.77s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'param_1': 10}
[2025-05-11 11:48:48,190.190] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:48:48,192.192] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:48:48] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/queries HTTP/1.1" 200 -
[2025-05-11 11:48:53,343.343] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:48:53] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/hit HTTP/1.1" 200 -
[2025-05-11 11:48:53,659.659] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:48:53,659.659] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:48:53,660.660] base.py -> _exec_single_context line:1901 [INFO]: [cached since 661.4s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:53,662.662] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-11 11:48:53,662.662] base.py -> _exec_single_context line:1901 [INFO]: [cached since 33.07s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'id_1_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:53,696.696] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.keyword_table AS keyword_table_keyword_table 
FROM keyword_table 
WHERE keyword_table.dataset_id IN (%(dataset_id_1_1)s::UUID)
[2025-05-11 11:48:53,696.696] base.py -> _exec_single_context line:1901 [INFO]: [cached since 33.03s ago] {'dataset_id_1_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:53,698.698] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (NULL) AND (1 != 1)
[2025-05-11 11:48:53,699.699] base.py -> _exec_single_context line:1901 [INFO]: [cached since 33.03s ago] {}
[2025-05-11 11:48:53,700.700] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO dataset_query (dataset_id, query, source, source_app_id, created_by) VALUES (%(dataset_id)s::UUID, %(query)s, %(source)s, %(source_app_id)s::UUID, %(created_by)s::UUID) RETURNING dataset_query.id, dataset_query.updated_at, dataset_query.created_at
[2025-05-11 11:48:53,700.700] base.py -> _exec_single_context line:1901 [INFO]: [cached since 5.873s ago] {'dataset_id': 'e9af1e9e-fc18-4521-b222-79303a3a949f', 'query': 'hao', 'source': <RetrievalSource.HIT_TESTING: 'hit_testing'>, 'source_app_id': None, 'created_by': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-11 11:48:53,702.702] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:48:53,703.703] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:48:53,703.703] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (%(id_1_1)s::UUID, %(id_1_2)s::UUID, %(id_1_3)s::UUID, %(id_1_4)s::UUID, %(id_1_5)s::UUID)
[2025-05-11 11:48:53,704.704] base.py -> _exec_single_context line:1901 [INFO]: [cached since 33.03s ago] {'hit_count_1': 1, 'id_1_1': UUID('6fa55b0e-3ebf-4eb8-861a-a778c921e1a4'), 'id_1_2': UUID('1ee87c29-76f0-4991-8115-83b8d555dcd3'), 'id_1_3': UUID('f62b8dc5-5ec2-4e1b-9b7a-e1d7bf0bcd65'), 'id_1_4': UUID('0be1239c-e04c-4fb4-852b-5132a4cab303'), 'id_1_5': UUID('0bab51e4-84f9-4ca7-8d96-0f319cae6e86')}
[2025-05-11 11:48:53,704.704] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:48:53,705.705] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:48:53,706.706] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID, %(id_1_2)s::UUID, %(id_1_3)s::UUID, %(id_1_4)s::UUID, %(id_1_5)s::UUID)
[2025-05-11 11:48:53,706.706] base.py -> _exec_single_context line:1901 [INFO]: [cached since 33.03s ago] {'id_1_1': '6fa55b0e-3ebf-4eb8-861a-a778c921e1a4', 'id_1_2': '1ee87c29-76f0-4991-8115-83b8d555dcd3', 'id_1_3': 'f62b8dc5-5ec2-4e1b-9b7a-e1d7bf0bcd65', 'id_1_4': '0be1239c-e04c-4fb4-852b-5132a4cab303', 'id_1_5': '0bab51e4-84f9-4ca7-8d96-0f319cae6e86'}
[2025-05-11 11:48:53,707.707] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:48:53,707.707] base.py -> _exec_single_context line:1901 [INFO]: [cached since 634.3s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:48:53,708.708] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-11 11:48:53,708.708] base.py -> _exec_single_context line:1901 [INFO]: [cached since 246.1s ago] {'id_1': UUID('b9bd487e-aaec-4362-8d42-ad24101a6cc9')}
[2025-05-11 11:48:53,709.709] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-11 11:48:53,720.720] base.py -> _exec_single_context line:1901 [INFO]: [cached since 246.1s ago] {'id_1': UUID('b9bd487e-aaec-4362-8d42-ad24101a6cc9')}
[2025-05-11 11:48:53,722.722] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-11 11:48:53,722.722] base.py -> _exec_single_context line:1901 [INFO]: [cached since 246.1s ago] {'id_1': UUID('b9bd487e-aaec-4362-8d42-ad24101a6cc9')}
[2025-05-11 11:48:53,723.723] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:48:53,723.723] base.py -> _exec_single_context line:1901 [INFO]: [cached since 634.3s ago] {'pk_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 11:48:53,724.724] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-11 11:48:53,724.724] base.py -> _exec_single_context line:1901 [INFO]: [cached since 246.1s ago] {'id_1': UUID('d34b03c1-e980-42fb-bf97-8bbbac4662d9')}
[2025-05-11 11:48:53,725.725] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:48:53,736.736] base.py -> _exec_single_context line:1901 [INFO]: [cached since 634.3s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:48:53,737.737] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-11 11:48:53,737.737] base.py -> _exec_single_context line:1901 [INFO]: [cached since 246.1s ago] {'id_1': UUID('b9bd487e-aaec-4362-8d42-ad24101a6cc9')}
[2025-05-11 11:48:53,739.739] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:48:53,739.739] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:48:53] "POST /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/hit HTTP/1.1" 200 -
[2025-05-11 11:48:54,049.049] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:48:54] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/queries HTTP/1.1" 200 -
[2025-05-11 11:48:54,052.052] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:48:54,053.053] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:48:54,053.053] base.py -> _exec_single_context line:1901 [INFO]: [cached since 661.8s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:48:54,054.054] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset_query.id AS dataset_query_id, dataset_query.dataset_id AS dataset_query_dataset_id, dataset_query.query AS dataset_query_query, dataset_query.source AS dataset_query_source, dataset_query.source_app_id AS dataset_query_source_app_id, dataset_query.created_by AS dataset_query_created_by, dataset_query.updated_at AS dataset_query_updated_at, dataset_query.created_at AS dataset_query_created_at 
FROM dataset_query 
WHERE dataset_query.dataset_id = %(dataset_id_1)s::UUID ORDER BY dataset_query.created_at DESC 
 LIMIT %(param_1)s
[2025-05-11 11:48:54,054.054] base.py -> _exec_single_context line:1901 [INFO]: [cached since 50.64s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'param_1': 10}
[2025-05-11 11:48:54,055.055] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:48:54,055.055] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:48:54] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/queries HTTP/1.1" 200 -
[2025-05-11 11:49:11,348.348] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:49:11] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/hit HTTP/1.1" 200 -
[2025-05-11 11:49:11,668.668] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:49:11,669.669] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:49:11,669.669] base.py -> _exec_single_context line:1901 [INFO]: [cached since 679.5s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:49:11,670.670] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-11 11:49:11,671.671] base.py -> _exec_single_context line:1901 [INFO]: [cached since 51.08s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'id_1_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:49:11,672.672] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.keyword_table AS keyword_table_keyword_table 
FROM keyword_table 
WHERE keyword_table.dataset_id IN (%(dataset_id_1_1)s::UUID)
[2025-05-11 11:49:11,672.672] base.py -> _exec_single_context line:1901 [INFO]: [cached since 51s ago] {'dataset_id_1_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:49:11,673.673] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2025-05-11 11:49:11,673.673] base.py -> _exec_single_context line:1901 [INFO]: [cached since 51s ago] {'id_1_1': '6fa55b0e-3ebf-4eb8-861a-a778c921e1a4'}
[2025-05-11 11:49:11,674.674] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO dataset_query (dataset_id, query, source, source_app_id, created_by) VALUES (%(dataset_id)s::UUID, %(query)s, %(source)s, %(source_app_id)s::UUID, %(created_by)s::UUID) RETURNING dataset_query.id, dataset_query.updated_at, dataset_query.created_at
[2025-05-11 11:49:11,674.674] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.85s ago] {'dataset_id': 'e9af1e9e-fc18-4521-b222-79303a3a949f', 'query': '好儿haoer', 'source': <RetrievalSource.HIT_TESTING: 'hit_testing'>, 'source_app_id': None, 'created_by': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-11 11:49:11,676.676] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:49:11,677.677] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:49:11,677.677] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (%(id_1_1)s::UUID)
[2025-05-11 11:49:11,677.677] base.py -> _exec_single_context line:1901 [INFO]: [cached since 51s ago] {'hit_count_1': 1, 'id_1_1': '6fa55b0e-3ebf-4eb8-861a-a778c921e1a4'}
[2025-05-11 11:49:11,678.678] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:49:11,681.681] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:49:11,682.682] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2025-05-11 11:49:11,682.682] base.py -> _exec_single_context line:1901 [INFO]: [cached since 51.01s ago] {'id_1_1': '6fa55b0e-3ebf-4eb8-861a-a778c921e1a4'}
[2025-05-11 11:49:11,683.683] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:49:11,683.683] base.py -> _exec_single_context line:1901 [INFO]: [cached since 652.2s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:49:11,685.685] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-11 11:49:11,685.685] base.py -> _exec_single_context line:1901 [INFO]: [cached since 264.1s ago] {'id_1': UUID('b9bd487e-aaec-4362-8d42-ad24101a6cc9')}
[2025-05-11 11:49:11,686.686] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:49:11,686.686] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:49:11] "POST /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/hit HTTP/1.1" 200 -
[2025-05-11 11:49:11,995.995] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:49:11] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/queries HTTP/1.1" 200 -
[2025-05-11 11:49:11,998.998] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:49:11,998.998] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:49:11,998.998] base.py -> _exec_single_context line:1901 [INFO]: [cached since 679.8s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:49:12,000.000] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset_query.id AS dataset_query_id, dataset_query.dataset_id AS dataset_query_dataset_id, dataset_query.query AS dataset_query_query, dataset_query.source AS dataset_query_source, dataset_query.source_app_id AS dataset_query_source_app_id, dataset_query.created_by AS dataset_query_created_by, dataset_query.updated_at AS dataset_query_updated_at, dataset_query.created_at AS dataset_query_created_at 
FROM dataset_query 
WHERE dataset_query.dataset_id = %(dataset_id_1)s::UUID ORDER BY dataset_query.created_at DESC 
 LIMIT %(param_1)s
[2025-05-11 11:49:12,001.001] base.py -> _exec_single_context line:1901 [INFO]: [cached since 68.58s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'param_1': 10}
[2025-05-11 11:49:12,011.011] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:49:12,011.011] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:49:12] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/queries HTTP/1.1" 200 -
[2025-05-11 11:49:22,233.233] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:49:22] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159 HTTP/1.1" 200 -
[2025-05-11 11:49:22,552.552] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:49:22] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:49:22,553.553] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:49:22,553.553] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:49:22,554.554] base.py -> _exec_single_context line:1901 [INFO]: [cached since 663.1s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:49:22,556.556] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:49:22,557.557] base.py -> _exec_single_context line:1901 [INFO]: [cached since 663.1s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:49:22,558.558] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count)) AS coalesce_1, 0 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:49:22,558.558] base.py -> _exec_single_context line:1901 [INFO]: [cached since 690s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:49:22,559.559] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:49:22,559.559] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:49:22] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159 HTTP/1.1" 200 -
[2025-05-11 11:49:22,816.816] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:49:22,817.817] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:49:22,817.817] base.py -> _exec_single_context line:1901 [INFO]: [cached since 663.4s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:49:22,819.819] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:49:22,819.819] base.py -> _exec_single_context line:1901 [INFO]: [cached since 313s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159'), 'param_1': 20, 'param_2': 0}
[2025-05-11 11:49:22,819.819] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2025-05-11 11:49:22,830.830] base.py -> _exec_single_context line:1901 [INFO]: [cached since 313s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:49:22,833.833] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:49:22,834.834] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:49:22] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:49:25,203.203] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:49:25] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments/6fa55b0e-3ebf-4eb8-861a-a778c921e1a4/enabled HTTP/1.1" 200 -
[2025-05-11 11:49:25,205.205] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:49:25,206.206] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-11 11:49:25,206.206] base.py -> _exec_single_context line:1901 [INFO]: [cached since 174.5s ago] {'pk_1': UUID('6fa55b0e-3ebf-4eb8-861a-a778c921e1a4')}
[2025-05-11 11:49:25,209.209] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET enabled=%(enabled)s, disabled_at=%(disabled_at)s WHERE segment.id = %(segment_id)s::UUID
[2025-05-11 11:49:25,209.209] base.py -> _exec_single_context line:1901 [INFO]: [cached since 174.5s ago] {'enabled': False, 'disabled_at': datetime.datetime(2025, 5, 11, 11, 49, 25, 209834), 'segment_id': UUID('6fa55b0e-3ebf-4eb8-861a-a778c921e1a4')}
[2025-05-11 11:49:25,210.210] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:49:25,213.213] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:49:25,213.213] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-11 11:49:25,213.213] base.py -> _exec_single_context line:1901 [INFO]: [cached since 174.5s ago] {'pk_1': UUID('6fa55b0e-3ebf-4eb8-861a-a778c921e1a4')}
[2025-05-11 11:49:25,214.214] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:49:25,217.217] base.py -> _exec_single_context line:1901 [INFO]: [cached since 665.8s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:49:25,219.219] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:49:25,219.219] base.py -> _exec_single_context line:1901 [INFO]: [cached since 174.5s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:49:25,220.220] base.py -> _exec_single_context line:1896 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s::JSONB WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2025-05-11 11:49:25,220.220] base.py -> _exec_single_context line:1901 [INFO]: [cached since 174.5s ago] {'keyword_table': '{"AI": ["0bab51e4-84f9-4ca7-8d96-0f319cae6e86"], "PP": ["5c616378-9616-4b8c-980b-42cb3e5fe6f2"], "x1": ["5c616378-9616-4b8c-980b-42cb3e5fe6f2"], "x2" ... (4006 characters truncated) ... 78-9616-4b8c-980b-42cb3e5fe6f2"], "transformers": ["0be1239c-e04c-4fb4-852b-5132a4cab303"], "unstructured": ["7258af3b-fdc0-473e-89a7-8b9110865109"]}', 'keyword_table_id': UUID('ba32e876-737b-4f74-998a-9806e8ae96e3')}
[2025-05-11 11:49:25,221.221] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:49:25,223.223] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:49:25,223.223] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-11 11:49:25,223.223] base.py -> _exec_single_context line:1901 [INFO]: [cached since 174.5s ago] {'pk_1': UUID('6fa55b0e-3ebf-4eb8-861a-a778c921e1a4')}
[2025-05-11 11:49:25,488.488] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:49:25,488.488] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:49:25] "POST /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments/6fa55b0e-3ebf-4eb8-861a-a778c921e1a4/enabled HTTP/1.1" 200 -
[2025-05-11 11:49:26,964.964] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:49:26] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f HTTP/1.1" 200 -
[2025-05-11 11:49:27,275.275] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:49:27] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:49:27,276.276] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:49:27,276.276] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:49:27,276.276] base.py -> _exec_single_context line:1901 [INFO]: [cached since 695.1s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:49:27,278.278] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:49:27,279.279] base.py -> _exec_single_context line:1901 [INFO]: [cached since 714.6s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:49:27,280.280] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:49:27,280.280] base.py -> _exec_single_context line:1901 [INFO]: [cached since 695.1s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:49:27,281.281] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:49:27,282.282] base.py -> _exec_single_context line:1901 [INFO]: [cached since 714.6s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:49:27,283.283] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:49:27,283.283] base.py -> _exec_single_context line:1901 [INFO]: [cached since 714.6s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:49:27,283.283] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:49:27,284.284] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:49:27] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f HTTP/1.1" 200 -
[2025-05-11 11:49:27,543.543] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:49:27,543.543] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:49:27,543.543] base.py -> _exec_single_context line:1901 [INFO]: [cached since 695.3s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:49:27,544.544] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:49:27,544.544] base.py -> _exec_single_context line:1901 [INFO]: [cached since 695s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'param_1': 20, 'param_2': 0}
[2025-05-11 11:49:27,546.546] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2025-05-11 11:49:27,546.546] base.py -> _exec_single_context line:1901 [INFO]: [cached since 695s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:49:27,547.547] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count)) AS coalesce_1, 0 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:49:27,555.555] base.py -> _exec_single_context line:1901 [INFO]: [cached since 695s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:49:27,556.556] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count)) AS coalesce_1, 0 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:49:27,556.556] base.py -> _exec_single_context line:1901 [INFO]: [cached since 695s ago] {'document_id_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 11:49:27,558.558] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:49:27,558.558] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:49:27] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:49:29,275.275] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:49:29] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/queries HTTP/1.1" 200 -
[2025-05-11 11:49:29,280.280] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:49:29,281.281] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:49:29,281.281] base.py -> _exec_single_context line:1901 [INFO]: [cached since 697.1s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:49:29,282.282] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset_query.id AS dataset_query_id, dataset_query.dataset_id AS dataset_query_dataset_id, dataset_query.query AS dataset_query_query, dataset_query.source AS dataset_query_source, dataset_query.source_app_id AS dataset_query_source_app_id, dataset_query.created_by AS dataset_query_created_by, dataset_query.updated_at AS dataset_query_updated_at, dataset_query.created_at AS dataset_query_created_at 
FROM dataset_query 
WHERE dataset_query.dataset_id = %(dataset_id_1)s::UUID ORDER BY dataset_query.created_at DESC 
 LIMIT %(param_1)s
[2025-05-11 11:49:29,283.283] base.py -> _exec_single_context line:1901 [INFO]: [cached since 85.87s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'param_1': 10}
[2025-05-11 11:49:29,284.284] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:49:29,284.284] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:49:29] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/queries HTTP/1.1" 200 -
[2025-05-11 11:49:35,997.997] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:49:35] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/hit HTTP/1.1" 200 -
[2025-05-11 11:49:36,313.313] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:49:36,313.313] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:49:36,313.313] base.py -> _exec_single_context line:1901 [INFO]: [cached since 704.1s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:49:36,314.314] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-11 11:49:36,316.316] base.py -> _exec_single_context line:1901 [INFO]: [cached since 75.72s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'id_1_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:49:36,358.358] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO dataset_query (dataset_id, query, source, source_app_id, created_by) VALUES (%(dataset_id)s::UUID, %(query)s, %(source)s, %(source_app_id)s::UUID, %(created_by)s::UUID) RETURNING dataset_query.id, dataset_query.updated_at, dataset_query.created_at
[2025-05-11 11:49:36,359.359] base.py -> _exec_single_context line:1901 [INFO]: [cached since 48.53s ago] {'dataset_id': 'e9af1e9e-fc18-4521-b222-79303a3a949f', 'query': '好儿haoer', 'source': <RetrievalSource.HIT_TESTING: 'hit_testing'>, 'source_app_id': None, 'created_by': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-11 11:49:36,360.360] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:49:36,361.361] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:49:36,362.362] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (%(id_1_1)s::UUID, %(id_1_2)s::UUID, %(id_1_3)s::UUID, %(id_1_4)s::UUID, %(id_1_5)s::UUID)
[2025-05-11 11:49:36,362.362] base.py -> _exec_single_context line:1901 [INFO]: [cached since 75.69s ago] {'hit_count_1': 1, 'id_1_1': UUID('f62b8dc5-5ec2-4e1b-9b7a-e1d7bf0bcd65'), 'id_1_2': UUID('1ee87c29-76f0-4991-8115-83b8d555dcd3'), 'id_1_3': UUID('0bab51e4-84f9-4ca7-8d96-0f319cae6e86'), 'id_1_4': UUID('0be1239c-e04c-4fb4-852b-5132a4cab303'), 'id_1_5': UUID('7258af3b-fdc0-473e-89a7-8b9110865109')}
[2025-05-11 11:49:36,364.364] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:49:36,365.365] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:49:36,365.365] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID, %(id_1_2)s::UUID, %(id_1_3)s::UUID, %(id_1_4)s::UUID, %(id_1_5)s::UUID)
[2025-05-11 11:49:36,365.365] base.py -> _exec_single_context line:1901 [INFO]: [cached since 75.69s ago] {'id_1_1': 'f62b8dc5-5ec2-4e1b-9b7a-e1d7bf0bcd65', 'id_1_2': '1ee87c29-76f0-4991-8115-83b8d555dcd3', 'id_1_3': '0bab51e4-84f9-4ca7-8d96-0f319cae6e86', 'id_1_4': '0be1239c-e04c-4fb4-852b-5132a4cab303', 'id_1_5': '7258af3b-fdc0-473e-89a7-8b9110865109'}
[2025-05-11 11:49:36,366.366] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:49:36,372.372] base.py -> _exec_single_context line:1901 [INFO]: [cached since 676.9s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:49:36,373.373] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-11 11:49:36,373.373] base.py -> _exec_single_context line:1901 [INFO]: [cached since 288.8s ago] {'id_1': UUID('b9bd487e-aaec-4362-8d42-ad24101a6cc9')}
[2025-05-11 11:49:36,374.374] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-11 11:49:36,374.374] base.py -> _exec_single_context line:1901 [INFO]: [cached since 288.8s ago] {'id_1': UUID('b9bd487e-aaec-4362-8d42-ad24101a6cc9')}
[2025-05-11 11:49:36,375.375] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-11 11:49:36,375.375] base.py -> _exec_single_context line:1901 [INFO]: [cached since 288.8s ago] {'id_1': UUID('b9bd487e-aaec-4362-8d42-ad24101a6cc9')}
[2025-05-11 11:49:36,376.376] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:49:36,376.376] base.py -> _exec_single_context line:1901 [INFO]: [cached since 676.9s ago] {'pk_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 11:49:36,378.378] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-11 11:49:36,388.388] base.py -> _exec_single_context line:1901 [INFO]: [cached since 288.8s ago] {'id_1': UUID('d34b03c1-e980-42fb-bf97-8bbbac4662d9')}
[2025-05-11 11:49:36,389.389] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:49:36,389.389] base.py -> _exec_single_context line:1901 [INFO]: [cached since 676.9s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:49:36,390.390] base.py -> _exec_single_context line:1896 [INFO]: SELECT upload_file.id AS upload_file_id, upload_file.account_id AS upload_file_account_id, upload_file.name AS upload_file_name, upload_file.key AS upload_file_key, upload_file.size AS upload_file_size, upload_file.extension AS upload_file_extension, upload_file.mime_type AS upload_file_mime_type, upload_file.hash AS upload_file_hash, upload_file.updated_at AS upload_file_updated_at, upload_file.created_at AS upload_file_created_at 
FROM upload_file 
WHERE upload_file.id = %(id_1)s::UUID
[2025-05-11 11:49:36,391.391] base.py -> _exec_single_context line:1901 [INFO]: [cached since 288.8s ago] {'id_1': UUID('b9bd487e-aaec-4362-8d42-ad24101a6cc9')}
[2025-05-11 11:49:36,392.392] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:49:36,393.393] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:49:36] "POST /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/hit HTTP/1.1" 200 -
[2025-05-11 11:49:36,702.702] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:49:36] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/queries HTTP/1.1" 200 -
[2025-05-11 11:49:36,706.706] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:49:36,707.707] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:49:36,707.707] base.py -> _exec_single_context line:1901 [INFO]: [cached since 704.5s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:49:36,708.708] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset_query.id AS dataset_query_id, dataset_query.dataset_id AS dataset_query_dataset_id, dataset_query.query AS dataset_query_query, dataset_query.source AS dataset_query_source, dataset_query.source_app_id AS dataset_query_source_app_id, dataset_query.created_by AS dataset_query_created_by, dataset_query.updated_at AS dataset_query_updated_at, dataset_query.created_at AS dataset_query_created_at 
FROM dataset_query 
WHERE dataset_query.dataset_id = %(dataset_id_1)s::UUID ORDER BY dataset_query.created_at DESC 
 LIMIT %(param_1)s
[2025-05-11 11:49:36,708.708] base.py -> _exec_single_context line:1901 [INFO]: [cached since 93.29s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'param_1': 10}
[2025-05-11 11:49:36,709.709] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:49:36,709.709] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:49:36] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/queries HTTP/1.1" 200 -
[2025-05-11 11:50:17,374.374] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:50:17] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159 HTTP/1.1" 200 -
[2025-05-11 11:50:17,688.688] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:50:17] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:50:17,689.689] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:50:17,690.690] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:50:17,691.691] base.py -> _exec_single_context line:1901 [INFO]: [cached since 718.3s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:50:17,692.692] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:50:17,693.693] base.py -> _exec_single_context line:1901 [INFO]: [cached since 718.3s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:50:17,694.694] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count)) AS coalesce_1, 0 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:50:17,694.694] base.py -> _exec_single_context line:1901 [INFO]: [cached since 745.2s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:50:17,695.695] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:50:17,695.695] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:50:17] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159 HTTP/1.1" 200 -
[2025-05-11 11:50:17,955.955] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:50:17,955.955] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:50:17,956.956] base.py -> _exec_single_context line:1901 [INFO]: [cached since 718.5s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:50:17,957.957] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:50:17,957.957] base.py -> _exec_single_context line:1901 [INFO]: [cached since 368.1s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159'), 'param_1': 20, 'param_2': 0}
[2025-05-11 11:50:17,958.958] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2025-05-11 11:50:17,968.968] base.py -> _exec_single_context line:1901 [INFO]: [cached since 368.1s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:50:17,970.970] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:50:17,971.971] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:50:17] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:50:20,958.958] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:50:20] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments/6fa55b0e-3ebf-4eb8-861a-a778c921e1a4/delete HTTP/1.1" 200 -
[2025-05-11 11:50:20,969.969] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:50:20,971.971] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-11 11:50:20,971.971] base.py -> _exec_single_context line:1901 [INFO]: [cached since 230.2s ago] {'pk_1': UUID('6fa55b0e-3ebf-4eb8-861a-a778c921e1a4')}
[2025-05-11 11:50:20,972.972] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:50:20,972.972] base.py -> _exec_single_context line:1901 [INFO]: [cached since 721.5s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:50:20,973.973] base.py -> _exec_single_context line:1896 [INFO]: DELETE FROM segment WHERE segment.id = %(id)s::UUID
[2025-05-11 11:50:20,974.974] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00028s] {'id': UUID('6fa55b0e-3ebf-4eb8-861a-a778c921e1a4')}
[2025-05-11 11:50:20,974.974] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:50:20,976.976] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:50:20,976.976] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:50:20,976.976] base.py -> _exec_single_context line:1901 [INFO]: [cached since 230.2s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:50:20,977.977] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:50:21,243.243] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:50:21,244.244] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.character_count), %(coalesce_2)s) AS coalesce_1, coalesce(sum(segment.token_count), %(coalesce_4)s) AS coalesce_3 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID 
 LIMIT %(param_1)s
[2025-05-11 11:50:21,244.244] base.py -> _exec_single_context line:1901 [INFO]: [cached since 196s ago] {'coalesce_2': 0, 'coalesce_4': 0, 'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159'), 'param_1': 1}
[2025-05-11 11:50:21,245.245] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:50:21,246.246] base.py -> _exec_single_context line:1901 [INFO]: [cached since 334.1s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:50:21,246.246] base.py -> _exec_single_context line:1896 [INFO]: UPDATE document SET character_count=%(character_count)s, token_count=%(token_count)s WHERE document.id = %(document_id)s::UUID
[2025-05-11 11:50:21,246.246] base.py -> _exec_single_context line:1901 [INFO]: [cached since 196s ago] {'character_count': 3125, 'token_count': 2767, 'document_id': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:50:21,247.247] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:50:21,248.248] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:50:21] "POST /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments/6fa55b0e-3ebf-4eb8-861a-a778c921e1a4/delete HTTP/1.1" 200 -
[2025-05-11 11:50:21,566.566] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:50:21,567.567] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:50:21,567.567] base.py -> _exec_single_context line:1901 [INFO]: [cached since 722.1s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:50:21,568.568] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:50:21,568.568] base.py -> _exec_single_context line:1901 [INFO]: [cached since 371.7s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159'), 'param_1': 20, 'param_2': 0}
[2025-05-11 11:50:21,569.569] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2025-05-11 11:50:21,577.577] base.py -> _exec_single_context line:1901 [INFO]: [cached since 371.8s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:50:21,579.579] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:50:21,579.579] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:50:21] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:51:10,918.918] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:51:10] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments HTTP/1.1" 200 -
[2025-05-11 11:51:11,235.235] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:51:11,235.235] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:51:11,235.235] base.py -> _exec_single_context line:1901 [INFO]: [cached since 771.8s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:51:11,236.236] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(max(segment.position), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:51:11,236.236] base.py -> _exec_single_context line:1901 [INFO]: [cached since 247.1s ago] {'coalesce_2': 0, 'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:51:11,240.240] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO segment (account_id, dataset_id, document_id, node_id, position, content, character_count, token_count, keywords, hash, enabled, disabled_at, processing_started_at, indexing_completed_at, completed_at, stopped_at, status) VALUES (%(account_id)s::UUID, %(dataset_id)s::UUID, %(document_id)s::UUID, %(node_id)s::UUID, %(position)s, %(content)s, %(character_count)s, %(token_count)s, %(keywords)s::JSONB, %(hash)s, %(enabled)s, %(disabled_at)s, %(processing_started_at)s, %(indexing_completed_at)s, %(completed_at)s, %(stopped_at)s, %(status)s) RETURNING segment.id, segment.hit_count, segment.error, segment.updated_at, segment.created_at
[2025-05-11 11:51:11,240.240] base.py -> _exec_single_context line:1901 [INFO]: [cached since 246.7s ago] {'account_id': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'document_id': UUID('5cd65806-5587-43fa-b3a5-66458c355159'), 'node_id': UUID('81862a2a-cd92-41cc-8c87-1c75a32156d1'), 'position': 8, 'content': '好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好好er', 'character_count': 164, 'token_count': 163, 'keywords': '["\\u597d\\u597d", "er"]', 'hash': 'f4a18665f1fd4b9be66c2c39739294973227be68c5e46386301bb59da709295f', 'enabled': True, 'disabled_at': None, 'processing_started_at': datetime.datetime(2025, 5, 11, 11, 51, 11, 239537), 'indexing_completed_at': datetime.datetime(2025, 5, 11, 11, 51, 11, 239537), 'completed_at': datetime.datetime(2025, 5, 11, 11, 51, 11, 239537), 'stopped_at': None, 'status': <SegmentStatus.COMPLETED: 'completed'>}
[2025-05-11 11:51:11,241.241] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:51:11,242.242] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:51:11,242.242] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:51:11,245.245] base.py -> _exec_single_context line:1901 [INFO]: [cached since 384.1s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:51:11,246.246] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-11 11:51:11,246.246] base.py -> _exec_single_context line:1901 [INFO]: [cached since 280.5s ago] {'pk_1': UUID('847feea1-cca8-49f7-b250-bee59d58f5a0')}
[2025-05-11 11:51:11,637.637] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.character_count), %(coalesce_2)s) AS coalesce_1, coalesce(sum(segment.token_count), %(coalesce_4)s) AS coalesce_3 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID 
 LIMIT %(param_1)s
[2025-05-11 11:51:11,638.638] base.py -> _exec_single_context line:1901 [INFO]: [cached since 246.4s ago] {'coalesce_2': 0, 'coalesce_4': 0, 'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159'), 'param_1': 1}
[2025-05-11 11:51:11,639.639] base.py -> _exec_single_context line:1896 [INFO]: UPDATE document SET character_count=%(character_count)s, token_count=%(token_count)s WHERE document.id = %(document_id)s::UUID
[2025-05-11 11:51:11,639.639] base.py -> _exec_single_context line:1901 [INFO]: [cached since 246.4s ago] {'character_count': 3289, 'token_count': 2930, 'document_id': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:51:11,639.639] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:51:11,640.640] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:51:11,640.640] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:51:11,641.641] base.py -> _exec_single_context line:1901 [INFO]: [cached since 384.5s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:51:11,641.641] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-11 11:51:11,641.641] base.py -> _exec_single_context line:1901 [INFO]: [cached since 280.9s ago] {'pk_1': UUID('847feea1-cca8-49f7-b250-bee59d58f5a0')}
[2025-05-11 11:51:11,642.642] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:51:11,643.643] base.py -> _exec_single_context line:1901 [INFO]: [cached since 280.9s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:51:11,653.653] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.keywords AS segment_keywords 
FROM segment 
WHERE segment.id IN (%(id_1_1)s::UUID)
[2025-05-11 11:51:11,653.653] base.py -> _exec_single_context line:1901 [INFO]: [cached since 265.8s ago] {'id_1_1': UUID('847feea1-cca8-49f7-b250-bee59d58f5a0')}
[2025-05-11 11:51:11,654.654] base.py -> _exec_single_context line:1896 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s::JSONB WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2025-05-11 11:51:11,654.654] base.py -> _exec_single_context line:1901 [INFO]: [cached since 280.9s ago] {'keyword_table': '{"AI": ["0bab51e4-84f9-4ca7-8d96-0f319cae6e86"], "PP": ["5c616378-9616-4b8c-980b-42cb3e5fe6f2"], "x1": ["5c616378-9616-4b8c-980b-42cb3e5fe6f2"], "x2" ... (4114 characters truncated) ... ["7258af3b-fdc0-473e-89a7-8b9110865109"], "\\u597d\\u597d": ["847feea1-cca8-49f7-b250-bee59d58f5a0"], "er": ["847feea1-cca8-49f7-b250-bee59d58f5a0"]}', 'keyword_table_id': UUID('ba32e876-737b-4f74-998a-9806e8ae96e3')}
[2025-05-11 11:51:11,655.655] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:51:11,657.657] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:51:11] "POST /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments HTTP/1.1" 200 -
[2025-05-11 11:51:11,662.662] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:51:11] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:51:11,665.665] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:51:11,666.666] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:51:11,666.666] base.py -> _exec_single_context line:1901 [INFO]: [cached since 772.2s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:51:11,668.668] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:51:11,668.668] base.py -> _exec_single_context line:1901 [INFO]: [cached since 421.8s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159'), 'param_1': 20, 'param_2': 0}
[2025-05-11 11:51:11,669.669] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2025-05-11 11:51:11,669.669] base.py -> _exec_single_context line:1901 [INFO]: [cached since 421.8s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:51:11,671.671] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:51:11,672.672] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:51:11] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:51:14,431.431] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:51:14] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f HTTP/1.1" 200 -
[2025-05-11 11:51:14,432.432] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:51:14] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:51:14,743.743] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:51:14,744.744] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:51:14,745.745] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:51:14,745.745] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:51:14,745.745] base.py -> _exec_single_context line:1901 [INFO]: [cached since 802.5s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:51:14,746.746] base.py -> _exec_single_context line:1901 [INFO]: [cached since 802.5s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:51:14,747.747] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:51:14,748.748] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:51:14,748.748] base.py -> _exec_single_context line:1901 [INFO]: [cached since 822.1s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:51:14,748.748] base.py -> _exec_single_context line:1901 [INFO]: [cached since 802.2s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'param_1': 20, 'param_2': 0}
[2025-05-11 11:51:14,749.749] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:51:14,750.750] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2025-05-11 11:51:14,750.750] base.py -> _exec_single_context line:1901 [INFO]: [cached since 802.5s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:51:14,756.756] base.py -> _exec_single_context line:1901 [INFO]: [cached since 802.2s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:51:14,758.758] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:51:14,759.759] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count)) AS coalesce_1, 0 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:51:14,759.759] base.py -> _exec_single_context line:1901 [INFO]: [cached since 822.1s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:51:14,759.759] base.py -> _exec_single_context line:1901 [INFO]: [cached since 802.2s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:51:14,760.760] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:51:14,760.760] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count)) AS coalesce_1, 0 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:51:14,760.760] base.py -> _exec_single_context line:1901 [INFO]: [cached since 822.1s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:51:14,760.760] base.py -> _exec_single_context line:1901 [INFO]: [cached since 802.2s ago] {'document_id_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 11:51:14,761.761] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:51:14,762.762] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:51:14,762.762] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:51:14] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f HTTP/1.1" 200 -
[2025-05-11 11:51:14,762.762] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:51:14] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:51:16,631.631] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:51:16] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159 HTTP/1.1" 200 -
[2025-05-11 11:51:16,632.632] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:51:16,632.632] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:51:16,633.633] base.py -> _exec_single_context line:1901 [INFO]: [cached since 777.2s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:51:16,634.634] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:51:16,634.634] base.py -> _exec_single_context line:1901 [INFO]: [cached since 426.8s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159'), 'param_1': 20, 'param_2': 0}
[2025-05-11 11:51:16,636.636] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2025-05-11 11:51:16,643.643] base.py -> _exec_single_context line:1901 [INFO]: [cached since 426.8s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:51:16,645.645] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:51:16,645.645] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:51:16] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:51:16,897.897] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:51:16,898.898] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:51:16,898.898] base.py -> _exec_single_context line:1901 [INFO]: [cached since 777.5s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:51:16,899.899] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(segment.id) AS count_1 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:51:16,899.899] base.py -> _exec_single_context line:1901 [INFO]: [cached since 777.5s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:51:16,900.900] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count)) AS coalesce_1, 0 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:51:16,901.901] base.py -> _exec_single_context line:1901 [INFO]: [cached since 804.4s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:51:16,901.901] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:51:16,902.902] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:51:16] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159 HTTP/1.1" 200 -
[2025-05-11 11:51:18,758.758] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:51:18] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments/847feea1-cca8-49f7-b250-bee59d58f5a0/delete HTTP/1.1" 200 -
[2025-05-11 11:51:18,760.760] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:51:18,761.761] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.id = %(pk_1)s::UUID
[2025-05-11 11:51:18,761.761] base.py -> _exec_single_context line:1901 [INFO]: [cached since 288s ago] {'pk_1': UUID('847feea1-cca8-49f7-b250-bee59d58f5a0')}
[2025-05-11 11:51:18,763.763] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:51:18,763.763] base.py -> _exec_single_context line:1901 [INFO]: [cached since 779.3s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:51:18,764.764] base.py -> _exec_single_context line:1896 [INFO]: DELETE FROM segment WHERE segment.id = %(id)s::UUID
[2025-05-11 11:51:18,764.764] base.py -> _exec_single_context line:1901 [INFO]: [cached since 57.79s ago] {'id': UUID('847feea1-cca8-49f7-b250-bee59d58f5a0')}
[2025-05-11 11:51:18,765.765] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:51:18,776.776] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:51:18,777.777] base.py -> _exec_single_context line:1896 [INFO]: SELECT keyword_table.id AS keyword_table_id, keyword_table.dataset_id AS keyword_table_dataset_id, keyword_table.keyword_table AS keyword_table_keyword_table, keyword_table.updated_at AS keyword_table_updated_at, keyword_table.created_at AS keyword_table_created_at 
FROM keyword_table 
WHERE keyword_table.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:51:18,777.777] base.py -> _exec_single_context line:1901 [INFO]: [cached since 288s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:51:18,778.778] base.py -> _exec_single_context line:1896 [INFO]: UPDATE keyword_table SET keyword_table=%(keyword_table)s::JSONB WHERE keyword_table.id = %(keyword_table_id)s::UUID
[2025-05-11 11:51:18,778.778] base.py -> _exec_single_context line:1901 [INFO]: [cached since 288s ago] {'keyword_table': '{"AI": ["0bab51e4-84f9-4ca7-8d96-0f319cae6e86"], "PP": ["5c616378-9616-4b8c-980b-42cb3e5fe6f2"], "x1": ["5c616378-9616-4b8c-980b-42cb3e5fe6f2"], "x2" ... (4006 characters truncated) ... 78-9616-4b8c-980b-42cb3e5fe6f2"], "transformers": ["0be1239c-e04c-4fb4-852b-5132a4cab303"], "unstructured": ["7258af3b-fdc0-473e-89a7-8b9110865109"]}', 'keyword_table_id': UUID('ba32e876-737b-4f74-998a-9806e8ae96e3')}
[2025-05-11 11:51:18,779.779] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:51:19,052.052] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:51:19,053.053] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.character_count), %(coalesce_2)s) AS coalesce_1, coalesce(sum(segment.token_count), %(coalesce_4)s) AS coalesce_3 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID 
 LIMIT %(param_1)s
[2025-05-11 11:51:19,053.053] base.py -> _exec_single_context line:1901 [INFO]: [cached since 253.8s ago] {'coalesce_2': 0, 'coalesce_4': 0, 'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159'), 'param_1': 1}
[2025-05-11 11:51:19,054.054] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:51:19,054.054] base.py -> _exec_single_context line:1901 [INFO]: [cached since 391.9s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:51:19,054.054] base.py -> _exec_single_context line:1896 [INFO]: UPDATE document SET character_count=%(character_count)s, token_count=%(token_count)s WHERE document.id = %(document_id)s::UUID
[2025-05-11 11:51:19,055.055] base.py -> _exec_single_context line:1901 [INFO]: [cached since 253.8s ago] {'character_count': 3125, 'token_count': 2767, 'document_id': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:51:19,055.055] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-11 11:51:19,056.056] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:51:19] "POST /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments/847feea1-cca8-49f7-b250-bee59d58f5a0/delete HTTP/1.1" 200 -
[2025-05-11 11:51:19,375.375] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:51:19] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:51:19,688.688] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:51:19,689.689] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.id = %(pk_1)s::UUID
[2025-05-11 11:51:19,689.689] base.py -> _exec_single_context line:1901 [INFO]: [cached since 780.2s ago] {'pk_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:51:19,691.691] base.py -> _exec_single_context line:1896 [INFO]: SELECT segment.id AS segment_id, segment.account_id AS segment_account_id, segment.dataset_id AS segment_dataset_id, segment.document_id AS segment_document_id, segment.node_id AS segment_node_id, segment.position AS segment_position, segment.content AS segment_content, segment.character_count AS segment_character_count, segment.token_count AS segment_token_count, segment.keywords AS segment_keywords, segment.hash AS segment_hash, segment.hit_count AS segment_hit_count, segment.enabled AS segment_enabled, segment.disabled_at AS segment_disabled_at, segment.processing_started_at AS segment_processing_started_at, segment.indexing_completed_at AS segment_indexing_completed_at, segment.completed_at AS segment_completed_at, segment.stopped_at AS segment_stopped_at, segment.error AS segment_error, segment.status AS segment_status, segment.updated_at AS segment_updated_at, segment.created_at AS segment_created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID ORDER BY segment.position ASC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:51:19,691.691] base.py -> _exec_single_context line:1901 [INFO]: [cached since 429.9s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159'), 'param_1': 20, 'param_2': 0}
[2025-05-11 11:51:19,692.692] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT segment.id AS id, segment.account_id AS account_id, segment.dataset_id AS dataset_id, segment.document_id AS document_id, segment.node_id AS node_id, segment.position AS position, segment.content AS content, segment.character_count AS character_count, segment.token_count AS token_count, segment.keywords AS keywords, segment.hash AS hash, segment.hit_count AS hit_count, segment.enabled AS enabled, segment.disabled_at AS disabled_at, segment.processing_started_at AS processing_started_at, segment.indexing_completed_at AS indexing_completed_at, segment.completed_at AS completed_at, segment.stopped_at AS stopped_at, segment.error AS error, segment.status AS status, segment.updated_at AS updated_at, segment.created_at AS created_at 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID) AS anon_1
[2025-05-11 11:51:19,702.702] base.py -> _exec_single_context line:1901 [INFO]: [cached since 429.9s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:51:19,705.705] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:51:19,705.705] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:51:19] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents/5cd65806-5587-43fa-b3a5-66458c355159/segments?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:51:20,820.820] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:51:20] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f HTTP/1.1" 200 -
[2025-05-11 11:51:20,827.827] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:51:20,827.827] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:51:20,827.827] base.py -> _exec_single_context line:1901 [INFO]: [cached since 808.6s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:51:20,829.829] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:51:20,829.829] base.py -> _exec_single_context line:1901 [INFO]: [cached since 828.2s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:51:20,830.830] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:51:20,831.831] base.py -> _exec_single_context line:1901 [INFO]: [cached since 808.6s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:51:20,832.832] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:51:20,832.832] base.py -> _exec_single_context line:1901 [INFO]: [cached since 828.2s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:51:20,833.833] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 11:51:20,833.833] base.py -> _exec_single_context line:1901 [INFO]: [cached since 828.1s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:51:20,834.834] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:51:20,835.835] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:51:20] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f HTTP/1.1" 200 -
[2025-05-11 11:51:21,138.138] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:51:21] "OPTIONS /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 11:51:21,451.451] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 11:51:21,451.451] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 11:51:21,451.451] base.py -> _exec_single_context line:1901 [INFO]: [cached since 809.2s ago] {'pk_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:51:21,453.453] base.py -> _exec_single_context line:1896 [INFO]: SELECT document.id AS document_id, document.account_id AS document_account_id, document.dataset_id AS document_dataset_id, document.upload_file_id AS document_upload_file_id, document.process_rule_id AS document_process_rule_id, document.batch AS document_batch, document.name AS document_name, document.position AS document_position, document.character_count AS document_character_count, document.token_count AS document_token_count, document.processing_started_at AS document_processing_started_at, document.parsing_completed_at AS document_parsing_completed_at, document.splitting_completed_at AS document_splitting_completed_at, document.indexing_completed_at AS document_indexing_completed_at, document.completed_at AS document_completed_at, document.stopped_at AS document_stopped_at, document.error AS document_error, document.enabled AS document_enabled, document.disabled_at AS document_disabled_at, document.status AS document_status, document.updated_at AS document_updated_at, document.created_at AS document_created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID ORDER BY document.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-05-11 11:51:21,453.453] base.py -> _exec_single_context line:1901 [INFO]: [cached since 808.9s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f'), 'param_1': 20, 'param_2': 0}
[2025-05-11 11:51:21,454.454] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT document.id AS id, document.account_id AS account_id, document.dataset_id AS dataset_id, document.upload_file_id AS upload_file_id, document.process_rule_id AS process_rule_id, document.batch AS batch, document.name AS name, document.position AS position, document.character_count AS character_count, document.token_count AS token_count, document.processing_started_at AS processing_started_at, document.parsing_completed_at AS parsing_completed_at, document.splitting_completed_at AS splitting_completed_at, document.indexing_completed_at AS indexing_completed_at, document.completed_at AS completed_at, document.stopped_at AS stopped_at, document.error AS error, document.enabled AS enabled, document.disabled_at AS disabled_at, document.status AS status, document.updated_at AS updated_at, document.created_at AS created_at 
FROM document 
WHERE document.account_id = %(account_id_1)s::UUID AND document.dataset_id = %(dataset_id_1)s::UUID) AS anon_1
[2025-05-11 11:51:21,454.454] base.py -> _exec_single_context line:1901 [INFO]: [cached since 808.9s ago] {'account_id_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f', 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-05-11 11:51:21,455.455] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count)) AS coalesce_1, 0 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:51:21,465.465] base.py -> _exec_single_context line:1901 [INFO]: [cached since 808.9s ago] {'document_id_1': UUID('5cd65806-5587-43fa-b3a5-66458c355159')}
[2025-05-11 11:51:21,466.466] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count)) AS coalesce_1, 0 
FROM segment 
WHERE segment.document_id = %(document_id_1)s::UUID
[2025-05-11 11:51:21,466.466] base.py -> _exec_single_context line:1901 [INFO]: [cached since 808.9s ago] {'document_id_1': UUID('40640321-d3d0-4fd8-a77b-e16fc92b80c5')}
[2025-05-11 11:51:21,467.467] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 11:51:21,467.467] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 11:51:21] "GET /datasets/e9af1e9e-fc18-4521-b222-79303a3a949f/documents?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-05-11 18:07:00,730.730] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-05-11 18:07:00,730.730] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-05-11 18:07:00,737.737] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-11 18:07:31,713.713] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-11 18:07:31,735.735] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-11 18:07:32,808.808] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 284, in decorated_view
    elif not current_user.is_authenticated:
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\werkzeug\local.py", line 318, in __get__
    obj = instance._get_current_object()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\werkzeug\local.py", line 526, in _get_current_object
    return get_name(local())
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 25, in <lambda>
    current_user = LocalProxy(lambda: _get_user())
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 370, in _get_user
    current_app.login_manager._load_user()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\login_manager.py", line 378, in _load_user
    user = self._load_user_from_request(request)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\login_manager.py", line 441, in _load_user_from_request
    user = self._request_callback(request)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\middleware\middleware.py", line 23, in request_loader
    raise UnauthorizedException("该接口需要授权才能访问 请登陆后重试")
internal.exception.exception.UnauthorizedException
[2025-05-11 18:07:32,823.823] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 18:07:32] "GET /datasets?search_word&current_page=1&page_size=10 HTTP/1.1" 200 -
[2025-05-11 18:09:44,090.090] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 844, in dispatch_request
    self.raise_routing_exception(req)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 453, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\werkzeug\routing\map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
[2025-05-11 18:09:44,106.106] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 18:09:44] "[35m[1mGET /datasets/ HTTP/1.1[0m" 500 -
[2025-05-11 18:10:00,724.724] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-11 18:10:00,724.724] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-11 18:10:00,726.726] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-11 18:10:00,726.726] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-11 18:10:00,727.727] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-11 18:10:00,728.728] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-11 18:10:00,728.728] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-11 18:10:00,732.732] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id = %(pk_1)s::UUID
[2025-05-11 18:10:00,732.732] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00058s] {'pk_1': UUID('69bac32a-eb58-45b9-86ff-7e1ac93a0a88')}
[2025-05-11 18:10:00,740.740] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 18:10:00,740.740] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00045s] {'dataset_id_1': UUID('69bac32a-eb58-45b9-86ff-7e1ac93a0a88')}
[2025-05-11 18:10:00,746.746] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(segment.hit_count), %(coalesce_2)s) AS coalesce_1 
FROM segment 
WHERE segment.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 18:10:00,746.746] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00041s] {'coalesce_2': 0, 'dataset_id_1': UUID('69bac32a-eb58-45b9-86ff-7e1ac93a0a88')}
[2025-05-11 18:10:00,750.750] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 18:10:00,751.751] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00031s] {'dataset_id_1': UUID('69bac32a-eb58-45b9-86ff-7e1ac93a0a88')}
[2025-05-11 18:10:00,753.753] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-05-11 18:10:00,753.753] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00033s] {'coalesce_2': 0, 'dataset_id_1': UUID('69bac32a-eb58-45b9-86ff-7e1ac93a0a88')}
[2025-05-11 18:10:00,754.754] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-11 18:10:00,754.754] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 18:10:00] "GET /datasets/69bac32a-eb58-45b9-86ff-7e1ac93a0a88 HTTP/1.1" 200 -
[2025-05-11 22:11:28,323.323] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-05-11 22:11:28,323.323] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-05-11 22:11:28,328.328] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-11 22:11:54,265.265] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-11 22:11:54,299.299] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-11 22:12:01,883.883] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [11/May/2025 22:12:01] "GET /oauth/github HTTP/1.1" 200 -
[2025-05-11 22:19:11,842.842] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\schema\\oauth_schema.py', reloading
[2025-05-11 22:19:13,265.265] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-11 22:19:39,725.725] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-11 22:19:39,745.745] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
