[2025-06-06 16:30:24,514.514] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-06-06 16:30:24,516.516] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-06-06 16:30:24,517.517] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 16:30:29,748.748] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-06-06 16:30:29,751.751] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-06-06 16:31:30,069.069] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-06-06 16:31:30,069.069] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:31:30,072.072] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-06-06 16:31:30,072.072] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:31:30,074.074] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-06-06 16:31:30,074.074] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:31:30,075.075] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:31:30,077.077] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:31:30,077.077] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00030s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:31:30,085.085] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 16:31:30,085.085] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:31:30] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 16:31:40,999.999] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:31:41,000.000] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:31:41,001.001] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.92s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:31:41,002.002] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 16:31:41,002.002] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:31:41] "POST /assistant-agent/chat?qeury=ä½ å¥½ HTTP/1.1" 200 -
[2025-06-06 16:31:55,590.590] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:31:55,590.590] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:31:55,591.591] base.py -> _exec_single_context line:1901 [INFO]: [cached since 25.51s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:31:55,592.592] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 16:31:55,592.592] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:31:55] "POST /assistant-agent/chat?qeury=ä½ å¥½ HTTP/1.1" 200 -
[2025-06-06 16:32:12,100.100] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:32:12,101.101] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:32:12,101.101] base.py -> _exec_single_context line:1901 [INFO]: [cached since 42.02s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:32:12,103.103] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 16:32:12,104.104] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:32:12] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 16:32:21,952.952] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:32:21,952.952] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:32:21,952.952] base.py -> _exec_single_context line:1901 [INFO]: [cached since 51.88s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:32:21,955.955] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO conversation (app_id, name, invoke_from, created_by) VALUES (%(app_id)s::UUID, %(name)s, %(invoke_from)s, %(created_by)s::UUID) RETURNING conversation.id, conversation.summary, conversation.is_pinned, conversation.is_deleted, conversation.updated_at, conversation.created_at
[2025-06-06 16:32:21,955.955] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00027s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'name': 'New Conversation', 'invoke_from': <InvokeFrom.ASSISTANT_AGENT: 'assistant_agent'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 16:32:21,969.969] base.py -> _exec_single_context line:1896 [INFO]: UPDATE account SET assistant_agent_conversation_id=%(assistant_agent_conversation_id)s::UUID WHERE account.id = %(account_id)s::UUID
[2025-06-06 16:32:21,970.970] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00040s] {'assistant_agent_conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'account_id': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 16:32:21,972.972] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:32:21,973.973] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:32:21,974.974] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:32:21,974.974] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00028s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:32:21,976.976] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:32:21,976.976] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00024s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 16:32:21,977.977] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 16:32:21,977.977] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00028s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 16:32:21,985.985] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:32:22,027.027] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:32:22,028.028] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:32:22,028.028] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05363s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:32:22,030.030] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 16:32:22,030.030] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00033s] {'conversation_id_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'answer_1': '', 'param_1': 3, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 16:32:22,039.039] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:32:22,040.040] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.06364s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 16:32:22,335.335] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 16:32:22,337.337] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00212s] {'pk_1': UUID('88baa483-681c-49e7-8fe9-d095c5217ab0')}
[2025-06-06 16:32:22,338.338] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:32:22] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 16:32:31,703.703] function_call_agent.py -> _llm_node line:192 [ERROR]: LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\core\agent\agents\function_call_agent.py", line 159, in _llm_node
    for chunk in llm.stream(state["messages"]):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 499, in stream
    for chunk in self._stream(input_messages, stop=stop, **kwargs):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 849, in _stream
    generation_chunk = self._convert_chunk_to_generation_chunk(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 707, in _convert_chunk_to_generation_chunk
    _create_usage_metadata(token_usage) if token_usage else None
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 2808, in _create_usage_metadata
    total_tokens = oai_token_usage.get("total_tokens", input_tokens + output_tokens)
TypeError: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
[2025-06-06 16:32:31,718.718] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 16:32:31,823.823] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:32:31,824.824] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:32:31,825.825] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00030s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:32:31,827.827] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 16:32:31,828.828] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00031s] {'pk_1': UUID('88baa483-681c-49e7-8fe9-d095c5217ab0')}
[2025-06-06 16:32:31,832.832] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-06-06 16:32:31,832.832] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00040s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'message_id': UUID('88baa483-681c-49e7-8fe9-d095c5217ab0'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-06-06 16:32:31,840.840] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:32:31,841.841] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:32:31,842.842] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 16:32:31,842.842] base.py -> _exec_single_context line:1901 [INFO]: [cached since 9.508s ago] {'pk_1': UUID('88baa483-681c-49e7-8fe9-d095c5217ab0')}
[2025-06-06 16:32:31,843.843] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET status=%(status)s, error=%(error)s WHERE message.id = %(message_id)s::UUID
[2025-06-06 16:32:31,844.844] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00030s] {'status': <QueueEvent.ERROR: 'error'>, 'error': "LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'", 'message_id': UUID('88baa483-681c-49e7-8fe9-d095c5217ab0')}
[2025-06-06 16:32:31,844.844] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:35:06,087.087] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\assistant_agent_service.py', reloading
[2025-06-06 16:35:06,459.459] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 16:35:38,751.751] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 16:35:43,792.792] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-06-06 16:35:43,795.795] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-06-06 16:35:50,365.365] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-06-06 16:35:50,365.365] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:35:50,366.366] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-06-06 16:35:50,366.366] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:35:50,367.367] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-06-06 16:35:50,367.367] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:35:50,367.367] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:35:50,369.369] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:35:50,369.369] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00026s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:35:50,376.376] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:35:50,376.376] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00037s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:35:50,379.379] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 16:35:50,380.380] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00031s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 16:35:50,384.384] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:35:50,390.390] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:35:50] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 16:36:10,044.044] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:36:10,045.045] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:36:10,045.045] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.68s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:36:10,046.046] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:36:10,047.047] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.67s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:36:10,048.048] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 16:36:10,048.048] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.67s ago] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 16:36:10,049.049] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:36:10,056.056] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:36:10] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 16:36:10,474.474] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\assistant_agent_service.py', reloading
[2025-06-06 16:36:10,855.855] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 16:36:16,190.190] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-06-06 16:36:16,193.193] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-06-06 16:36:16,426.426] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-06-06 16:36:16,426.426] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:36:16,427.427] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-06-06 16:36:16,428.428] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:36:16,428.428] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-06-06 16:36:16,429.429] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:36:16,429.429] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:36:16,432.432] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:36:16,432.432] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00036s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:36:16,437.437] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:36:16,437.437] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00042s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:36:16,441.441] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 16:36:16,442.442] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00035s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 16:36:16,448.448] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:36:16,491.491] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:36:16,492.492] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:36:16,492.492] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00033s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:36:16,496.496] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 16:36:16,496.496] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00047s] {'conversation_id_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'answer_1': '', 'param_1': 3, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 16:36:16,499.499] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:36:16,499.499] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00042s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 16:36:16,723.723] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 16:36:16,724.724] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00048s] {'pk_1': UUID('fad75c7b-d816-4e21-a6a5-d706067ee0d5')}
[2025-06-06 16:36:16,809.809] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:36:16] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 16:36:26,414.414] function_call_agent.py -> _llm_node line:192 [ERROR]: LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\core\agent\agents\function_call_agent.py", line 159, in _llm_node
    for chunk in llm.stream(state["messages"]):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 499, in stream
    for chunk in self._stream(input_messages, stop=stop, **kwargs):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 849, in _stream
    generation_chunk = self._convert_chunk_to_generation_chunk(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 707, in _convert_chunk_to_generation_chunk
    _create_usage_metadata(token_usage) if token_usage else None
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 2808, in _create_usage_metadata
    total_tokens = oai_token_usage.get("total_tokens", input_tokens + output_tokens)
TypeError: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
[2025-06-06 16:36:26,419.419] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 16:36:26,536.536] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:36:26,537.537] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:36:26,537.537] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.1s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:36:26,540.540] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 16:36:26,540.540] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00039s] {'pk_1': UUID('fad75c7b-d816-4e21-a6a5-d706067ee0d5')}
[2025-06-06 16:36:26,544.544] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-06-06 16:36:26,544.544] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00059s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'message_id': UUID('fad75c7b-d816-4e21-a6a5-d706067ee0d5'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-06-06 16:36:26,551.551] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:36:26,553.553] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:36:26,554.554] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 16:36:26,554.554] base.py -> _exec_single_context line:1901 [INFO]: [cached since 9.832s ago] {'pk_1': UUID('fad75c7b-d816-4e21-a6a5-d706067ee0d5')}
[2025-06-06 16:36:26,556.556] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET status=%(status)s, error=%(error)s WHERE message.id = %(message_id)s::UUID
[2025-06-06 16:36:26,556.556] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00037s] {'status': <QueueEvent.ERROR: 'error'>, 'error': "LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'", 'message_id': UUID('fad75c7b-d816-4e21-a6a5-d706067ee0d5')}
[2025-06-06 16:36:26,558.558] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:38:10,747.747] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\handler\\assistant_agent_handler.py', reloading
[2025-06-06 16:38:11,116.116] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 16:38:17,139.139] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-06-06 16:38:17,142.142] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-06-06 16:38:59,142.142] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-06-06 16:38:59,143.143] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:38:59,144.144] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-06-06 16:38:59,144.144] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:38:59,144.144] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-06-06 16:38:59,145.145] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:38:59,145.145] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:38:59,147.147] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:38:59,147.147] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00027s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:38:59,153.153] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:38:59,154.154] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00057s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:38:59,157.157] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 16:38:59,158.158] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00038s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 16:38:59,164.164] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:38:59,206.206] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:38:59,207.207] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:38:59,208.208] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00030s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:38:59,210.210] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 16:38:59,211.211] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00041s] {'conversation_id_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'answer_1': '', 'param_1': 3, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 16:38:59,213.213] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:38:59,214.214] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00068s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 16:38:59,432.432] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 16:38:59,433.433] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00041s] {'pk_1': UUID('48fb6a6d-00cb-4974-88fd-ee75ed88969f')}
[2025-06-06 16:38:59,514.514] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:38:59] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 16:39:10,590.590] function_call_agent.py -> _llm_node line:192 [ERROR]: LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\core\agent\agents\function_call_agent.py", line 159, in _llm_node
    for chunk in llm.stream(state["messages"]):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 499, in stream
    for chunk in self._stream(input_messages, stop=stop, **kwargs):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 849, in _stream
    generation_chunk = self._convert_chunk_to_generation_chunk(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 707, in _convert_chunk_to_generation_chunk
    _create_usage_metadata(token_usage) if token_usage else None
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 2808, in _create_usage_metadata
    total_tokens = oai_token_usage.get("total_tokens", input_tokens + output_tokens)
TypeError: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
[2025-06-06 16:39:10,593.593] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 16:39:10,807.807] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:39:10,808.808] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:39:10,808.808] base.py -> _exec_single_context line:1901 [INFO]: [cached since 11.66s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:39:10,811.811] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 16:39:10,811.811] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00032s] {'pk_1': UUID('48fb6a6d-00cb-4974-88fd-ee75ed88969f')}
[2025-06-06 16:39:10,815.815] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-06-06 16:39:10,815.815] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00039s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'message_id': UUID('48fb6a6d-00cb-4974-88fd-ee75ed88969f'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-06-06 16:39:10,820.820] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:39:10,822.822] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:39:10,823.823] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 16:39:10,823.823] base.py -> _exec_single_context line:1901 [INFO]: [cached since 11.39s ago] {'pk_1': UUID('48fb6a6d-00cb-4974-88fd-ee75ed88969f')}
[2025-06-06 16:39:10,825.825] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET status=%(status)s, error=%(error)s WHERE message.id = %(message_id)s::UUID
[2025-06-06 16:39:10,826.826] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00055s] {'status': <QueueEvent.ERROR: 'error'>, 'error': "LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'", 'message_id': UUID('48fb6a6d-00cb-4974-88fd-ee75ed88969f')}
[2025-06-06 16:39:10,827.827] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:40:35,897.897] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\assistant_agent_service.py', reloading
[2025-06-06 16:40:36,261.261] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 16:40:41,505.505] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-06-06 16:40:41,508.508] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-06-06 16:40:41,702.702] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-06-06 16:40:41,702.702] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:40:41,704.704] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-06-06 16:40:41,704.704] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:40:41,705.705] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-06-06 16:40:41,705.705] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:40:41,706.706] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:40:41,708.708] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:40:41,708.708] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00029s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:40:41,714.714] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:40:41,714.714] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00047s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:40:41,718.718] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 16:40:41,718.718] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00037s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 16:40:41,723.723] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:40:41,771.771] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:40:41] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 16:40:55,709.709] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:40:55,710.710] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:40:55,710.710] base.py -> _exec_single_context line:1901 [INFO]: [cached since 14s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:40:55,711.711] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:40:55,711.711] base.py -> _exec_single_context line:1901 [INFO]: [cached since 14s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:40:55,712.712] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 16:40:55,712.712] base.py -> _exec_single_context line:1901 [INFO]: [cached since 14s ago] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 16:40:55,714.714] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:40:55,762.762] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:40:55] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 16:40:56,163.163] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\assistant_agent_service.py', reloading
[2025-06-06 16:40:56,565.565] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 16:41:01,743.743] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-06-06 16:41:01,745.745] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-06-06 16:41:04,787.787] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-06-06 16:41:04,787.787] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:41:04,788.788] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-06-06 16:41:04,789.789] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:41:04,789.789] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-06-06 16:41:04,789.789] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:41:04,790.790] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:41:04,792.792] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:41:04,792.792] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00026s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:41:04,797.797] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:41:04,798.798] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00037s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:41:04,801.801] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 16:41:04,802.802] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00034s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 16:41:04,807.807] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:41:04,857.857] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:41:04] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 16:41:56,090.090] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\assistant_agent_service.py', reloading
[2025-06-06 16:41:56,458.458] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 16:42:01,740.740] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-06-06 16:42:01,742.742] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-06-06 16:42:18,574.574] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\assistant_agent_service.py', reloading
[2025-06-06 16:42:18,893.893] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 16:42:24,300.300] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-06-06 16:42:24,304.304] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-06-06 16:42:24,693.693] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-06-06 16:42:24,694.694] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:42:24,694.694] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-06-06 16:42:24,695.695] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:42:24,695.695] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-06-06 16:42:24,695.695] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:42:24,696.696] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:42:24,699.699] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:42:24,699.699] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00029s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:42:24,704.704] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:42:24,704.704] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00035s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:42:24,708.708] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 16:42:24,708.708] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00043s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 16:42:24,714.714] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:42:24,772.772] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:42:24] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 16:42:40,710.710] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:42:40,710.710] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:42:40,711.711] base.py -> _exec_single_context line:1901 [INFO]: [cached since 16.01s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:42:40,712.712] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:42:40,713.713] base.py -> _exec_single_context line:1901 [INFO]: [cached since 16.01s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:42:40,714.714] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 16:42:40,714.714] base.py -> _exec_single_context line:1901 [INFO]: [cached since 16.01s ago] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 16:42:40,715.715] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:42:40,764.764] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:42:40] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 16:42:43,266.266] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:42:43,267.267] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:42:43,267.267] base.py -> _exec_single_context line:1901 [INFO]: [cached since 18.57s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:42:43,270.270] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:42:43,271.271] base.py -> _exec_single_context line:1901 [INFO]: [cached since 18.57s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:42:43,272.272] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 16:42:43,273.273] base.py -> _exec_single_context line:1901 [INFO]: [cached since 18.57s ago] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 16:42:43,274.274] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:42:43,323.323] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:42:43] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 16:43:36,408.408] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:43:36,409.409] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:43:36,409.409] base.py -> _exec_single_context line:1901 [INFO]: [cached since 71.71s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:43:36,411.411] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:43:36,411.411] base.py -> _exec_single_context line:1901 [INFO]: [cached since 71.71s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:43:36,413.413] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 16:43:36,413.413] base.py -> _exec_single_context line:1901 [INFO]: [cached since 71.71s ago] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 16:43:36,415.415] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:43:36,463.463] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:43:36] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 16:43:50,779.779] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:43:50,779.779] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:43:50,780.780] base.py -> _exec_single_context line:1901 [INFO]: [cached since 86.08s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:43:50,781.781] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:43:50,782.782] base.py -> _exec_single_context line:1901 [INFO]: [cached since 86.08s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:43:50,783.783] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 16:43:50,783.783] base.py -> _exec_single_context line:1901 [INFO]: [cached since 86.08s ago] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 16:43:50,785.785] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:43:50,835.835] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:43:50] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 16:43:50,861.861] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\assistant_agent_service.py', reloading
[2025-06-06 16:43:51,328.328] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 16:43:56,743.743] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-06-06 16:43:56,746.746] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-06-06 16:43:56,975.975] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-06-06 16:43:56,976.976] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:43:56,977.977] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-06-06 16:43:56,977.977] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:43:56,978.978] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-06-06 16:43:56,978.978] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:43:56,979.979] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:43:56,981.981] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:43:56,982.982] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00040s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:43:56,987.987] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:43:56,987.987] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00038s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:43:56,991.991] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 16:43:56,991.991] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00040s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 16:43:56,998.998] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:43:57,040.040] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:43:57,041.041] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:43:57,042.042] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00030s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:43:57,045.045] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 16:43:57,045.045] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00043s] {'conversation_id_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'answer_1': '', 'param_1': 3, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 16:43:57,048.048] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 16:43:57,053.053] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:43:57] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 16:44:10,222.222] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\assistant_agent_service.py', reloading
[2025-06-06 16:44:10,605.605] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 16:44:15,952.952] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-06-06 16:44:15,955.955] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-06-06 16:44:16,184.184] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-06-06 16:44:16,184.184] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:44:16,185.185] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-06-06 16:44:16,185.185] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:44:16,186.186] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-06-06 16:44:16,186.186] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:44:16,187.187] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:44:16,189.189] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:44:16,190.190] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00037s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:44:16,194.194] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:44:16,195.195] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00039s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:44:16,199.199] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 16:44:16,199.199] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00033s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 16:44:16,204.204] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:44:16,247.247] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:44:16,248.248] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:44:16,248.248] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00029s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:44:16,251.251] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 16:44:16,251.251] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00037s] {'conversation_id_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'answer_1': '', 'param_1': 3, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 16:44:16,253.253] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:44:16,254.254] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00028s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 16:44:16,533.533] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 16:44:16,538.538] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00482s] {'pk_1': UUID('97ce536d-e907-4efc-b017-8d2dd9118004')}
[2025-06-06 16:44:16,539.539] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:44:16] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 16:44:24,089.089] function_call_agent.py -> _llm_node line:192 [ERROR]: LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: Connection error.
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_transports\default.py", line 69, in map_httpcore_exceptions
    yield
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_transports\default.py", line 233, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_sync\connection_pool.py", line 256, in handle_request
    raise exc from None
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_sync\http_proxy.py", line 288, in handle_request
    connect_response = self._connection.handle_request(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    raise exc
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_sync\connection.py", line 78, in handle_request
    stream = self._connect(request)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_sync\connection.py", line 124, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_backends\sync.py", line 215, in connect_tcp
    sock.setsockopt(socket.IPPROTO_TCP, socket.TCP_NODELAY, 1)
  File "C:\Users\Lenovo\.pyenv\pyenv-win\versions\3.9.12\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [WinError 10061] ç”±äºŽç›®æ ‡è®¡ç®—æœºç§¯æžæ‹’ç»ï¼Œæ— æ³•è¿žæŽ¥ã€‚

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 955, in _request
    response = self._client.send(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_client.py", line 1015, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_transports\default.py", line 233, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\Lenovo\.pyenv\pyenv-win\versions\3.9.12\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_transports\default.py", line 86, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [WinError 10061] ç”±äºŽç›®æ ‡è®¡ç®—æœºç§¯æžæ‹’ç»ï¼Œæ— æ³•è¿žæŽ¥ã€‚

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\core\agent\agents\function_call_agent.py", line 159, in _llm_node
    for chunk in llm.stream(state["messages"]):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 499, in stream
    for chunk in self._stream(input_messages, stop=stop, **kwargs):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 841, in _stream
    response = self.client.create(**payload)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_utils\_utils.py", line 279, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\resources\chat\completions\completions.py", line 914, in create
    return self._post(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 1242, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 919, in request
    return self._request(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 979, in _request
    return self._retry_request(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 1057, in _retry_request
    return self._request(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 979, in _request
    return self._retry_request(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 1057, in _retry_request
    return self._request(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 989, in _request
    raise APIConnectionError(request=request) from err
openai.APIConnectionError: Connection error.
[2025-06-06 16:44:24,103.103] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 16:44:24,204.204] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:44:24,204.204] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:44:24,205.205] base.py -> _exec_single_context line:1901 [INFO]: [cached since 8.011s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:44:24,207.207] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 16:44:24,207.207] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00028s] {'pk_1': UUID('97ce536d-e907-4efc-b017-8d2dd9118004')}
[2025-06-06 16:44:24,211.211] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-06-06 16:44:24,211.211] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00046s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'message_id': UUID('97ce536d-e907-4efc-b017-8d2dd9118004'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-06-06 16:44:24,218.218] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:44:24,220.220] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:44:24,220.220] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 16:44:24,220.220] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.688s ago] {'pk_1': UUID('97ce536d-e907-4efc-b017-8d2dd9118004')}
[2025-06-06 16:44:24,222.222] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET status=%(status)s, error=%(error)s WHERE message.id = %(message_id)s::UUID
[2025-06-06 16:44:24,222.222] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00025s] {'status': <QueueEvent.ERROR: 'error'>, 'error': 'LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: Connection error.', 'message_id': UUID('97ce536d-e907-4efc-b017-8d2dd9118004')}
[2025-06-06 16:44:24,223.223] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:44:27,406.406] client.py -> info line:628 [WARNING]: Failed to get info from https://api.smith.langchain.com: LangSmithConnectionError('Connection error caused failure to GET /info in LangSmith API. Please confirm your internet connection. ProxyError(MaxRetryError("HTTPSConnectionPool(host=\'api.smith.langchain.com\', port=443): Max retries exceeded with url: /info (Caused by ProxyError(\'Cannot connect to proxy.\', NewConnectionError(\'<urllib3.connection.HTTPSConnection object at 0x000001552F4C2FD0>: Failed to establish a new connection: [WinError 10061] ç”±äºŽç›®æ ‡è®¡ç®—æœºç§¯æžæ‹’ç»ï¼Œæ— æ³•è¿žæŽ¥ã€‚\')))"))\nContent-Length: None\nAPI Key: lsv2_********************************************31')
[2025-06-06 16:45:04,628.628] client.py -> _post_batch_ingest_runs line:1491 [WARNING]: Failed to batch ingest runs: langsmith.utils.LangSmithConnectionError: Connection error caused failure to POST https://api.smith.langchain.com/runs/batch in LangSmith API. Please confirm your internet connection. ProxyError(MaxRetryError("HTTPSConnectionPool(host='api.smith.langchain.com', port=443): Max retries exceeded with url: /runs/batch (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x0000015536318B50>: Failed to establish a new connection: [WinError 10061] ç”±äºŽç›®æ ‡è®¡ç®—æœºç§¯æžæ‹’ç»ï¼Œæ— æ³•è¿žæŽ¥ã€‚')))"))
Content-Length: 48606
API Key: lsv2_********************************************31
post: trace=e36075e3-c9fa-4fe6-99c4-a2e822dc16ed,id=e36075e3-c9fa-4fe6-99c4-a2e822dc16ed; trace=e36075e3-c9fa-4fe6-99c4-a2e822dc16ed,id=c0eb8338-55bd-4375-ab4d-c8b42a4c34c9; trace=e36075e3-c9fa-4fe6-99c4-a2e822dc16ed,id=c71aeed6-9bdf-428a-983c-c2081af1295a; trace=e36075e3-c9fa-4fe6-99c4-a2e822dc16ed,id=9e4dbdaf-1549-41d0-901f-9a72630bf716; trace=e36075e3-c9fa-4fe6-99c4-a2e822dc16ed,id=eacdc1c3-08e3-47e5-9ad7-3c6c2238bc4d; trace=e36075e3-c9fa-4fe6-99c4-a2e822dc16ed,id=31ca288f-3d9e-4790-8621-47dfca616cf7; trace=e36075e3-c9fa-4fe6-99c4-a2e822dc16ed,id=4dd87087-3413-4ed1-b601-41d659359c29; trace=e36075e3-c9fa-4fe6-99c4-a2e822dc16ed,id=55202331-d8e2-4510-8033-e46e5cac726a; trace=e36075e3-c9fa-4fe6-99c4-a2e822dc16ed,id=409d1d88-88ca-40c6-91a2-52cecabcedb4; trace=e36075e3-c9fa-4fe6-99c4-a2e822dc16ed,id=faff946b-6760-4f44-b141-cd56273ff259; trace=e36075e3-c9fa-4fe6-99c4-a2e822dc16ed,id=bf246525-2ac2-4a8e-9e3a-cfa417659424; trace=e36075e3-c9fa-4fe6-99c4-a2e822dc16ed,id=9fb3a247-63f2-4871-85e1-b15fabb18a28
[2025-06-06 16:45:21,164.164] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\assistant_agent_service.py', reloading
[2025-06-06 16:45:21,529.529] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 16:45:26,845.845] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-06-06 16:45:26,848.848] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-06-06 16:45:27,039.039] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-06-06 16:45:27,039.039] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:45:27,040.040] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-06-06 16:45:27,040.040] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:45:27,041.041] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-06-06 16:45:27,041.041] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:45:27,042.042] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:45:27,045.045] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:45:27,045.045] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00032s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:45:27,050.050] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:45:27,050.050] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00042s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:45:27,054.054] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 16:45:27,054.054] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00048s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 16:45:27,060.060] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:45:27,104.104] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:45:27,105.105] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:45:27,105.105] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00035s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:45:27,108.108] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 16:45:27,108.108] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00051s] {'conversation_id_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'answer_1': '', 'param_1': 3, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 16:45:27,111.111] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:45:27,112.112] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00031s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 16:45:27,387.387] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 16:45:27,392.392] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00487s] {'pk_1': UUID('abb9416d-eafa-4c61-8c0a-45b53fead89f')}
[2025-06-06 16:45:27,393.393] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:45:27] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 16:45:34,825.825] function_call_agent.py -> _llm_node line:192 [ERROR]: LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: Connection error.
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_transports\default.py", line 69, in map_httpcore_exceptions
    yield
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_transports\default.py", line 233, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_sync\connection_pool.py", line 256, in handle_request
    raise exc from None
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_sync\http_proxy.py", line 288, in handle_request
    connect_response = self._connection.handle_request(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    raise exc
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_sync\connection.py", line 78, in handle_request
    stream = self._connect(request)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_sync\connection.py", line 124, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_backends\sync.py", line 215, in connect_tcp
    sock.setsockopt(socket.IPPROTO_TCP, socket.TCP_NODELAY, 1)
  File "C:\Users\Lenovo\.pyenv\pyenv-win\versions\3.9.12\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [WinError 10061] ç”±äºŽç›®æ ‡è®¡ç®—æœºç§¯æžæ‹’ç»ï¼Œæ— æ³•è¿žæŽ¥ã€‚

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 955, in _request
    response = self._client.send(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_client.py", line 1015, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_transports\default.py", line 233, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\Lenovo\.pyenv\pyenv-win\versions\3.9.12\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_transports\default.py", line 86, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [WinError 10061] ç”±äºŽç›®æ ‡è®¡ç®—æœºç§¯æžæ‹’ç»ï¼Œæ— æ³•è¿žæŽ¥ã€‚

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\core\agent\agents\function_call_agent.py", line 159, in _llm_node
    for chunk in llm.stream(state["messages"]):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 499, in stream
    for chunk in self._stream(input_messages, stop=stop, **kwargs):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 841, in _stream
    response = self.client.create(**payload)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_utils\_utils.py", line 279, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\resources\chat\completions\completions.py", line 914, in create
    return self._post(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 1242, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 919, in request
    return self._request(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 979, in _request
    return self._retry_request(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 1057, in _retry_request
    return self._request(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 979, in _request
    return self._retry_request(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 1057, in _retry_request
    return self._request(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 989, in _request
    raise APIConnectionError(request=request) from err
openai.APIConnectionError: Connection error.
[2025-06-06 16:45:34,839.839] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 16:45:34,913.913] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:45:34,913.913] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:45:34,914.914] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.864s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:45:34,916.916] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 16:45:34,917.917] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00029s] {'pk_1': UUID('abb9416d-eafa-4c61-8c0a-45b53fead89f')}
[2025-06-06 16:45:34,920.920] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-06-06 16:45:34,920.920] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00032s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'message_id': UUID('abb9416d-eafa-4c61-8c0a-45b53fead89f'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-06-06 16:45:34,926.926] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:45:34,927.927] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:45:34,927.927] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 16:45:34,927.927] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.54s ago] {'pk_1': UUID('abb9416d-eafa-4c61-8c0a-45b53fead89f')}
[2025-06-06 16:45:34,929.929] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET status=%(status)s, error=%(error)s WHERE message.id = %(message_id)s::UUID
[2025-06-06 16:45:34,929.929] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00026s] {'status': <QueueEvent.ERROR: 'error'>, 'error': 'LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: Connection error.', 'message_id': UUID('abb9416d-eafa-4c61-8c0a-45b53fead89f')}
[2025-06-06 16:45:34,930.930] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:45:38,280.280] client.py -> info line:628 [WARNING]: Failed to get info from https://api.smith.langchain.com: LangSmithConnectionError('Connection error caused failure to GET /info in LangSmith API. Please confirm your internet connection. ProxyError(MaxRetryError("HTTPSConnectionPool(host=\'api.smith.langchain.com\', port=443): Max retries exceeded with url: /info (Caused by ProxyError(\'Cannot connect to proxy.\', NewConnectionError(\'<urllib3.connection.HTTPSConnection object at 0x000001A713AD2F40>: Failed to establish a new connection: [WinError 10061] ç”±äºŽç›®æ ‡è®¡ç®—æœºç§¯æžæ‹’ç»ï¼Œæ— æ³•è¿žæŽ¥ã€‚\')))"))\nContent-Length: None\nAPI Key: lsv2_********************************************31')
[2025-06-06 16:46:00,141.141] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\assistant_agent_service.py', reloading
[2025-06-06 16:46:00,584.584] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 16:46:06,195.195] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-06-06 16:46:06,199.199] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-06-06 16:46:06,479.479] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-06-06 16:46:06,479.479] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:46:06,480.480] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-06-06 16:46:06,480.480] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:46:06,481.481] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-06-06 16:46:06,481.481] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:46:06,481.481] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:46:06,484.484] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:46:06,484.484] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00031s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:46:06,489.489] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:46:06,489.489] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00044s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:46:06,493.493] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 16:46:06,493.493] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00036s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 16:46:06,499.499] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:46:06,539.539] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:46:06,540.540] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:46:06,541.541] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00029s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:46:06,543.543] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 16:46:06,544.544] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00040s] {'conversation_id_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'answer_1': '', 'param_1': 3, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 16:46:06,546.546] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:46:06,546.546] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00025s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 16:46:06,876.876] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 16:46:06,881.881] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00462s] {'pk_1': UUID('b5b2784e-8a25-4e6e-9c87-5365afc9dc33')}
[2025-06-06 16:46:06,882.882] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:46:06] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 16:46:08,597.597] client.py -> info line:628 [WARNING]: Failed to get info from https://api.smith.langchain.com: LangSmithConnectionError('Connection error caused failure to GET /info in LangSmith API. Please confirm your internet connection. ProxyError(MaxRetryError("HTTPSConnectionPool(host=\'api.smith.langchain.com\', port=443): Max retries exceeded with url: /info (Caused by ProxyError(\'Cannot connect to proxy.\', NewConnectionError(\'<urllib3.connection.HTTPSConnection object at 0x000001F36CA53D60>: Failed to establish a new connection: [WinError 10061] ç”±äºŽç›®æ ‡è®¡ç®—æœºç§¯æžæ‹’ç»ï¼Œæ— æ³•è¿žæŽ¥ã€‚\')))"))\nContent-Length: None\nAPI Key: lsv2_********************************************31')
[2025-06-06 16:46:14,227.227] function_call_agent.py -> _llm_node line:192 [ERROR]: LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: Connection error.
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_transports\default.py", line 69, in map_httpcore_exceptions
    yield
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_transports\default.py", line 233, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_sync\connection_pool.py", line 256, in handle_request
    raise exc from None
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_sync\http_proxy.py", line 288, in handle_request
    connect_response = self._connection.handle_request(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    raise exc
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_sync\connection.py", line 78, in handle_request
    stream = self._connect(request)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_sync\connection.py", line 124, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_backends\sync.py", line 215, in connect_tcp
    sock.setsockopt(socket.IPPROTO_TCP, socket.TCP_NODELAY, 1)
  File "C:\Users\Lenovo\.pyenv\pyenv-win\versions\3.9.12\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [WinError 10061] ç”±äºŽç›®æ ‡è®¡ç®—æœºç§¯æžæ‹’ç»ï¼Œæ— æ³•è¿žæŽ¥ã€‚

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 955, in _request
    response = self._client.send(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_client.py", line 1015, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_transports\default.py", line 233, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\Lenovo\.pyenv\pyenv-win\versions\3.9.12\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_transports\default.py", line 86, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [WinError 10061] ç”±äºŽç›®æ ‡è®¡ç®—æœºç§¯æžæ‹’ç»ï¼Œæ— æ³•è¿žæŽ¥ã€‚

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\core\agent\agents\function_call_agent.py", line 159, in _llm_node
    for chunk in llm.stream(state["messages"]):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 499, in stream
    for chunk in self._stream(input_messages, stop=stop, **kwargs):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 841, in _stream
    response = self.client.create(**payload)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_utils\_utils.py", line 279, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\resources\chat\completions\completions.py", line 914, in create
    return self._post(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 1242, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 919, in request
    return self._request(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 979, in _request
    return self._retry_request(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 1057, in _retry_request
    return self._request(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 979, in _request
    return self._retry_request(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 1057, in _retry_request
    return self._request(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 989, in _request
    raise APIConnectionError(request=request) from err
openai.APIConnectionError: Connection error.
[2025-06-06 16:46:14,239.239] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 16:46:14,354.354] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:46:14,354.354] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:46:14,355.355] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.867s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:46:14,357.357] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 16:46:14,358.358] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00034s] {'pk_1': UUID('b5b2784e-8a25-4e6e-9c87-5365afc9dc33')}
[2025-06-06 16:46:14,361.361] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-06-06 16:46:14,362.362] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00039s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'message_id': UUID('b5b2784e-8a25-4e6e-9c87-5365afc9dc33'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-06-06 16:46:14,367.367] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:46:14,368.368] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:46:14,368.368] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 16:46:14,369.369] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.492s ago] {'pk_1': UUID('b5b2784e-8a25-4e6e-9c87-5365afc9dc33')}
[2025-06-06 16:46:14,371.371] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET status=%(status)s, error=%(error)s WHERE message.id = %(message_id)s::UUID
[2025-06-06 16:46:14,371.371] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00045s] {'status': <QueueEvent.ERROR: 'error'>, 'error': 'LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: Connection error.', 'message_id': UUID('b5b2784e-8a25-4e6e-9c87-5365afc9dc33')}
[2025-06-06 16:46:14,371.371] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:46:45,404.404] client.py -> _post_batch_ingest_runs line:1491 [WARNING]: Failed to batch ingest runs: langsmith.utils.LangSmithConnectionError: Connection error caused failure to POST https://api.smith.langchain.com/runs/batch in LangSmith API. Please confirm your internet connection. ProxyError(MaxRetryError("HTTPSConnectionPool(host='api.smith.langchain.com', port=443): Max retries exceeded with url: /runs/batch (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x000001F36D4AECA0>: Failed to establish a new connection: [WinError 10061] ç”±äºŽç›®æ ‡è®¡ç®—æœºç§¯æžæ‹’ç»ï¼Œæ— æ³•è¿žæŽ¥ã€‚')))"))
Content-Length: 28695
API Key: lsv2_********************************************31
post: trace=1bb699af-b554-4027-b8bc-7779f6b324e1,id=1bb699af-b554-4027-b8bc-7779f6b324e1; trace=1bb699af-b554-4027-b8bc-7779f6b324e1,id=71ad2a70-5bde-4a77-916f-26858f92a2e8; trace=1bb699af-b554-4027-b8bc-7779f6b324e1,id=41d34043-06fa-429e-a2bd-179f8b9a9199; trace=1bb699af-b554-4027-b8bc-7779f6b324e1,id=a73e433b-0a49-43a4-9d6f-70aaeaee1c00; trace=1bb699af-b554-4027-b8bc-7779f6b324e1,id=465a2746-c937-435e-8679-853257799910; trace=1bb699af-b554-4027-b8bc-7779f6b324e1,id=63a4e28b-bf66-493c-8c30-3320d879bdbd; trace=1bb699af-b554-4027-b8bc-7779f6b324e1,id=92e5b5e2-be06-4f3f-bb0e-689b2fabf406; trace=1bb699af-b554-4027-b8bc-7779f6b324e1,id=626cb760-9d86-4608-ae7d-3b4089c64753; trace=1bb699af-b554-4027-b8bc-7779f6b324e1,id=3012399e-905b-4a88-bcdd-83a2b3b7c8f9; trace=1bb699af-b554-4027-b8bc-7779f6b324e1,id=c896f56d-a7df-4e55-b2e8-83e33d8f575e; trace=1bb699af-b554-4027-b8bc-7779f6b324e1,id=bbb6601e-e84e-4421-b1a4-89a89b346135; trace=1bb699af-b554-4027-b8bc-7779f6b324e1,id=7b81b70c-7ee6-4ab2-8d15-3b81745dd079
[2025-06-06 16:47:22,347.347] client.py -> _post_batch_ingest_runs line:1491 [WARNING]: Failed to batch ingest runs: langsmith.utils.LangSmithConnectionError: Connection error caused failure to POST https://api.smith.langchain.com/runs/batch in LangSmith API. Please confirm your internet connection. ProxyError(MaxRetryError("HTTPSConnectionPool(host='api.smith.langchain.com', port=443): Max retries exceeded with url: /runs/batch (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x000001F36D4AE7C0>: Failed to establish a new connection: [WinError 10061] ç”±äºŽç›®æ ‡è®¡ç®—æœºç§¯æžæ‹’ç»ï¼Œæ— æ³•è¿žæŽ¥ã€‚')))"))
Content-Length: 22919
API Key: lsv2_********************************************31
patch: trace=1bb699af-b554-4027-b8bc-7779f6b324e1,id=1bb699af-b554-4027-b8bc-7779f6b324e1; trace=1bb699af-b554-4027-b8bc-7779f6b324e1,id=bbb6601e-e84e-4421-b1a4-89a89b346135; trace=1bb699af-b554-4027-b8bc-7779f6b324e1,id=7b81b70c-7ee6-4ab2-8d15-3b81745dd079
[2025-06-06 16:48:43,426.426] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 844, in dispatch_request
    self.raise_routing_exception(req)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 453, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\werkzeug\routing\map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
[2025-06-06 16:48:43,453.453] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:48:43] "[35m[1mPOST /assistant-agent/chat/123/stop HTTP/1.1[0m" 500 -
[2025-06-06 16:49:40,561.561] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:49:40,561.561] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:49:40,561.561] base.py -> _exec_single_context line:1901 [INFO]: [cached since 214.1s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:49:40,564.564] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:49:40,564.564] base.py -> _exec_single_context line:1901 [INFO]: [cached since 214.1s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:49:40,569.569] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.status IN (%(status_1_1)s, %(status_1_2)s) AND message.answer != %(answer_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-06-06 16:49:40,569.569] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00036s] {'conversation_id_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'answer_1': '', 'param_1': 20, 'param_2': 0, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 16:49:40,579.579] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT message.id AS id, message.app_id AS app_id, message.conversation_id AS conversation_id, message.invoke_from AS invoke_from, message.created_by AS created_by, message.query AS query, message.message AS message, message.message_token_count AS message_token_count, message.message_unit_price AS message_unit_price, message.message_price_unit AS message_price_unit, message.answer AS answer, message.answer_token_count AS answer_token_count, message.answer_unit_price AS answer_unit_price, message.answer_price_unit AS answer_price_unit, message.latency AS latency, message.is_deleted AS is_deleted, message.status AS status, message.error AS error, message.total_token_count AS total_token_count, message.total_price AS total_price, message.updated_at AS updated_at, message.created_at AS created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.status IN (%(status_1_1)s, %(status_1_2)s) AND message.answer != %(answer_1)s) AS anon_1
[2025-06-06 16:49:40,579.579] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00044s] {'conversation_id_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'answer_1': '', 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 16:49:40,583.583] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 16:49:40,585.585] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:49:40] "GET /assistant-agent/messages HTTP/1.1" 200 -
[2025-06-06 16:50:37,372.372] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 405 Method Not Allowed: The method is not allowed for the requested URL.
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 844, in dispatch_request
    self.raise_routing_exception(req)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 453, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\werkzeug\routing\map.py", line 624, in match
    raise MethodNotAllowed(valid_methods=list(e.have_match_for)) from None
werkzeug.exceptions.MethodNotAllowed: 405 Method Not Allowed: The method is not allowed for the requested URL.
[2025-06-06 16:50:37,381.381] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:50:37] "[35m[1mGET /assistant-agent/delete-conversation HTTP/1.1[0m" 500 -
[2025-06-06 16:51:07,874.874] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:51:07,874.874] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:51:07,875.875] base.py -> _exec_single_context line:1901 [INFO]: [cached since 301.4s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:51:07,877.877] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 16:51:07,877.877] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:51:07] "GET /account HTTP/1.1" 200 -
[2025-06-06 16:51:48,756.756] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:51:48,756.756] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:51:48,758.758] base.py -> _exec_single_context line:1901 [INFO]: [cached since 342.3s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:51:48,767.767] base.py -> _exec_single_context line:1896 [INFO]: SELECT workflow.id AS workflow_id, workflow.account_id AS workflow_account_id, workflow.name AS workflow_name, workflow.tool_call_name AS workflow_tool_call_name, workflow.icon AS workflow_icon, workflow.description AS workflow_description, workflow.graph AS workflow_graph, workflow.draft_graph AS workflow_draft_graph, workflow.is_debug_passed AS workflow_is_debug_passed, workflow.status AS workflow_status, workflow.published_at AS workflow_published_at, workflow.updated_at AS workflow_updated_at, workflow.created_at AS workflow_created_at 
FROM workflow 
WHERE workflow.account_id = %(account_id_1)s::UUID ORDER BY workflow.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-06-06 16:51:48,770.770] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00259s] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'param_1': 20, 'param_2': 0}
[2025-06-06 16:51:48,784.784] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT workflow.id AS id, workflow.account_id AS account_id, workflow.name AS name, workflow.tool_call_name AS tool_call_name, workflow.icon AS icon, workflow.description AS description, workflow.graph AS graph, workflow.draft_graph AS draft_graph, workflow.is_debug_passed AS is_debug_passed, workflow.status AS status, workflow.published_at AS published_at, workflow.updated_at AS updated_at, workflow.created_at AS created_at 
FROM workflow 
WHERE workflow.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-06-06 16:51:48,785.785] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00057s] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 16:51:48,786.786] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 16:51:48,787.787] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:51:48] "GET /workflows HTTP/1.1" 200 -
[2025-06-06 16:53:17,118.118] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:53:17,119.119] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:53:17,120.120] base.py -> _exec_single_context line:1901 [INFO]: [cached since 430.6s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:53:19,239.239] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: [WinError 10061] ç”±äºŽç›®æ ‡è®¡ç®—æœºç§¯æžæ‹’ç»ï¼Œæ— æ³•è¿žæŽ¥ã€‚
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_transports\default.py", line 69, in map_httpcore_exceptions
    yield
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_transports\default.py", line 233, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_sync\connection_pool.py", line 256, in handle_request
    raise exc from None
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_sync\http_proxy.py", line 206, in handle_request
    return self._connection.handle_request(proxy_request)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    raise exc
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_sync\connection.py", line 78, in handle_request
    stream = self._connect(request)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_sync\connection.py", line 124, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_backends\sync.py", line 215, in connect_tcp
    sock.setsockopt(socket.IPPROTO_TCP, socket.TCP_NODELAY, 1)
  File "C:\Users\Lenovo\.pyenv\pyenv-win\versions\3.9.12\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [WinError 10061] ç”±äºŽç›®æ ‡è®¡ç®—æœºç§¯æžæ‹’ç»ï¼Œæ— æ³•è¿žæŽ¥ã€‚

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 229, in ping
    "content": llm.invoke("ä½ å¥½").content,
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 372, in invoke
    self.generate_prompt(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 957, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 776, in generate
    self._generate_with_cache(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 1022, in _generate_with_cache
    result = self._generate(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_ollama\chat_models.py", line 741, in _generate
    final_chunk = self._chat_stream_with_aggregation(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_ollama\chat_models.py", line 678, in _chat_stream_with_aggregation
    for chunk in self._iterate_over_stream(messages, stop, **kwargs):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_ollama\chat_models.py", line 763, in _iterate_over_stream
    for stream_resp in self._create_chat_stream(messages, stop, **kwargs):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_ollama\chat_models.py", line 665, in _create_chat_stream
    yield from self._client.chat(**chat_params)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\ollama\_client.py", line 165, in inner
    with self._client.stream(*args, **kwargs) as r:
  File "C:\Users\Lenovo\.pyenv\pyenv-win\versions\3.9.12\lib\contextlib.py", line 119, in __enter__
    return next(self.gen)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_client.py", line 870, in stream
    response = self.send(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_client.py", line 1015, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_transports\default.py", line 233, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\Lenovo\.pyenv\pyenv-win\versions\3.9.12\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_transports\default.py", line 86, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [WinError 10061] ç”±äºŽç›®æ ‡è®¡ç®—æœºç§¯æžæ‹’ç»ï¼Œæ— æ³•è¿žæŽ¥ã€‚
[2025-06-06 16:53:19,251.251] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 16:53:19,274.274] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:53:19] "[35m[1mGET /ping HTTP/1.1[0m" 500 -
[2025-06-06 16:53:53,872.872] client.py -> _post_batch_ingest_runs line:1491 [WARNING]: Failed to batch ingest runs: langsmith.utils.LangSmithConnectionError: Connection error caused failure to POST https://api.smith.langchain.com/runs/batch in LangSmith API. Please confirm your internet connection. ProxyError(MaxRetryError("HTTPSConnectionPool(host='api.smith.langchain.com', port=443): Max retries exceeded with url: /runs/batch (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x000001F36E656970>: Failed to establish a new connection: [WinError 10061] ç”±äºŽç›®æ ‡è®¡ç®—æœºç§¯æžæ‹’ç»ï¼Œæ— æ³•è¿žæŽ¥ã€‚')))"))
Content-Length: 1426
API Key: lsv2_********************************************31
post: trace=012565c7-9e48-4731-9c8f-96bc6d65c7a2,id=012565c7-9e48-4731-9c8f-96bc6d65c7a2
[2025-06-06 16:53:54,786.786] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\handler\\app_handler.py', reloading
[2025-06-06 16:53:55,116.116] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 16:54:00,465.465] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-06-06 16:54:00,467.467] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-06-06 16:54:00,688.688] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-06-06 16:54:00,688.688] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:54:00,689.689] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-06-06 16:54:00,690.690] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:54:00,690.690] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-06-06 16:54:00,691.691] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:54:00,691.691] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:54:00,694.694] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:54:00,694.694] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00033s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:54:08,189.189] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: Connection error.
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_transports\default.py", line 69, in map_httpcore_exceptions
    yield
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_transports\default.py", line 233, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_sync\connection_pool.py", line 256, in handle_request
    raise exc from None
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_sync\http_proxy.py", line 288, in handle_request
    connect_response = self._connection.handle_request(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    raise exc
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_sync\connection.py", line 78, in handle_request
    stream = self._connect(request)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_sync\connection.py", line 124, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_backends\sync.py", line 215, in connect_tcp
    sock.setsockopt(socket.IPPROTO_TCP, socket.TCP_NODELAY, 1)
  File "C:\Users\Lenovo\.pyenv\pyenv-win\versions\3.9.12\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpcore\_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [WinError 10061] ç”±äºŽç›®æ ‡è®¡ç®—æœºç§¯æžæ‹’ç»ï¼Œæ— æ³•è¿žæŽ¥ã€‚

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 955, in _request
    response = self._client.send(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_client.py", line 1015, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_transports\default.py", line 233, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\Lenovo\.pyenv\pyenv-win\versions\3.9.12\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\httpx\_transports\default.py", line 86, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [WinError 10061] ç”±äºŽç›®æ ‡è®¡ç®—æœºç§¯æžæ‹’ç»ï¼Œæ— æ³•è¿žæŽ¥ã€‚

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 229, in ping
    "content": llm.invoke("ä½ å¥½").content,
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 372, in invoke
    self.generate_prompt(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 957, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 776, in generate
    self._generate_with_cache(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 1022, in _generate_with_cache
    result = self._generate(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 925, in _generate
    response = self.client.create(**payload)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_utils\_utils.py", line 279, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\resources\chat\completions\completions.py", line 914, in create
    return self._post(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 1242, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 919, in request
    return self._request(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 979, in _request
    return self._retry_request(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 1057, in _retry_request
    return self._request(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 979, in _request
    return self._retry_request(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 1057, in _retry_request
    return self._request(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\openai\_base_client.py", line 989, in _request
    raise APIConnectionError(request=request) from err
openai.APIConnectionError: Connection error.
[2025-06-06 16:54:08,211.211] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 16:54:08,283.283] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:54:08] "[35m[1mGET /ping HTTP/1.1[0m" 500 -
[2025-06-06 16:54:11,879.879] client.py -> info line:628 [WARNING]: Failed to get info from https://api.smith.langchain.com: LangSmithConnectionError('Connection error caused failure to GET /info in LangSmith API. Please confirm your internet connection. ProxyError(MaxRetryError("HTTPSConnectionPool(host=\'api.smith.langchain.com\', port=443): Max retries exceeded with url: /info (Caused by ProxyError(\'Cannot connect to proxy.\', NewConnectionError(\'<urllib3.connection.HTTPSConnection object at 0x0000020FE37E5C70>: Failed to establish a new connection: [WinError 10061] ç”±äºŽç›®æ ‡è®¡ç®—æœºç§¯æžæ‹’ç»ï¼Œæ— æ³•è¿žæŽ¥ã€‚\')))"))\nContent-Length: None\nAPI Key: lsv2_********************************************31')
[2025-06-06 16:54:35,326.326] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:54:35,327.327] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:54:35,327.327] base.py -> _exec_single_context line:1901 [INFO]: [cached since 34.63s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:54:44,647.647] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 16:54:44,648.648] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:54:44] "GET /ping HTTP/1.1" 200 -
[2025-06-06 16:55:18,852.852] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:55:18,852.852] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:55:18,854.854] base.py -> _exec_single_context line:1901 [INFO]: [cached since 78.16s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:55:18,860.860] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 16:55:18,860.860] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:55:18] "POST /assistant-agent/chat/889dceb4-d58f-4971-9027-5ac7f12e6faf/stop HTTP/1.1" 200 -
[2025-06-06 16:55:24,015.015] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:55:24,016.016] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:55:24,016.016] base.py -> _exec_single_context line:1901 [INFO]: [cached since 83.32s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:55:24,024.024] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:55:24,024.024] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00041s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:55:24,112.112] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.status IN (%(status_1_1)s, %(status_1_2)s) AND message.answer != %(answer_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-06-06 16:55:24,113.113] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00060s] {'conversation_id_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'answer_1': '', 'param_1': 20, 'param_2': 0, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 16:55:24,116.116] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT message.id AS id, message.app_id AS app_id, message.conversation_id AS conversation_id, message.invoke_from AS invoke_from, message.created_by AS created_by, message.query AS query, message.message AS message, message.message_token_count AS message_token_count, message.message_unit_price AS message_unit_price, message.message_price_unit AS message_price_unit, message.answer AS answer, message.answer_token_count AS answer_token_count, message.answer_unit_price AS answer_unit_price, message.answer_price_unit AS answer_price_unit, message.latency AS latency, message.is_deleted AS is_deleted, message.status AS status, message.error AS error, message.total_token_count AS total_token_count, message.total_price AS total_price, message.updated_at AS updated_at, message.created_at AS created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.status IN (%(status_1_1)s, %(status_1_2)s) AND message.answer != %(answer_1)s) AS anon_1
[2025-06-06 16:55:24,118.118] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00036s] {'conversation_id_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'answer_1': '', 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 16:55:24,119.119] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 16:55:24,119.119] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:55:24] "GET /assistant-agent/messages HTTP/1.1" 200 -
[2025-06-06 16:55:28,044.044] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:55:28,044.044] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:55:28,044.044] base.py -> _exec_single_context line:1901 [INFO]: [cached since 87.35s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:55:28,046.046] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:55:28,047.047] base.py -> _exec_single_context line:1901 [INFO]: [cached since 4.023s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:55:28,049.049] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 16:55:28,049.049] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00031s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 16:55:28,055.055] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:55:28,097.097] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:55:28,098.098] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:55:28,098.098] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00033s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:55:28,101.101] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 16:55:28,101.101] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00036s] {'conversation_id_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'answer_1': '', 'param_1': 3, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 16:55:28,102.102] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:55:28,103.103] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00032s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 16:55:36,985.985] function_call_agent.py -> _llm_node line:192 [ERROR]: LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\core\agent\agents\function_call_agent.py", line 159, in _llm_node
    for chunk in llm.stream(state["messages"]):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 499, in stream
    for chunk in self._stream(input_messages, stop=stop, **kwargs):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 849, in _stream
    generation_chunk = self._convert_chunk_to_generation_chunk(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 707, in _convert_chunk_to_generation_chunk
    _create_usage_metadata(token_usage) if token_usage else None
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 2808, in _create_usage_metadata
    total_tokens = oai_token_usage.get("total_tokens", input_tokens + output_tokens)
TypeError: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
[2025-06-06 16:55:36,986.986] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 16:55:36,987.987] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00056s] {'pk_1': UUID('a56b361f-d233-4739-ac75-6e1cf3563406')}
[2025-06-06 16:55:36,988.988] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:55:36] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 16:55:36,991.991] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 16:55:37,109.109] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:55:37,110.110] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:55:37,110.110] base.py -> _exec_single_context line:1901 [INFO]: [cached since 13.09s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:55:37,113.113] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 16:55:37,113.113] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00036s] {'pk_1': UUID('a56b361f-d233-4739-ac75-6e1cf3563406')}
[2025-06-06 16:55:37,116.116] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET status=%(status)s, error=%(error)s WHERE message.id = %(message_id)s::UUID
[2025-06-06 16:55:37,116.116] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00035s] {'status': <QueueEvent.ERROR: 'error'>, 'error': "LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'", 'message_id': UUID('a56b361f-d233-4739-ac75-6e1cf3563406')}
[2025-06-06 16:55:37,118.118] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:56:12,669.669] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:56:12,670.670] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:56:12,671.671] base.py -> _exec_single_context line:1901 [INFO]: [cached since 132s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:56:12,673.673] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:56:12,674.674] base.py -> _exec_single_context line:1901 [INFO]: [cached since 48.65s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:56:12,675.675] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 16:56:12,675.675] base.py -> _exec_single_context line:1901 [INFO]: [cached since 44.63s ago] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½,AIæ˜¯ä»€ä¹ˆ?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 16:56:12,678.678] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:56:12,774.774] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:56:12,775.775] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:56:12,775.775] base.py -> _exec_single_context line:1901 [INFO]: [cached since 44.68s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:56:12,777.777] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 16:56:12,777.777] base.py -> _exec_single_context line:1901 [INFO]: [cached since 44.68s ago] {'conversation_id_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'answer_1': '', 'param_1': 3, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 16:56:12,779.779] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:56:12,779.779] base.py -> _exec_single_context line:1901 [INFO]: [cached since 44.68s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 16:56:20,319.319] function_call_agent.py -> _llm_node line:192 [ERROR]: LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\core\agent\agents\function_call_agent.py", line 159, in _llm_node
    for chunk in llm.stream(state["messages"]):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 499, in stream
    for chunk in self._stream(input_messages, stop=stop, **kwargs):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 849, in _stream
    generation_chunk = self._convert_chunk_to_generation_chunk(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 707, in _convert_chunk_to_generation_chunk
    _create_usage_metadata(token_usage) if token_usage else None
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 2808, in _create_usage_metadata
    total_tokens = oai_token_usage.get("total_tokens", input_tokens + output_tokens)
TypeError: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
[2025-06-06 16:56:20,320.320] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 16:56:20,324.324] base.py -> _exec_single_context line:1901 [INFO]: [cached since 43.34s ago] {'pk_1': UUID('657e5e76-ba74-4ba7-8835-29992953f123')}
[2025-06-06 16:56:20,331.331] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:56:20] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 16:56:20,334.334] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 16:56:20,336.336] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:56:20,337.337] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:56:20,339.339] base.py -> _exec_single_context line:1901 [INFO]: [cached since 56.32s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:56:20,342.342] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 16:56:20,342.342] base.py -> _exec_single_context line:1901 [INFO]: [cached since 43.23s ago] {'pk_1': UUID('657e5e76-ba74-4ba7-8835-29992953f123')}
[2025-06-06 16:56:20,343.343] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET status=%(status)s, error=%(error)s WHERE message.id = %(message_id)s::UUID
[2025-06-06 16:56:20,344.344] base.py -> _exec_single_context line:1901 [INFO]: [cached since 43.23s ago] {'status': <QueueEvent.ERROR: 'error'>, 'error': "LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'", 'message_id': UUID('657e5e76-ba74-4ba7-8835-29992953f123')}
[2025-06-06 16:56:20,347.347] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:57:31,019.019] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\assistant_agent_service.py', reloading
[2025-06-06 16:57:31,546.546] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 16:57:36,880.880] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-06-06 16:57:36,882.882] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-06-06 16:58:00,012.012] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-06-06 16:58:00,012.012] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:58:00,014.014] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-06-06 16:58:00,014.014] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:58:00,015.015] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-06-06 16:58:00,015.015] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 16:58:00,016.016] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:58:00,020.020] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:58:00,021.021] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00079s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 16:58:00,027.027] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:58:00,028.028] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00054s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:58:00,032.032] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 16:58:00,034.034] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00075s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½,AIæ˜¯ä»€ä¹ˆ?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 16:58:00,040.040] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:58:00,110.110] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:58:00,111.111] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:58:00,112.112] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00037s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:58:00,116.116] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 16:58:00,116.116] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00047s] {'conversation_id_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'answer_1': '', 'param_1': 3, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 16:58:00,119.119] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 16:58:00,120.120] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00035s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 16:58:00,516.516] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 16:58:00,519.519] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00303s] {'pk_1': UUID('2375cccd-d0c1-4a87-90b4-fb0ce48dea22')}
[2025-06-06 16:58:00,530.530] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 16:58:00] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 16:58:08,332.332] function_call_agent.py -> _llm_node line:192 [ERROR]: LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\core\agent\agents\function_call_agent.py", line 159, in _llm_node
    for chunk in llm.stream(state["messages"]):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 499, in stream
    for chunk in self._stream(input_messages, stop=stop, **kwargs):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 849, in _stream
    generation_chunk = self._convert_chunk_to_generation_chunk(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 707, in _convert_chunk_to_generation_chunk
    _create_usage_metadata(token_usage) if token_usage else None
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 2808, in _create_usage_metadata
    total_tokens = oai_token_usage.get("total_tokens", input_tokens + output_tokens)
TypeError: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
[2025-06-06 16:58:08,348.348] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 16:58:08,456.456] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:58:08,457.457] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 16:58:08,457.457] base.py -> _exec_single_context line:1901 [INFO]: [cached since 8.429s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 16:58:08,460.460] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 16:58:08,460.460] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00038s] {'pk_1': UUID('2375cccd-d0c1-4a87-90b4-fb0ce48dea22')}
[2025-06-06 16:58:08,465.465] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-06-06 16:58:08,465.465] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00046s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'message_id': UUID('2375cccd-d0c1-4a87-90b4-fb0ce48dea22'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-06-06 16:58:08,472.472] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 16:58:08,475.475] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 16:58:08,475.475] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 16:58:08,476.476] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.959s ago] {'pk_1': UUID('2375cccd-d0c1-4a87-90b4-fb0ce48dea22')}
[2025-06-06 16:58:08,477.477] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET status=%(status)s, error=%(error)s WHERE message.id = %(message_id)s::UUID
[2025-06-06 16:58:08,478.478] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00051s] {'status': <QueueEvent.ERROR: 'error'>, 'error': "LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'", 'message_id': UUID('2375cccd-d0c1-4a87-90b4-fb0ce48dea22')}
[2025-06-06 16:58:08,479.479] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:00:33,387.387] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\assistant_agent_service.py', reloading
[2025-06-06 17:00:33,738.738] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 17:00:39,033.033] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-06-06 17:00:39,036.036] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-06-06 17:00:39,232.232] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-06-06 17:00:39,232.232] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 17:00:39,233.233] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-06-06 17:00:39,233.233] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 17:00:39,234.234] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-06-06 17:00:39,234.234] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 17:00:39,235.235] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:00:39,237.237] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:00:39,237.237] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00043s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:00:39,242.242] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:00:39,242.242] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00030s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 17:00:39,245.245] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 17:00:39,246.246] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00028s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½,AIæ˜¯ä»€ä¹ˆ?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 17:00:39,251.251] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:00:39,297.297] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:00:39] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 17:01:30,936.936] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\core\\memory\\token_buffer_memory.py', reloading
[2025-06-06 17:01:31,259.259] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 17:01:36,571.571] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-06-06 17:01:36,573.573] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-06-06 17:01:48,907.907] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\assistant_agent_service.py', reloading
[2025-06-06 17:01:49,229.229] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 17:01:54,697.697] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-06-06 17:01:54,700.700] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-06-06 17:01:54,928.928] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-06-06 17:01:54,930.930] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 17:01:54,931.931] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-06-06 17:01:54,931.931] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 17:01:54,932.932] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-06-06 17:01:54,932.932] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 17:01:54,932.932] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:01:54,935.935] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:01:54,935.935] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00036s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:01:54,941.941] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:01:54,942.942] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00039s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 17:01:54,946.946] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 17:01:54,946.946] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00045s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½,AIæ˜¯ä»€ä¹ˆ?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 17:01:54,952.952] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:01:54,994.994] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:01:54,995.995] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:01:54,996.996] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00026s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 17:01:54,998.998] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 17:01:54,998.998] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00041s] {'conversation_id_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'answer_1': '', 'param_1': 3, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 17:01:55,002.002] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:01:55,002.002] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00031s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:01:55,361.361] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:01:55,367.367] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00598s] {'pk_1': UUID('2a51cda9-cfc4-442b-9226-625cf1cb33ed')}
[2025-06-06 17:01:55,369.369] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:01:55] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 17:02:03,880.880] function_call_agent.py -> _llm_node line:192 [ERROR]: LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\core\agent\agents\function_call_agent.py", line 159, in _llm_node
    for chunk in llm.stream(state["messages"]):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 499, in stream
    for chunk in self._stream(input_messages, stop=stop, **kwargs):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 849, in _stream
    generation_chunk = self._convert_chunk_to_generation_chunk(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 707, in _convert_chunk_to_generation_chunk
    _create_usage_metadata(token_usage) if token_usage else None
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 2808, in _create_usage_metadata
    total_tokens = oai_token_usage.get("total_tokens", input_tokens + output_tokens)
TypeError: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
[2025-06-06 17:02:03,887.887] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:02:03,995.995] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:02:03,995.995] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:02:03,996.996] base.py -> _exec_single_context line:1901 [INFO]: [cached since 9.054s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 17:02:03,999.999] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:02:04,000.000] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00055s] {'pk_1': UUID('2a51cda9-cfc4-442b-9226-625cf1cb33ed')}
[2025-06-06 17:02:04,004.004] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-06-06 17:02:04,005.005] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00050s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'message_id': UUID('2a51cda9-cfc4-442b-9226-625cf1cb33ed'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-06-06 17:02:04,011.011] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:02:04,013.013] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:02:04,013.013] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:02:04,013.013] base.py -> _exec_single_context line:1901 [INFO]: [cached since 8.653s ago] {'pk_1': UUID('2a51cda9-cfc4-442b-9226-625cf1cb33ed')}
[2025-06-06 17:02:04,015.015] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET status=%(status)s, error=%(error)s WHERE message.id = %(message_id)s::UUID
[2025-06-06 17:02:04,015.015] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00026s] {'status': <QueueEvent.ERROR: 'error'>, 'error': "LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'", 'message_id': UUID('2a51cda9-cfc4-442b-9226-625cf1cb33ed')}
[2025-06-06 17:02:04,016.016] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:04:21,532.532] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\assistant_agent_service.py', reloading
[2025-06-06 17:04:21,876.876] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 17:04:27,170.170] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-06-06 17:04:27,173.173] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-06-06 17:04:27,392.392] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-06-06 17:04:27,393.393] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 17:04:27,394.394] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-06-06 17:04:27,394.394] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 17:04:27,395.395] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-06-06 17:04:27,395.395] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 17:04:27,396.396] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:04:27,398.398] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:04:27,398.398] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00030s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:04:27,405.405] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:04:27,405.405] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00071s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 17:04:27,410.410] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 17:04:27,410.410] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00044s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½,AIæ˜¯ä»€ä¹ˆ?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 17:04:27,417.417] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:04:27,460.460] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:04:27,461.461] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:04:27,461.461] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00033s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 17:04:27,464.464] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 17:04:27,464.464] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00053s] {'conversation_id_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'answer_1': '', 'param_1': 3, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 17:04:27,467.467] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:04:27,468.468] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00048s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:04:27,745.745] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:04:27,750.750] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00576s] {'pk_1': UUID('b4d77508-815e-40d5-82ba-6e629406e13d')}
[2025-06-06 17:04:27,752.752] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:04:27] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 17:04:35,242.242] function_call_agent.py -> _llm_node line:192 [ERROR]: LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\core\agent\agents\function_call_agent.py", line 159, in _llm_node
    for chunk in llm.stream(state["messages"]):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 499, in stream
    for chunk in self._stream(input_messages, stop=stop, **kwargs):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 849, in _stream
    generation_chunk = self._convert_chunk_to_generation_chunk(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 707, in _convert_chunk_to_generation_chunk
    _create_usage_metadata(token_usage) if token_usage else None
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 2808, in _create_usage_metadata
    total_tokens = oai_token_usage.get("total_tokens", input_tokens + output_tokens)
TypeError: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
[2025-06-06 17:04:35,246.246] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:04:35,352.352] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:04:35,353.353] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:04:35,353.353] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.948s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 17:04:35,356.356] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:04:35,356.356] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00031s] {'pk_1': UUID('b4d77508-815e-40d5-82ba-6e629406e13d')}
[2025-06-06 17:04:35,360.360] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-06-06 17:04:35,360.360] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00038s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'message_id': UUID('b4d77508-815e-40d5-82ba-6e629406e13d'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-06-06 17:04:35,366.366] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:04:35,367.367] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:04:35,367.367] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:04:35,368.368] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.623s ago] {'pk_1': UUID('b4d77508-815e-40d5-82ba-6e629406e13d')}
[2025-06-06 17:04:35,369.369] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET status=%(status)s, error=%(error)s WHERE message.id = %(message_id)s::UUID
[2025-06-06 17:04:35,369.369] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00026s] {'status': <QueueEvent.ERROR: 'error'>, 'error': "LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'", 'message_id': UUID('b4d77508-815e-40d5-82ba-6e629406e13d')}
[2025-06-06 17:04:35,370.370] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:08:08,045.045] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:08:08,046.046] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_key.id AS api_key_id, api_key.account_id AS api_key_account_id, api_key.api_key AS api_key_api_key, api_key.is_active AS api_key_is_active, api_key.remark AS api_key_remark, api_key.updated_at AS api_key_updated_at, api_key.created_at AS api_key_created_at 
FROM api_key 
WHERE api_key.api_key = %(api_key_1)s
[2025-06-06 17:08:08,046.046] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00034s] {'api_key_1': 'llmops-v1/alnNVkiLQwjT59qmrzLZWhHvJeXQneGKJpo-T5Pe5LPOfMndm9xS4qzEIQ73cbbw'}
[2025-06-06 17:08:08,054.054] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:08:08,054.054] base.py -> _exec_single_context line:1901 [INFO]: [cached since 220.7s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:08:08,056.056] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:08:08,056.056] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:08:08] "POST /openapi/chat HTTP/1.1" 200 -
[2025-06-06 17:09:09,950.950] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:09:09,950.950] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_key.id AS api_key_id, api_key.account_id AS api_key_account_id, api_key.api_key AS api_key_api_key, api_key.is_active AS api_key_is_active, api_key.remark AS api_key_remark, api_key.updated_at AS api_key_updated_at, api_key.created_at AS api_key_created_at 
FROM api_key 
WHERE api_key.api_key = %(api_key_1)s
[2025-06-06 17:09:09,950.950] base.py -> _exec_single_context line:1901 [INFO]: [cached since 61.9s ago] {'api_key_1': 'llmops-v1/alnNVkiLQwjT59qmrzLZWhHvJeXQneGKJpo-T5Pe5LPOfMndm9xS4qzEIQ73cbbw'}
[2025-06-06 17:09:09,953.953] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:09:09,953.953] base.py -> _exec_single_context line:1901 [INFO]: [cached since 282.6s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:09:09,954.954] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:09:09,954.954] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:09:09] "POST /openapi/chat HTTP/1.1" 200 -
[2025-06-06 17:09:26,804.804] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:09:26,804.804] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_key.id AS api_key_id, api_key.account_id AS api_key_account_id, api_key.api_key AS api_key_api_key, api_key.is_active AS api_key_is_active, api_key.remark AS api_key_remark, api_key.updated_at AS api_key_updated_at, api_key.created_at AS api_key_created_at 
FROM api_key 
WHERE api_key.api_key = %(api_key_1)s
[2025-06-06 17:09:26,805.805] base.py -> _exec_single_context line:1901 [INFO]: [cached since 78.76s ago] {'api_key_1': 'llmops-v1/alnNVkiLQwjT59qmrzLZWhHvJeXQneGKJpo-T5Pe5LPOfMndm9xS4qzEIQ73cbbw'}
[2025-06-06 17:09:26,806.806] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:09:26,807.807] base.py -> _exec_single_context line:1901 [INFO]: [cached since 299.4s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:09:26,809.809] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:09:26,809.809] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00030s] {'pk_1': '4e929f64-66bf-4718-9637-fa7f12b4d804'}
[2025-06-06 17:09:26,811.811] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\openapi_handler.py", line 23, in chat
    resp = self.openapi_service.chat(req, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\openapi_service.py", line 47, in chat
    raise NotFoundException("è¯¥åº”ç”¨ä¸å­˜åœ¨æˆ–æœªå‘å¸ƒï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.NotFoundException
[2025-06-06 17:09:26,814.814] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:09:26,815.815] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:09:26] "POST /openapi/chat HTTP/1.1" 200 -
[2025-06-06 17:09:41,619.619] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:09:41,620.620] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_key.id AS api_key_id, api_key.account_id AS api_key_account_id, api_key.api_key AS api_key_api_key, api_key.is_active AS api_key_is_active, api_key.remark AS api_key_remark, api_key.updated_at AS api_key_updated_at, api_key.created_at AS api_key_created_at 
FROM api_key 
WHERE api_key.api_key = %(api_key_1)s
[2025-06-06 17:09:41,620.620] base.py -> _exec_single_context line:1901 [INFO]: [cached since 93.57s ago] {'api_key_1': 'llmops-v1/alnNVkiLQwjT59qmrzLZWhHvJeXQneGKJpo-T5Pe5LPOfMndm9xS4qzEIQ73cbbw'}
[2025-06-06 17:09:41,621.621] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:09:41,622.622] base.py -> _exec_single_context line:1901 [INFO]: [cached since 314.2s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:09:41,623.623] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:09:41,623.623] base.py -> _exec_single_context line:1901 [INFO]: [cached since 14.81s ago] {'pk_1': '05519640-8a7f-4606-bb09-cc3ca8948407'}
[2025-06-06 17:09:41,625.625] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\openapi_handler.py", line 23, in chat
    resp = self.openapi_service.chat(req, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\openapi_service.py", line 47, in chat
    raise NotFoundException("è¯¥åº”ç”¨ä¸å­˜åœ¨æˆ–æœªå‘å¸ƒï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.NotFoundException
[2025-06-06 17:09:41,626.626] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:09:41,627.627] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:09:41] "POST /openapi/chat HTTP/1.1" 200 -
[2025-06-06 17:09:53,491.491] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:09:53,492.492] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_key.id AS api_key_id, api_key.account_id AS api_key_account_id, api_key.api_key AS api_key_api_key, api_key.is_active AS api_key_is_active, api_key.remark AS api_key_remark, api_key.updated_at AS api_key_updated_at, api_key.created_at AS api_key_created_at 
FROM api_key 
WHERE api_key.api_key = %(api_key_1)s
[2025-06-06 17:09:53,492.492] base.py -> _exec_single_context line:1901 [INFO]: [cached since 105.4s ago] {'api_key_1': 'llmops-v1/alnNVkiLQwjT59qmrzLZWhHvJeXQneGKJpo-T5Pe5LPOfMndm9xS4qzEIQ73cbbw'}
[2025-06-06 17:09:53,493.493] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:09:53,493.493] base.py -> _exec_single_context line:1901 [INFO]: [cached since 326.1s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:09:53,494.494] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:09:53,495.495] base.py -> _exec_single_context line:1901 [INFO]: [cached since 26.69s ago] {'pk_1': '83040ed9-0795-43db-99da-b6eb2321a71b'}
[2025-06-06 17:09:53,496.496] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO end_user (tenant_id, app_id) VALUES (%(tenant_id)s::UUID, %(app_id)s::UUID) RETURNING end_user.id, end_user.updated_at, end_user.created_at
[2025-06-06 17:09:53,497.497] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00043s] {'tenant_id': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:09:53,500.500] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:09:53,501.501] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:09:53,501.501] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:09:53,502.502] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00023s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:09:53,503.503] base.py -> _exec_single_context line:1896 [INFO]: SELECT end_user.id AS end_user_id, end_user.tenant_id AS end_user_tenant_id, end_user.app_id AS end_user_app_id, end_user.updated_at AS end_user_updated_at, end_user.created_at AS end_user_created_at 
FROM end_user 
WHERE end_user.id = %(pk_1)s::UUID
[2025-06-06 17:09:53,503.503] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00025s] {'pk_1': UUID('9f51a3df-3e07-4f8d-baa9-a09680ac0e27')}
[2025-06-06 17:09:53,505.505] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO conversation (app_id, name, invoke_from, created_by) VALUES (%(app_id)s::UUID, %(name)s, %(invoke_from)s, %(created_by)s::UUID) RETURNING conversation.id, conversation.summary, conversation.is_pinned, conversation.is_deleted, conversation.updated_at, conversation.created_at
[2025-06-06 17:09:53,505.505] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00026s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'name': 'New Conversation', 'invoke_from': <InvokeFrom.SERVICE_API: 'service_api'>, 'created_by': UUID('9f51a3df-3e07-4f8d-baa9-a09680ac0e27')}
[2025-06-06 17:09:53,507.507] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:09:53,508.508] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:09:53,509.509] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:09:53,509.509] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.007498s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:09:53,512.512] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config.id AS app_config_id, app_config.app_id AS app_config_app_id, app_config.model_config AS app_config_model_config, app_config.dialog_round AS app_config_dialog_round, app_config.preset_prompt AS app_config_preset_prompt, app_config.tools AS app_config_tools, app_config.workflows AS app_config_workflows, app_config.retrieval_config AS app_config_retrieval_config, app_config.long_term_memory AS app_config_long_term_memory, app_config.opening_statement AS app_config_opening_statement, app_config.opening_questions AS app_config_opening_questions, app_config.speech_to_text AS app_config_speech_to_text, app_config.text_to_speech AS app_config_text_to_speech, app_config.suggested_after_answer AS app_config_suggested_after_answer, app_config.review_config AS app_config_review_config, app_config.updated_at AS app_config_updated_at, app_config.created_at AS app_config_created_at 
FROM app_config 
WHERE app_config.id = %(pk_1)s::UUID
[2025-06-06 17:09:53,513.513] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00041s] {'pk_1': UUID('f6e0a072-f9e7-4b23-837e-281d1084df58')}
[2025-06-06 17:09:53,516.516] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_dataset_join.id AS app_dataset_join_id, app_dataset_join.app_id AS app_dataset_join_app_id, app_dataset_join.dataset_id AS app_dataset_join_dataset_id, app_dataset_join.updated_at AS app_dataset_join_updated_at, app_dataset_join.created_at AS app_dataset_join_created_at 
FROM app_dataset_join 
WHERE app_dataset_join.app_id = %(app_id_1)s::UUID
[2025-06-06 17:09:53,517.517] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00032s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:09:53,520.520] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-06-06 17:09:53,520.520] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00035s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-06-06 17:09:53,522.522] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:09:53,522.522] base.py -> _exec_single_context line:1901 [INFO]: [cached since 326.1s ago] {'pk_1': UUID('57f0b229-c957-4234-a7af-4b48b4f72bfe')}
[2025-06-06 17:09:53,523.523] base.py -> _exec_single_context line:1896 [INFO]: SELECT end_user.id AS end_user_id, end_user.tenant_id AS end_user_tenant_id, end_user.app_id AS end_user_app_id, end_user.updated_at AS end_user_updated_at, end_user.created_at AS end_user_created_at 
FROM end_user 
WHERE end_user.id = %(pk_1)s::UUID
[2025-06-06 17:09:53,523.523] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02035s ago] {'pk_1': UUID('9f51a3df-3e07-4f8d-baa9-a09680ac0e27')}
[2025-06-06 17:09:53,524.524] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 17:09:53,524.524] base.py -> _exec_single_context line:1901 [INFO]: [cached since 326.1s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('57f0b229-c957-4234-a7af-4b48b4f72bfe'), 'invoke_from': <InvokeFrom.SERVICE_API: 'service_api'>, 'created_by': UUID('9f51a3df-3e07-4f8d-baa9-a09680ac0e27'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 17:09:53,526.526] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:09:53,569.569] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:09:53,569.569] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:09:53,569.569] base.py -> _exec_single_context line:1901 [INFO]: [cached since 326.1s ago] {'pk_1': UUID('57f0b229-c957-4234-a7af-4b48b4f72bfe')}
[2025-06-06 17:09:53,571.571] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 17:09:53,571.571] base.py -> _exec_single_context line:1901 [INFO]: [cached since 326.1s ago] {'conversation_id_1': UUID('57f0b229-c957-4234-a7af-4b48b4f72bfe'), 'answer_1': '', 'param_1': 10, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 17:09:53,572.572] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:09:53,572.572] base.py -> _exec_single_context line:1901 [INFO]: [cached since 326.1s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:10:00,767.767] function_call_agent.py -> _llm_node line:192 [ERROR]: LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\core\agent\agents\function_call_agent.py", line 159, in _llm_node
    for chunk in llm.stream(state["messages"]):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\runnables\base.py", line 5607, in stream
    yield from self.bound.stream(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 499, in stream
    for chunk in self._stream(input_messages, stop=stop, **kwargs):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 849, in _stream
    generation_chunk = self._convert_chunk_to_generation_chunk(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 707, in _convert_chunk_to_generation_chunk
    _create_usage_metadata(token_usage) if token_usage else None
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 2808, in _create_usage_metadata
    total_tokens = oai_token_usage.get("total_tokens", input_tokens + output_tokens)
TypeError: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
[2025-06-06 17:10:00,772.772] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:10:00,772.772] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.271s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:10:00,773.773] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:10:00,774.774] base.py -> _exec_single_context line:1901 [INFO]: [cached since 333s ago] {'pk_1': UUID('7ba10e34-6e84-47bc-a3f5-a206feb6b56a')}
[2025-06-06 17:10:00,776.776] base.py -> _exec_single_context line:1896 [INFO]: SELECT end_user.id AS end_user_id, end_user.tenant_id AS end_user_tenant_id, end_user.app_id AS end_user_app_id, end_user.updated_at AS end_user_updated_at, end_user.created_at AS end_user_created_at 
FROM end_user 
WHERE end_user.id = %(pk_1)s::UUID
[2025-06-06 17:10:00,776.776] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:10:00,776.776] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.273s ago] {'pk_1': UUID('9f51a3df-3e07-4f8d-baa9-a09680ac0e27')}
[2025-06-06 17:10:00,777.777] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:10:00,778.778] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:10:00,778.778] base.py -> _exec_single_context line:1901 [INFO]: [cached since 333.4s ago] {'pk_1': UUID('57f0b229-c957-4234-a7af-4b48b4f72bfe')}
[2025-06-06 17:10:00,778.778] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:10:00] "POST /openapi/chat HTTP/1.1" 200 -
[2025-06-06 17:10:00,779.779] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:10:00,779.779] base.py -> _exec_single_context line:1901 [INFO]: [cached since 325.4s ago] {'pk_1': UUID('7ba10e34-6e84-47bc-a3f5-a206feb6b56a')}
[2025-06-06 17:10:00,780.780] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET status=%(status)s, error=%(error)s WHERE message.id = %(message_id)s::UUID
[2025-06-06 17:10:00,781.781] base.py -> _exec_single_context line:1901 [INFO]: [cached since 325.4s ago] {'status': <QueueEvent.ERROR: 'error'>, 'error': "LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'", 'message_id': UUID('7ba10e34-6e84-47bc-a3f5-a206feb6b56a')}
[2025-06-06 17:10:00,782.782] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:11:22,171.171] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:11:22,171.171] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_key.id AS api_key_id, api_key.account_id AS api_key_account_id, api_key.api_key AS api_key_api_key, api_key.is_active AS api_key_is_active, api_key.remark AS api_key_remark, api_key.updated_at AS api_key_updated_at, api_key.created_at AS api_key_created_at 
FROM api_key 
WHERE api_key.api_key = %(api_key_1)s
[2025-06-06 17:11:22,172.172] base.py -> _exec_single_context line:1901 [INFO]: [cached since 194.1s ago] {'api_key_1': 'llmops-v1/alnNVkiLQwjT59qmrzLZWhHvJeXQneGKJpo-T5Pe5LPOfMndm9xS4qzEIQ73cbbw'}
[2025-06-06 17:11:22,173.173] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:11:22,173.173] base.py -> _exec_single_context line:1901 [INFO]: [cached since 414.8s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:11:22,174.174] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:11:22,175.175] base.py -> _exec_single_context line:1901 [INFO]: [cached since 115.4s ago] {'pk_1': '83040ed9-0795-43db-99da-b6eb2321a71b'}
[2025-06-06 17:11:22,175.175] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO end_user (tenant_id, app_id) VALUES (%(tenant_id)s::UUID, %(app_id)s::UUID) RETURNING end_user.id, end_user.updated_at, end_user.created_at
[2025-06-06 17:11:22,176.176] base.py -> _exec_single_context line:1901 [INFO]: [cached since 88.68s ago] {'tenant_id': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:11:22,177.177] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:11:22,179.179] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:11:22,179.179] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:11:22,179.179] base.py -> _exec_single_context line:1901 [INFO]: [cached since 88.68s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:11:22,181.181] base.py -> _exec_single_context line:1896 [INFO]: SELECT end_user.id AS end_user_id, end_user.tenant_id AS end_user_tenant_id, end_user.app_id AS end_user_app_id, end_user.updated_at AS end_user_updated_at, end_user.created_at AS end_user_created_at 
FROM end_user 
WHERE end_user.id = %(pk_1)s::UUID
[2025-06-06 17:11:22,181.181] base.py -> _exec_single_context line:1901 [INFO]: [cached since 88.68s ago] {'pk_1': UUID('e6530c97-b79b-48aa-a4e6-f8a0e994d63c')}
[2025-06-06 17:11:22,182.182] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO conversation (app_id, name, invoke_from, created_by) VALUES (%(app_id)s::UUID, %(name)s, %(invoke_from)s, %(created_by)s::UUID) RETURNING conversation.id, conversation.summary, conversation.is_pinned, conversation.is_deleted, conversation.updated_at, conversation.created_at
[2025-06-06 17:11:22,182.182] base.py -> _exec_single_context line:1901 [INFO]: [cached since 88.68s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'name': 'New Conversation', 'invoke_from': <InvokeFrom.SERVICE_API: 'service_api'>, 'created_by': UUID('e6530c97-b79b-48aa-a4e6-f8a0e994d63c')}
[2025-06-06 17:11:22,184.184] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:11:22,185.185] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:11:22,186.186] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:11:22,186.186] base.py -> _exec_single_context line:1901 [INFO]: [cached since 88.68s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:11:22,187.187] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config.id AS app_config_id, app_config.app_id AS app_config_app_id, app_config.model_config AS app_config_model_config, app_config.dialog_round AS app_config_dialog_round, app_config.preset_prompt AS app_config_preset_prompt, app_config.tools AS app_config_tools, app_config.workflows AS app_config_workflows, app_config.retrieval_config AS app_config_retrieval_config, app_config.long_term_memory AS app_config_long_term_memory, app_config.opening_statement AS app_config_opening_statement, app_config.opening_questions AS app_config_opening_questions, app_config.speech_to_text AS app_config_speech_to_text, app_config.text_to_speech AS app_config_text_to_speech, app_config.suggested_after_answer AS app_config_suggested_after_answer, app_config.review_config AS app_config_review_config, app_config.updated_at AS app_config_updated_at, app_config.created_at AS app_config_created_at 
FROM app_config 
WHERE app_config.id = %(pk_1)s::UUID
[2025-06-06 17:11:22,187.187] base.py -> _exec_single_context line:1901 [INFO]: [cached since 88.67s ago] {'pk_1': UUID('f6e0a072-f9e7-4b23-837e-281d1084df58')}
[2025-06-06 17:11:22,189.189] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_dataset_join.id AS app_dataset_join_id, app_dataset_join.app_id AS app_dataset_join_app_id, app_dataset_join.dataset_id AS app_dataset_join_dataset_id, app_dataset_join.updated_at AS app_dataset_join_updated_at, app_dataset_join.created_at AS app_dataset_join_created_at 
FROM app_dataset_join 
WHERE app_dataset_join.app_id = %(app_id_1)s::UUID
[2025-06-06 17:11:22,189.189] base.py -> _exec_single_context line:1901 [INFO]: [cached since 88.67s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:11:22,190.190] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-06-06 17:11:22,191.191] base.py -> _exec_single_context line:1901 [INFO]: [cached since 88.67s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-06-06 17:11:22,192.192] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:11:22,192.192] base.py -> _exec_single_context line:1901 [INFO]: [cached since 414.7s ago] {'pk_1': UUID('bfaa1ae6-7102-436b-8a52-e1f7e599f365')}
[2025-06-06 17:11:22,193.193] base.py -> _exec_single_context line:1896 [INFO]: SELECT end_user.id AS end_user_id, end_user.tenant_id AS end_user_tenant_id, end_user.app_id AS end_user_app_id, end_user.updated_at AS end_user_updated_at, end_user.created_at AS end_user_created_at 
FROM end_user 
WHERE end_user.id = %(pk_1)s::UUID
[2025-06-06 17:11:22,193.193] base.py -> _exec_single_context line:1901 [INFO]: [cached since 88.69s ago] {'pk_1': UUID('e6530c97-b79b-48aa-a4e6-f8a0e994d63c')}
[2025-06-06 17:11:22,194.194] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 17:11:22,194.194] base.py -> _exec_single_context line:1901 [INFO]: [cached since 414.8s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('bfaa1ae6-7102-436b-8a52-e1f7e599f365'), 'invoke_from': <InvokeFrom.SERVICE_API: 'service_api'>, 'created_by': UUID('e6530c97-b79b-48aa-a4e6-f8a0e994d63c'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 17:11:22,195.195] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:11:22,239.239] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:11:22,239.239] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:11:22,240.240] base.py -> _exec_single_context line:1901 [INFO]: [cached since 414.8s ago] {'pk_1': UUID('bfaa1ae6-7102-436b-8a52-e1f7e599f365')}
[2025-06-06 17:11:22,241.241] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 17:11:22,241.241] base.py -> _exec_single_context line:1901 [INFO]: [cached since 414.8s ago] {'conversation_id_1': UUID('bfaa1ae6-7102-436b-8a52-e1f7e599f365'), 'answer_1': '', 'param_1': 10, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 17:11:22,243.243] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:11:22,243.243] base.py -> _exec_single_context line:1901 [INFO]: [cached since 414.8s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:11:22,338.338] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\embeddings_service.py', reloading
[2025-06-06 17:11:22,756.756] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 17:12:12,896.896] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-06-06 17:12:12,918.918] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-06-06 17:12:14,472.472] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-06-06 17:12:14,472.472] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 17:12:14,474.474] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-06-06 17:12:14,474.474] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 17:12:14,475.475] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-06-06 17:12:14,476.476] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 17:12:14,476.476] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:12:14,479.479] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_key.id AS api_key_id, api_key.account_id AS api_key_account_id, api_key.api_key AS api_key_api_key, api_key.is_active AS api_key_is_active, api_key.remark AS api_key_remark, api_key.updated_at AS api_key_updated_at, api_key.created_at AS api_key_created_at 
FROM api_key 
WHERE api_key.api_key = %(api_key_1)s
[2025-06-06 17:12:14,479.479] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00031s] {'api_key_1': 'llmops-v1/alnNVkiLQwjT59qmrzLZWhHvJeXQneGKJpo-T5Pe5LPOfMndm9xS4qzEIQ73cbbw'}
[2025-06-06 17:12:14,485.485] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:12:14,486.486] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00037s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:12:14,495.495] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:12:14,495.495] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00045s] {'pk_1': '83040ed9-0795-43db-99da-b6eb2321a71b'}
[2025-06-06 17:12:14,498.498] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO end_user (tenant_id, app_id) VALUES (%(tenant_id)s::UUID, %(app_id)s::UUID) RETURNING end_user.id, end_user.updated_at, end_user.created_at
[2025-06-06 17:12:14,498.498] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00028s] {'tenant_id': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:12:14,514.514] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:12:14,516.516] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:12:14,517.517] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:12:14,517.517] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00033s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:12:14,519.519] base.py -> _exec_single_context line:1896 [INFO]: SELECT end_user.id AS end_user_id, end_user.tenant_id AS end_user_tenant_id, end_user.app_id AS end_user_app_id, end_user.updated_at AS end_user_updated_at, end_user.created_at AS end_user_created_at 
FROM end_user 
WHERE end_user.id = %(pk_1)s::UUID
[2025-06-06 17:12:14,519.519] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00039s] {'pk_1': UUID('a08ee8e8-b767-410d-8e52-d772aab7e450')}
[2025-06-06 17:12:14,522.522] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO conversation (app_id, name, invoke_from, created_by) VALUES (%(app_id)s::UUID, %(name)s, %(invoke_from)s, %(created_by)s::UUID) RETURNING conversation.id, conversation.summary, conversation.is_pinned, conversation.is_deleted, conversation.updated_at, conversation.created_at
[2025-06-06 17:12:14,522.522] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00030s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'name': 'New Conversation', 'invoke_from': <InvokeFrom.SERVICE_API: 'service_api'>, 'created_by': UUID('a08ee8e8-b767-410d-8e52-d772aab7e450')}
[2025-06-06 17:12:14,525.525] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:12:14,526.526] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:12:14,526.526] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:12:14,526.526] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.009684s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:12:14,529.529] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config.id AS app_config_id, app_config.app_id AS app_config_app_id, app_config.model_config AS app_config_model_config, app_config.dialog_round AS app_config_dialog_round, app_config.preset_prompt AS app_config_preset_prompt, app_config.tools AS app_config_tools, app_config.workflows AS app_config_workflows, app_config.retrieval_config AS app_config_retrieval_config, app_config.long_term_memory AS app_config_long_term_memory, app_config.opening_statement AS app_config_opening_statement, app_config.opening_questions AS app_config_opening_questions, app_config.speech_to_text AS app_config_speech_to_text, app_config.text_to_speech AS app_config_text_to_speech, app_config.suggested_after_answer AS app_config_suggested_after_answer, app_config.review_config AS app_config_review_config, app_config.updated_at AS app_config_updated_at, app_config.created_at AS app_config_created_at 
FROM app_config 
WHERE app_config.id = %(pk_1)s::UUID
[2025-06-06 17:12:14,529.529] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00028s] {'pk_1': UUID('f6e0a072-f9e7-4b23-837e-281d1084df58')}
[2025-06-06 17:12:14,533.533] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_dataset_join.id AS app_dataset_join_id, app_dataset_join.app_id AS app_dataset_join_app_id, app_dataset_join.dataset_id AS app_dataset_join_dataset_id, app_dataset_join.updated_at AS app_dataset_join_updated_at, app_dataset_join.created_at AS app_dataset_join_created_at 
FROM app_dataset_join 
WHERE app_dataset_join.app_id = %(app_id_1)s::UUID
[2025-06-06 17:12:14,533.533] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00036s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:12:14,537.537] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-06-06 17:12:14,537.537] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00039s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-06-06 17:12:14,539.539] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:12:14,540.540] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00084s] {'pk_1': UUID('1b265fe4-6d60-4949-aee8-c31cda015b90')}
[2025-06-06 17:12:14,542.542] base.py -> _exec_single_context line:1896 [INFO]: SELECT end_user.id AS end_user_id, end_user.tenant_id AS end_user_tenant_id, end_user.app_id AS end_user_app_id, end_user.updated_at AS end_user_updated_at, end_user.created_at AS end_user_created_at 
FROM end_user 
WHERE end_user.id = %(pk_1)s::UUID
[2025-06-06 17:12:14,542.542] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02311s ago] {'pk_1': UUID('a08ee8e8-b767-410d-8e52-d772aab7e450')}
[2025-06-06 17:12:14,544.544] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 17:12:14,544.544] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00030s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('1b265fe4-6d60-4949-aee8-c31cda015b90'), 'invoke_from': <InvokeFrom.SERVICE_API: 'service_api'>, 'created_by': UUID('a08ee8e8-b767-410d-8e52-d772aab7e450'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 17:12:14,548.548] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:12:14,608.608] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:12:14,608.608] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:12:14,608.608] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.06894s ago] {'pk_1': UUID('1b265fe4-6d60-4949-aee8-c31cda015b90')}
[2025-06-06 17:12:14,611.611] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 17:12:14,611.611] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00032s] {'conversation_id_1': UUID('1b265fe4-6d60-4949-aee8-c31cda015b90'), 'answer_1': '', 'param_1': 10, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 17:12:14,615.615] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:12:14,615.615] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00049s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:12:22,016.016] function_call_agent.py -> _llm_node line:192 [ERROR]: LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\core\agent\agents\function_call_agent.py", line 159, in _llm_node
    for chunk in llm.stream(state["messages"]):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\runnables\base.py", line 5607, in stream
    yield from self.bound.stream(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 499, in stream
    for chunk in self._stream(input_messages, stop=stop, **kwargs):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 849, in _stream
    generation_chunk = self._convert_chunk_to_generation_chunk(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 707, in _convert_chunk_to_generation_chunk
    _create_usage_metadata(token_usage) if token_usage else None
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 2808, in _create_usage_metadata
    total_tokens = oai_token_usage.get("total_tokens", input_tokens + output_tokens)
TypeError: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
[2025-06-06 17:12:22,021.021] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:12:22,021.021] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.505s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:12:22,024.024] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:12:22,025.025] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00046s] {'pk_1': UUID('f47c8860-e063-4673-a40d-604544234416')}
[2025-06-06 17:12:22,027.027] base.py -> _exec_single_context line:1896 [INFO]: SELECT end_user.id AS end_user_id, end_user.tenant_id AS end_user_tenant_id, end_user.app_id AS end_user_app_id, end_user.updated_at AS end_user_updated_at, end_user.created_at AS end_user_created_at 
FROM end_user 
WHERE end_user.id = %(pk_1)s::UUID
[2025-06-06 17:12:22,028.028] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.509s ago] {'pk_1': UUID('a08ee8e8-b767-410d-8e52-d772aab7e450')}
[2025-06-06 17:12:22,030.030] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:12:22,031.031] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:12:22] "POST /openapi/chat HTTP/1.1" 200 -
[2025-06-06 17:12:22,121.121] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:12:22,122.122] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:12:22,122.122] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00035s] {'pk_1': UUID('1b265fe4-6d60-4949-aee8-c31cda015b90')}
[2025-06-06 17:12:22,125.125] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:12:22,126.126] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00037s] {'pk_1': UUID('f47c8860-e063-4673-a40d-604544234416')}
[2025-06-06 17:12:22,130.130] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-06-06 17:12:22,130.130] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00054s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('1b265fe4-6d60-4949-aee8-c31cda015b90'), 'message_id': UUID('f47c8860-e063-4673-a40d-604544234416'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-06-06 17:12:22,136.136] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:12:22,138.138] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:12:22,138.138] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:12:22,138.138] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.1148s ago] {'pk_1': UUID('f47c8860-e063-4673-a40d-604544234416')}
[2025-06-06 17:12:22,140.140] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET status=%(status)s, error=%(error)s WHERE message.id = %(message_id)s::UUID
[2025-06-06 17:12:22,140.140] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00028s] {'status': <QueueEvent.ERROR: 'error'>, 'error': "LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'", 'message_id': UUID('f47c8860-e063-4673-a40d-604544234416')}
[2025-06-06 17:12:22,143.143] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:12:28,638.638] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:12:28,639.639] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_key.id AS api_key_id, api_key.account_id AS api_key_account_id, api_key.api_key AS api_key_api_key, api_key.is_active AS api_key_is_active, api_key.remark AS api_key_remark, api_key.updated_at AS api_key_updated_at, api_key.created_at AS api_key_created_at 
FROM api_key 
WHERE api_key.api_key = %(api_key_1)s
[2025-06-06 17:12:28,639.639] base.py -> _exec_single_context line:1901 [INFO]: [cached since 14.16s ago] {'api_key_1': 'llmops-v1/alnNVkiLQwjT59qmrzLZWhHvJeXQneGKJpo-T5Pe5LPOfMndm9xS4qzEIQ73cbbw'}
[2025-06-06 17:12:28,642.642] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:12:28,642.642] base.py -> _exec_single_context line:1901 [INFO]: [cached since 14.16s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:12:28,644.644] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:12:28,644.644] base.py -> _exec_single_context line:1901 [INFO]: [cached since 14.15s ago] {'pk_1': '83040ed9-0795-43db-99da-b6eb2321a71b'}
[2025-06-06 17:12:28,646.646] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO end_user (tenant_id, app_id) VALUES (%(tenant_id)s::UUID, %(app_id)s::UUID) RETURNING end_user.id, end_user.updated_at, end_user.created_at
[2025-06-06 17:12:28,646.646] base.py -> _exec_single_context line:1901 [INFO]: [cached since 14.15s ago] {'tenant_id': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:12:28,648.648] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:12:28,649.649] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:12:28,649.649] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:12:28,650.650] base.py -> _exec_single_context line:1901 [INFO]: [cached since 14.13s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:12:28,651.651] base.py -> _exec_single_context line:1896 [INFO]: SELECT end_user.id AS end_user_id, end_user.tenant_id AS end_user_tenant_id, end_user.app_id AS end_user_app_id, end_user.updated_at AS end_user_updated_at, end_user.created_at AS end_user_created_at 
FROM end_user 
WHERE end_user.id = %(pk_1)s::UUID
[2025-06-06 17:12:28,651.651] base.py -> _exec_single_context line:1901 [INFO]: [cached since 14.13s ago] {'pk_1': UUID('36ec0c80-0f65-4239-bf2a-15c6d47ceba6')}
[2025-06-06 17:12:28,652.652] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO conversation (app_id, name, invoke_from, created_by) VALUES (%(app_id)s::UUID, %(name)s, %(invoke_from)s, %(created_by)s::UUID) RETURNING conversation.id, conversation.summary, conversation.is_pinned, conversation.is_deleted, conversation.updated_at, conversation.created_at
[2025-06-06 17:12:28,652.652] base.py -> _exec_single_context line:1901 [INFO]: [cached since 14.13s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'name': 'New Conversation', 'invoke_from': <InvokeFrom.SERVICE_API: 'service_api'>, 'created_by': UUID('36ec0c80-0f65-4239-bf2a-15c6d47ceba6')}
[2025-06-06 17:12:28,654.654] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:12:28,654.654] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:12:28,655.655] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:12:28,655.655] base.py -> _exec_single_context line:1901 [INFO]: [cached since 14.14s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:12:28,656.656] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config.id AS app_config_id, app_config.app_id AS app_config_app_id, app_config.model_config AS app_config_model_config, app_config.dialog_round AS app_config_dialog_round, app_config.preset_prompt AS app_config_preset_prompt, app_config.tools AS app_config_tools, app_config.workflows AS app_config_workflows, app_config.retrieval_config AS app_config_retrieval_config, app_config.long_term_memory AS app_config_long_term_memory, app_config.opening_statement AS app_config_opening_statement, app_config.opening_questions AS app_config_opening_questions, app_config.speech_to_text AS app_config_speech_to_text, app_config.text_to_speech AS app_config_text_to_speech, app_config.suggested_after_answer AS app_config_suggested_after_answer, app_config.review_config AS app_config_review_config, app_config.updated_at AS app_config_updated_at, app_config.created_at AS app_config_created_at 
FROM app_config 
WHERE app_config.id = %(pk_1)s::UUID
[2025-06-06 17:12:28,656.656] base.py -> _exec_single_context line:1901 [INFO]: [cached since 14.13s ago] {'pk_1': UUID('f6e0a072-f9e7-4b23-837e-281d1084df58')}
[2025-06-06 17:12:28,658.658] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_dataset_join.id AS app_dataset_join_id, app_dataset_join.app_id AS app_dataset_join_app_id, app_dataset_join.dataset_id AS app_dataset_join_dataset_id, app_dataset_join.updated_at AS app_dataset_join_updated_at, app_dataset_join.created_at AS app_dataset_join_created_at 
FROM app_dataset_join 
WHERE app_dataset_join.app_id = %(app_id_1)s::UUID
[2025-06-06 17:12:28,658.658] base.py -> _exec_single_context line:1901 [INFO]: [cached since 14.12s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:12:28,660.660] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-06-06 17:12:28,660.660] base.py -> _exec_single_context line:1901 [INFO]: [cached since 14.12s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-06-06 17:12:28,661.661] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:12:28,662.662] base.py -> _exec_single_context line:1901 [INFO]: [cached since 14.12s ago] {'pk_1': UUID('9b62a054-dbd4-4cc4-a812-eef6c5e0fd23')}
[2025-06-06 17:12:28,662.662] base.py -> _exec_single_context line:1896 [INFO]: SELECT end_user.id AS end_user_id, end_user.tenant_id AS end_user_tenant_id, end_user.app_id AS end_user_app_id, end_user.updated_at AS end_user_updated_at, end_user.created_at AS end_user_created_at 
FROM end_user 
WHERE end_user.id = %(pk_1)s::UUID
[2025-06-06 17:12:28,663.663] base.py -> _exec_single_context line:1901 [INFO]: [cached since 14.14s ago] {'pk_1': UUID('36ec0c80-0f65-4239-bf2a-15c6d47ceba6')}
[2025-06-06 17:12:28,664.664] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 17:12:28,664.664] base.py -> _exec_single_context line:1901 [INFO]: [cached since 14.12s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('9b62a054-dbd4-4cc4-a812-eef6c5e0fd23'), 'invoke_from': <InvokeFrom.SERVICE_API: 'service_api'>, 'created_by': UUID('36ec0c80-0f65-4239-bf2a-15c6d47ceba6'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 17:12:28,666.666] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:12:28,708.708] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:12:28,709.709] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:12:28,709.709] base.py -> _exec_single_context line:1901 [INFO]: [cached since 14.17s ago] {'pk_1': UUID('9b62a054-dbd4-4cc4-a812-eef6c5e0fd23')}
[2025-06-06 17:12:28,710.710] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 17:12:28,711.711] base.py -> _exec_single_context line:1901 [INFO]: [cached since 14.1s ago] {'conversation_id_1': UUID('9b62a054-dbd4-4cc4-a812-eef6c5e0fd23'), 'answer_1': '', 'param_1': 10, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 17:12:28,712.712] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:12:28,712.712] base.py -> _exec_single_context line:1901 [INFO]: [cached since 14.1s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:12:35,927.927] function_call_agent.py -> _llm_node line:192 [ERROR]: LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\core\agent\agents\function_call_agent.py", line 159, in _llm_node
    for chunk in llm.stream(state["messages"]):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\runnables\base.py", line 5607, in stream
    yield from self.bound.stream(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 499, in stream
    for chunk in self._stream(input_messages, stop=stop, **kwargs):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 849, in _stream
    generation_chunk = self._convert_chunk_to_generation_chunk(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 707, in _convert_chunk_to_generation_chunk
    _create_usage_metadata(token_usage) if token_usage else None
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 2808, in _create_usage_metadata
    total_tokens = oai_token_usage.get("total_tokens", input_tokens + output_tokens)
TypeError: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
[2025-06-06 17:12:35,930.930] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:12:35,931.931] base.py -> _exec_single_context line:1901 [INFO]: [cached since 21.41s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:12:35,932.932] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:12:35,932.932] base.py -> _exec_single_context line:1901 [INFO]: [cached since 13.91s ago] {'pk_1': UUID('e97ce5af-47d2-4fc5-9615-6028dd591871')}
[2025-06-06 17:12:35,934.934] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:12:35,935.935] base.py -> _exec_single_context line:1896 [INFO]: SELECT end_user.id AS end_user_id, end_user.tenant_id AS end_user_tenant_id, end_user.app_id AS end_user_app_id, end_user.updated_at AS end_user_updated_at, end_user.created_at AS end_user_created_at 
FROM end_user 
WHERE end_user.id = %(pk_1)s::UUID
[2025-06-06 17:12:35,935.935] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:12:35,935.935] base.py -> _exec_single_context line:1901 [INFO]: [cached since 21.42s ago] {'pk_1': UUID('36ec0c80-0f65-4239-bf2a-15c6d47ceba6')}
[2025-06-06 17:12:35,936.936] base.py -> _exec_single_context line:1901 [INFO]: [cached since 13.81s ago] {'pk_1': UUID('9b62a054-dbd4-4cc4-a812-eef6c5e0fd23')}
[2025-06-06 17:12:35,937.937] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:12:35,938.938] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:12:35,938.938] base.py -> _exec_single_context line:1901 [INFO]: [cached since 13.81s ago] {'pk_1': UUID('e97ce5af-47d2-4fc5-9615-6028dd591871')}
[2025-06-06 17:12:35,938.938] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:12:35] "POST /openapi/chat HTTP/1.1" 200 -
[2025-06-06 17:12:35,939.939] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET status=%(status)s, error=%(error)s WHERE message.id = %(message_id)s::UUID
[2025-06-06 17:12:35,939.939] base.py -> _exec_single_context line:1901 [INFO]: [cached since 13.8s ago] {'status': <QueueEvent.ERROR: 'error'>, 'error': "LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'", 'message_id': UUID('e97ce5af-47d2-4fc5-9615-6028dd591871')}
[2025-06-06 17:12:35,941.941] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:13:26,898.898] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\embeddings_service.py', reloading
[2025-06-06 17:13:28,444.444] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 17:13:34,769.769] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-06-06 17:13:34,773.773] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-06-06 17:20:22,445.445] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:20:22] "OPTIONS /account HTTP/1.1" 200 -
[2025-06-06 17:20:22,875.875] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-06-06 17:20:22,875.875] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 17:20:22,876.876] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-06-06 17:20:22,876.876] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 17:20:22,877.877] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-06-06 17:20:22,877.877] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 17:20:22,877.877] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:20:22,880.880] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:20:22,880.880] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00053s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:20:22,885.885] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:20:22,886.886] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:20:22] "GET /account HTTP/1.1" 200 -
[2025-06-06 17:20:23,957.957] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:20:23] "OPTIONS /apps?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-06-06 17:20:23,961.961] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:20:23,962.962] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:20:23,962.962] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.082s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:20:23,967.967] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.account_id = %(account_id_1)s::UUID ORDER BY app.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-06-06 17:20:23,968.968] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00062s] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'param_1': 20, 'param_2': 0}
[2025-06-06 17:20:23,973.973] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT app.id AS id, app.account_id AS account_id, app.app_config_id AS app_config_id, app.draft_app_config_id AS draft_app_config_id, app.debug_conversation_id AS debug_conversation_id, app.name AS name, app.icon AS icon, app.description AS description, app.status AS status, app.updated_at AS updated_at, app.created_at AS created_at 
FROM app 
WHERE app.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-06-06 17:20:23,973.973] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00053s] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:20:23,978.978] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:20:23,978.978] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00059s] {'app_id_1': UUID('1dd689e3-ceaa-4adc-b382-298ac0250798'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:20:23,984.984] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:20:23,984.984] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.005988s ago] {'app_id_1': UUID('4e929f64-66bf-4718-9637-fa7f12b4d804'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:20:23,987.987] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:20:23,987.987] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0092s ago] {'app_id_1': UUID('05519640-8a7f-4606-bb09-cc3ca8948407'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:20:23,988.988] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:20:24,000.000] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02214s ago] {'app_id_1': UUID('72072ee8-f80b-47b9-9e66-d5805e0bff79'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:20:24,002.002] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config.id AS app_config_id, app_config.app_id AS app_config_app_id, app_config.model_config AS app_config_model_config, app_config.dialog_round AS app_config_dialog_round, app_config.preset_prompt AS app_config_preset_prompt, app_config.tools AS app_config_tools, app_config.workflows AS app_config_workflows, app_config.retrieval_config AS app_config_retrieval_config, app_config.long_term_memory AS app_config_long_term_memory, app_config.opening_statement AS app_config_opening_statement, app_config.opening_questions AS app_config_opening_questions, app_config.speech_to_text AS app_config_speech_to_text, app_config.text_to_speech AS app_config_text_to_speech, app_config.suggested_after_answer AS app_config_suggested_after_answer, app_config.review_config AS app_config_review_config, app_config.updated_at AS app_config_updated_at, app_config.created_at AS app_config_created_at 
FROM app_config 
WHERE app_config.id = %(pk_1)s::UUID
[2025-06-06 17:20:24,002.002] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00047s] {'pk_1': UUID('f6e0a072-f9e7-4b23-837e-281d1084df58')}
[2025-06-06 17:20:24,008.008] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:20:24,010.010] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:20:24] "GET /apps?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-06-06 17:20:27,834.834] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:20:27] "OPTIONS /builtin-tools/categories HTTP/1.1" 200 -
[2025-06-06 17:20:27,834.834] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:20:27] "OPTIONS /datasets?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-06-06 17:20:27,837.837] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:20:27] "OPTIONS /apps/1dd689e3-ceaa-4adc-b382-298ac0250798/conversations/messages?current_page=1&page_size=5&created_at=0 HTTP/1.1" 200 -
[2025-06-06 17:20:27,838.838] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:20:27] "OPTIONS /apps/1dd689e3-ceaa-4adc-b382-298ac0250798/draft-app-config HTTP/1.1" 200 -
[2025-06-06 17:20:27,840.840] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:20:27] "OPTIONS /apps/1dd689e3-ceaa-4adc-b382-298ac0250798 HTTP/1.1" 200 -
[2025-06-06 17:20:28,142.142] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:20:28,145.145] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:20:28] "GET /builtin-tools/categories HTTP/1.1" 200 -
[2025-06-06 17:20:28,146.146] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:20:28,150.150] base.py -> _exec_single_context line:1901 [INFO]: [cached since 5.27s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:20:28,152.152] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:20:28,154.154] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00133s] {'pk_1': UUID('1dd689e3-ceaa-4adc-b382-298ac0250798')}
[2025-06-06 17:20:28,157.157] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-06-06 17:20:28,157.157] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00057s] {'id_1': UUID('cd6bd620-4275-4e71-a51b-c3d9ae6628fb'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-06-06 17:20:28,161.161] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.status IN (%(status_1_1)s, %(status_1_2)s) AND message.answer != %(answer_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-06-06 17:20:28,162.162] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00051s] {'conversation_id_1': UUID('cd6bd620-4275-4e71-a51b-c3d9ae6628fb'), 'answer_1': '', 'param_1': 5, 'param_2': 0, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 17:20:28,166.166] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT message.id AS id, message.app_id AS app_id, message.conversation_id AS conversation_id, message.invoke_from AS invoke_from, message.created_by AS created_by, message.query AS query, message.message AS message, message.message_token_count AS message_token_count, message.message_unit_price AS message_unit_price, message.message_price_unit AS message_price_unit, message.answer AS answer, message.answer_token_count AS answer_token_count, message.answer_unit_price AS answer_unit_price, message.answer_price_unit AS answer_price_unit, message.latency AS latency, message.is_deleted AS is_deleted, message.status AS status, message.error AS error, message.total_token_count AS total_token_count, message.total_price AS total_price, message.updated_at AS updated_at, message.created_at AS created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.status IN (%(status_1_1)s, %(status_1_2)s) AND message.answer != %(answer_1)s) AS anon_1
[2025-06-06 17:20:28,166.166] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00069s] {'conversation_id_1': UUID('cd6bd620-4275-4e71-a51b-c3d9ae6628fb'), 'answer_1': '', 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 17:20:28,171.171] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:20:28,172.172] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:20:28] "GET /apps/1dd689e3-ceaa-4adc-b382-298ac0250798/conversations/messages?current_page=1&page_size=5&created_at=0 HTTP/1.1" 200 -
[2025-06-06 17:20:28,256.256] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:20:28,256.256] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:20:28,257.257] base.py -> _exec_single_context line:1901 [INFO]: [cached since 5.376s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:20:28,262.262] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.account_id = %(account_id_1)s::UUID ORDER BY dataset.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-06-06 17:20:28,262.262] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00051s] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'param_1': 20, 'param_2': 0}
[2025-06-06 17:20:28,265.265] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT dataset.id AS id, dataset.account_id AS account_id, dataset.name AS name, dataset.icon AS icon, dataset.description AS description, dataset.updated_at AS updated_at, dataset.created_at AS created_at 
FROM dataset 
WHERE dataset.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-06-06 17:20:28,266.266] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00050s] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:20:28,267.267] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,268.268] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00039s] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-06-06 17:20:28,273.273] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,274.274] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00048s] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-06-06 17:20:28,277.277] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,277.277] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00039s] {'coalesce_2': 0, 'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-06-06 17:20:28,279.279] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,280.280] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01205s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-06-06 17:20:28,280.280] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,281.281] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.007141s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-06-06 17:20:28,282.282] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,282.282] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.004974s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-06-06 17:20:28,283.283] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,283.283] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01546s ago] {'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-06-06 17:20:28,284.284] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,284.284] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01044s ago] {'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-06-06 17:20:28,285.285] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,286.286] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.00866s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-06-06 17:20:28,286.286] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,286.286] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01975s ago] {'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-06-06 17:20:28,286.286] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,286.286] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01496s ago] {'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-06-06 17:20:28,286.286] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,290.290] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01285s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-06-06 17:20:28,291.291] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,291.291] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02355s ago] {'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-06-06 17:20:28,291.291] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,291.291] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01851s ago] {'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-06-06 17:20:28,293.293] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,293.293] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01627s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-06-06 17:20:28,294.294] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,294.294] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02672s ago] {'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-06-06 17:20:28,294.294] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,294.294] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0219s ago] {'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-06-06 17:20:28,296.296] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,296.296] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01965s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-06-06 17:20:28,296.296] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,296.296] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03009s ago] {'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-06-06 17:20:28,298.298] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,298.298] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02557s ago] {'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-06-06 17:20:28,298.298] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,298.298] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0234s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-06-06 17:20:28,298.298] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,302.302] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03416s ago] {'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-06-06 17:20:28,302.302] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,303.303] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02928s ago] {'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-06-06 17:20:28,307.307] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,307.307] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03037s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-06-06 17:20:28,308.308] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,308.308] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04103s ago] {'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-06-06 17:20:28,309.309] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,309.309] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03613s ago] {'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-06-06 17:20:28,310.310] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,311.311] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03426s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-06-06 17:20:28,312.312] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,313.313] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04531s ago] {'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-06-06 17:20:28,314.314] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,315.315] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04089s ago] {'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-06-06 17:20:28,316.316] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,316.316] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03895s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-06-06 17:20:28,316.316] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,317.317] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04946s ago] {'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-06-06 17:20:28,318.318] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,318.318] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04469s ago] {'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-06-06 17:20:28,320.320] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,320.320] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04311s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-06-06 17:20:28,320.320] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,320.320] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05404s ago] {'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-06-06 17:20:28,324.324] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,324.324] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05147s ago] {'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-06-06 17:20:28,326.326] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,326.326] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05012s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-06-06 17:20:28,328.328] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,328.328] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.06165s ago] {'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-06-06 17:20:28,330.330] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,330.330] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05749s ago] {'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-06-06 17:20:28,332.332] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,334.334] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05655s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-06-06 17:20:28,335.335] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,335.335] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.06806s ago] {'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-06-06 17:20:28,337.337] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,337.337] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.06398s ago] {'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-06-06 17:20:28,339.339] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,339.339] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.06245s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-06-06 17:20:28,340.340] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,340.340] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.07337s ago] {'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-06-06 17:20:28,341.341] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,342.342] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.06856s ago] {'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-06-06 17:20:28,343.343] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,343.343] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.06647s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-06-06 17:20:28,344.344] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,344.344] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.07714s ago] {'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-06-06 17:20:28,345.345] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,345.345] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.07234s ago] {'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-06-06 17:20:28,346.346] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,347.347] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.07027s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-06-06 17:20:28,349.349] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,349.349] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0814s ago] {'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-06-06 17:20:28,350.350] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,350.350] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.07663s ago] {'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-06-06 17:20:28,351.351] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,352.352] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.07456s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-06-06 17:20:28,353.353] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,353.353] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.08546s ago] {'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-06-06 17:20:28,358.358] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,358.358] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.08468s ago] {'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-06-06 17:20:28,358.358] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,358.358] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.08288s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-06-06 17:20:28,361.361] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,361.361] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.09387s ago] {'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-06-06 17:20:28,363.363] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,363.363] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:20:28,363.363] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.08978s ago] {'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-06-06 17:20:28,363.363] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:20:28,365.365] base.py -> _exec_single_context line:1901 [INFO]: [cached since 5.484s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:20:28,365.365] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,365.365] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.08899s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-06-06 17:20:28,367.367] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,367.367] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.1s ago] {'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-06-06 17:20:28,369.369] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:20:28,369.369] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,369.369] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.2167s ago] {'pk_1': UUID('1dd689e3-ceaa-4adc-b382-298ac0250798')}
[2025-06-06 17:20:28,369.369] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.09619s ago] {'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-06-06 17:20:28,373.373] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:20:28,374.374] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:28,374.374] base.py -> _exec_single_context line:1901 [INFO]: [cached since 4.396s ago] {'app_id_1': UUID('1dd689e3-ceaa-4adc-b382-298ac0250798'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:20:28,374.374] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.09717s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-06-06 17:20:28,376.376] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:20:28,378.378] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (NULL) AND (1 != 1)
[2025-06-06 17:20:28,378.378] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00058s] {}
[2025-06-06 17:20:28,378.378] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:20:28] "GET /datasets?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-06-06 17:20:28,382.382] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:20:28,383.383] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:20:28] "GET /apps/1dd689e3-ceaa-4adc-b382-298ac0250798/draft-app-config HTTP/1.1" 200 -
[2025-06-06 17:20:28,441.441] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:20:28,442.442] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:20:28,443.443] base.py -> _exec_single_context line:1901 [INFO]: [cached since 5.562s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:20:28,446.446] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:20:28,446.446] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.2932s ago] {'pk_1': UUID('1dd689e3-ceaa-4adc-b382-298ac0250798')}
[2025-06-06 17:20:28,448.448] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:20:28,449.449] base.py -> _exec_single_context line:1901 [INFO]: [cached since 4.471s ago] {'app_id_1': UUID('1dd689e3-ceaa-4adc-b382-298ac0250798'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:20:28,452.452] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:20:28,453.453] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:20:28] "GET /apps/1dd689e3-ceaa-4adc-b382-298ac0250798 HTTP/1.1" 200 -
[2025-06-06 17:20:28,753.753] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:20:28] "GET /builtin-tools/google/icon HTTP/1.1" 200 -
[2025-06-06 17:20:32,779.779] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:20:32] "OPTIONS /apps/1dd689e3-ceaa-4adc-b382-298ac0250798/conversations HTTP/1.1" 200 -
[2025-06-06 17:20:33,082.082] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:20:33,082.082] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:20:33,085.085] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.2s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:20:33,087.087] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:20:33,087.087] base.py -> _exec_single_context line:1901 [INFO]: [cached since 4.934s ago] {'pk_1': UUID('1dd689e3-ceaa-4adc-b382-298ac0250798')}
[2025-06-06 17:20:33,088.088] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:20:33,089.089] base.py -> _exec_single_context line:1901 [INFO]: [cached since 9.111s ago] {'app_id_1': UUID('1dd689e3-ceaa-4adc-b382-298ac0250798'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:20:33,090.090] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (NULL) AND (1 != 1)
[2025-06-06 17:20:33,090.090] base.py -> _exec_single_context line:1901 [INFO]: [cached since 4.713s ago] {}
[2025-06-06 17:20:33,092.092] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-06-06 17:20:33,098.098] base.py -> _exec_single_context line:1901 [INFO]: [cached since 4.941s ago] {'id_1': UUID('cd6bd620-4275-4e71-a51b-c3d9ae6628fb'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-06-06 17:20:33,100.100] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 17:20:33,100.100] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00036s] {'app_id': UUID('1dd689e3-ceaa-4adc-b382-298ac0250798'), 'conversation_id': UUID('cd6bd620-4275-4e71-a51b-c3d9ae6628fb'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'è¯·é—®æ‚¨æ‰“ç®—é€‰æ‹©ä»€ä¹ˆæ ·çš„äº¤é€šæ–¹å¼ï¼Ÿ', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 17:20:33,107.107] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:20:33,176.176] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:20:33,177.177] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:20:33,177.177] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00053s] {'pk_1': UUID('cd6bd620-4275-4e71-a51b-c3d9ae6628fb')}
[2025-06-06 17:20:33,182.182] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 17:20:33,182.182] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00050s] {'conversation_id_1': UUID('cd6bd620-4275-4e71-a51b-c3d9ae6628fb'), 'answer_1': '', 'param_1': 3, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 17:20:33,188.188] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:20:33,188.188] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00073s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:20:33,498.498] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:20:33,506.506] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00732s] {'pk_1': UUID('0cca7a8a-7c6a-4432-abec-3d6cc8d290f1')}
[2025-06-06 17:20:33,507.507] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:20:33] "POST /apps/1dd689e3-ceaa-4adc-b382-298ac0250798/conversations HTTP/1.1" 200 -
[2025-06-06 17:20:41,033.033] function_call_agent.py -> _llm_node line:192 [ERROR]: LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\core\agent\agents\function_call_agent.py", line 159, in _llm_node
    for chunk in llm.stream(state["messages"]):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\runnables\base.py", line 5607, in stream
    yield from self.bound.stream(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 499, in stream
    for chunk in self._stream(input_messages, stop=stop, **kwargs):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 849, in _stream
    generation_chunk = self._convert_chunk_to_generation_chunk(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 707, in _convert_chunk_to_generation_chunk
    _create_usage_metadata(token_usage) if token_usage else None
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 2808, in _create_usage_metadata
    total_tokens = oai_token_usage.get("total_tokens", input_tokens + output_tokens)
TypeError: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
[2025-06-06 17:20:41,044.044] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:20:41,044.044] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:20:41,048.048] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:20:41,054.054] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00561s] {'pk_1': UUID('cd6bd620-4275-4e71-a51b-c3d9ae6628fb')}
[2025-06-06 17:20:41,057.057] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:20:41,059.059] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00252s] {'pk_1': UUID('0cca7a8a-7c6a-4432-abec-3d6cc8d290f1')}
[2025-06-06 17:20:41,064.064] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-06-06 17:20:41,066.066] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00236s] {'app_id': UUID('1dd689e3-ceaa-4adc-b382-298ac0250798'), 'conversation_id': UUID('cd6bd620-4275-4e71-a51b-c3d9ae6628fb'), 'message_id': UUID('0cca7a8a-7c6a-4432-abec-3d6cc8d290f1'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-06-06 17:20:41,073.073] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:20:41,075.075] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:20:41,076.076] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:20:41,076.076] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.577s ago] {'pk_1': UUID('0cca7a8a-7c6a-4432-abec-3d6cc8d290f1')}
[2025-06-06 17:20:41,079.079] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET status=%(status)s, error=%(error)s WHERE message.id = %(message_id)s::UUID
[2025-06-06 17:20:41,079.079] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00034s] {'status': <QueueEvent.ERROR: 'error'>, 'error': "LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'", 'message_id': UUID('0cca7a8a-7c6a-4432-abec-3d6cc8d290f1')}
[2025-06-06 17:20:41,080.080] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:20:41,365.365] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:20:41] "OPTIONS /ai/suggested-questions HTTP/1.1" 200 -
[2025-06-06 17:20:41,370.370] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:20:41,370.370] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:20:41,370.370] base.py -> _exec_single_context line:1901 [INFO]: [cached since 18.49s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:20:41,372.372] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:20:41,372.372] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.3145s ago] {'pk_1': '0cca7a8a-7c6a-4432-abec-3d6cc8d290f1'}
[2025-06-06 17:20:50,144.144] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:20:50,144.144] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:20:50] "POST /ai/suggested-questions HTTP/1.1" 200 -
[2025-06-06 17:20:58,756.756] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:20:58] "OPTIONS /builtin-tools/categories HTTP/1.1" 200 -
[2025-06-06 17:20:59,061.061] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:20:59] "OPTIONS /datasets?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-06-06 17:20:59,061.061] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:20:59] "OPTIONS /apps/1dd689e3-ceaa-4adc-b382-298ac0250798/conversations/messages?current_page=1&page_size=5&created_at=0 HTTP/1.1" 200 -
[2025-06-06 17:20:59,062.062] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:20:59] "OPTIONS /apps/1dd689e3-ceaa-4adc-b382-298ac0250798/draft-app-config HTTP/1.1" 200 -
[2025-06-06 17:20:59,063.063] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:20:59] "OPTIONS /apps/1dd689e3-ceaa-4adc-b382-298ac0250798 HTTP/1.1" 200 -
[2025-06-06 17:20:59,064.064] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:20:59] "GET /builtin-tools/categories HTTP/1.1" 200 -
[2025-06-06 17:20:59,325.325] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:20:59,325.325] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:20:59,326.326] base.py -> _exec_single_context line:1901 [INFO]: [cached since 36.45s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:20:59,327.327] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.account_id = %(account_id_1)s::UUID ORDER BY dataset.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-06-06 17:20:59,327.327] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.07s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'param_1': 20, 'param_2': 0}
[2025-06-06 17:20:59,328.328] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT dataset.id AS id, dataset.account_id AS account_id, dataset.name AS name, dataset.icon AS icon, dataset.description AS description, dataset.updated_at AS updated_at, dataset.created_at AS created_at 
FROM dataset 
WHERE dataset.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-06-06 17:20:59,329.329] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.06s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:20:59,330.330] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,330.330] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.06s ago] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-06-06 17:20:59,330.330] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,331.331] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.06s ago] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-06-06 17:20:59,331.331] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,331.331] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.05s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-06-06 17:20:59,332.332] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,332.332] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.07s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-06-06 17:20:59,333.333] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,333.333] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.06s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-06-06 17:20:59,334.334] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,334.334] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.06s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-06-06 17:20:59,335.335] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,335.335] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.07s ago] {'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-06-06 17:20:59,336.336] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,336.336] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.06s ago] {'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-06-06 17:20:59,337.337] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,337.337] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.06s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-06-06 17:20:59,338.338] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,338.338] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.07s ago] {'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-06-06 17:20:59,339.339] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,339.339] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.07s ago] {'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-06-06 17:20:59,339.339] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,340.340] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.06s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-06-06 17:20:59,340.340] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,341.341] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.07s ago] {'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-06-06 17:20:59,341.341] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,341.341] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.07s ago] {'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-06-06 17:20:59,341.341] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,343.343] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.07s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-06-06 17:20:59,343.343] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,343.343] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.08s ago] {'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-06-06 17:20:59,344.344] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,344.344] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.07s ago] {'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-06-06 17:20:59,345.345] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,345.345] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.07s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-06-06 17:20:59,345.345] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,345.345] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.08s ago] {'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-06-06 17:20:59,346.346] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,346.346] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.07s ago] {'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-06-06 17:20:59,347.347] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,347.347] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.07s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-06-06 17:20:59,347.347] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,348.348] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.08s ago] {'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-06-06 17:20:59,348.348] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,348.348] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.07s ago] {'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-06-06 17:20:59,349.349] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,349.349] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.07s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-06-06 17:20:59,350.350] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,350.350] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.08s ago] {'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-06-06 17:20:59,351.351] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,351.351] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.08s ago] {'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-06-06 17:20:59,352.352] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,352.352] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.08s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-06-06 17:20:59,353.353] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,353.353] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.09s ago] {'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-06-06 17:20:59,354.354] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,355.355] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.08s ago] {'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-06-06 17:20:59,355.355] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,355.355] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.08s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-06-06 17:20:59,357.357] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,357.357] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.09s ago] {'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-06-06 17:20:59,358.358] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,358.358] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.08s ago] {'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-06-06 17:20:59,360.360] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,360.360] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.08s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-06-06 17:20:59,361.361] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,361.361] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.09s ago] {'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-06-06 17:20:59,361.361] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,363.363] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.09s ago] {'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-06-06 17:20:59,363.363] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,364.364] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.09s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-06-06 17:20:59,364.364] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,365.365] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.1s ago] {'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-06-06 17:20:59,365.365] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,365.365] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.09s ago] {'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-06-06 17:20:59,366.366] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,366.366] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.09s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-06-06 17:20:59,367.367] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,367.367] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.1s ago] {'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-06-06 17:20:59,368.368] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,368.368] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.09s ago] {'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-06-06 17:20:59,370.370] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,370.370] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.09s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-06-06 17:20:59,371.371] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,371.371] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.1s ago] {'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-06-06 17:20:59,371.371] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,372.372] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:20:59,372.372] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.1s ago] {'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-06-06 17:20:59,374.374] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:20:59,374.374] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:20:59,375.375] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:20:59,376.376] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,376.376] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:20:59,377.377] base.py -> _exec_single_context line:1901 [INFO]: [cached since 36.5s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:20:59,377.377] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:20:59,377.377] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.1s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-06-06 17:20:59,377.377] base.py -> _exec_single_context line:1901 [INFO]: [cached since 36.5s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:20:59,378.378] base.py -> _exec_single_context line:1901 [INFO]: [cached since 36.5s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:20:59,379.379] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:20:59,380.380] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,381.381] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:20:59,381.381] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:20:59,381.381] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.23s ago] {'pk_1': UUID('1dd689e3-ceaa-4adc-b382-298ac0250798')}
[2025-06-06 17:20:59,381.381] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.11s ago] {'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-06-06 17:20:59,382.382] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.23s ago] {'pk_1': UUID('1dd689e3-ceaa-4adc-b382-298ac0250798')}
[2025-06-06 17:20:59,382.382] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.23s ago] {'pk_1': UUID('1dd689e3-ceaa-4adc-b382-298ac0250798')}
[2025-06-06 17:20:59,383.383] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-06-06 17:20:59,383.383] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,384.384] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:20:59,385.385] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:20:59,385.385] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.23s ago] {'id_1': UUID('cd6bd620-4275-4e71-a51b-c3d9ae6628fb'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-06-06 17:20:59,385.385] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.11s ago] {'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-06-06 17:20:59,385.385] base.py -> _exec_single_context line:1901 [INFO]: [cached since 35.41s ago] {'app_id_1': UUID('1dd689e3-ceaa-4adc-b382-298ac0250798'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:20:59,385.385] base.py -> _exec_single_context line:1901 [INFO]: [cached since 35.41s ago] {'app_id_1': UUID('1dd689e3-ceaa-4adc-b382-298ac0250798'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:20:59,388.388] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,388.388] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (NULL) AND (1 != 1)
[2025-06-06 17:20:59,389.389] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:20:59,390.390] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.status IN (%(status_1_1)s, %(status_1_2)s) AND message.answer != %(answer_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-06-06 17:20:59,390.390] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.11s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-06-06 17:20:59,390.390] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.01s ago] {}
[2025-06-06 17:20:59,390.390] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.23s ago] {'conversation_id_1': UUID('cd6bd620-4275-4e71-a51b-c3d9ae6628fb'), 'answer_1': '', 'param_1': 5, 'param_2': 0, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 17:20:59,391.391] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:20:59] "GET /apps/1dd689e3-ceaa-4adc-b382-298ac0250798 HTTP/1.1" 200 -
[2025-06-06 17:20:59,392.392] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,393.393] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:20:59,393.393] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.13s ago] {'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-06-06 17:20:59,394.394] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT message.id AS id, message.app_id AS app_id, message.conversation_id AS conversation_id, message.invoke_from AS invoke_from, message.created_by AS created_by, message.query AS query, message.message AS message, message.message_token_count AS message_token_count, message.message_unit_price AS message_unit_price, message.message_price_unit AS message_price_unit, message.answer AS answer, message.answer_token_count AS answer_token_count, message.answer_unit_price AS answer_unit_price, message.answer_price_unit AS answer_price_unit, message.latency AS latency, message.is_deleted AS is_deleted, message.status AS status, message.error AS error, message.total_token_count AS total_token_count, message.total_price AS total_price, message.updated_at AS updated_at, message.created_at AS created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.status IN (%(status_1_1)s, %(status_1_2)s) AND message.answer != %(answer_1)s) AS anon_1
[2025-06-06 17:20:59,394.394] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:20:59] "GET /apps/1dd689e3-ceaa-4adc-b382-298ac0250798/draft-app-config HTTP/1.1" 200 -
[2025-06-06 17:20:59,396.396] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.23s ago] {'conversation_id_1': UUID('cd6bd620-4275-4e71-a51b-c3d9ae6628fb'), 'answer_1': '', 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 17:20:59,396.396] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,397.397] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.12s ago] {'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-06-06 17:20:59,398.398] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:20:59,399.399] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:20:59] "GET /apps/1dd689e3-ceaa-4adc-b382-298ac0250798/conversations/messages?current_page=1&page_size=5&created_at=0 HTTP/1.1" 200 -
[2025-06-06 17:20:59,399.399] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,400.400] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.12s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-06-06 17:20:59,401.401] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,402.402] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.13s ago] {'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-06-06 17:20:59,403.403] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,403.403] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.13s ago] {'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-06-06 17:20:59,404.404] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,404.404] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.13s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-06-06 17:20:59,405.405] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,406.406] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.14s ago] {'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-06-06 17:20:59,406.406] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,407.407] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.13s ago] {'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-06-06 17:20:59,407.407] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,408.408] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.13s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-06-06 17:20:59,408.408] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,408.408] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.14s ago] {'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-06-06 17:20:59,409.409] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,409.409] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.14s ago] {'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-06-06 17:20:59,410.410] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:20:59,410.410] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.13s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-06-06 17:20:59,412.412] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:20:59,413.413] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:20:59] "GET /builtin-tools/google/icon HTTP/1.1" 200 -
[2025-06-06 17:20:59,413.413] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:20:59] "GET /datasets?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-06-06 17:21:02,510.510] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:21:02] "OPTIONS /apps?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-06-06 17:21:02,511.511] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:21:02] "OPTIONS /account HTTP/1.1" 200 -
[2025-06-06 17:21:02,822.822] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:21:02,823.823] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:21:02,823.823] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:21:02,824.824] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:21:02,824.824] base.py -> _exec_single_context line:1901 [INFO]: [cached since 39.94s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:21:02,824.824] base.py -> _exec_single_context line:1901 [INFO]: [cached since 39.94s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:21:02,825.825] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.account_id = %(account_id_1)s::UUID ORDER BY app.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-06-06 17:21:02,826.826] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:21:02,826.826] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.86s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'param_1': 20, 'param_2': 0}
[2025-06-06 17:21:02,826.826] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:21:02] "GET /account HTTP/1.1" 200 -
[2025-06-06 17:21:02,827.827] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT app.id AS id, app.account_id AS account_id, app.app_config_id AS app_config_id, app.draft_app_config_id AS draft_app_config_id, app.debug_conversation_id AS debug_conversation_id, app.name AS name, app.icon AS icon, app.description AS description, app.status AS status, app.updated_at AS updated_at, app.created_at AS created_at 
FROM app 
WHERE app.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-06-06 17:21:02,827.827] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.85s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:21:02,829.829] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:21:02,829.829] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.85s ago] {'app_id_1': UUID('1dd689e3-ceaa-4adc-b382-298ac0250798'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:21:02,830.830] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:21:02,831.831] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.85s ago] {'app_id_1': UUID('4e929f64-66bf-4718-9637-fa7f12b4d804'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:21:02,832.832] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:21:02,832.832] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.85s ago] {'app_id_1': UUID('05519640-8a7f-4606-bb09-cc3ca8948407'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:21:02,833.833] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:21:02,837.837] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.86s ago] {'app_id_1': UUID('72072ee8-f80b-47b9-9e66-d5805e0bff79'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:21:02,838.838] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config.id AS app_config_id, app_config.app_id AS app_config_app_id, app_config.model_config AS app_config_model_config, app_config.dialog_round AS app_config_dialog_round, app_config.preset_prompt AS app_config_preset_prompt, app_config.tools AS app_config_tools, app_config.workflows AS app_config_workflows, app_config.retrieval_config AS app_config_retrieval_config, app_config.long_term_memory AS app_config_long_term_memory, app_config.opening_statement AS app_config_opening_statement, app_config.opening_questions AS app_config_opening_questions, app_config.speech_to_text AS app_config_speech_to_text, app_config.text_to_speech AS app_config_text_to_speech, app_config.suggested_after_answer AS app_config_suggested_after_answer, app_config.review_config AS app_config_review_config, app_config.updated_at AS app_config_updated_at, app_config.created_at AS app_config_created_at 
FROM app_config 
WHERE app_config.id = %(pk_1)s::UUID
[2025-06-06 17:21:02,838.838] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.83s ago] {'pk_1': UUID('f6e0a072-f9e7-4b23-837e-281d1084df58')}
[2025-06-06 17:21:02,839.839] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:21:02,840.840] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:21:02] "GET /apps?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-06-06 17:21:05,766.766] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:21:05] "OPTIONS /builtin-tools/categories HTTP/1.1" 200 -
[2025-06-06 17:21:05,770.770] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:21:05] "GET /builtin-tools/categories HTTP/1.1" 200 -
[2025-06-06 17:21:06,074.074] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:21:06] "OPTIONS /datasets?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-06-06 17:21:06,075.075] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:21:06] "OPTIONS /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations/messages?current_page=1&page_size=5&created_at=0 HTTP/1.1" 200 -
[2025-06-06 17:21:06,076.076] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:21:06] "OPTIONS /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-06-06 17:21:06,076.076] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:21:06] "OPTIONS /apps/83040ed9-0795-43db-99da-b6eb2321a71b HTTP/1.1" 200 -
[2025-06-06 17:21:06,385.385] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:21:06,386.386] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:21:06,387.387] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:21:06,388.388] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:21:06,388.388] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:21:06,388.388] base.py -> _exec_single_context line:1901 [INFO]: [cached since 43.51s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:21:06,389.389] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:21:06,389.389] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:21:06,389.389] base.py -> _exec_single_context line:1901 [INFO]: [cached since 43.51s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:21:06,390.390] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:21:06,391.391] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.account_id = %(account_id_1)s::UUID ORDER BY dataset.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-06-06 17:21:06,391.391] base.py -> _exec_single_context line:1901 [INFO]: [cached since 43.51s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:21:06,391.391] base.py -> _exec_single_context line:1901 [INFO]: [cached since 43.51s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:21:06,392.392] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:21:06,392.392] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.13s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'param_1': 20, 'param_2': 0}
[2025-06-06 17:21:06,393.393] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:21:06,393.393] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:21:06,393.393] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.24s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:21:06,393.393] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.24s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:21:06,394.394] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT dataset.id AS id, dataset.account_id AS account_id, dataset.name AS name, dataset.icon AS icon, dataset.description AS description, dataset.updated_at AS updated_at, dataset.created_at AS created_at 
FROM dataset 
WHERE dataset.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-06-06 17:21:06,395.395] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.13s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:21:06,394.394] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.24s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:21:06,395.395] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:21:06,396.396] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-06-06 17:21:06,396.396] base.py -> _exec_single_context line:1901 [INFO]: [cached since 42.42s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:21:06,397.397] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,397.397] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:21:06,397.397] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.24s ago] {'id_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-06-06 17:21:06,398.398] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.13s ago] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-06-06 17:21:06,399.399] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-06-06 17:21:06,399.399] base.py -> _exec_single_context line:1901 [INFO]: [cached since 42.42s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:21:06,400.400] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.status IN (%(status_1_1)s, %(status_1_2)s) AND message.answer != %(answer_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-06-06 17:21:06,400.400] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.02s ago] {'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-06-06 17:21:06,400.400] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,401.401] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.24s ago] {'conversation_id_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'answer_1': '', 'param_1': 5, 'param_2': 0, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 17:21:06,402.402] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:21:06,402.402] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.13s ago] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-06-06 17:21:06,403.403] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:21:06,403.403] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:21:06] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b HTTP/1.1" 200 -
[2025-06-06 17:21:06,404.404] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:21:06] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-06-06 17:21:06,404.404] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,405.405] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.13s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-06-06 17:21:06,406.406] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,407.407] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT message.id AS id, message.app_id AS app_id, message.conversation_id AS conversation_id, message.invoke_from AS invoke_from, message.created_by AS created_by, message.query AS query, message.message AS message, message.message_token_count AS message_token_count, message.message_unit_price AS message_unit_price, message.message_price_unit AS message_price_unit, message.answer AS answer, message.answer_token_count AS answer_token_count, message.answer_unit_price AS answer_unit_price, message.answer_price_unit AS answer_price_unit, message.latency AS latency, message.is_deleted AS is_deleted, message.status AS status, message.error AS error, message.total_token_count AS total_token_count, message.total_price AS total_price, message.updated_at AS updated_at, message.created_at AS created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.status IN (%(status_1_1)s, %(status_1_2)s) AND message.answer != %(answer_1)s) AS anon_1
[2025-06-06 17:21:06,408.408] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.14s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-06-06 17:21:06,408.408] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.24s ago] {'conversation_id_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'answer_1': '', 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 17:21:06,409.409] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,410.410] base.py -> _exec_single_context line:1896 [INFO]: SELECT message_agent_thought.id AS message_agent_thought_id, message_agent_thought.app_id AS message_agent_thought_app_id, message_agent_thought.conversation_id AS message_agent_thought_conversation_id, message_agent_thought.message_id AS message_agent_thought_message_id, message_agent_thought.invoke_from AS message_agent_thought_invoke_from, message_agent_thought.created_by AS message_agent_thought_created_by, message_agent_thought.position AS message_agent_thought_position, message_agent_thought.event AS message_agent_thought_event, message_agent_thought.thought AS message_agent_thought_thought, message_agent_thought.observation AS message_agent_thought_observation, message_agent_thought.tool AS message_agent_thought_tool, message_agent_thought.tool_input AS message_agent_thought_tool_input, message_agent_thought.message AS message_agent_thought_message, message_agent_thought.message_token_count AS message_agent_thought_message_token_count, message_agent_thought.message_unit_price AS message_agent_thought_message_unit_price, message_agent_thought.message_price_unit AS message_agent_thought_message_price_unit, message_agent_thought.answer AS message_agent_thought_answer, message_agent_thought.answer_token_count AS message_agent_thought_answer_token_count, message_agent_thought.answer_unit_price AS message_agent_thought_answer_unit_price, message_agent_thought.answer_price_unit AS message_agent_thought_answer_price_unit, message_agent_thought.total_token_count AS message_agent_thought_total_token_count, message_agent_thought.total_price AS message_agent_thought_total_price, message_agent_thought.latency AS message_agent_thought_latency, message_agent_thought.updated_at AS message_agent_thought_updated_at, message_agent_thought.created_at AS message_agent_thought_created_at 
FROM message_agent_thought 
WHERE message_agent_thought.message_id = %(message_id_1)s::UUID ORDER BY message_agent_thought.position ASC
[2025-06-06 17:21:06,411.411] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.14s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-06-06 17:21:06,411.411] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00069s] {'message_id_1': UUID('4bde7302-f192-44bc-9ff0-ec55223fb3da')}
[2025-06-06 17:21:06,412.412] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,412.412] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.14s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-06-06 17:21:06,413.413] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,413.413] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.15s ago] {'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-06-06 17:21:06,414.414] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,415.415] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.14s ago] {'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-06-06 17:21:06,415.415] base.py -> _exec_single_context line:1896 [INFO]: SELECT message_agent_thought.id AS message_agent_thought_id, message_agent_thought.app_id AS message_agent_thought_app_id, message_agent_thought.conversation_id AS message_agent_thought_conversation_id, message_agent_thought.message_id AS message_agent_thought_message_id, message_agent_thought.invoke_from AS message_agent_thought_invoke_from, message_agent_thought.created_by AS message_agent_thought_created_by, message_agent_thought.position AS message_agent_thought_position, message_agent_thought.event AS message_agent_thought_event, message_agent_thought.thought AS message_agent_thought_thought, message_agent_thought.observation AS message_agent_thought_observation, message_agent_thought.tool AS message_agent_thought_tool, message_agent_thought.tool_input AS message_agent_thought_tool_input, message_agent_thought.message AS message_agent_thought_message, message_agent_thought.message_token_count AS message_agent_thought_message_token_count, message_agent_thought.message_unit_price AS message_agent_thought_message_unit_price, message_agent_thought.message_price_unit AS message_agent_thought_message_price_unit, message_agent_thought.answer AS message_agent_thought_answer, message_agent_thought.answer_token_count AS message_agent_thought_answer_token_count, message_agent_thought.answer_unit_price AS message_agent_thought_answer_unit_price, message_agent_thought.answer_price_unit AS message_agent_thought_answer_price_unit, message_agent_thought.total_token_count AS message_agent_thought_total_token_count, message_agent_thought.total_price AS message_agent_thought_total_price, message_agent_thought.latency AS message_agent_thought_latency, message_agent_thought.updated_at AS message_agent_thought_updated_at, message_agent_thought.created_at AS message_agent_thought_created_at 
FROM message_agent_thought 
WHERE message_agent_thought.message_id = %(message_id_1)s::UUID ORDER BY message_agent_thought.position ASC
[2025-06-06 17:21:06,416.416] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.005584s ago] {'message_id_1': UUID('ed8be130-3c49-49b9-8fd2-f621d6150418')}
[2025-06-06 17:21:06,416.416] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,417.417] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.14s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-06-06 17:21:06,417.417] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,418.418] base.py -> _exec_single_context line:1896 [INFO]: SELECT message_agent_thought.id AS message_agent_thought_id, message_agent_thought.app_id AS message_agent_thought_app_id, message_agent_thought.conversation_id AS message_agent_thought_conversation_id, message_agent_thought.message_id AS message_agent_thought_message_id, message_agent_thought.invoke_from AS message_agent_thought_invoke_from, message_agent_thought.created_by AS message_agent_thought_created_by, message_agent_thought.position AS message_agent_thought_position, message_agent_thought.event AS message_agent_thought_event, message_agent_thought.thought AS message_agent_thought_thought, message_agent_thought.observation AS message_agent_thought_observation, message_agent_thought.tool AS message_agent_thought_tool, message_agent_thought.tool_input AS message_agent_thought_tool_input, message_agent_thought.message AS message_agent_thought_message, message_agent_thought.message_token_count AS message_agent_thought_message_token_count, message_agent_thought.message_unit_price AS message_agent_thought_message_unit_price, message_agent_thought.message_price_unit AS message_agent_thought_message_price_unit, message_agent_thought.answer AS message_agent_thought_answer, message_agent_thought.answer_token_count AS message_agent_thought_answer_token_count, message_agent_thought.answer_unit_price AS message_agent_thought_answer_unit_price, message_agent_thought.answer_price_unit AS message_agent_thought_answer_price_unit, message_agent_thought.total_token_count AS message_agent_thought_total_token_count, message_agent_thought.total_price AS message_agent_thought_total_price, message_agent_thought.latency AS message_agent_thought_latency, message_agent_thought.updated_at AS message_agent_thought_updated_at, message_agent_thought.created_at AS message_agent_thought_created_at 
FROM message_agent_thought 
WHERE message_agent_thought.message_id = %(message_id_1)s::UUID ORDER BY message_agent_thought.position ASC
[2025-06-06 17:21:06,418.418] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.15s ago] {'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-06-06 17:21:06,418.418] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.007838s ago] {'message_id_1': UUID('2436bd16-3937-4c92-bbc8-3011112aedde')}
[2025-06-06 17:21:06,419.419] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,419.419] base.py -> _exec_single_context line:1896 [INFO]: SELECT message_agent_thought.id AS message_agent_thought_id, message_agent_thought.app_id AS message_agent_thought_app_id, message_agent_thought.conversation_id AS message_agent_thought_conversation_id, message_agent_thought.message_id AS message_agent_thought_message_id, message_agent_thought.invoke_from AS message_agent_thought_invoke_from, message_agent_thought.created_by AS message_agent_thought_created_by, message_agent_thought.position AS message_agent_thought_position, message_agent_thought.event AS message_agent_thought_event, message_agent_thought.thought AS message_agent_thought_thought, message_agent_thought.observation AS message_agent_thought_observation, message_agent_thought.tool AS message_agent_thought_tool, message_agent_thought.tool_input AS message_agent_thought_tool_input, message_agent_thought.message AS message_agent_thought_message, message_agent_thought.message_token_count AS message_agent_thought_message_token_count, message_agent_thought.message_unit_price AS message_agent_thought_message_unit_price, message_agent_thought.message_price_unit AS message_agent_thought_message_price_unit, message_agent_thought.answer AS message_agent_thought_answer, message_agent_thought.answer_token_count AS message_agent_thought_answer_token_count, message_agent_thought.answer_unit_price AS message_agent_thought_answer_unit_price, message_agent_thought.answer_price_unit AS message_agent_thought_answer_price_unit, message_agent_thought.total_token_count AS message_agent_thought_total_token_count, message_agent_thought.total_price AS message_agent_thought_total_price, message_agent_thought.latency AS message_agent_thought_latency, message_agent_thought.updated_at AS message_agent_thought_updated_at, message_agent_thought.created_at AS message_agent_thought_created_at 
FROM message_agent_thought 
WHERE message_agent_thought.message_id = %(message_id_1)s::UUID ORDER BY message_agent_thought.position ASC
[2025-06-06 17:21:06,419.419] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.15s ago] {'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-06-06 17:21:06,420.420] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.009663s ago] {'message_id_1': UUID('a7dad8ef-c18d-45fc-acf5-e68dc70dbcb8')}
[2025-06-06 17:21:06,421.421] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,421.421] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.14s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-06-06 17:21:06,422.422] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:21:06,423.423] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,423.423] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.16s ago] {'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-06-06 17:21:06,423.423] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:21:06] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations/messages?current_page=1&page_size=5&created_at=0 HTTP/1.1" 200 -
[2025-06-06 17:21:06,424.424] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,424.424] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.15s ago] {'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-06-06 17:21:06,425.425] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,426.426] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.15s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-06-06 17:21:06,427.427] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,427.427] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.16s ago] {'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-06-06 17:21:06,428.428] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,428.428] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.15s ago] {'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-06-06 17:21:06,429.429] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,429.429] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.15s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-06-06 17:21:06,432.432] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,432.432] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.16s ago] {'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-06-06 17:21:06,433.433] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,434.434] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.16s ago] {'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-06-06 17:21:06,435.435] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,435.435] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.16s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-06-06 17:21:06,436.436] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,436.436] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.17s ago] {'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-06-06 17:21:06,437.437] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,437.437] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.16s ago] {'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-06-06 17:21:06,438.438] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,439.439] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.16s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-06-06 17:21:06,440.440] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,440.440] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.17s ago] {'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-06-06 17:21:06,440.440] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,441.441] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.17s ago] {'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-06-06 17:21:06,441.441] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,442.442] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.16s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-06-06 17:21:06,443.443] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,443.443] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.18s ago] {'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-06-06 17:21:06,444.444] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,444.444] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.17s ago] {'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-06-06 17:21:06,444.444] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,445.445] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.17s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-06-06 17:21:06,445.445] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,445.445] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.18s ago] {'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-06-06 17:21:06,447.447] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,447.447] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.17s ago] {'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-06-06 17:21:06,448.448] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,448.448] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.17s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-06-06 17:21:06,449.449] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,449.449] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.18s ago] {'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-06-06 17:21:06,449.449] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,450.450] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.18s ago] {'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-06-06 17:21:06,450.450] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,451.451] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.17s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-06-06 17:21:06,451.451] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,451.451] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.18s ago] {'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-06-06 17:21:06,452.452] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,452.452] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.18s ago] {'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-06-06 17:21:06,453.453] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,453.453] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.18s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-06-06 17:21:06,454.454] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,455.455] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.19s ago] {'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-06-06 17:21:06,455.455] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,455.455] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.18s ago] {'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-06-06 17:21:06,456.456] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,456.456] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.18s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-06-06 17:21:06,457.457] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,457.457] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.19s ago] {'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-06-06 17:21:06,458.458] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,458.458] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.18s ago] {'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-06-06 17:21:06,459.459] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,459.459] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.18s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-06-06 17:21:06,459.459] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,460.460] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.19s ago] {'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-06-06 17:21:06,460.460] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,461.461] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.19s ago] {'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-06-06 17:21:06,462.462] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,462.462] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.19s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-06-06 17:21:06,464.464] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,464.464] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.2s ago] {'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-06-06 17:21:06,465.465] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,465.465] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.19s ago] {'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-06-06 17:21:06,467.467] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,467.467] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.19s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-06-06 17:21:06,468.468] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,469.469] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.2s ago] {'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-06-06 17:21:06,470.470] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,470.470] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.2s ago] {'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-06-06 17:21:06,471.471] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,472.472] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.19s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-06-06 17:21:06,473.473] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,474.474] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.21s ago] {'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-06-06 17:21:06,475.475] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,475.475] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.2s ago] {'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-06-06 17:21:06,476.476] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,477.477] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.2s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-06-06 17:21:06,478.478] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,478.478] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.21s ago] {'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-06-06 17:21:06,480.480] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,480.480] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.21s ago] {'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-06-06 17:21:06,482.482] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:21:06,482.482] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.21s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-06-06 17:21:06,484.484] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:21:06,485.485] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:21:06] "GET /datasets?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-06-06 17:21:06,648.648] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:21:06] "GET /builtin-tools/gaode/icon HTTP/1.1" 200 -
[2025-06-06 17:21:13,849.849] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:21:13] "OPTIONS /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-06-06 17:21:13,850.850] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:21:13,851.851] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:21:13,851.851] base.py -> _exec_single_context line:1901 [INFO]: [cached since 50.97s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:21:13,854.854] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:21:13,854.854] base.py -> _exec_single_context line:1901 [INFO]: [cached since 45.7s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:21:13,855.855] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:21:13,855.855] base.py -> _exec_single_context line:1901 [INFO]: [cached since 49.88s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:21:13,856.856] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-06-06 17:21:13,856.856] base.py -> _exec_single_context line:1901 [INFO]: [cached since 45.48s ago] {'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-06-06 17:21:13,857.857] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-06-06 17:21:13,857.857] base.py -> _exec_single_context line:1901 [INFO]: [cached since 45.7s ago] {'id_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-06-06 17:21:13,858.858] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 17:21:13,859.859] base.py -> _exec_single_context line:1901 [INFO]: [cached since 40.76s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 17:21:13,860.860] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:21:13,899.899] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:21:13,899.899] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:21:13,899.899] base.py -> _exec_single_context line:1901 [INFO]: [cached since 40.72s ago] {'pk_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e')}
[2025-06-06 17:21:13,902.902] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 17:21:13,902.902] base.py -> _exec_single_context line:1901 [INFO]: [cached since 40.72s ago] {'conversation_id_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'answer_1': '', 'param_1': 10, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 17:21:17,126.126] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:21:17,127.127] base.py -> _exec_single_context line:1901 [INFO]: [cached since 43.94s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:21:24,488.488] function_call_agent.py -> _llm_node line:192 [ERROR]: LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\core\agent\agents\function_call_agent.py", line 159, in _llm_node
    for chunk in llm.stream(state["messages"]):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\runnables\base.py", line 5607, in stream
    yield from self.bound.stream(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 499, in stream
    for chunk in self._stream(input_messages, stop=stop, **kwargs):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 849, in _stream
    generation_chunk = self._convert_chunk_to_generation_chunk(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 707, in _convert_chunk_to_generation_chunk
    _create_usage_metadata(token_usage) if token_usage else None
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 2808, in _create_usage_metadata
    total_tokens = oai_token_usage.get("total_tokens", input_tokens + output_tokens)
TypeError: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
[2025-06-06 17:21:24,489.489] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:21:24,490.490] base.py -> _exec_single_context line:1901 [INFO]: [cached since 50.99s ago] {'pk_1': UUID('5a55e972-11cd-4a69-b6f2-0c0cb3e9f433')}
[2025-06-06 17:21:24,491.491] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:21:24] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-06-06 17:21:24,501.501] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:21:24,501.501] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:21:24,501.501] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:21:24,502.502] base.py -> _exec_single_context line:1901 [INFO]: [cached since 43.45s ago] {'pk_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e')}
[2025-06-06 17:21:24,504.504] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:21:24,504.504] base.py -> _exec_single_context line:1901 [INFO]: [cached since 43.45s ago] {'pk_1': UUID('5a55e972-11cd-4a69-b6f2-0c0cb3e9f433')}
[2025-06-06 17:21:24,505.505] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET status=%(status)s, error=%(error)s WHERE message.id = %(message_id)s::UUID
[2025-06-06 17:21:24,505.505] base.py -> _exec_single_context line:1901 [INFO]: [cached since 43.43s ago] {'status': <QueueEvent.ERROR: 'error'>, 'error': "LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'", 'message_id': UUID('5a55e972-11cd-4a69-b6f2-0c0cb3e9f433')}
[2025-06-06 17:21:24,506.506] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:21:24,509.509] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:21:24] "OPTIONS /ai/suggested-questions HTTP/1.1" 200 -
[2025-06-06 17:21:24,823.823] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:21:24,823.823] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:21:24,823.823] base.py -> _exec_single_context line:1901 [INFO]: [cached since 61.94s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:21:24,825.825] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:21:24,825.825] base.py -> _exec_single_context line:1901 [INFO]: [cached since 43.77s ago] {'pk_1': '5a55e972-11cd-4a69-b6f2-0c0cb3e9f433'}
[2025-06-06 17:21:32,653.653] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:21:32,653.653] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:21:32] "POST /ai/suggested-questions HTTP/1.1" 200 -
[2025-06-06 17:23:42,554.554] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\embeddings_service.py', reloading
[2025-06-06 17:23:42,992.992] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 17:23:48,333.333] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-06-06 17:23:48,335.335] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-06-06 17:23:56,613.613] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:23:56] "OPTIONS /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-06-06 17:23:57,210.210] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-06-06 17:23:57,211.211] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 17:23:57,212.212] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-06-06 17:23:57,212.212] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 17:23:57,213.213] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-06-06 17:23:57,213.213] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 17:23:57,213.213] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:23:57,215.215] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:23:57,215.215] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00026s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:23:57,219.219] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:23:57,220.220] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00034s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:23:57,223.223] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:23:57,224.224] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00029s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:23:57,226.226] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-06-06 17:23:57,226.226] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00035s] {'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-06-06 17:23:57,229.229] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-06-06 17:23:57,230.230] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00036s] {'id_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-06-06 17:23:57,233.233] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 17:23:57,233.233] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00031s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 17:23:57,239.239] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:23:57,282.282] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:23:57,282.282] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:23:57,283.283] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00027s] {'pk_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e')}
[2025-06-06 17:23:57,285.285] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 17:23:57,285.285] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00036s] {'conversation_id_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'answer_1': '', 'param_1': 10, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 17:23:57,398.398] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:23:57,398.398] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00037s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:23:57,617.617] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:23:57,625.625] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00843s] {'pk_1': UUID('8f1cd0b4-4c1c-4314-b86c-224800cbb3ee')}
[2025-06-06 17:23:57,626.626] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:23:57] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-06-06 17:24:04,745.745] function_call_agent.py -> _llm_node line:192 [ERROR]: LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\core\agent\agents\function_call_agent.py", line 159, in _llm_node
    for chunk in llm.stream(state["messages"]):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\runnables\base.py", line 5607, in stream
    yield from self.bound.stream(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 499, in stream
    for chunk in self._stream(input_messages, stop=stop, **kwargs):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 849, in _stream
    generation_chunk = self._convert_chunk_to_generation_chunk(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 707, in _convert_chunk_to_generation_chunk
    _create_usage_metadata(token_usage) if token_usage else None
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 2808, in _create_usage_metadata
    total_tokens = oai_token_usage.get("total_tokens", input_tokens + output_tokens)
TypeError: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
[2025-06-06 17:24:04,750.750] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:24:04,759.759] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:24:04] "OPTIONS /ai/suggested-questions HTTP/1.1" 200 -
[2025-06-06 17:24:04,762.762] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:24:04,762.762] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:24:04,762.762] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.547s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:24:04,764.764] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:24:04,765.765] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00037s] {'pk_1': '8f1cd0b4-4c1c-4314-b86c-224800cbb3ee'}
[2025-06-06 17:24:04,872.872] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:24:04,875.875] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:24:04,875.875] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00028s] {'pk_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e')}
[2025-06-06 17:24:04,878.878] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:24:04,879.879] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.1142s ago] {'pk_1': UUID('8f1cd0b4-4c1c-4314-b86c-224800cbb3ee')}
[2025-06-06 17:24:04,882.882] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-06-06 17:24:04,882.882] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00047s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'message_id': UUID('8f1cd0b4-4c1c-4314-b86c-224800cbb3ee'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': 'äººç±»è¯¢é—®AIå¦‚ä½•æ›´å¥½åœ°ä¿æŠ¤åœ°çƒçŽ¯å¢ƒï¼ŒAIæä¾›äº†å¤šç§æŽªæ–½ï¼ŒåŒ…æ‹¬å‡å°‘ç¢³è¶³è¿¹ã€èŠ‚çº¦èµ„æºã€å‡å°‘åºŸç‰©ã€æ”¯æŒå¯æŒç»­å†œä¸šã€ä¿æŠ¤è‡ªç„¶ç”Ÿæ€ã€æé«˜å…¬ä¼—æ„è¯†ä»¥åŠæ”¯æŒæ”¿ç­–å’Œç«‹æ³•ï¼Œå¼ºè°ƒæ¯ä¸ªäººéƒ½å¯ä»¥é€šè¿‡è¿™äº›æ–¹å¼ä¸ºä¿æŠ¤åœ°çƒçŽ¯å¢ƒè´¡çŒ®åŠ›é‡ã€‚æ­¤å¤–ï¼Œäººç±»è¯¢é—®æ·„åšçš„ç¾Žé£Ÿï¼ŒAIåˆ—ä¸¾äº†å¤šç§ç‰¹è‰²ç¾Žé£Ÿï¼ŒåŒ…æ‹¬æ·„åšçƒ§çƒ¤ã€åšå±±è±†è…ã€æ·„åšç…Žé¥¼ã€æ°´ç…ŽåŒ…ã€é²èœã€ç„¦åœˆå’Œç‚¸é¸¡æŸ³ï¼ŒæŒ‡å‡ºè¿™äº›ç¾Žé£Ÿä¸ä»…ç¾Žå‘³ï¼Œè¿˜èƒ½è®©äººæ›´å¥½åœ°ä½“éªŒæ·„åšçš„åœ°æ–¹æ–‡åŒ–ã€‚æœ€è¿‘ï¼Œäººç±»ä¸ŽAIè¿›è¡Œäº†ç®€å•çš„é—®å€™ï¼ŒAIå›žåº”äº†äººç±»çš„é—®å€™å¹¶è¯¢é—®æ˜¯å¦éœ€è¦å¸®åŠ©ã€‚', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-06-06 17:24:04,890.890] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:24:04,891.891] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:24:04,892.892] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:24:04,892.892] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.275s ago] {'pk_1': UUID('8f1cd0b4-4c1c-4314-b86c-224800cbb3ee')}
[2025-06-06 17:24:04,893.893] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET status=%(status)s, error=%(error)s WHERE message.id = %(message_id)s::UUID
[2025-06-06 17:24:04,893.893] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00026s] {'status': <QueueEvent.ERROR: 'error'>, 'error': "LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'", 'message_id': UUID('8f1cd0b4-4c1c-4314-b86c-224800cbb3ee')}
[2025-06-06 17:24:04,894.894] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:24:12,234.234] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:24:12,234.234] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:24:12] "POST /ai/suggested-questions HTTP/1.1" 200 -
[2025-06-06 17:24:20,313.313] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:24:20] "OPTIONS /builtin-tools/categories HTTP/1.1" 200 -
[2025-06-06 17:24:20,313.313] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:24:20] "OPTIONS /datasets?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-06-06 17:24:20,314.314] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:24:20] "OPTIONS /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations/messages?current_page=1&page_size=5&created_at=0 HTTP/1.1" 200 -
[2025-06-06 17:24:20,314.314] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:24:20] "OPTIONS /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-06-06 17:24:20,315.315] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:24:20] "OPTIONS /apps/83040ed9-0795-43db-99da-b6eb2321a71b HTTP/1.1" 200 -
[2025-06-06 17:24:20,624.624] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:24:20] "GET /builtin-tools/categories HTTP/1.1" 200 -
[2025-06-06 17:24:20,626.626] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:24:20,627.627] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:24:20,628.628] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:24:20,628.628] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.41s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:24:20,627.627] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:24:20,628.628] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.41s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:24:20,631.631] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:24:20,632.632] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.41s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:24:20,634.634] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-06-06 17:24:20,634.634] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.4s ago] {'id_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-06-06 17:24:20,636.636] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.account_id = %(account_id_1)s::UUID ORDER BY dataset.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-06-06 17:24:20,636.636] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00059s] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'param_1': 20, 'param_2': 0}
[2025-06-06 17:24:20,637.637] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.status IN (%(status_1_1)s, %(status_1_2)s) AND message.answer != %(answer_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-06-06 17:24:20,638.638] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00055s] {'conversation_id_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'answer_1': '', 'param_1': 5, 'param_2': 0, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 17:24:20,641.641] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT message.id AS id, message.app_id AS app_id, message.conversation_id AS conversation_id, message.invoke_from AS invoke_from, message.created_by AS created_by, message.query AS query, message.message AS message, message.message_token_count AS message_token_count, message.message_unit_price AS message_unit_price, message.message_price_unit AS message_price_unit, message.answer AS answer, message.answer_token_count AS answer_token_count, message.answer_unit_price AS answer_unit_price, message.answer_price_unit AS answer_price_unit, message.latency AS latency, message.is_deleted AS is_deleted, message.status AS status, message.error AS error, message.total_token_count AS total_token_count, message.total_price AS total_price, message.updated_at AS updated_at, message.created_at AS created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.status IN (%(status_1_1)s, %(status_1_2)s) AND message.answer != %(answer_1)s) AS anon_1
[2025-06-06 17:24:20,642.642] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT dataset.id AS id, dataset.account_id AS account_id, dataset.name AS name, dataset.icon AS icon, dataset.description AS description, dataset.updated_at AS updated_at, dataset.created_at AS created_at 
FROM dataset 
WHERE dataset.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-06-06 17:24:20,643.643] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00152s] {'conversation_id_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'answer_1': '', 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 17:24:20,643.643] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00052s] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:24:20,644.644] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,649.649] base.py -> _exec_single_context line:1896 [INFO]: SELECT message_agent_thought.id AS message_agent_thought_id, message_agent_thought.app_id AS message_agent_thought_app_id, message_agent_thought.conversation_id AS message_agent_thought_conversation_id, message_agent_thought.message_id AS message_agent_thought_message_id, message_agent_thought.invoke_from AS message_agent_thought_invoke_from, message_agent_thought.created_by AS message_agent_thought_created_by, message_agent_thought.position AS message_agent_thought_position, message_agent_thought.event AS message_agent_thought_event, message_agent_thought.thought AS message_agent_thought_thought, message_agent_thought.observation AS message_agent_thought_observation, message_agent_thought.tool AS message_agent_thought_tool, message_agent_thought.tool_input AS message_agent_thought_tool_input, message_agent_thought.message AS message_agent_thought_message, message_agent_thought.message_token_count AS message_agent_thought_message_token_count, message_agent_thought.message_unit_price AS message_agent_thought_message_unit_price, message_agent_thought.message_price_unit AS message_agent_thought_message_price_unit, message_agent_thought.answer AS message_agent_thought_answer, message_agent_thought.answer_token_count AS message_agent_thought_answer_token_count, message_agent_thought.answer_unit_price AS message_agent_thought_answer_unit_price, message_agent_thought.answer_price_unit AS message_agent_thought_answer_price_unit, message_agent_thought.total_token_count AS message_agent_thought_total_token_count, message_agent_thought.total_price AS message_agent_thought_total_price, message_agent_thought.latency AS message_agent_thought_latency, message_agent_thought.updated_at AS message_agent_thought_updated_at, message_agent_thought.created_at AS message_agent_thought_created_at 
FROM message_agent_thought 
WHERE message_agent_thought.message_id = %(message_id_1)s::UUID ORDER BY message_agent_thought.position ASC
[2025-06-06 17:24:20,649.649] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00467s] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-06-06 17:24:20,649.649] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00061s] {'message_id_1': UUID('4bde7302-f192-44bc-9ff0-ec55223fb3da')}
[2025-06-06 17:24:20,654.654] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,654.654] base.py -> _exec_single_context line:1896 [INFO]: SELECT message_agent_thought.id AS message_agent_thought_id, message_agent_thought.app_id AS message_agent_thought_app_id, message_agent_thought.conversation_id AS message_agent_thought_conversation_id, message_agent_thought.message_id AS message_agent_thought_message_id, message_agent_thought.invoke_from AS message_agent_thought_invoke_from, message_agent_thought.created_by AS message_agent_thought_created_by, message_agent_thought.position AS message_agent_thought_position, message_agent_thought.event AS message_agent_thought_event, message_agent_thought.thought AS message_agent_thought_thought, message_agent_thought.observation AS message_agent_thought_observation, message_agent_thought.tool AS message_agent_thought_tool, message_agent_thought.tool_input AS message_agent_thought_tool_input, message_agent_thought.message AS message_agent_thought_message, message_agent_thought.message_token_count AS message_agent_thought_message_token_count, message_agent_thought.message_unit_price AS message_agent_thought_message_unit_price, message_agent_thought.message_price_unit AS message_agent_thought_message_price_unit, message_agent_thought.answer AS message_agent_thought_answer, message_agent_thought.answer_token_count AS message_agent_thought_answer_token_count, message_agent_thought.answer_unit_price AS message_agent_thought_answer_unit_price, message_agent_thought.answer_price_unit AS message_agent_thought_answer_price_unit, message_agent_thought.total_token_count AS message_agent_thought_total_token_count, message_agent_thought.total_price AS message_agent_thought_total_price, message_agent_thought.latency AS message_agent_thought_latency, message_agent_thought.updated_at AS message_agent_thought_updated_at, message_agent_thought.created_at AS message_agent_thought_created_at 
FROM message_agent_thought 
WHERE message_agent_thought.message_id = %(message_id_1)s::UUID ORDER BY message_agent_thought.position ASC
[2025-06-06 17:24:20,655.655] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00126s] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-06-06 17:24:20,655.655] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.00542s ago] {'message_id_1': UUID('ed8be130-3c49-49b9-8fd2-f621d6150418')}
[2025-06-06 17:24:20,656.656] base.py -> _exec_single_context line:1896 [INFO]: SELECT message_agent_thought.id AS message_agent_thought_id, message_agent_thought.app_id AS message_agent_thought_app_id, message_agent_thought.conversation_id AS message_agent_thought_conversation_id, message_agent_thought.message_id AS message_agent_thought_message_id, message_agent_thought.invoke_from AS message_agent_thought_invoke_from, message_agent_thought.created_by AS message_agent_thought_created_by, message_agent_thought.position AS message_agent_thought_position, message_agent_thought.event AS message_agent_thought_event, message_agent_thought.thought AS message_agent_thought_thought, message_agent_thought.observation AS message_agent_thought_observation, message_agent_thought.tool AS message_agent_thought_tool, message_agent_thought.tool_input AS message_agent_thought_tool_input, message_agent_thought.message AS message_agent_thought_message, message_agent_thought.message_token_count AS message_agent_thought_message_token_count, message_agent_thought.message_unit_price AS message_agent_thought_message_unit_price, message_agent_thought.message_price_unit AS message_agent_thought_message_price_unit, message_agent_thought.answer AS message_agent_thought_answer, message_agent_thought.answer_token_count AS message_agent_thought_answer_token_count, message_agent_thought.answer_unit_price AS message_agent_thought_answer_unit_price, message_agent_thought.answer_price_unit AS message_agent_thought_answer_price_unit, message_agent_thought.total_token_count AS message_agent_thought_total_token_count, message_agent_thought.total_price AS message_agent_thought_total_price, message_agent_thought.latency AS message_agent_thought_latency, message_agent_thought.updated_at AS message_agent_thought_updated_at, message_agent_thought.created_at AS message_agent_thought_created_at 
FROM message_agent_thought 
WHERE message_agent_thought.message_id = %(message_id_1)s::UUID ORDER BY message_agent_thought.position ASC
[2025-06-06 17:24:20,658.658] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,661.661] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01108s ago] {'message_id_1': UUID('2436bd16-3937-4c92-bbc8-3011112aedde')}
[2025-06-06 17:24:20,661.661] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00319s] {'coalesce_2': 0, 'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-06-06 17:24:20,662.662] base.py -> _exec_single_context line:1896 [INFO]: SELECT message_agent_thought.id AS message_agent_thought_id, message_agent_thought.app_id AS message_agent_thought_app_id, message_agent_thought.conversation_id AS message_agent_thought_conversation_id, message_agent_thought.message_id AS message_agent_thought_message_id, message_agent_thought.invoke_from AS message_agent_thought_invoke_from, message_agent_thought.created_by AS message_agent_thought_created_by, message_agent_thought.position AS message_agent_thought_position, message_agent_thought.event AS message_agent_thought_event, message_agent_thought.thought AS message_agent_thought_thought, message_agent_thought.observation AS message_agent_thought_observation, message_agent_thought.tool AS message_agent_thought_tool, message_agent_thought.tool_input AS message_agent_thought_tool_input, message_agent_thought.message AS message_agent_thought_message, message_agent_thought.message_token_count AS message_agent_thought_message_token_count, message_agent_thought.message_unit_price AS message_agent_thought_message_unit_price, message_agent_thought.message_price_unit AS message_agent_thought_message_price_unit, message_agent_thought.answer AS message_agent_thought_answer, message_agent_thought.answer_token_count AS message_agent_thought_answer_token_count, message_agent_thought.answer_unit_price AS message_agent_thought_answer_unit_price, message_agent_thought.answer_price_unit AS message_agent_thought_answer_price_unit, message_agent_thought.total_token_count AS message_agent_thought_total_token_count, message_agent_thought.total_price AS message_agent_thought_total_price, message_agent_thought.latency AS message_agent_thought_latency, message_agent_thought.updated_at AS message_agent_thought_updated_at, message_agent_thought.created_at AS message_agent_thought_created_at 
FROM message_agent_thought 
WHERE message_agent_thought.message_id = %(message_id_1)s::UUID ORDER BY message_agent_thought.position ASC
[2025-06-06 17:24:20,662.662] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,663.663] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01368s ago] {'message_id_1': UUID('a7dad8ef-c18d-45fc-acf5-e68dc70dbcb8')}
[2025-06-06 17:24:20,663.663] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0183s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-06-06 17:24:20,664.664] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,665.665] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:24:20,667.667] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01309s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-06-06 17:24:20,667.667] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:24:20] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations/messages?current_page=1&page_size=5&created_at=0 HTTP/1.1" 200 -
[2025-06-06 17:24:20,668.668] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,669.669] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01124s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-06-06 17:24:20,670.670] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,670.670] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02545s ago] {'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-06-06 17:24:20,671.671] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,672.672] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01885s ago] {'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-06-06 17:24:20,672.672] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,673.673] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01576s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-06-06 17:24:20,673.673] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,673.673] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02902s ago] {'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-06-06 17:24:20,675.675] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,675.675] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0215s ago] {'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-06-06 17:24:20,675.675] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,676.676] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01825s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-06-06 17:24:20,676.676] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,676.676] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0315s ago] {'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-06-06 17:24:20,677.677] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,677.677] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02404s ago] {'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-06-06 17:24:20,678.678] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,678.678] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02082s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-06-06 17:24:20,679.679] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,679.679] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0341s ago] {'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-06-06 17:24:20,680.680] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,680.680] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02689s ago] {'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-06-06 17:24:20,681.681] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,681.681] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02393s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-06-06 17:24:20,682.682] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,682.682] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03726s ago] {'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-06-06 17:24:20,683.683] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,683.683] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02975s ago] {'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-06-06 17:24:20,684.684] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,684.684] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02694s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-06-06 17:24:20,685.685] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,685.685] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04027s ago] {'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-06-06 17:24:20,686.686] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,687.687] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03297s ago] {'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-06-06 17:24:20,687.687] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,688.688] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03001s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-06-06 17:24:20,689.689] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,689.689] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0436s ago] {'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-06-06 17:24:20,690.690] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,690.690] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03659s ago] {'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-06-06 17:24:20,691.691] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,692.692] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03406s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-06-06 17:24:20,693.693] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,693.693] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04761s ago] {'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-06-06 17:24:20,694.694] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,694.694] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04037s ago] {'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-06-06 17:24:20,695.695] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,695.695] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0375s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-06-06 17:24:20,696.696] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,697.697] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05129s ago] {'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-06-06 17:24:20,698.698] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,698.698] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04452s ago] {'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-06-06 17:24:20,699.699] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,699.699] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04164s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-06-06 17:24:20,700.700] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,701.701] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05549s ago] {'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-06-06 17:24:20,702.702] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,702.702] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04866s ago] {'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-06-06 17:24:20,703.703] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,704.704] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04604s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-06-06 17:24:20,705.705] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,705.705] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05989s ago] {'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-06-06 17:24:20,706.706] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,706.706] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05283s ago] {'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-06-06 17:24:20,707.707] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,708.708] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05016s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-06-06 17:24:20,709.709] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,709.709] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.06406s ago] {'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-06-06 17:24:20,711.711] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,711.711] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05822s ago] {'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-06-06 17:24:20,713.713] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,714.714] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05593s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-06-06 17:24:20,715.715] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,715.715] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.06978s ago] {'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-06-06 17:24:20,716.716] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,717.717] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.06328s ago] {'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-06-06 17:24:20,719.719] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,719.719] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.06168s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-06-06 17:24:20,720.720] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,721.721] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.07613s ago] {'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-06-06 17:24:20,723.723] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,723.723] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0699s ago] {'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-06-06 17:24:20,724.724] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,725.725] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.06756s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-06-06 17:24:20,726.726] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,726.726] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.08142s ago] {'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-06-06 17:24:20,727.727] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,727.727] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.07442s ago] {'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-06-06 17:24:20,728.728] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,729.729] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.07176s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-06-06 17:24:20,730.730] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,731.731] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.08591s ago] {'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-06-06 17:24:20,732.732] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,732.732] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.07903s ago] {'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-06-06 17:24:20,734.734] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,735.735] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.07736s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-06-06 17:24:20,737.737] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,737.737] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.09237s ago] {'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-06-06 17:24:20,739.739] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,739.739] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.08577s ago] {'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-06-06 17:24:20,740.740] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,741.741] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.08315s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-06-06 17:24:20,742.742] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,742.742] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.09695s ago] {'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-06-06 17:24:20,743.743] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,744.744] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0903s ago] {'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-06-06 17:24:20,745.745] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:24:20,745.745] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.088s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-06-06 17:24:20,748.748] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:24:20,749.749] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:24:20,750.750] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:24:20] "GET /datasets?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-06-06 17:24:20,750.750] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:24:20,751.751] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.54s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:24:20,754.754] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:24:20,755.755] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.54s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:24:20,759.759] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:24:20,759.759] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.54s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:24:20,763.763] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-06-06 17:24:20,763.763] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.54s ago] {'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-06-06 17:24:20,765.765] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:24:20,766.766] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:24:20] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-06-06 17:24:20,820.820] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:24:20,821.821] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:24:20,822.822] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.61s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:24:20,824.824] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:24:20,825.825] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.61s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:24:20,827.827] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:24:20,828.828] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.61s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:24:20,830.830] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:24:20,831.831] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:24:20] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b HTTP/1.1" 200 -
[2025-06-06 17:24:21,056.056] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:24:21] "GET /builtin-tools/google/icon HTTP/1.1" 200 -
[2025-06-06 17:24:21,094.094] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:24:21] "GET /builtin-tools/gaode/icon HTTP/1.1" 200 -
[2025-06-06 17:24:26,011.011] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:24:26] "OPTIONS /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-06-06 17:24:26,015.015] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:24:26,016.016] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:24:26,016.016] base.py -> _exec_single_context line:1901 [INFO]: [cached since 28.8s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:24:26,018.018] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:24:26,018.018] base.py -> _exec_single_context line:1901 [INFO]: [cached since 28.8s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:24:26,019.019] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:24:26,020.020] base.py -> _exec_single_context line:1901 [INFO]: [cached since 28.8s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:24:26,021.021] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-06-06 17:24:26,021.021] base.py -> _exec_single_context line:1901 [INFO]: [cached since 28.79s ago] {'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-06-06 17:24:26,022.022] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-06-06 17:24:26,023.023] base.py -> _exec_single_context line:1901 [INFO]: [cached since 28.79s ago] {'id_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-06-06 17:24:26,024.024] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 17:24:26,024.024] base.py -> _exec_single_context line:1901 [INFO]: [cached since 28.79s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 17:24:26,026.026] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:24:26,068.068] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:24:26,068.068] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:24:26,068.068] base.py -> _exec_single_context line:1901 [INFO]: [cached since 28.79s ago] {'pk_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e')}
[2025-06-06 17:24:26,069.069] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 17:24:26,070.070] base.py -> _exec_single_context line:1901 [INFO]: [cached since 28.79s ago] {'conversation_id_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'answer_1': '', 'param_1': 10, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 17:24:26,072.072] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:24:26,072.072] base.py -> _exec_single_context line:1901 [INFO]: [cached since 28.68s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:24:32,232.232] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:24:32,233.233] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:24:32,233.233] base.py -> _exec_single_context line:1901 [INFO]: [cached since 35.02s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:24:32,237.237] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:24:32,237.237] base.py -> _exec_single_context line:1901 [INFO]: [cached since 27.36s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 17:24:32,239.239] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 17:24:32,239.239] base.py -> _exec_single_context line:1901 [INFO]: [cached since 35.01s ago] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½,AIæ˜¯ä»€ä¹ˆ?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 17:24:32,245.245] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:24:32,288.288] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:24:32,288.288] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:24:32,288.288] base.py -> _exec_single_context line:1901 [INFO]: [cached since 35.01s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 17:24:32,291.291] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 17:24:32,292.292] base.py -> _exec_single_context line:1901 [INFO]: [cached since 35.01s ago] {'conversation_id_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'answer_1': '', 'param_1': 3, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 17:24:32,294.294] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:24:32,295.295] base.py -> _exec_single_context line:1901 [INFO]: [cached since 34.9s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:24:33,324.324] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:24:33,324.324] base.py -> _exec_single_context line:1901 [INFO]: [cached since 35.71s ago] {'pk_1': UUID('44cdbb06-e0dd-4211-8139-00c584345540')}
[2025-06-06 17:24:33,325.325] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:24:33] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 17:24:33,402.402] function_call_agent.py -> _llm_node line:192 [ERROR]: LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\core\agent\agents\function_call_agent.py", line 159, in _llm_node
    for chunk in llm.stream(state["messages"]):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\runnables\base.py", line 5607, in stream
    yield from self.bound.stream(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 499, in stream
    for chunk in self._stream(input_messages, stop=stop, **kwargs):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 849, in _stream
    generation_chunk = self._convert_chunk_to_generation_chunk(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 707, in _convert_chunk_to_generation_chunk
    _create_usage_metadata(token_usage) if token_usage else None
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 2808, in _create_usage_metadata
    total_tokens = oai_token_usage.get("total_tokens", input_tokens + output_tokens)
TypeError: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
[2025-06-06 17:24:33,402.402] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:24:33,403.403] base.py -> _exec_single_context line:1901 [INFO]: [cached since 35.79s ago] {'pk_1': UUID('2fc9ccc9-3383-4909-84f1-ffcfc21b6b79')}
[2025-06-06 17:24:33,405.405] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:24:33] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-06-06 17:24:33,410.410] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:24:33,411.411] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:24:33,411.411] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:24:33,411.411] base.py -> _exec_single_context line:1901 [INFO]: [cached since 28.54s ago] {'pk_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e')}
[2025-06-06 17:24:33,413.413] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:24:33,414.414] base.py -> _exec_single_context line:1901 [INFO]: [cached since 28.65s ago] {'pk_1': UUID('2fc9ccc9-3383-4909-84f1-ffcfc21b6b79')}
[2025-06-06 17:24:33,416.416] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET status=%(status)s, error=%(error)s WHERE message.id = %(message_id)s::UUID
[2025-06-06 17:24:33,416.416] base.py -> _exec_single_context line:1901 [INFO]: [cached since 28.52s ago] {'status': <QueueEvent.ERROR: 'error'>, 'error': "LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'", 'message_id': UUID('2fc9ccc9-3383-4909-84f1-ffcfc21b6b79')}
[2025-06-06 17:24:33,418.418] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:24:33,733.733] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:24:33] "OPTIONS /ai/suggested-questions HTTP/1.1" 200 -
[2025-06-06 17:24:34,046.046] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:24:34,046.046] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:24:34,046.046] base.py -> _exec_single_context line:1901 [INFO]: [cached since 36.83s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:24:34,048.048] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:24:34,049.049] base.py -> _exec_single_context line:1901 [INFO]: [cached since 29.28s ago] {'pk_1': '2fc9ccc9-3383-4909-84f1-ffcfc21b6b79'}
[2025-06-06 17:24:39,608.608] function_call_agent.py -> _llm_node line:192 [ERROR]: LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\core\agent\agents\function_call_agent.py", line 159, in _llm_node
    for chunk in llm.stream(state["messages"]):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 499, in stream
    for chunk in self._stream(input_messages, stop=stop, **kwargs):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 849, in _stream
    generation_chunk = self._convert_chunk_to_generation_chunk(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 707, in _convert_chunk_to_generation_chunk
    _create_usage_metadata(token_usage) if token_usage else None
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 2808, in _create_usage_metadata
    total_tokens = oai_token_usage.get("total_tokens", input_tokens + output_tokens)
TypeError: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
[2025-06-06 17:24:39,612.612] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:24:39,612.612] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:24:39,613.613] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:24:39,613.613] base.py -> _exec_single_context line:1901 [INFO]: [cached since 34.74s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 17:24:39,615.615] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:24:39,615.615] base.py -> _exec_single_context line:1901 [INFO]: [cached since 34.85s ago] {'pk_1': UUID('44cdbb06-e0dd-4211-8139-00c584345540')}
[2025-06-06 17:24:39,616.616] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-06-06 17:24:39,616.616] base.py -> _exec_single_context line:1901 [INFO]: [cached since 34.74s ago] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'message_id': UUID('44cdbb06-e0dd-4211-8139-00c584345540'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-06-06 17:24:39,617.617] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:24:39,619.619] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:24:39,619.619] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:24:39,619.619] base.py -> _exec_single_context line:1901 [INFO]: [cached since 42s ago] {'pk_1': UUID('44cdbb06-e0dd-4211-8139-00c584345540')}
[2025-06-06 17:24:39,620.620] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET status=%(status)s, error=%(error)s WHERE message.id = %(message_id)s::UUID
[2025-06-06 17:24:39,621.621] base.py -> _exec_single_context line:1901 [INFO]: [cached since 34.73s ago] {'status': <QueueEvent.ERROR: 'error'>, 'error': "LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'", 'message_id': UUID('44cdbb06-e0dd-4211-8139-00c584345540')}
[2025-06-06 17:24:39,621.621] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:24:40,181.181] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:24:40,182.182] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:24:40] "POST /ai/suggested-questions HTTP/1.1" 200 -
[2025-06-06 17:26:17,290.290] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-06-06 17:26:17,291.291] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-06-06 17:26:17,292.292] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 17:26:22,594.594] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-06-06 17:26:22,596.596] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-06-06 17:28:15,628.628] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-06-06 17:28:15,628.628] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 17:28:15,629.629] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-06-06 17:28:15,629.629] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 17:28:15,630.630] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-06-06 17:28:15,630.630] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 17:28:15,630.630] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:28:15,632.632] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:28:15,632.632] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00028s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:28:15,637.637] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:28:15,638.638] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00096s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 17:28:15,642.642] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 17:28:15,642.642] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00037s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½,AIæ˜¯ä»€ä¹ˆ?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 17:28:15,647.647] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:28:15,689.689] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:28:15,691.691] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:28:15,691.691] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00054s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 17:28:15,694.694] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 17:28:15,695.695] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00044s] {'conversation_id_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'answer_1': '', 'param_1': 3, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 17:28:15,698.698] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:28:15,698.698] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00028s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:28:15,933.933] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:28:15,933.933] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00053s] {'pk_1': UUID('3f4dff3b-0663-48d8-92ab-ef18c3b4dd34')}
[2025-06-06 17:28:15,935.935] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:28:15] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 17:28:23,436.436] function_call_agent.py -> _llm_node line:192 [ERROR]: LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\core\agent\agents\function_call_agent.py", line 159, in _llm_node
    for chunk in llm.stream(state["messages"]):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 499, in stream
    for chunk in self._stream(input_messages, stop=stop, **kwargs):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 849, in _stream
    generation_chunk = self._convert_chunk_to_generation_chunk(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 707, in _convert_chunk_to_generation_chunk
    _create_usage_metadata(token_usage) if token_usage else None
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 2808, in _create_usage_metadata
    total_tokens = oai_token_usage.get("total_tokens", input_tokens + output_tokens)
TypeError: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
[2025-06-06 17:28:23,443.443] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:28:23,602.602] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:28:23,603.603] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:28:23,603.603] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.965s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 17:28:23,606.606] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:28:23,606.606] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00035s] {'pk_1': UUID('3f4dff3b-0663-48d8-92ab-ef18c3b4dd34')}
[2025-06-06 17:28:23,610.610] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-06-06 17:28:23,610.610] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00038s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'message_id': UUID('3f4dff3b-0663-48d8-92ab-ef18c3b4dd34'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-06-06 17:28:23,615.615] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:28:23,618.618] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:28:23,618.618] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:28:23,618.618] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.686s ago] {'pk_1': UUID('3f4dff3b-0663-48d8-92ab-ef18c3b4dd34')}
[2025-06-06 17:28:23,619.619] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET status=%(status)s, error=%(error)s WHERE message.id = %(message_id)s::UUID
[2025-06-06 17:28:23,619.619] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00028s] {'status': <QueueEvent.ERROR: 'error'>, 'error': "LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'", 'message_id': UUID('3f4dff3b-0663-48d8-92ab-ef18c3b4dd34')}
[2025-06-06 17:28:23,620.620] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:33:46,802.802] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\core\\memory\\token_buffer_memory.py', reloading
[2025-06-06 17:33:47,145.145] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 17:33:52,570.570] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-06-06 17:33:52,573.573] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-06-06 17:34:03,863.863] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\handler\\dataset_handler.py', reloading
[2025-06-06 17:34:04,217.217] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 17:34:09,458.458] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-06-06 17:34:09,461.461] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-06-06 17:35:11,771.771] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\vector_database_service.py', reloading
[2025-06-06 17:35:12,099.099] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 17:35:33,495.495] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-06-06 17:35:33,500.500] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-06-06 17:35:33,773.773] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-06-06 17:35:33,773.773] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 17:35:33,775.775] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-06-06 17:35:33,775.775] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 17:35:33,776.776] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-06-06 17:35:33,776.776] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 17:35:33,777.777] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:35:33,779.779] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:35:33,780.780] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00051s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:35:33,785.785] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:35:33,786.786] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00036s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 17:35:33,789.789] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 17:35:33,790.790] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00030s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½,AIæ˜¯ä»€ä¹ˆ?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 17:35:33,796.796] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:35:33,839.839] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:35:33,840.840] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:35:33,840.840] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00029s] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 17:35:33,843.843] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 17:35:33,843.843] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00032s] {'conversation_id_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'answer_1': '', 'param_1': 3, 'status_1_1': <MessageStatus.NORMAL: 'normal'>, 'status_1_2': <MessageStatus.STOP: 'stop'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 17:35:33,845.845] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:35:33,846.846] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00027s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:35:34,180.180] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:35:34,180.180] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00057s] {'pk_1': UUID('f51ff3ce-5223-4d60-84da-a11d576a9a80')}
[2025-06-06 17:35:34,183.183] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:35:34] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 17:35:41,803.803] function_call_agent.py -> _llm_node line:192 [ERROR]: LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\core\agent\agents\function_call_agent.py", line 159, in _llm_node
    for chunk in llm.stream(state["messages"]):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 499, in stream
    for chunk in self._stream(input_messages, stop=stop, **kwargs):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 849, in _stream
    generation_chunk = self._convert_chunk_to_generation_chunk(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 707, in _convert_chunk_to_generation_chunk
    _create_usage_metadata(token_usage) if token_usage else None
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 2808, in _create_usage_metadata
    total_tokens = oai_token_usage.get("total_tokens", input_tokens + output_tokens)
TypeError: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
[2025-06-06 17:35:41,810.810] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:35:41,929.929] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:35:41,930.930] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:35:41,930.930] base.py -> _exec_single_context line:1901 [INFO]: [cached since 8.145s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 17:35:41,932.932] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:35:41,933.933] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00029s] {'pk_1': UUID('f51ff3ce-5223-4d60-84da-a11d576a9a80')}
[2025-06-06 17:35:41,936.936] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-06-06 17:35:41,936.936] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00034s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'message_id': UUID('f51ff3ce-5223-4d60-84da-a11d576a9a80'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-06-06 17:35:41,942.942] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:35:41,943.943] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:35:41,944.944] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:35:41,944.944] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.765s ago] {'pk_1': UUID('f51ff3ce-5223-4d60-84da-a11d576a9a80')}
[2025-06-06 17:35:41,945.945] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET status=%(status)s, error=%(error)s WHERE message.id = %(message_id)s::UUID
[2025-06-06 17:35:41,946.946] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00024s] {'status': <QueueEvent.ERROR: 'error'>, 'error': "LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'", 'message_id': UUID('f51ff3ce-5223-4d60-84da-a11d576a9a80')}
[2025-06-06 17:35:41,946.946] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:35:49,075.075] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:35:49] "OPTIONS /builtin-tools/categories HTTP/1.1" 200 -
[2025-06-06 17:35:49,075.075] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:35:49] "OPTIONS /datasets?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-06-06 17:35:49,076.076] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:35:49] "OPTIONS /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-06-06 17:35:49,077.077] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:35:49] "OPTIONS /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations/messages?current_page=1&page_size=5&created_at=0 HTTP/1.1" 200 -
[2025-06-06 17:35:49,077.077] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:35:49] "OPTIONS /apps/83040ed9-0795-43db-99da-b6eb2321a71b HTTP/1.1" 200 -
[2025-06-06 17:35:49,387.387] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:35:49] "GET /builtin-tools/categories HTTP/1.1" 200 -
[2025-06-06 17:35:49,388.388] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:35:49,389.389] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:35:49,390.390] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:35:49,390.390] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:35:49,390.390] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.61s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:35:49,390.390] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.61s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:35:49,393.393] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:35:49,394.394] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00084s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:35:49,395.395] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.account_id = %(account_id_1)s::UUID ORDER BY dataset.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-06-06 17:35:49,395.395] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00031s] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'param_1': 20, 'param_2': 0}
[2025-06-06 17:35:49,398.398] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:35:49,399.399] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT dataset.id AS id, dataset.account_id AS account_id, dataset.name AS name, dataset.icon AS icon, dataset.description AS description, dataset.updated_at AS updated_at, dataset.created_at AS created_at 
FROM dataset 
WHERE dataset.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-06-06 17:35:49,399.399] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00200s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:35:49,399.399] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00057s] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:35:49,401.401] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,402.402] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-06-06 17:35:49,402.402] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00111s] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-06-06 17:35:49,403.403] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00052s] {'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-06-06 17:35:49,404.404] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,405.405] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:35:49,405.405] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00094s] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-06-06 17:35:49,406.406] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:35:49] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-06-06 17:35:49,407.407] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,408.408] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:35:49,408.408] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00102s] {'coalesce_2': 0, 'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-06-06 17:35:49,409.409] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:35:49,409.409] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.63s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:35:49,409.409] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,410.410] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:35:49,410.410] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.008852s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-06-06 17:35:49,410.410] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01741s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:35:49,411.411] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,411.411] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.006798s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-06-06 17:35:49,412.412] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:35:49,412.412] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,413.413] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0155s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:35:49,413.413] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.00545s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-06-06 17:35:49,413.413] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,414.414] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:35:49,415.415] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01309s ago] {'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-06-06 17:35:49,415.415] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:35:49] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b HTTP/1.1" 200 -
[2025-06-06 17:35:49,416.416] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,416.416] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01172s ago] {'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-06-06 17:35:49,417.417] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,418.418] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01007s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-06-06 17:35:49,420.420] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,420.420] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01893s ago] {'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-06-06 17:35:49,421.421] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,422.422] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01704s ago] {'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-06-06 17:35:49,422.422] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,423.423] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01494s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-06-06 17:35:49,423.423] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,423.423] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.022s ago] {'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-06-06 17:35:49,424.424] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,424.424] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01973s ago] {'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-06-06 17:35:49,425.425] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,425.425] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01745s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-06-06 17:35:49,426.426] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,426.426] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02443s ago] {'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-06-06 17:35:49,426.426] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,427.427] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02216s ago] {'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-06-06 17:35:49,427.427] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,428.428] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01992s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-06-06 17:35:49,428.428] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,428.428] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02684s ago] {'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-06-06 17:35:49,429.429] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,429.429] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02478s ago] {'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-06-06 17:35:49,430.430] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,430.430] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02269s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-06-06 17:35:49,431.431] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,431.431] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02987s ago] {'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-06-06 17:35:49,433.433] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,433.433] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02798s ago] {'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-06-06 17:35:49,434.434] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,434.434] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02611s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-06-06 17:35:49,435.435] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,435.435] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03348s ago] {'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-06-06 17:35:49,436.436] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,436.436] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0316s ago] {'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-06-06 17:35:49,437.437] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,438.438] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02978s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-06-06 17:35:49,439.439] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,439.439] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03757s ago] {'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-06-06 17:35:49,441.441] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,441.441] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03611s ago] {'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-06-06 17:35:49,442.442] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,442.442] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03421s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-06-06 17:35:49,443.443] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,443.443] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04139s ago] {'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-06-06 17:35:49,444.444] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,445.445] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03986s ago] {'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-06-06 17:35:49,445.445] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,445.445] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03809s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-06-06 17:35:49,447.447] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,448.448] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04604s ago] {'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-06-06 17:35:49,449.449] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,449.449] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04474s ago] {'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-06-06 17:35:49,450.450] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,451.451] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04305s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-06-06 17:35:49,452.452] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,452.452] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05089s ago] {'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-06-06 17:35:49,453.453] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,454.454] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04905s ago] {'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-06-06 17:35:49,455.455] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,455.455] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04725s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-06-06 17:35:49,456.456] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,456.456] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05491s ago] {'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-06-06 17:35:49,457.457] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,457.457] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05274s ago] {'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-06-06 17:35:49,457.457] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,459.459] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05047s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-06-06 17:35:49,459.459] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,459.459] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05749s ago] {'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-06-06 17:35:49,460.460] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,460.460] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05568s ago] {'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-06-06 17:35:49,462.462] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,462.462] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05419s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-06-06 17:35:49,463.463] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,463.463] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.06126s ago] {'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-06-06 17:35:49,464.464] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,464.464] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0592s ago] {'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-06-06 17:35:49,465.465] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,466.466] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05755s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-06-06 17:35:49,467.467] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,467.467] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.06502s ago] {'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-06-06 17:35:49,468.468] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,468.468] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.06305s ago] {'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-06-06 17:35:49,469.469] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,469.469] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.06087s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-06-06 17:35:49,470.470] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,470.470] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0679s ago] {'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-06-06 17:35:49,470.470] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,471.471] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.06567s ago] {'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-06-06 17:35:49,471.471] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,472.472] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.06372s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-06-06 17:35:49,473.473] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,473.473] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.07127s ago] {'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-06-06 17:35:49,474.474] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,474.474] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.06929s ago] {'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-06-06 17:35:49,475.475] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,476.476] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.06767s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-06-06 17:35:49,477.477] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,477.477] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.07503s ago] {'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-06-06 17:35:49,478.478] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,478.478] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.07302s ago] {'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-06-06 17:35:49,479.479] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:49,479.479] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.07103s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-06-06 17:35:49,481.481] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:35:49,481.481] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:35:49] "GET /datasets?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-06-06 17:35:49,534.534] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:35:49,534.534] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:35:49,535.535] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.76s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:35:49,539.539] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:35:49,539.539] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.1457s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:35:49,542.542] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-06-06 17:35:49,542.542] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00053s] {'id_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-06-06 17:35:49,546.546] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.status IN (%(status_1_1)s, %(status_1_2)s) AND message.answer != %(answer_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-06-06 17:35:49,547.547] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00062s] {'conversation_id_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'answer_1': '', 'param_1': 5, 'param_2': 0, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 17:35:49,553.553] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT message.id AS id, message.app_id AS app_id, message.conversation_id AS conversation_id, message.invoke_from AS invoke_from, message.created_by AS created_by, message.query AS query, message.message AS message, message.message_token_count AS message_token_count, message.message_unit_price AS message_unit_price, message.message_price_unit AS message_price_unit, message.answer AS answer, message.answer_token_count AS answer_token_count, message.answer_unit_price AS answer_unit_price, message.answer_price_unit AS answer_price_unit, message.latency AS latency, message.is_deleted AS is_deleted, message.status AS status, message.error AS error, message.total_token_count AS total_token_count, message.total_price AS total_price, message.updated_at AS updated_at, message.created_at AS created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.status IN (%(status_1_1)s, %(status_1_2)s) AND message.answer != %(answer_1)s) AS anon_1
[2025-06-06 17:35:49,553.553] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00046s] {'conversation_id_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'answer_1': '', 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 17:35:49,556.556] base.py -> _exec_single_context line:1896 [INFO]: SELECT message_agent_thought.id AS message_agent_thought_id, message_agent_thought.app_id AS message_agent_thought_app_id, message_agent_thought.conversation_id AS message_agent_thought_conversation_id, message_agent_thought.message_id AS message_agent_thought_message_id, message_agent_thought.invoke_from AS message_agent_thought_invoke_from, message_agent_thought.created_by AS message_agent_thought_created_by, message_agent_thought.position AS message_agent_thought_position, message_agent_thought.event AS message_agent_thought_event, message_agent_thought.thought AS message_agent_thought_thought, message_agent_thought.observation AS message_agent_thought_observation, message_agent_thought.tool AS message_agent_thought_tool, message_agent_thought.tool_input AS message_agent_thought_tool_input, message_agent_thought.message AS message_agent_thought_message, message_agent_thought.message_token_count AS message_agent_thought_message_token_count, message_agent_thought.message_unit_price AS message_agent_thought_message_unit_price, message_agent_thought.message_price_unit AS message_agent_thought_message_price_unit, message_agent_thought.answer AS message_agent_thought_answer, message_agent_thought.answer_token_count AS message_agent_thought_answer_token_count, message_agent_thought.answer_unit_price AS message_agent_thought_answer_unit_price, message_agent_thought.answer_price_unit AS message_agent_thought_answer_price_unit, message_agent_thought.total_token_count AS message_agent_thought_total_token_count, message_agent_thought.total_price AS message_agent_thought_total_price, message_agent_thought.latency AS message_agent_thought_latency, message_agent_thought.updated_at AS message_agent_thought_updated_at, message_agent_thought.created_at AS message_agent_thought_created_at 
FROM message_agent_thought 
WHERE message_agent_thought.message_id = %(message_id_1)s::UUID ORDER BY message_agent_thought.position ASC
[2025-06-06 17:35:49,556.556] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00047s] {'message_id_1': UUID('4bde7302-f192-44bc-9ff0-ec55223fb3da')}
[2025-06-06 17:35:49,650.650] base.py -> _exec_single_context line:1896 [INFO]: SELECT message_agent_thought.id AS message_agent_thought_id, message_agent_thought.app_id AS message_agent_thought_app_id, message_agent_thought.conversation_id AS message_agent_thought_conversation_id, message_agent_thought.message_id AS message_agent_thought_message_id, message_agent_thought.invoke_from AS message_agent_thought_invoke_from, message_agent_thought.created_by AS message_agent_thought_created_by, message_agent_thought.position AS message_agent_thought_position, message_agent_thought.event AS message_agent_thought_event, message_agent_thought.thought AS message_agent_thought_thought, message_agent_thought.observation AS message_agent_thought_observation, message_agent_thought.tool AS message_agent_thought_tool, message_agent_thought.tool_input AS message_agent_thought_tool_input, message_agent_thought.message AS message_agent_thought_message, message_agent_thought.message_token_count AS message_agent_thought_message_token_count, message_agent_thought.message_unit_price AS message_agent_thought_message_unit_price, message_agent_thought.message_price_unit AS message_agent_thought_message_price_unit, message_agent_thought.answer AS message_agent_thought_answer, message_agent_thought.answer_token_count AS message_agent_thought_answer_token_count, message_agent_thought.answer_unit_price AS message_agent_thought_answer_unit_price, message_agent_thought.answer_price_unit AS message_agent_thought_answer_price_unit, message_agent_thought.total_token_count AS message_agent_thought_total_token_count, message_agent_thought.total_price AS message_agent_thought_total_price, message_agent_thought.latency AS message_agent_thought_latency, message_agent_thought.updated_at AS message_agent_thought_updated_at, message_agent_thought.created_at AS message_agent_thought_created_at 
FROM message_agent_thought 
WHERE message_agent_thought.message_id = %(message_id_1)s::UUID ORDER BY message_agent_thought.position ASC
[2025-06-06 17:35:49,651.651] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.09585s ago] {'message_id_1': UUID('ed8be130-3c49-49b9-8fd2-f621d6150418')}
[2025-06-06 17:35:49,653.653] base.py -> _exec_single_context line:1896 [INFO]: SELECT message_agent_thought.id AS message_agent_thought_id, message_agent_thought.app_id AS message_agent_thought_app_id, message_agent_thought.conversation_id AS message_agent_thought_conversation_id, message_agent_thought.message_id AS message_agent_thought_message_id, message_agent_thought.invoke_from AS message_agent_thought_invoke_from, message_agent_thought.created_by AS message_agent_thought_created_by, message_agent_thought.position AS message_agent_thought_position, message_agent_thought.event AS message_agent_thought_event, message_agent_thought.thought AS message_agent_thought_thought, message_agent_thought.observation AS message_agent_thought_observation, message_agent_thought.tool AS message_agent_thought_tool, message_agent_thought.tool_input AS message_agent_thought_tool_input, message_agent_thought.message AS message_agent_thought_message, message_agent_thought.message_token_count AS message_agent_thought_message_token_count, message_agent_thought.message_unit_price AS message_agent_thought_message_unit_price, message_agent_thought.message_price_unit AS message_agent_thought_message_price_unit, message_agent_thought.answer AS message_agent_thought_answer, message_agent_thought.answer_token_count AS message_agent_thought_answer_token_count, message_agent_thought.answer_unit_price AS message_agent_thought_answer_unit_price, message_agent_thought.answer_price_unit AS message_agent_thought_answer_price_unit, message_agent_thought.total_token_count AS message_agent_thought_total_token_count, message_agent_thought.total_price AS message_agent_thought_total_price, message_agent_thought.latency AS message_agent_thought_latency, message_agent_thought.updated_at AS message_agent_thought_updated_at, message_agent_thought.created_at AS message_agent_thought_created_at 
FROM message_agent_thought 
WHERE message_agent_thought.message_id = %(message_id_1)s::UUID ORDER BY message_agent_thought.position ASC
[2025-06-06 17:35:49,654.654] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.09809s ago] {'message_id_1': UUID('2436bd16-3937-4c92-bbc8-3011112aedde')}
[2025-06-06 17:35:49,655.655] base.py -> _exec_single_context line:1896 [INFO]: SELECT message_agent_thought.id AS message_agent_thought_id, message_agent_thought.app_id AS message_agent_thought_app_id, message_agent_thought.conversation_id AS message_agent_thought_conversation_id, message_agent_thought.message_id AS message_agent_thought_message_id, message_agent_thought.invoke_from AS message_agent_thought_invoke_from, message_agent_thought.created_by AS message_agent_thought_created_by, message_agent_thought.position AS message_agent_thought_position, message_agent_thought.event AS message_agent_thought_event, message_agent_thought.thought AS message_agent_thought_thought, message_agent_thought.observation AS message_agent_thought_observation, message_agent_thought.tool AS message_agent_thought_tool, message_agent_thought.tool_input AS message_agent_thought_tool_input, message_agent_thought.message AS message_agent_thought_message, message_agent_thought.message_token_count AS message_agent_thought_message_token_count, message_agent_thought.message_unit_price AS message_agent_thought_message_unit_price, message_agent_thought.message_price_unit AS message_agent_thought_message_price_unit, message_agent_thought.answer AS message_agent_thought_answer, message_agent_thought.answer_token_count AS message_agent_thought_answer_token_count, message_agent_thought.answer_unit_price AS message_agent_thought_answer_unit_price, message_agent_thought.answer_price_unit AS message_agent_thought_answer_price_unit, message_agent_thought.total_token_count AS message_agent_thought_total_token_count, message_agent_thought.total_price AS message_agent_thought_total_price, message_agent_thought.latency AS message_agent_thought_latency, message_agent_thought.updated_at AS message_agent_thought_updated_at, message_agent_thought.created_at AS message_agent_thought_created_at 
FROM message_agent_thought 
WHERE message_agent_thought.message_id = %(message_id_1)s::UUID ORDER BY message_agent_thought.position ASC
[2025-06-06 17:35:49,660.660] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.1036s ago] {'message_id_1': UUID('a7dad8ef-c18d-45fc-acf5-e68dc70dbcb8')}
[2025-06-06 17:35:49,662.662] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:35:49,664.664] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:35:49] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations/messages?current_page=1&page_size=5&created_at=0 HTTP/1.1" 200 -
[2025-06-06 17:35:49,897.897] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:35:49] "GET /builtin-tools/google/icon HTTP/1.1" 200 -
[2025-06-06 17:35:49,936.936] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:35:49] "GET /builtin-tools/gaode/icon HTTP/1.1" 200 -
[2025-06-06 17:35:54,979.979] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:35:54] "OPTIONS /apps?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-06-06 17:35:54,984.984] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:35:54,985.985] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:35:54,985.985] base.py -> _exec_single_context line:1901 [INFO]: [cached since 21.21s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:35:54,989.989] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.account_id = %(account_id_1)s::UUID ORDER BY app.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-06-06 17:35:54,989.989] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00065s] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'param_1': 20, 'param_2': 0}
[2025-06-06 17:35:54,992.992] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT app.id AS id, app.account_id AS account_id, app.app_config_id AS app_config_id, app.draft_app_config_id AS draft_app_config_id, app.debug_conversation_id AS debug_conversation_id, app.name AS name, app.icon AS icon, app.description AS description, app.status AS status, app.updated_at AS updated_at, app.created_at AS created_at 
FROM app 
WHERE app.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-06-06 17:35:54,992.992] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00044s] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:35:54,993.993] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:35:54,993.993] base.py -> _exec_single_context line:1901 [INFO]: [cached since 5.596s ago] {'app_id_1': UUID('1dd689e3-ceaa-4adc-b382-298ac0250798'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:35:54,995.995] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:35:54,996.996] base.py -> _exec_single_context line:1901 [INFO]: [cached since 5.598s ago] {'app_id_1': UUID('4e929f64-66bf-4718-9637-fa7f12b4d804'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:35:54,997.997] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:35:54,998.998] base.py -> _exec_single_context line:1901 [INFO]: [cached since 5.6s ago] {'app_id_1': UUID('05519640-8a7f-4606-bb09-cc3ca8948407'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:35:55,000.000] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:35:55,001.001] base.py -> _exec_single_context line:1901 [INFO]: [cached since 5.603s ago] {'app_id_1': UUID('72072ee8-f80b-47b9-9e66-d5805e0bff79'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:35:55,004.004] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config.id AS app_config_id, app_config.app_id AS app_config_app_id, app_config.model_config AS app_config_model_config, app_config.dialog_round AS app_config_dialog_round, app_config.preset_prompt AS app_config_preset_prompt, app_config.tools AS app_config_tools, app_config.workflows AS app_config_workflows, app_config.retrieval_config AS app_config_retrieval_config, app_config.long_term_memory AS app_config_long_term_memory, app_config.opening_statement AS app_config_opening_statement, app_config.opening_questions AS app_config_opening_questions, app_config.speech_to_text AS app_config_speech_to_text, app_config.text_to_speech AS app_config_text_to_speech, app_config.suggested_after_answer AS app_config_suggested_after_answer, app_config.review_config AS app_config_review_config, app_config.updated_at AS app_config_updated_at, app_config.created_at AS app_config_created_at 
FROM app_config 
WHERE app_config.id = %(pk_1)s::UUID
[2025-06-06 17:35:55,004.004] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00030s] {'pk_1': UUID('f6e0a072-f9e7-4b23-837e-281d1084df58')}
[2025-06-06 17:35:55,007.007] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:35:55,008.008] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:35:55] "GET /apps?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-06-06 17:35:55,288.288] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:35:55] "OPTIONS /account HTTP/1.1" 200 -
[2025-06-06 17:35:55,601.601] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:35:55,601.601] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:35:55,601.601] base.py -> _exec_single_context line:1901 [INFO]: [cached since 21.82s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:35:55,603.603] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:35:55,603.603] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:35:55] "GET /account HTTP/1.1" 200 -
[2025-06-06 17:35:58,086.086] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:35:58] "OPTIONS /api-tools?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-06-06 17:35:58,089.089] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:35:58,090.090] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:35:58,090.090] base.py -> _exec_single_context line:1901 [INFO]: [cached since 24.31s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:35:58,092.092] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool_provider.id AS api_tool_provider_id, api_tool_provider.account_id AS api_tool_provider_account_id, api_tool_provider.name AS api_tool_provider_name, api_tool_provider.icon AS api_tool_provider_icon, api_tool_provider.description AS api_tool_provider_description, api_tool_provider.openapi_schema AS api_tool_provider_openapi_schema, api_tool_provider.headers AS api_tool_provider_headers, api_tool_provider.updated_at AS api_tool_provider_updated_at, api_tool_provider.created_at AS api_tool_provider_created_at 
FROM api_tool_provider 
WHERE api_tool_provider.account_id = %(account_id_1)s::UUID ORDER BY api_tool_provider.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-06-06 17:35:58,093.093] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00034s] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'param_1': 20, 'param_2': 0}
[2025-06-06 17:35:58,097.097] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT api_tool_provider.id AS id, api_tool_provider.account_id AS account_id, api_tool_provider.name AS name, api_tool_provider.icon AS icon, api_tool_provider.description AS description, api_tool_provider.openapi_schema AS openapi_schema, api_tool_provider.headers AS headers, api_tool_provider.updated_at AS updated_at, api_tool_provider.created_at AS created_at 
FROM api_tool_provider 
WHERE api_tool_provider.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-06-06 17:35:58,097.097] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00040s] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:35:58,099.099] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:35:58,099.099] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00029s] {'provider_id_1': UUID('7e41e2e9-5940-4853-ac4d-fb92bcd7840a')}
[2025-06-06 17:35:58,101.101] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:35:58,102.102] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.002765s ago] {'provider_id_1': UUID('ee453518-8819-43b8-9693-fbb0ec025b6b')}
[2025-06-06 17:35:58,102.102] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:35:58,102.102] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.00361s ago] {'provider_id_1': UUID('5c706d2f-1e5d-4a1e-a87d-7e284d7d69fd')}
[2025-06-06 17:35:58,103.103] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:35:58,103.103] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.00442s ago] {'provider_id_1': UUID('bed074e4-c5af-4bd4-88f7-81251eb95a6c')}
[2025-06-06 17:35:58,104.104] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:35:58,104.104] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.005225s ago] {'provider_id_1': UUID('1bd06d2b-1d4c-4bf5-8812-f94a0fa8cd0e')}
[2025-06-06 17:35:58,105.105] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:35:58,105.105] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.006054s ago] {'provider_id_1': UUID('e9780583-c578-42e4-84ef-e3c2c1069de9')}
[2025-06-06 17:35:58,105.105] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:35:58,106.106] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.00689s ago] {'provider_id_1': UUID('94cef19d-3df1-457e-8f1f-5e6ecec2df39')}
[2025-06-06 17:35:58,106.106] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:35:58,107.107] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.007911s ago] {'provider_id_1': UUID('a9fd691c-c789-45b4-af05-1df914542bad')}
[2025-06-06 17:35:58,108.108] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:35:58,108.108] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.009139s ago] {'provider_id_1': UUID('db13bc34-1d40-49e5-92d8-d22c7418cf7d')}
[2025-06-06 17:35:58,109.109] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:35:58,109.109] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01012s ago] {'provider_id_1': UUID('bbd73f46-4891-4f18-a8cf-065e1639809f')}
[2025-06-06 17:35:58,110.110] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:35:58,110.110] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01098s ago] {'provider_id_1': UUID('8229ae9b-a334-472e-af36-8c1e36b85356')}
[2025-06-06 17:35:58,110.110] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:35:58,111.111] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01188s ago] {'provider_id_1': UUID('e1afb674-e985-4f45-9416-04c8457ef621')}
[2025-06-06 17:35:58,111.111] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:35:58,111.111] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01267s ago] {'provider_id_1': UUID('eb23d087-cfac-4b07-b348-0ce7e019e481')}
[2025-06-06 17:35:58,112.112] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:35:58,113.113] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01375s ago] {'provider_id_1': UUID('4a3b1d5e-7eba-4d5e-a903-08bc4e381ddf')}
[2025-06-06 17:35:58,113.113] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:35:58,114.114] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01487s ago] {'provider_id_1': UUID('c7fd1c86-ad90-4011-aa6f-37af7dd7c123')}
[2025-06-06 17:35:58,115.115] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:35:58,115.115] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01614s ago] {'provider_id_1': UUID('79f0585f-48e8-4612-ac04-8742e6eb849d')}
[2025-06-06 17:35:58,116.116] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:35:58,117.117] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01744s ago] {'provider_id_1': UUID('bce415bd-bdca-4976-b519-35c4c9af2b99')}
[2025-06-06 17:35:58,117.117] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:35:58,118.118] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01861s ago] {'provider_id_1': UUID('f7190437-4704-4f73-9871-a786624778be')}
[2025-06-06 17:35:58,119.119] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:35:58,119.119] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01986s ago] {'provider_id_1': UUID('a93b42f1-9d6d-4d7b-9687-cfa76eee2ff2')}
[2025-06-06 17:35:58,120.120] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:35:58,120.120] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02112s ago] {'provider_id_1': UUID('e9b3b8ee-b6fb-4217-8c3e-57b3c0175c3c')}
[2025-06-06 17:35:58,123.123] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:35:58,123.123] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:35:58] "GET /api-tools?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-06-06 17:35:58,884.884] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:35:58] "OPTIONS /workflows?current_page=1&page_size=20&search_word=&status= HTTP/1.1" 200 -
[2025-06-06 17:35:59,203.203] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:35:59,203.203] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:35:59,203.203] base.py -> _exec_single_context line:1901 [INFO]: [cached since 25.42s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:35:59,206.206] base.py -> _exec_single_context line:1896 [INFO]: SELECT workflow.id AS workflow_id, workflow.account_id AS workflow_account_id, workflow.name AS workflow_name, workflow.tool_call_name AS workflow_tool_call_name, workflow.icon AS workflow_icon, workflow.description AS workflow_description, workflow.graph AS workflow_graph, workflow.draft_graph AS workflow_draft_graph, workflow.is_debug_passed AS workflow_is_debug_passed, workflow.status AS workflow_status, workflow.published_at AS workflow_published_at, workflow.updated_at AS workflow_updated_at, workflow.created_at AS workflow_created_at 
FROM workflow 
WHERE workflow.account_id = %(account_id_1)s::UUID ORDER BY workflow.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-06-06 17:35:59,206.206] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00026s] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'param_1': 20, 'param_2': 0}
[2025-06-06 17:35:59,210.210] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT workflow.id AS id, workflow.account_id AS account_id, workflow.name AS name, workflow.tool_call_name AS tool_call_name, workflow.icon AS icon, workflow.description AS description, workflow.graph AS graph, workflow.draft_graph AS draft_graph, workflow.is_debug_passed AS is_debug_passed, workflow.status AS status, workflow.published_at AS published_at, workflow.updated_at AS updated_at, workflow.created_at AS created_at 
FROM workflow 
WHERE workflow.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-06-06 17:35:59,210.210] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00036s] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:35:59,211.211] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:35:59,211.211] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:35:59] "GET /workflows?current_page=1&page_size=20&search_word=&status= HTTP/1.1" 200 -
[2025-06-06 17:35:59,794.794] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:35:59] "OPTIONS /datasets?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-06-06 17:35:59,798.798] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:35:59,798.798] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:35:59,799.799] base.py -> _exec_single_context line:1901 [INFO]: [cached since 26.02s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:35:59,800.800] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.account_id = %(account_id_1)s::UUID ORDER BY dataset.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-06-06 17:35:59,800.800] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.41s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'param_1': 20, 'param_2': 0}
[2025-06-06 17:35:59,801.801] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT dataset.id AS id, dataset.account_id AS account_id, dataset.name AS name, dataset.icon AS icon, dataset.description AS description, dataset.updated_at AS updated_at, dataset.created_at AS created_at 
FROM dataset 
WHERE dataset.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-06-06 17:35:59,801.801] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.4s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:35:59,802.802] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,802.802] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.4s ago] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-06-06 17:35:59,803.803] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,803.803] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.4s ago] {'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-06-06 17:35:59,804.804] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,804.804] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.4s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9315438-563c-44e2-99a0-a60e0ba4b76e')}
[2025-06-06 17:35:59,805.805] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,805.805] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.4s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-06-06 17:35:59,806.806] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,806.806] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.4s ago] {'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-06-06 17:35:59,807.807] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,807.807] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.4s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('e9af1e9e-fc18-4521-b222-79303a3a949f')}
[2025-06-06 17:35:59,808.808] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,808.808] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.41s ago] {'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-06-06 17:35:59,808.808] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,808.808] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.4s ago] {'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-06-06 17:35:59,809.809] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,809.809] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.4s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c44c3229-35d5-4db8-b710-0e66089b5194')}
[2025-06-06 17:35:59,810.810] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,810.810] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.41s ago] {'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-06-06 17:35:59,810.810] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,812.812] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.41s ago] {'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-06-06 17:35:59,812.812] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,812.812] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.4s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c4893bc6-7efb-45e4-8307-baf962a48b05')}
[2025-06-06 17:35:59,812.812] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,812.812] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.41s ago] {'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-06-06 17:35:59,813.813] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,813.813] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.41s ago] {'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-06-06 17:35:59,813.813] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,814.814] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.41s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('4cc5b531-8c8a-47b1-a641-bf75d7b7ac82')}
[2025-06-06 17:35:59,814.814] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,814.814] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.41s ago] {'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-06-06 17:35:59,815.815] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,815.815] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.41s ago] {'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-06-06 17:35:59,817.817] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,817.817] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.41s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('1ff78486-ddd5-45f0-a024-d63ecbeaa307')}
[2025-06-06 17:35:59,817.817] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,817.817] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.42s ago] {'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-06-06 17:35:59,818.818] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,818.818] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.41s ago] {'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-06-06 17:35:59,819.819] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,819.819] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.41s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('639052d1-06f1-4e89-a2d8-6eef01fcb5bd')}
[2025-06-06 17:35:59,819.819] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,819.819] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.42s ago] {'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-06-06 17:35:59,820.820] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,820.820] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.42s ago] {'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-06-06 17:35:59,821.821] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,821.821] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.41s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('7b5aca75-14ea-434c-8cbb-c3508eb3dc68')}
[2025-06-06 17:35:59,822.822] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,822.822] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.42s ago] {'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-06-06 17:35:59,822.822] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,822.822] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.42s ago] {'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-06-06 17:35:59,823.823] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,823.823] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.42s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('f932375a-8700-4d3b-ae2d-958b29fcae48')}
[2025-06-06 17:35:59,824.824] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,824.824] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.42s ago] {'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-06-06 17:35:59,825.825] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,825.825] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.42s ago] {'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-06-06 17:35:59,826.826] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,826.826] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.42s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('c6a2f8f1-e3b3-4555-a691-0fe457b2dded')}
[2025-06-06 17:35:59,827.827] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,827.827] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.42s ago] {'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-06-06 17:35:59,827.827] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,827.827] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.42s ago] {'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-06-06 17:35:59,828.828] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,828.828] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.42s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('9af90c52-28b2-4a47-9c92-148c9f21b512')}
[2025-06-06 17:35:59,829.829] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,829.829] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.43s ago] {'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-06-06 17:35:59,830.830] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,830.830] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.42s ago] {'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-06-06 17:35:59,831.831] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,831.831] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.42s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('9cf6cccc-1bf7-44db-9044-1d1638e4e142')}
[2025-06-06 17:35:59,831.831] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,832.832] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.43s ago] {'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-06-06 17:35:59,832.832] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,832.832] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.43s ago] {'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-06-06 17:35:59,832.832] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,832.832] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.42s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('37a9f300-a2f2-47d1-97ef-67da9b65193d')}
[2025-06-06 17:35:59,833.833] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,833.833] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.43s ago] {'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-06-06 17:35:59,834.834] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,834.834] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.43s ago] {'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-06-06 17:35:59,835.835] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,835.835] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.43s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('df56c578-0b13-4ac2-9cdb-cfb431dca264')}
[2025-06-06 17:35:59,835.835] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,835.835] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.43s ago] {'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-06-06 17:35:59,836.836] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,836.836] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.43s ago] {'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-06-06 17:35:59,837.837] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,837.837] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.43s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('17166c83-14ea-4ba3-ac67-1bcb1c5672bb')}
[2025-06-06 17:35:59,837.837] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,838.838] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.44s ago] {'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-06-06 17:35:59,838.838] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,839.839] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.43s ago] {'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-06-06 17:35:59,839.839] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,839.839] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.43s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('49908250-8e6e-4284-a6c6-204599c5b53d')}
[2025-06-06 17:35:59,840.840] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,840.840] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.44s ago] {'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-06-06 17:35:59,841.841] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,841.841] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.44s ago] {'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-06-06 17:35:59,842.842] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,842.842] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.43s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('8af6e64d-1128-427e-b4bf-8ef556836bfa')}
[2025-06-06 17:35:59,842.842] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,843.843] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.44s ago] {'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-06-06 17:35:59,843.843] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,843.843] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.44s ago] {'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-06-06 17:35:59,844.844] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,844.844] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.44s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('f1b9d5e9-bbdb-4b81-92a5-ce04bd27a82b')}
[2025-06-06 17:35:59,845.845] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,845.845] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.44s ago] {'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-06-06 17:35:59,845.845] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,845.845] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.44s ago] {'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-06-06 17:35:59,846.846] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,846.846] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.44s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('6bca0bd4-647c-456c-8b9c-00e2b06bd4a9')}
[2025-06-06 17:35:59,847.847] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(document.id) AS count_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,847.847] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.45s ago] {'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-06-06 17:35:59,848.848] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(app_dataset_join.id) AS count_1 
FROM app_dataset_join 
WHERE app_dataset_join.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,848.848] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.44s ago] {'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-06-06 17:35:59,849.849] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(sum(document.character_count), %(coalesce_2)s) AS coalesce_1 
FROM document 
WHERE document.dataset_id = %(dataset_id_1)s::UUID
[2025-06-06 17:35:59,849.849] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.44s ago] {'coalesce_2': 0, 'dataset_id_1': UUID('29d11e42-b1ac-4986-b595-dda47b75302a')}
[2025-06-06 17:35:59,850.850] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:35:59,850.850] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:35:59] "GET /datasets?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-06-06 17:36:00,177.177] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:00] "OPTIONS /builtin-apps/categories HTTP/1.1" 200 -
[2025-06-06 17:36:00,493.493] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:00] "OPTIONS /builtin-apps HTTP/1.1" 200 -
[2025-06-06 17:36:00,494.494] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:36:00,494.494] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:36:00,495.495] base.py -> _exec_single_context line:1901 [INFO]: [cached since 26.72s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:36:00,497.497] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:36:00,497.497] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:00] "GET /builtin-apps/categories HTTP/1.1" 200 -
[2025-06-06 17:36:00,757.757] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:36:00,757.757] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:36:00,757.757] base.py -> _exec_single_context line:1901 [INFO]: [cached since 26.98s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:36:00,759.759] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:36:00,759.759] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:00] "GET /builtin-apps HTTP/1.1" 200 -
[2025-06-06 17:36:02,283.283] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:02] "OPTIONS /builtin-tools HTTP/1.1" 200 -
[2025-06-06 17:36:02,284.284] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:02] "OPTIONS /builtin-tools/categories HTTP/1.1" 200 -
[2025-06-06 17:36:02,286.286] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:02] "GET /builtin-tools HTTP/1.1" 200 -
[2025-06-06 17:36:02,594.594] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:02] "GET /builtin-tools/categories HTTP/1.1" 200 -
[2025-06-06 17:36:02,611.611] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:02] "GET /builtin-tools/time/icon HTTP/1.1" 200 -
[2025-06-06 17:36:02,611.611] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:02] "GET /builtin-tools/dalle/icon HTTP/1.1" 200 -
[2025-06-06 17:36:02,612.612] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:02] "GET /builtin-tools/wikipedia/icon HTTP/1.1" 200 -
[2025-06-06 17:36:02,612.612] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:02] "GET /builtin-tools/duckduckgo/icon HTTP/1.1" 200 -
[2025-06-06 17:36:07,079.079] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:07] "OPTIONS /apps?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-06-06 17:36:07,397.397] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:36:07,398.398] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:36:07,398.398] base.py -> _exec_single_context line:1901 [INFO]: [cached since 33.62s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:36:07,400.400] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.account_id = %(account_id_1)s::UUID ORDER BY app.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-06-06 17:36:07,401.401] base.py -> _exec_single_context line:1901 [INFO]: [cached since 12.41s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'param_1': 20, 'param_2': 0}
[2025-06-06 17:36:07,402.402] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT app.id AS id, app.account_id AS account_id, app.app_config_id AS app_config_id, app.draft_app_config_id AS draft_app_config_id, app.debug_conversation_id AS debug_conversation_id, app.name AS name, app.icon AS icon, app.description AS description, app.status AS status, app.updated_at AS updated_at, app.created_at AS created_at 
FROM app 
WHERE app.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-06-06 17:36:07,403.403] base.py -> _exec_single_context line:1901 [INFO]: [cached since 12.41s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:36:07,403.403] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:36:07,404.404] base.py -> _exec_single_context line:1901 [INFO]: [cached since 18.01s ago] {'app_id_1': UUID('1dd689e3-ceaa-4adc-b382-298ac0250798'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:36:07,406.406] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:36:07,406.406] base.py -> _exec_single_context line:1901 [INFO]: [cached since 18.01s ago] {'app_id_1': UUID('4e929f64-66bf-4718-9637-fa7f12b4d804'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:36:07,410.410] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:36:07,410.410] base.py -> _exec_single_context line:1901 [INFO]: [cached since 18.01s ago] {'app_id_1': UUID('05519640-8a7f-4606-bb09-cc3ca8948407'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:36:07,411.411] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:36:07,411.411] base.py -> _exec_single_context line:1901 [INFO]: [cached since 18.01s ago] {'app_id_1': UUID('72072ee8-f80b-47b9-9e66-d5805e0bff79'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:36:07,412.412] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config.id AS app_config_id, app_config.app_id AS app_config_app_id, app_config.model_config AS app_config_model_config, app_config.dialog_round AS app_config_dialog_round, app_config.preset_prompt AS app_config_preset_prompt, app_config.tools AS app_config_tools, app_config.workflows AS app_config_workflows, app_config.retrieval_config AS app_config_retrieval_config, app_config.long_term_memory AS app_config_long_term_memory, app_config.opening_statement AS app_config_opening_statement, app_config.opening_questions AS app_config_opening_questions, app_config.speech_to_text AS app_config_speech_to_text, app_config.text_to_speech AS app_config_text_to_speech, app_config.suggested_after_answer AS app_config_suggested_after_answer, app_config.review_config AS app_config_review_config, app_config.updated_at AS app_config_updated_at, app_config.created_at AS app_config_created_at 
FROM app_config 
WHERE app_config.id = %(pk_1)s::UUID
[2025-06-06 17:36:07,416.416] base.py -> _exec_single_context line:1901 [INFO]: [cached since 12.41s ago] {'pk_1': UUID('f6e0a072-f9e7-4b23-837e-281d1084df58')}
[2025-06-06 17:36:07,418.418] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:36:07,418.418] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:07] "GET /apps?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-06-06 17:36:08,234.234] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:08] "OPTIONS /workflows?current_page=1&page_size=20&search_word=&status= HTTP/1.1" 200 -
[2025-06-06 17:36:08,238.238] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:36:08,238.238] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:36:08,238.238] base.py -> _exec_single_context line:1901 [INFO]: [cached since 34.46s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:36:08,240.240] base.py -> _exec_single_context line:1896 [INFO]: SELECT workflow.id AS workflow_id, workflow.account_id AS workflow_account_id, workflow.name AS workflow_name, workflow.tool_call_name AS workflow_tool_call_name, workflow.icon AS workflow_icon, workflow.description AS workflow_description, workflow.graph AS workflow_graph, workflow.draft_graph AS workflow_draft_graph, workflow.is_debug_passed AS workflow_is_debug_passed, workflow.status AS workflow_status, workflow.published_at AS workflow_published_at, workflow.updated_at AS workflow_updated_at, workflow.created_at AS workflow_created_at 
FROM workflow 
WHERE workflow.account_id = %(account_id_1)s::UUID ORDER BY workflow.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-06-06 17:36:08,241.241] base.py -> _exec_single_context line:1901 [INFO]: [cached since 9.035s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'param_1': 20, 'param_2': 0}
[2025-06-06 17:36:08,243.243] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT workflow.id AS id, workflow.account_id AS account_id, workflow.name AS name, workflow.tool_call_name AS tool_call_name, workflow.icon AS icon, workflow.description AS description, workflow.graph AS graph, workflow.draft_graph AS draft_graph, workflow.is_debug_passed AS is_debug_passed, workflow.status AS status, workflow.published_at AS published_at, workflow.updated_at AS updated_at, workflow.created_at AS created_at 
FROM workflow 
WHERE workflow.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-06-06 17:36:08,243.243] base.py -> _exec_single_context line:1901 [INFO]: [cached since 9.033s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:36:08,244.244] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:36:08,245.245] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:08] "GET /workflows?current_page=1&page_size=20&search_word=&status= HTTP/1.1" 200 -
[2025-06-06 17:36:10,945.945] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:10] "OPTIONS /workflows/04a8777b-604c-4567-8444-07482ae82bf9 HTTP/1.1" 200 -
[2025-06-06 17:36:11,257.257] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:36:11,257.257] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:36:11,257.257] base.py -> _exec_single_context line:1901 [INFO]: [cached since 37.48s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:36:11,259.259] base.py -> _exec_single_context line:1896 [INFO]: SELECT workflow.id AS workflow_id, workflow.account_id AS workflow_account_id, workflow.name AS workflow_name, workflow.tool_call_name AS workflow_tool_call_name, workflow.icon AS workflow_icon, workflow.description AS workflow_description, workflow.graph AS workflow_graph, workflow.draft_graph AS workflow_draft_graph, workflow.is_debug_passed AS workflow_is_debug_passed, workflow.status AS workflow_status, workflow.published_at AS workflow_published_at, workflow.updated_at AS workflow_updated_at, workflow.created_at AS workflow_created_at 
FROM workflow 
WHERE workflow.id = %(pk_1)s::UUID
[2025-06-06 17:36:11,259.259] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00026s] {'pk_1': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:36:11,260.260] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:36:11,261.261] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:11] "GET /workflows/04a8777b-604c-4567-8444-07482ae82bf9 HTTP/1.1" 200 -
[2025-06-06 17:36:11,583.583] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:11] "OPTIONS /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:36:11,585.585] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:36:11,586.586] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:36:11,586.586] base.py -> _exec_single_context line:1901 [INFO]: [cached since 37.81s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:36:11,587.587] base.py -> _exec_single_context line:1896 [INFO]: SELECT workflow.id AS workflow_id, workflow.account_id AS workflow_account_id, workflow.name AS workflow_name, workflow.tool_call_name AS workflow_tool_call_name, workflow.icon AS workflow_icon, workflow.description AS workflow_description, workflow.graph AS workflow_graph, workflow.draft_graph AS workflow_draft_graph, workflow.is_debug_passed AS workflow_is_debug_passed, workflow.status AS workflow_status, workflow.published_at AS workflow_published_at, workflow.updated_at AS workflow_updated_at, workflow.created_at AS workflow_created_at 
FROM workflow 
WHERE workflow.id = %(pk_1)s::UUID
[2025-06-06 17:36:11,587.587] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.3289s ago] {'pk_1': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:36:11,590.590] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:36:11,590.590] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:11] "GET /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:36:17,189.189] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:17] "OPTIONS /builtin-tools/categories HTTP/1.1" 200 -
[2025-06-06 17:36:17,498.498] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:17] "GET /builtin-tools/categories HTTP/1.1" 200 -
[2025-06-06 17:36:18,945.945] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:18] "OPTIONS /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:36:18,945.945] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:18] "OPTIONS /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:36:18,949.949] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:36:18,950.950] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:36:18,950.950] base.py -> _exec_single_context line:1901 [INFO]: [cached since 45.17s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:36:18,951.951] base.py -> _exec_single_context line:1896 [INFO]: SELECT workflow.id AS workflow_id, workflow.account_id AS workflow_account_id, workflow.name AS workflow_name, workflow.tool_call_name AS workflow_tool_call_name, workflow.icon AS workflow_icon, workflow.description AS workflow_description, workflow.graph AS workflow_graph, workflow.draft_graph AS workflow_draft_graph, workflow.is_debug_passed AS workflow_is_debug_passed, workflow.status AS workflow_status, workflow.published_at AS workflow_published_at, workflow.updated_at AS workflow_updated_at, workflow.created_at AS workflow_created_at 
FROM workflow 
WHERE workflow.id = %(pk_1)s::UUID
[2025-06-06 17:36:18,951.951] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.693s ago] {'pk_1': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:36:18,952.952] base.py -> _exec_single_context line:1896 [INFO]: UPDATE workflow SET draft_graph=%(draft_graph)s::JSONB WHERE workflow.id = %(workflow_id)s::UUID
[2025-06-06 17:36:18,954.954] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00030s] {'draft_graph': '{"nodes": [{"id": "2758da9d-b4ea-4177-b2bb-1cfebd633f0d", "node_type": "start", "title": "\\u5f00\\u59cb\\u8282\\u70b9_nr8xx", "description": "\\u5de ... (2307 characters truncated) ... "id": "google_serper", "label": "\\u8c37\\u6b4cSerper\\u641c\\u7d22", "name": "google_serper", "params": {}}, "type": "builtin_tool"}}], "edges": []}', 'workflow_id': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:36:18,956.956] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:36:18,958.958] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:18] "POST /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:36:19,254.254] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:36:19,254.254] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:36:19,254.254] base.py -> _exec_single_context line:1901 [INFO]: [cached since 45.47s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:36:19,256.256] base.py -> _exec_single_context line:1896 [INFO]: SELECT workflow.id AS workflow_id, workflow.account_id AS workflow_account_id, workflow.name AS workflow_name, workflow.tool_call_name AS workflow_tool_call_name, workflow.icon AS workflow_icon, workflow.description AS workflow_description, workflow.graph AS workflow_graph, workflow.draft_graph AS workflow_draft_graph, workflow.is_debug_passed AS workflow_is_debug_passed, workflow.status AS workflow_status, workflow.published_at AS workflow_published_at, workflow.updated_at AS workflow_updated_at, workflow.created_at AS workflow_created_at 
FROM workflow 
WHERE workflow.id = %(pk_1)s::UUID
[2025-06-06 17:36:19,256.256] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.997s ago] {'pk_1': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:36:19,257.257] base.py -> _exec_single_context line:1896 [INFO]: UPDATE workflow SET draft_graph=%(draft_graph)s::JSONB WHERE workflow.id = %(workflow_id)s::UUID
[2025-06-06 17:36:19,257.257] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.3039s ago] {'draft_graph': '{"nodes": [{"id": "2758da9d-b4ea-4177-b2bb-1cfebd633f0d", "node_type": "start", "title": "\\u5f00\\u59cb\\u8282\\u70b9_nr8xx", "description": "\\u5de ... (798 characters truncated) ... ", "value": {"type": "ref", "content": {"ref_node_id": "31d36d93-3d57-4a02-ab43-aadfe74155ac", "ref_var_name": "text"}}, "meta": {}}]}], "edges": []}', 'workflow_id': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:36:19,258.258] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:36:19,260.260] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:19] "POST /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:36:20,715.715] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:36:20,715.715] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:36:20,715.715] base.py -> _exec_single_context line:1901 [INFO]: [cached since 46.94s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:36:20,716.716] base.py -> _exec_single_context line:1896 [INFO]: SELECT workflow.id AS workflow_id, workflow.account_id AS workflow_account_id, workflow.name AS workflow_name, workflow.tool_call_name AS workflow_tool_call_name, workflow.icon AS workflow_icon, workflow.description AS workflow_description, workflow.graph AS workflow_graph, workflow.draft_graph AS workflow_draft_graph, workflow.is_debug_passed AS workflow_is_debug_passed, workflow.status AS workflow_status, workflow.published_at AS workflow_published_at, workflow.updated_at AS workflow_updated_at, workflow.created_at AS workflow_created_at 
FROM workflow 
WHERE workflow.id = %(pk_1)s::UUID
[2025-06-06 17:36:20,717.717] base.py -> _exec_single_context line:1901 [INFO]: [cached since 9.458s ago] {'pk_1': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:36:20,718.718] base.py -> _exec_single_context line:1896 [INFO]: UPDATE workflow SET draft_graph=%(draft_graph)s::JSONB WHERE workflow.id = %(workflow_id)s::UUID
[2025-06-06 17:36:20,718.718] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.765s ago] {'draft_graph': '{"nodes": [{"id": "2758da9d-b4ea-4177-b2bb-1cfebd633f0d", "node_type": "start", "title": "\\u5f00\\u59cb\\u8282\\u70b9_nr8xx", "description": "\\u5de ... (1508 characters truncated) ... {"name": "output", "description": "", "required": true, "type": "string", "value": {"type": "generated", "content": ""}, "meta": {}}]}], "edges": []}', 'workflow_id': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:36:20,719.719] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:36:20,720.720] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:20] "POST /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:36:21,591.591] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:36:21,592.592] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:36:21,593.593] base.py -> _exec_single_context line:1901 [INFO]: [cached since 47.81s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:36:21,595.595] base.py -> _exec_single_context line:1896 [INFO]: SELECT workflow.id AS workflow_id, workflow.account_id AS workflow_account_id, workflow.name AS workflow_name, workflow.tool_call_name AS workflow_tool_call_name, workflow.icon AS workflow_icon, workflow.description AS workflow_description, workflow.graph AS workflow_graph, workflow.draft_graph AS workflow_draft_graph, workflow.is_debug_passed AS workflow_is_debug_passed, workflow.status AS workflow_status, workflow.published_at AS workflow_published_at, workflow.updated_at AS workflow_updated_at, workflow.created_at AS workflow_created_at 
FROM workflow 
WHERE workflow.id = %(pk_1)s::UUID
[2025-06-06 17:36:21,595.595] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.34s ago] {'pk_1': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:36:21,596.596] base.py -> _exec_single_context line:1896 [INFO]: UPDATE workflow SET draft_graph=%(draft_graph)s::JSONB WHERE workflow.id = %(workflow_id)s::UUID
[2025-06-06 17:36:21,597.597] base.py -> _exec_single_context line:1901 [INFO]: [cached since 2.643s ago] {'draft_graph': '{"nodes": [{"id": "2758da9d-b4ea-4177-b2bb-1cfebd633f0d", "node_type": "start", "title": "\\u5f00\\u59cb\\u8282\\u70b9_nr8xx", "description": "\\u5de ... (1508 characters truncated) ... {"name": "output", "description": "", "required": true, "type": "string", "value": {"type": "generated", "content": ""}, "meta": {}}]}], "edges": []}', 'workflow_id': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:36:21,599.599] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:36:21,601.601] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:21] "POST /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:36:23,090.090] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:36:23,091.091] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:36:23,091.091] base.py -> _exec_single_context line:1901 [INFO]: [cached since 49.31s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:36:23,092.092] base.py -> _exec_single_context line:1896 [INFO]: SELECT workflow.id AS workflow_id, workflow.account_id AS workflow_account_id, workflow.name AS workflow_name, workflow.tool_call_name AS workflow_tool_call_name, workflow.icon AS workflow_icon, workflow.description AS workflow_description, workflow.graph AS workflow_graph, workflow.draft_graph AS workflow_draft_graph, workflow.is_debug_passed AS workflow_is_debug_passed, workflow.status AS workflow_status, workflow.published_at AS workflow_published_at, workflow.updated_at AS workflow_updated_at, workflow.created_at AS workflow_created_at 
FROM workflow 
WHERE workflow.id = %(pk_1)s::UUID
[2025-06-06 17:36:23,092.092] base.py -> _exec_single_context line:1901 [INFO]: [cached since 11.83s ago] {'pk_1': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:36:23,094.094] base.py -> _exec_single_context line:1896 [INFO]: UPDATE workflow SET draft_graph=%(draft_graph)s::JSONB WHERE workflow.id = %(workflow_id)s::UUID
[2025-06-06 17:36:23,095.095] base.py -> _exec_single_context line:1901 [INFO]: [cached since 4.141s ago] {'draft_graph': '{"nodes": [{"id": "2758da9d-b4ea-4177-b2bb-1cfebd633f0d", "node_type": "start", "title": "\\u5f00\\u59cb\\u8282\\u70b9_nr8xx", "description": "\\u5de ... (1700 characters truncated) ... , "source": "2758da9d-b4ea-4177-b2bb-1cfebd633f0d", "source_type": "start", "target": "bc9571f1-5fda-4202-a110-042467536fe4", "target_type": "llm"}]}', 'workflow_id': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:36:23,096.096] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:36:23,098.098] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:23] "POST /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:36:24,081.081] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:24] "OPTIONS /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:36:24,085.085] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:36:24,086.086] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:36:24,086.086] base.py -> _exec_single_context line:1901 [INFO]: [cached since 50.31s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:36:24,088.088] base.py -> _exec_single_context line:1896 [INFO]: SELECT workflow.id AS workflow_id, workflow.account_id AS workflow_account_id, workflow.name AS workflow_name, workflow.tool_call_name AS workflow_tool_call_name, workflow.icon AS workflow_icon, workflow.description AS workflow_description, workflow.graph AS workflow_graph, workflow.draft_graph AS workflow_draft_graph, workflow.is_debug_passed AS workflow_is_debug_passed, workflow.status AS workflow_status, workflow.published_at AS workflow_published_at, workflow.updated_at AS workflow_updated_at, workflow.created_at AS workflow_created_at 
FROM workflow 
WHERE workflow.id = %(pk_1)s::UUID
[2025-06-06 17:36:24,088.088] base.py -> _exec_single_context line:1901 [INFO]: [cached since 12.83s ago] {'pk_1': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:36:24,090.090] base.py -> _exec_single_context line:1896 [INFO]: UPDATE workflow SET draft_graph=%(draft_graph)s::JSONB WHERE workflow.id = %(workflow_id)s::UUID
[2025-06-06 17:36:24,090.090] base.py -> _exec_single_context line:1901 [INFO]: [cached since 5.137s ago] {'draft_graph': '{"nodes": [{"id": "2758da9d-b4ea-4177-b2bb-1cfebd633f0d", "node_type": "start", "title": "\\u5f00\\u59cb\\u8282\\u70b9_nr8xx", "description": "\\u5de ... (1892 characters truncated) ... 7", "source": "bc9571f1-5fda-4202-a110-042467536fe4", "source_type": "llm", "target": "3375ae65-029f-4ae2-8282-281dabb9af57", "target_type": "end"}]}', 'workflow_id': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:36:24,091.091] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:36:24,093.093] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:24] "POST /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:36:49,856.856] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:49] "OPTIONS /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:36:50,169.169] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:36:50,169.169] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:36:50,170.170] base.py -> _exec_single_context line:1901 [INFO]: [cached since 76.39s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:36:50,171.171] base.py -> _exec_single_context line:1896 [INFO]: SELECT workflow.id AS workflow_id, workflow.account_id AS workflow_account_id, workflow.name AS workflow_name, workflow.tool_call_name AS workflow_tool_call_name, workflow.icon AS workflow_icon, workflow.description AS workflow_description, workflow.graph AS workflow_graph, workflow.draft_graph AS workflow_draft_graph, workflow.is_debug_passed AS workflow_is_debug_passed, workflow.status AS workflow_status, workflow.published_at AS workflow_published_at, workflow.updated_at AS workflow_updated_at, workflow.created_at AS workflow_created_at 
FROM workflow 
WHERE workflow.id = %(pk_1)s::UUID
[2025-06-06 17:36:50,172.172] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.91s ago] {'pk_1': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:36:50,173.173] base.py -> _exec_single_context line:1896 [INFO]: UPDATE workflow SET draft_graph=%(draft_graph)s::JSONB WHERE workflow.id = %(workflow_id)s::UUID
[2025-06-06 17:36:50,173.173] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.22s ago] {'draft_graph': '{"nodes": [{"id": "2758da9d-b4ea-4177-b2bb-1cfebd633f0d", "node_type": "start", "title": "\\u5f00\\u59cb\\u8282\\u70b9_nr8xx", "description": "\\u5de ... (2167 characters truncated) ... 7", "source": "bc9571f1-5fda-4202-a110-042467536fe4", "source_type": "llm", "target": "3375ae65-029f-4ae2-8282-281dabb9af57", "target_type": "end"}]}', 'workflow_id': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:36:50,176.176] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:36:50,177.177] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:50] "POST /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:36:54,952.952] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:54] "OPTIONS /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:36:54,955.955] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:36:54,956.956] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:36:54,956.956] base.py -> _exec_single_context line:1901 [INFO]: [cached since 81.18s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:36:54,958.958] base.py -> _exec_single_context line:1896 [INFO]: SELECT workflow.id AS workflow_id, workflow.account_id AS workflow_account_id, workflow.name AS workflow_name, workflow.tool_call_name AS workflow_tool_call_name, workflow.icon AS workflow_icon, workflow.description AS workflow_description, workflow.graph AS workflow_graph, workflow.draft_graph AS workflow_draft_graph, workflow.is_debug_passed AS workflow_is_debug_passed, workflow.status AS workflow_status, workflow.published_at AS workflow_published_at, workflow.updated_at AS workflow_updated_at, workflow.created_at AS workflow_created_at 
FROM workflow 
WHERE workflow.id = %(pk_1)s::UUID
[2025-06-06 17:36:54,958.958] base.py -> _exec_single_context line:1901 [INFO]: [cached since 43.7s ago] {'pk_1': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:36:54,960.960] base.py -> _exec_single_context line:1896 [INFO]: UPDATE workflow SET draft_graph=%(draft_graph)s::JSONB WHERE workflow.id = %(workflow_id)s::UUID
[2025-06-06 17:36:54,960.960] base.py -> _exec_single_context line:1901 [INFO]: [cached since 36.01s ago] {'draft_graph': '{"nodes": [{"id": "2758da9d-b4ea-4177-b2bb-1cfebd633f0d", "node_type": "start", "title": "\\u5f00\\u59cb\\u8282\\u70b9_nr8xx", "description": "\\u5de ... (2169 characters truncated) ... 7", "source": "bc9571f1-5fda-4202-a110-042467536fe4", "source_type": "llm", "target": "3375ae65-029f-4ae2-8282-281dabb9af57", "target_type": "end"}]}', 'workflow_id': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:36:54,961.961] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:36:54,964.964] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:36:54] "POST /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:37:02,727.727] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:37:02] "OPTIONS /workflows/04a8777b-604c-4567-8444-07482ae82bf9/debug HTTP/1.1" 200 -
[2025-06-06 17:37:03,041.041] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:37:03,041.041] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:37:03,041.041] base.py -> _exec_single_context line:1901 [INFO]: [cached since 89.26s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:37:03,042.042] base.py -> _exec_single_context line:1896 [INFO]: SELECT workflow.id AS workflow_id, workflow.account_id AS workflow_account_id, workflow.name AS workflow_name, workflow.tool_call_name AS workflow_tool_call_name, workflow.icon AS workflow_icon, workflow.description AS workflow_description, workflow.graph AS workflow_graph, workflow.draft_graph AS workflow_draft_graph, workflow.is_debug_passed AS workflow_is_debug_passed, workflow.status AS workflow_status, workflow.published_at AS workflow_published_at, workflow.updated_at AS workflow_updated_at, workflow.created_at AS workflow_created_at 
FROM workflow 
WHERE workflow.id = %(pk_1)s::UUID
[2025-06-06 17:37:03,042.042] base.py -> _exec_single_context line:1901 [INFO]: [cached since 51.78s ago] {'pk_1': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:37:03,045.045] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO workflow_result (app_id, account_id, workflow_id, graph, state, latency, status) VALUES (%(app_id)s::UUID, %(account_id)s::UUID, %(workflow_id)s::UUID, %(graph)s::JSONB, %(state)s::JSONB, %(latency)s, %(status)s) RETURNING workflow_result.id, workflow_result.updated_at, workflow_result.created_at
[2025-06-06 17:37:03,046.046] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00034s] {'app_id': None, 'account_id': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'workflow_id': UUID('04a8777b-604c-4567-8444-07482ae82bf9'), 'graph': '{"edges": [{"id": "dade5d92-b3d5-422e-80eb-5cff1b3be5a1", "source": "2758da9d-b4ea-4177-b2bb-1cfebd633f0d", "target": "bc9571f1-5fda-4202-a110-042467 ... (2169 characters truncated) ... ", "provider": "openai", "parameters": {"top_p": 0.85, "max_tokens": 8192, "temperature": 0.5, "presence_penalty": 0.2, "frequency_penalty": 0.2}}}]}', 'state': '[]', 'latency': 0, 'status': <WorkflowResultStatus.RUNNING: 'running'>}
[2025-06-06 17:37:03,051.051] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:37:03,055.055] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:37:03] "POST /workflows/04a8777b-604c-4567-8444-07482ae82bf9/debug HTTP/1.1" 200 -
[2025-06-06 17:37:10,477.477] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:37:10,479.479] base.py -> _exec_single_context line:1896 [INFO]: SELECT workflow_result.id AS workflow_result_id, workflow_result.app_id AS workflow_result_app_id, workflow_result.account_id AS workflow_result_account_id, workflow_result.workflow_id AS workflow_result_workflow_id, workflow_result.graph AS workflow_result_graph, workflow_result.state AS workflow_result_state, workflow_result.latency AS workflow_result_latency, workflow_result.status AS workflow_result_status, workflow_result.updated_at AS workflow_result_updated_at, workflow_result.created_at AS workflow_result_created_at 
FROM workflow_result 
WHERE workflow_result.id = %(pk_1)s::UUID
[2025-06-06 17:37:10,479.479] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00025s] {'pk_1': UUID('89247392-1c69-4e86-a7f1-d611386c262a')}
[2025-06-06 17:37:10,481.481] base.py -> _exec_single_context line:1896 [INFO]: UPDATE workflow_result SET state=%(state)s::JSONB, latency=%(latency)s, status=%(status)s WHERE workflow_result.id = %(workflow_result_id)s::UUID
[2025-06-06 17:37:10,481.481] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00027s] {'state': '[{"node_data": {"id": "2758da9d-b4ea-4177-b2bb-1cfebd633f0d", "node_type": "start", "title": "\\u5f00\\u59cb\\u8282\\u70b9_nr8xx", "description": "\\ ... (208 characters truncated) ... "status": "succeeded", "inputs": {"query": "\\u4e0a\\u6d77"}, "outputs": {"query": "\\u4e0a\\u6d77"}, "latency": 4.599999996912629e-06, "error": ""}]', 'latency': 7.425623999999999, 'status': <WorkflowResultStatus.FAILED: 'failed'>, 'workflow_result_id': UUID('89247392-1c69-4e86-a7f1-d611386c262a')}
[2025-06-06 17:37:10,483.483] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:37:38,432.432] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:37:38] "OPTIONS /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:37:38,434.434] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:37:38,435.435] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:37:38,435.435] base.py -> _exec_single_context line:1901 [INFO]: [cached since 124.7s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:37:38,436.436] base.py -> _exec_single_context line:1896 [INFO]: SELECT workflow.id AS workflow_id, workflow.account_id AS workflow_account_id, workflow.name AS workflow_name, workflow.tool_call_name AS workflow_tool_call_name, workflow.icon AS workflow_icon, workflow.description AS workflow_description, workflow.graph AS workflow_graph, workflow.draft_graph AS workflow_draft_graph, workflow.is_debug_passed AS workflow_is_debug_passed, workflow.status AS workflow_status, workflow.published_at AS workflow_published_at, workflow.updated_at AS workflow_updated_at, workflow.created_at AS workflow_created_at 
FROM workflow 
WHERE workflow.id = %(pk_1)s::UUID
[2025-06-06 17:37:38,437.437] base.py -> _exec_single_context line:1901 [INFO]: [cached since 87.18s ago] {'pk_1': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:37:38,438.438] base.py -> _exec_single_context line:1896 [INFO]: UPDATE workflow SET draft_graph=%(draft_graph)s::JSONB WHERE workflow.id = %(workflow_id)s::UUID
[2025-06-06 17:37:38,438.438] base.py -> _exec_single_context line:1901 [INFO]: [cached since 79.48s ago] {'draft_graph': '{"nodes": [{"id": "2758da9d-b4ea-4177-b2bb-1cfebd633f0d", "node_type": "start", "title": "\\u5f00\\u59cb\\u8282\\u70b9_nr8xx", "description": "\\u5de ... (1785 characters truncated) ... {"name": "output", "description": "", "required": true, "type": "string", "value": {"type": "generated", "content": ""}, "meta": {}}]}], "edges": []}', 'workflow_id': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:37:38,439.439] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:37:38,440.440] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:37:38] "POST /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:37:38,740.740] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:37:38] "OPTIONS /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:37:39,054.054] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:37:39,055.055] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:37:39,056.056] base.py -> _exec_single_context line:1901 [INFO]: [cached since 125.3s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:37:39,057.057] base.py -> _exec_single_context line:1896 [INFO]: SELECT workflow.id AS workflow_id, workflow.account_id AS workflow_account_id, workflow.name AS workflow_name, workflow.tool_call_name AS workflow_tool_call_name, workflow.icon AS workflow_icon, workflow.description AS workflow_description, workflow.graph AS workflow_graph, workflow.draft_graph AS workflow_draft_graph, workflow.is_debug_passed AS workflow_is_debug_passed, workflow.status AS workflow_status, workflow.published_at AS workflow_published_at, workflow.updated_at AS workflow_updated_at, workflow.created_at AS workflow_created_at 
FROM workflow 
WHERE workflow.id = %(pk_1)s::UUID
[2025-06-06 17:37:39,057.057] base.py -> _exec_single_context line:1901 [INFO]: [cached since 87.8s ago] {'pk_1': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:37:39,059.059] base.py -> _exec_single_context line:1896 [INFO]: UPDATE workflow SET draft_graph=%(draft_graph)s::JSONB WHERE workflow.id = %(workflow_id)s::UUID
[2025-06-06 17:37:39,059.059] base.py -> _exec_single_context line:1901 [INFO]: [cached since 80.11s ago] {'draft_graph': '{"nodes": [{"id": "2758da9d-b4ea-4177-b2bb-1cfebd633f0d", "node_type": "start", "title": "\\u5f00\\u59cb\\u8282\\u70b9_nr8xx", "description": "\\u5de ... (800 characters truncated) ...  "value": {"type": "ref", "content": {"ref_node_id": "bc9571f1-5fda-4202-a110-042467536fe4", "ref_var_name": "output"}}, "meta": {}}]}], "edges": []}', 'workflow_id': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:37:39,060.060] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:37:39,063.063] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:37:39] "POST /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:37:40,080.080] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:37:40,081.081] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:37:40,081.081] base.py -> _exec_single_context line:1901 [INFO]: [cached since 126.3s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:37:40,083.083] base.py -> _exec_single_context line:1896 [INFO]: SELECT workflow.id AS workflow_id, workflow.account_id AS workflow_account_id, workflow.name AS workflow_name, workflow.tool_call_name AS workflow_tool_call_name, workflow.icon AS workflow_icon, workflow.description AS workflow_description, workflow.graph AS workflow_graph, workflow.draft_graph AS workflow_draft_graph, workflow.is_debug_passed AS workflow_is_debug_passed, workflow.status AS workflow_status, workflow.published_at AS workflow_published_at, workflow.updated_at AS workflow_updated_at, workflow.created_at AS workflow_created_at 
FROM workflow 
WHERE workflow.id = %(pk_1)s::UUID
[2025-06-06 17:37:40,083.083] base.py -> _exec_single_context line:1901 [INFO]: [cached since 88.82s ago] {'pk_1': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:37:40,084.084] base.py -> _exec_single_context line:1896 [INFO]: UPDATE workflow SET draft_graph=%(draft_graph)s::JSONB WHERE workflow.id = %(workflow_id)s::UUID
[2025-06-06 17:37:40,085.085] base.py -> _exec_single_context line:1901 [INFO]: [cached since 81.13s ago] {'draft_graph': '{"nodes": [{"id": "2758da9d-b4ea-4177-b2bb-1cfebd633f0d", "node_type": "start", "title": "\\u5f00\\u59cb\\u8282\\u70b9_nr8xx", "description": "\\u5de ... (1558 characters truncated) ... name": "", "label": "", "icon": "", "description": ""}, "tool": {"id": "", "name": "", "label": "", "description": "", "params": {}}}}], "edges": []}', 'workflow_id': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:37:40,086.086] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:37:40,087.087] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:37:40] "POST /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:37:41,652.652] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:37:41,653.653] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:37:41,653.653] base.py -> _exec_single_context line:1901 [INFO]: [cached since 127.9s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:37:41,654.654] base.py -> _exec_single_context line:1896 [INFO]: SELECT workflow.id AS workflow_id, workflow.account_id AS workflow_account_id, workflow.name AS workflow_name, workflow.tool_call_name AS workflow_tool_call_name, workflow.icon AS workflow_icon, workflow.description AS workflow_description, workflow.graph AS workflow_graph, workflow.draft_graph AS workflow_draft_graph, workflow.is_debug_passed AS workflow_is_debug_passed, workflow.status AS workflow_status, workflow.published_at AS workflow_published_at, workflow.updated_at AS workflow_updated_at, workflow.created_at AS workflow_created_at 
FROM workflow 
WHERE workflow.id = %(pk_1)s::UUID
[2025-06-06 17:37:41,654.654] base.py -> _exec_single_context line:1901 [INFO]: [cached since 90.4s ago] {'pk_1': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:37:41,655.655] base.py -> _exec_single_context line:1896 [INFO]: UPDATE workflow SET draft_graph=%(draft_graph)s::JSONB WHERE workflow.id = %(workflow_id)s::UUID
[2025-06-06 17:37:41,656.656] base.py -> _exec_single_context line:1901 [INFO]: [cached since 82.7s ago] {'draft_graph': '{"nodes": [{"id": "2758da9d-b4ea-4177-b2bb-1cfebd633f0d", "node_type": "start", "title": "\\u5f00\\u59cb\\u8282\\u70b9_nr8xx", "description": "\\u5de ... (1558 characters truncated) ... name": "", "label": "", "icon": "", "description": ""}, "tool": {"id": "", "name": "", "label": "", "description": "", "params": {}}}}], "edges": []}', 'workflow_id': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:37:41,656.656] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:37:41,658.658] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:37:41] "POST /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:37:42,797.797] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:37:42] "OPTIONS /builtin-tools/categories HTTP/1.1" 200 -
[2025-06-06 17:37:42,800.800] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:37:42] "GET /builtin-tools/categories HTTP/1.1" 200 -
[2025-06-06 17:37:45,780.780] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:37:45] "OPTIONS /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:37:46,098.098] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:37:46,099.099] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:37:46,099.099] base.py -> _exec_single_context line:1901 [INFO]: [cached since 132.3s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:37:46,100.100] base.py -> _exec_single_context line:1896 [INFO]: SELECT workflow.id AS workflow_id, workflow.account_id AS workflow_account_id, workflow.name AS workflow_name, workflow.tool_call_name AS workflow_tool_call_name, workflow.icon AS workflow_icon, workflow.description AS workflow_description, workflow.graph AS workflow_graph, workflow.draft_graph AS workflow_draft_graph, workflow.is_debug_passed AS workflow_is_debug_passed, workflow.status AS workflow_status, workflow.published_at AS workflow_published_at, workflow.updated_at AS workflow_updated_at, workflow.created_at AS workflow_created_at 
FROM workflow 
WHERE workflow.id = %(pk_1)s::UUID
[2025-06-06 17:37:46,100.100] base.py -> _exec_single_context line:1901 [INFO]: [cached since 94.84s ago] {'pk_1': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:37:46,101.101] base.py -> _exec_single_context line:1896 [INFO]: UPDATE workflow SET draft_graph=%(draft_graph)s::JSONB WHERE workflow.id = %(workflow_id)s::UUID
[2025-06-06 17:37:46,102.102] base.py -> _exec_single_context line:1901 [INFO]: [cached since 87.15s ago] {'draft_graph': '{"nodes": [{"id": "2758da9d-b4ea-4177-b2bb-1cfebd633f0d", "node_type": "start", "title": "\\u5f00\\u59cb\\u8282\\u70b9_nr8xx", "description": "\\u5de ... (1751 characters truncated) ...  "source": "2758da9d-b4ea-4177-b2bb-1cfebd633f0d", "source_type": "start", "target": "1d358a83-d48f-4d64-8549-9fe8dbabd79a", "target_type": "tool"}]}', 'workflow_id': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:37:46,102.102] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:37:46,104.104] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:37:46] "POST /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:37:47,414.414] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:37:47,415.415] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:37:47,415.415] base.py -> _exec_single_context line:1901 [INFO]: [cached since 133.6s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:37:47,416.416] base.py -> _exec_single_context line:1896 [INFO]: SELECT workflow.id AS workflow_id, workflow.account_id AS workflow_account_id, workflow.name AS workflow_name, workflow.tool_call_name AS workflow_tool_call_name, workflow.icon AS workflow_icon, workflow.description AS workflow_description, workflow.graph AS workflow_graph, workflow.draft_graph AS workflow_draft_graph, workflow.is_debug_passed AS workflow_is_debug_passed, workflow.status AS workflow_status, workflow.published_at AS workflow_published_at, workflow.updated_at AS workflow_updated_at, workflow.created_at AS workflow_created_at 
FROM workflow 
WHERE workflow.id = %(pk_1)s::UUID
[2025-06-06 17:37:47,417.417] base.py -> _exec_single_context line:1901 [INFO]: [cached since 96.16s ago] {'pk_1': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:37:47,418.418] base.py -> _exec_single_context line:1896 [INFO]: UPDATE workflow SET draft_graph=%(draft_graph)s::JSONB WHERE workflow.id = %(workflow_id)s::UUID
[2025-06-06 17:37:47,418.418] base.py -> _exec_single_context line:1901 [INFO]: [cached since 88.47s ago] {'draft_graph': '{"nodes": [{"id": "2758da9d-b4ea-4177-b2bb-1cfebd633f0d", "node_type": "start", "title": "\\u5f00\\u59cb\\u8282\\u70b9_nr8xx", "description": "\\u5de ... (1751 characters truncated) ...  "source": "2758da9d-b4ea-4177-b2bb-1cfebd633f0d", "source_type": "start", "target": "1d358a83-d48f-4d64-8549-9fe8dbabd79a", "target_type": "tool"}]}', 'workflow_id': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:37:47,419.419] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:37:47,421.421] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:37:47] "POST /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:37:48,831.831] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:37:48,831.831] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:37:48,831.831] base.py -> _exec_single_context line:1901 [INFO]: [cached since 135.1s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:37:48,833.833] base.py -> _exec_single_context line:1896 [INFO]: SELECT workflow.id AS workflow_id, workflow.account_id AS workflow_account_id, workflow.name AS workflow_name, workflow.tool_call_name AS workflow_tool_call_name, workflow.icon AS workflow_icon, workflow.description AS workflow_description, workflow.graph AS workflow_graph, workflow.draft_graph AS workflow_draft_graph, workflow.is_debug_passed AS workflow_is_debug_passed, workflow.status AS workflow_status, workflow.published_at AS workflow_published_at, workflow.updated_at AS workflow_updated_at, workflow.created_at AS workflow_created_at 
FROM workflow 
WHERE workflow.id = %(pk_1)s::UUID
[2025-06-06 17:37:48,833.833] base.py -> _exec_single_context line:1901 [INFO]: [cached since 97.57s ago] {'pk_1': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:37:48,835.835] base.py -> _exec_single_context line:1896 [INFO]: UPDATE workflow SET draft_graph=%(draft_graph)s::JSONB WHERE workflow.id = %(workflow_id)s::UUID
[2025-06-06 17:37:48,835.835] base.py -> _exec_single_context line:1901 [INFO]: [cached since 89.88s ago] {'draft_graph': '{"nodes": [{"id": "2758da9d-b4ea-4177-b2bb-1cfebd633f0d", "node_type": "start", "title": "\\u5f00\\u59cb\\u8282\\u70b9_nr8xx", "description": "\\u5de ... (1944 characters truncated) ... ", "source": "1d358a83-d48f-4d64-8549-9fe8dbabd79a", "source_type": "tool", "target": "3375ae65-029f-4ae2-8282-281dabb9af57", "target_type": "end"}]}', 'workflow_id': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:37:48,836.836] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:37:48,838.838] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:37:48] "POST /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:37:50,465.465] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:37:50] "OPTIONS /api-tools?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-06-06 17:37:50,468.468] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:37:50,469.469] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:37:50,470.470] base.py -> _exec_single_context line:1901 [INFO]: [cached since 136.7s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:37:50,471.471] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool_provider.id AS api_tool_provider_id, api_tool_provider.account_id AS api_tool_provider_account_id, api_tool_provider.name AS api_tool_provider_name, api_tool_provider.icon AS api_tool_provider_icon, api_tool_provider.description AS api_tool_provider_description, api_tool_provider.openapi_schema AS api_tool_provider_openapi_schema, api_tool_provider.headers AS api_tool_provider_headers, api_tool_provider.updated_at AS api_tool_provider_updated_at, api_tool_provider.created_at AS api_tool_provider_created_at 
FROM api_tool_provider 
WHERE api_tool_provider.account_id = %(account_id_1)s::UUID ORDER BY api_tool_provider.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-06-06 17:37:50,471.471] base.py -> _exec_single_context line:1901 [INFO]: [cached since 112.4s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'param_1': 20, 'param_2': 0}
[2025-06-06 17:37:50,473.473] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT api_tool_provider.id AS id, api_tool_provider.account_id AS account_id, api_tool_provider.name AS name, api_tool_provider.icon AS icon, api_tool_provider.description AS description, api_tool_provider.openapi_schema AS openapi_schema, api_tool_provider.headers AS headers, api_tool_provider.updated_at AS updated_at, api_tool_provider.created_at AS created_at 
FROM api_tool_provider 
WHERE api_tool_provider.account_id = %(account_id_1)s::UUID) AS anon_1
[2025-06-06 17:37:50,474.474] base.py -> _exec_single_context line:1901 [INFO]: [cached since 112.4s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:37:50,475.475] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:37:50,475.475] base.py -> _exec_single_context line:1901 [INFO]: [cached since 112.4s ago] {'provider_id_1': UUID('7e41e2e9-5940-4853-ac4d-fb92bcd7840a')}
[2025-06-06 17:37:50,476.476] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:37:50,477.477] base.py -> _exec_single_context line:1901 [INFO]: [cached since 112.4s ago] {'provider_id_1': UUID('ee453518-8819-43b8-9693-fbb0ec025b6b')}
[2025-06-06 17:37:50,477.477] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:37:50,477.477] base.py -> _exec_single_context line:1901 [INFO]: [cached since 112.4s ago] {'provider_id_1': UUID('5c706d2f-1e5d-4a1e-a87d-7e284d7d69fd')}
[2025-06-06 17:37:50,478.478] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:37:50,478.478] base.py -> _exec_single_context line:1901 [INFO]: [cached since 112.4s ago] {'provider_id_1': UUID('bed074e4-c5af-4bd4-88f7-81251eb95a6c')}
[2025-06-06 17:37:50,479.479] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:37:50,479.479] base.py -> _exec_single_context line:1901 [INFO]: [cached since 112.4s ago] {'provider_id_1': UUID('1bd06d2b-1d4c-4bf5-8812-f94a0fa8cd0e')}
[2025-06-06 17:37:50,480.480] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:37:50,481.481] base.py -> _exec_single_context line:1901 [INFO]: [cached since 112.4s ago] {'provider_id_1': UUID('e9780583-c578-42e4-84ef-e3c2c1069de9')}
[2025-06-06 17:37:50,482.482] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:37:50,482.482] base.py -> _exec_single_context line:1901 [INFO]: [cached since 112.4s ago] {'provider_id_1': UUID('94cef19d-3df1-457e-8f1f-5e6ecec2df39')}
[2025-06-06 17:37:50,482.482] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:37:50,482.482] base.py -> _exec_single_context line:1901 [INFO]: [cached since 112.4s ago] {'provider_id_1': UUID('a9fd691c-c789-45b4-af05-1df914542bad')}
[2025-06-06 17:37:50,483.483] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:37:50,483.483] base.py -> _exec_single_context line:1901 [INFO]: [cached since 112.4s ago] {'provider_id_1': UUID('db13bc34-1d40-49e5-92d8-d22c7418cf7d')}
[2025-06-06 17:37:50,484.484] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:37:50,484.484] base.py -> _exec_single_context line:1901 [INFO]: [cached since 112.4s ago] {'provider_id_1': UUID('bbd73f46-4891-4f18-a8cf-065e1639809f')}
[2025-06-06 17:37:50,485.485] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:37:50,485.485] base.py -> _exec_single_context line:1901 [INFO]: [cached since 112.4s ago] {'provider_id_1': UUID('8229ae9b-a334-472e-af36-8c1e36b85356')}
[2025-06-06 17:37:50,485.485] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:37:50,486.486] base.py -> _exec_single_context line:1901 [INFO]: [cached since 112.4s ago] {'provider_id_1': UUID('e1afb674-e985-4f45-9416-04c8457ef621')}
[2025-06-06 17:37:50,486.486] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:37:50,486.486] base.py -> _exec_single_context line:1901 [INFO]: [cached since 112.4s ago] {'provider_id_1': UUID('eb23d087-cfac-4b07-b348-0ce7e019e481')}
[2025-06-06 17:37:50,487.487] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:37:50,487.487] base.py -> _exec_single_context line:1901 [INFO]: [cached since 112.4s ago] {'provider_id_1': UUID('4a3b1d5e-7eba-4d5e-a903-08bc4e381ddf')}
[2025-06-06 17:37:50,488.488] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:37:50,488.488] base.py -> _exec_single_context line:1901 [INFO]: [cached since 112.4s ago] {'provider_id_1': UUID('c7fd1c86-ad90-4011-aa6f-37af7dd7c123')}
[2025-06-06 17:37:50,489.489] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:37:50,489.489] base.py -> _exec_single_context line:1901 [INFO]: [cached since 112.4s ago] {'provider_id_1': UUID('79f0585f-48e8-4612-ac04-8742e6eb849d')}
[2025-06-06 17:37:50,490.490] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:37:50,490.490] base.py -> _exec_single_context line:1901 [INFO]: [cached since 112.4s ago] {'provider_id_1': UUID('bce415bd-bdca-4976-b519-35c4c9af2b99')}
[2025-06-06 17:37:50,491.491] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:37:50,491.491] base.py -> _exec_single_context line:1901 [INFO]: [cached since 112.4s ago] {'provider_id_1': UUID('f7190437-4704-4f73-9871-a786624778be')}
[2025-06-06 17:37:50,492.492] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:37:50,492.492] base.py -> _exec_single_context line:1901 [INFO]: [cached since 112.4s ago] {'provider_id_1': UUID('a93b42f1-9d6d-4d7b-9687-cfa76eee2ff2')}
[2025-06-06 17:37:50,493.493] base.py -> _exec_single_context line:1896 [INFO]: SELECT api_tool.id AS api_tool_id, api_tool.account_id AS api_tool_account_id, api_tool.provider_id AS api_tool_provider_id, api_tool.name AS api_tool_name, api_tool.description AS api_tool_description, api_tool.url AS api_tool_url, api_tool.method AS api_tool_method, api_tool.parameters AS api_tool_parameters, api_tool.updated_at AS api_tool_updated_at, api_tool.created_at AS api_tool_created_at 
FROM api_tool 
WHERE api_tool.provider_id = %(provider_id_1)s::UUID
[2025-06-06 17:37:50,493.493] base.py -> _exec_single_context line:1901 [INFO]: [cached since 112.4s ago] {'provider_id_1': UUID('e9b3b8ee-b6fb-4217-8c3e-57b3c0175c3c')}
[2025-06-06 17:37:50,495.495] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:37:50,495.495] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:37:50] "GET /api-tools?current_page=1&page_size=20&search_word= HTTP/1.1" 200 -
[2025-06-06 17:37:50,715.715] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:37:50] "OPTIONS /builtin-tools HTTP/1.1" 200 -
[2025-06-06 17:37:51,029.029] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:37:51] "GET /builtin-tools HTTP/1.1" 200 -
[2025-06-06 17:37:51,366.366] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:37:51] "GET /builtin-tools/time/icon HTTP/1.1" 200 -
[2025-06-06 17:37:51,667.667] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:37:51] "GET /builtin-tools/wikipedia/icon HTTP/1.1" 200 -
[2025-06-06 17:37:52,518.518] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:37:52] "OPTIONS /builtin-tools/google/tools/google_serper HTTP/1.1" 200 -
[2025-06-06 17:37:52,836.836] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:37:52] "GET /builtin-tools/google/tools/google_serper HTTP/1.1" 200 -
[2025-06-06 17:37:56,202.202] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:37:56] "OPTIONS /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:37:56,205.205] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:37:56,206.206] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:37:56,206.206] base.py -> _exec_single_context line:1901 [INFO]: [cached since 142.4s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:37:56,208.208] base.py -> _exec_single_context line:1896 [INFO]: SELECT workflow.id AS workflow_id, workflow.account_id AS workflow_account_id, workflow.name AS workflow_name, workflow.tool_call_name AS workflow_tool_call_name, workflow.icon AS workflow_icon, workflow.description AS workflow_description, workflow.graph AS workflow_graph, workflow.draft_graph AS workflow_draft_graph, workflow.is_debug_passed AS workflow_is_debug_passed, workflow.status AS workflow_status, workflow.published_at AS workflow_published_at, workflow.updated_at AS workflow_updated_at, workflow.created_at AS workflow_created_at 
FROM workflow 
WHERE workflow.id = %(pk_1)s::UUID
[2025-06-06 17:37:56,208.208] base.py -> _exec_single_context line:1901 [INFO]: [cached since 104.9s ago] {'pk_1': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:37:56,209.209] base.py -> _exec_single_context line:1896 [INFO]: UPDATE workflow SET draft_graph=%(draft_graph)s::JSONB WHERE workflow.id = %(workflow_id)s::UUID
[2025-06-06 17:37:56,209.209] base.py -> _exec_single_context line:1901 [INFO]: [cached since 97.26s ago] {'draft_graph': '{"nodes": [{"id": "2758da9d-b4ea-4177-b2bb-1cfebd633f0d", "node_type": "start", "title": "\\u5f00\\u59cb\\u8282\\u70b9_nr8xx", "description": "\\u5de ... (2695 characters truncated) ... ", "source": "1d358a83-d48f-4d64-8549-9fe8dbabd79a", "source_type": "tool", "target": "3375ae65-029f-4ae2-8282-281dabb9af57", "target_type": "end"}]}', 'workflow_id': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:37:56,210.210] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:37:56,212.212] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:37:56] "POST /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:37:57,927.927] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:37:57,927.927] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:37:57,928.928] base.py -> _exec_single_context line:1901 [INFO]: [cached since 144.1s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:37:57,929.929] base.py -> _exec_single_context line:1896 [INFO]: SELECT workflow.id AS workflow_id, workflow.account_id AS workflow_account_id, workflow.name AS workflow_name, workflow.tool_call_name AS workflow_tool_call_name, workflow.icon AS workflow_icon, workflow.description AS workflow_description, workflow.graph AS workflow_graph, workflow.draft_graph AS workflow_draft_graph, workflow.is_debug_passed AS workflow_is_debug_passed, workflow.status AS workflow_status, workflow.published_at AS workflow_published_at, workflow.updated_at AS workflow_updated_at, workflow.created_at AS workflow_created_at 
FROM workflow 
WHERE workflow.id = %(pk_1)s::UUID
[2025-06-06 17:37:57,929.929] base.py -> _exec_single_context line:1901 [INFO]: [cached since 106.7s ago] {'pk_1': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:37:57,931.931] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:37:57,932.932] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:37:57] "POST /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:38:02,057.057] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:38:02] "OPTIONS /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:38:02,060.060] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:38:02,061.061] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:38:02,061.061] base.py -> _exec_single_context line:1901 [INFO]: [cached since 148.3s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:38:02,062.062] base.py -> _exec_single_context line:1896 [INFO]: SELECT workflow.id AS workflow_id, workflow.account_id AS workflow_account_id, workflow.name AS workflow_name, workflow.tool_call_name AS workflow_tool_call_name, workflow.icon AS workflow_icon, workflow.description AS workflow_description, workflow.graph AS workflow_graph, workflow.draft_graph AS workflow_draft_graph, workflow.is_debug_passed AS workflow_is_debug_passed, workflow.status AS workflow_status, workflow.published_at AS workflow_published_at, workflow.updated_at AS workflow_updated_at, workflow.created_at AS workflow_created_at 
FROM workflow 
WHERE workflow.id = %(pk_1)s::UUID
[2025-06-06 17:38:02,062.062] base.py -> _exec_single_context line:1901 [INFO]: [cached since 110.8s ago] {'pk_1': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:38:02,064.064] base.py -> _exec_single_context line:1896 [INFO]: UPDATE workflow SET draft_graph=%(draft_graph)s::JSONB WHERE workflow.id = %(workflow_id)s::UUID
[2025-06-06 17:38:02,064.064] base.py -> _exec_single_context line:1901 [INFO]: [cached since 103.1s ago] {'draft_graph': '{"nodes": [{"id": "2758da9d-b4ea-4177-b2bb-1cfebd633f0d", "node_type": "start", "title": "\\u5f00\\u59cb\\u8282\\u70b9_nr8xx", "description": "\\u5de ... (2693 characters truncated) ... ", "source": "1d358a83-d48f-4d64-8549-9fe8dbabd79a", "source_type": "tool", "target": "3375ae65-029f-4ae2-8282-281dabb9af57", "target_type": "end"}]}', 'workflow_id': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:38:02,065.065] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:38:02,067.067] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:38:02] "POST /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:38:07,798.798] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:38:07] "OPTIONS /workflows/04a8777b-604c-4567-8444-07482ae82bf9/debug HTTP/1.1" 200 -
[2025-06-06 17:38:08,110.110] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:38:08,110.110] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:38:08,111.111] base.py -> _exec_single_context line:1901 [INFO]: [cached since 154.3s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:38:08,112.112] base.py -> _exec_single_context line:1896 [INFO]: SELECT workflow.id AS workflow_id, workflow.account_id AS workflow_account_id, workflow.name AS workflow_name, workflow.tool_call_name AS workflow_tool_call_name, workflow.icon AS workflow_icon, workflow.description AS workflow_description, workflow.graph AS workflow_graph, workflow.draft_graph AS workflow_draft_graph, workflow.is_debug_passed AS workflow_is_debug_passed, workflow.status AS workflow_status, workflow.published_at AS workflow_published_at, workflow.updated_at AS workflow_updated_at, workflow.created_at AS workflow_created_at 
FROM workflow 
WHERE workflow.id = %(pk_1)s::UUID
[2025-06-06 17:38:08,112.112] base.py -> _exec_single_context line:1901 [INFO]: [cached since 116.9s ago] {'pk_1': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:38:08,115.115] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO workflow_result (app_id, account_id, workflow_id, graph, state, latency, status) VALUES (%(app_id)s::UUID, %(account_id)s::UUID, %(workflow_id)s::UUID, %(graph)s::JSONB, %(state)s::JSONB, %(latency)s, %(status)s) RETURNING workflow_result.id, workflow_result.updated_at, workflow_result.created_at
[2025-06-06 17:38:08,115.115] base.py -> _exec_single_context line:1901 [INFO]: [cached since 65.07s ago] {'app_id': None, 'account_id': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'workflow_id': UUID('04a8777b-604c-4567-8444-07482ae82bf9'), 'graph': '{"edges": [{"id": "85ca5740-c988-4f58-8b02-0c158d59c30b", "source": "2758da9d-b4ea-4177-b2bb-1cfebd633f0d", "target": "1d358a83-d48f-4d64-8549-9fe8db ... (2693 characters truncated) ... u573a\\u6216\\u81ea\\u5b9a\\u4e49API\\u63d2\\u4ef6\\uff0c\\u652f\\u6301\\u80fd\\u529b\\u6269\\u5c55\\u548c\\u590d\\u7528", "provider_id": "google"}]}', 'state': '[]', 'latency': 0, 'status': <WorkflowResultStatus.RUNNING: 'running'>}
[2025-06-06 17:38:08,120.120] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:38:08,123.123] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:38:08] "POST /workflows/04a8777b-604c-4567-8444-07482ae82bf9/debug HTTP/1.1" 200 -
[2025-06-06 17:38:09,478.478] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:38:09,478.478] base.py -> _exec_single_context line:1896 [INFO]: SELECT workflow_result.id AS workflow_result_id, workflow_result.app_id AS workflow_result_app_id, workflow_result.account_id AS workflow_result_account_id, workflow_result.workflow_id AS workflow_result_workflow_id, workflow_result.graph AS workflow_result_graph, workflow_result.state AS workflow_result_state, workflow_result.latency AS workflow_result_latency, workflow_result.status AS workflow_result_status, workflow_result.updated_at AS workflow_result_updated_at, workflow_result.created_at AS workflow_result_created_at 
FROM workflow_result 
WHERE workflow_result.id = %(pk_1)s::UUID
[2025-06-06 17:38:09,479.479] base.py -> _exec_single_context line:1901 [INFO]: [cached since 59s ago] {'pk_1': UUID('b57e585e-dfea-4992-ad45-c8f6ecab98d1')}
[2025-06-06 17:38:09,481.481] base.py -> _exec_single_context line:1896 [INFO]: UPDATE workflow_result SET state=%(state)s::JSONB, latency=%(latency)s, status=%(status)s WHERE workflow_result.id = %(workflow_result_id)s::UUID
[2025-06-06 17:38:09,482.482] base.py -> _exec_single_context line:1901 [INFO]: [cached since 59s ago] {'state': '[{"node_data": {"id": "2758da9d-b4ea-4177-b2bb-1cfebd633f0d", "node_type": "start", "title": "\\u5f00\\u59cb\\u8282\\u70b9_nr8xx", "description": "\\ ... (8100 characters truncated) ... and Departments is announced today. Deakin University in Australia is ranked No.1 in the world, ..."}, "latency": 9.30000001631015e-06, "error": ""}]', 'latency': 1.356884000000008, 'status': <WorkflowResultStatus.SUCCEEDED: 'succeeded'>, 'workflow_result_id': UUID('b57e585e-dfea-4992-ad45-c8f6ecab98d1')}
[2025-06-06 17:38:09,485.485] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:38:09,485.485] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:38:09,486.486] base.py -> _exec_single_context line:1896 [INFO]: SELECT workflow.id AS workflow_id, workflow.account_id AS workflow_account_id, workflow.name AS workflow_name, workflow.tool_call_name AS workflow_tool_call_name, workflow.icon AS workflow_icon, workflow.description AS workflow_description, workflow.graph AS workflow_graph, workflow.draft_graph AS workflow_draft_graph, workflow.is_debug_passed AS workflow_is_debug_passed, workflow.status AS workflow_status, workflow.published_at AS workflow_published_at, workflow.updated_at AS workflow_updated_at, workflow.created_at AS workflow_created_at 
FROM workflow 
WHERE workflow.id = %(pk_1)s::UUID
[2025-06-06 17:38:09,486.486] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00022s] {'pk_1': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:38:09,488.488] base.py -> _exec_single_context line:1896 [INFO]: UPDATE workflow SET is_debug_passed=%(is_debug_passed)s WHERE workflow.id = %(workflow_id)s::UUID
[2025-06-06 17:38:09,488.488] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00024s] {'is_debug_passed': True, 'workflow_id': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:38:09,489.489] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:38:33,948.948] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:38:33] "OPTIONS /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:38:33,951.951] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:38:33,952.952] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:38:33,952.952] base.py -> _exec_single_context line:1901 [INFO]: [cached since 180.2s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:38:33,953.953] base.py -> _exec_single_context line:1896 [INFO]: SELECT workflow.id AS workflow_id, workflow.account_id AS workflow_account_id, workflow.name AS workflow_name, workflow.tool_call_name AS workflow_tool_call_name, workflow.icon AS workflow_icon, workflow.description AS workflow_description, workflow.graph AS workflow_graph, workflow.draft_graph AS workflow_draft_graph, workflow.is_debug_passed AS workflow_is_debug_passed, workflow.status AS workflow_status, workflow.published_at AS workflow_published_at, workflow.updated_at AS workflow_updated_at, workflow.created_at AS workflow_created_at 
FROM workflow 
WHERE workflow.id = %(pk_1)s::UUID
[2025-06-06 17:38:33,954.954] base.py -> _exec_single_context line:1901 [INFO]: [cached since 142.7s ago] {'pk_1': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:38:33,955.955] base.py -> _exec_single_context line:1896 [INFO]: UPDATE workflow SET draft_graph=%(draft_graph)s::JSONB, is_debug_passed=%(is_debug_passed)s WHERE workflow.id = %(workflow_id)s::UUID
[2025-06-06 17:38:33,956.956] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00034s] {'draft_graph': '{"nodes": [{"id": "2758da9d-b4ea-4177-b2bb-1cfebd633f0d", "node_type": "start", "title": "\\u5f00\\u59cb\\u8282\\u70b9_nr8xx", "description": "\\u5de ... (2693 characters truncated) ... ", "source": "1d358a83-d48f-4d64-8549-9fe8dbabd79a", "source_type": "tool", "target": "3375ae65-029f-4ae2-8282-281dabb9af57", "target_type": "end"}]}', 'is_debug_passed': False, 'workflow_id': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:38:33,957.957] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:38:33,958.958] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:38:33] "POST /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:38:35,748.748] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:38:35,748.748] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:38:35,748.748] base.py -> _exec_single_context line:1901 [INFO]: [cached since 182s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:38:35,750.750] base.py -> _exec_single_context line:1896 [INFO]: SELECT workflow.id AS workflow_id, workflow.account_id AS workflow_account_id, workflow.name AS workflow_name, workflow.tool_call_name AS workflow_tool_call_name, workflow.icon AS workflow_icon, workflow.description AS workflow_description, workflow.graph AS workflow_graph, workflow.draft_graph AS workflow_draft_graph, workflow.is_debug_passed AS workflow_is_debug_passed, workflow.status AS workflow_status, workflow.published_at AS workflow_published_at, workflow.updated_at AS workflow_updated_at, workflow.created_at AS workflow_created_at 
FROM workflow 
WHERE workflow.id = %(pk_1)s::UUID
[2025-06-06 17:38:35,750.750] base.py -> _exec_single_context line:1901 [INFO]: [cached since 144.5s ago] {'pk_1': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:38:35,751.751] base.py -> _exec_single_context line:1896 [INFO]: UPDATE workflow SET draft_graph=%(draft_graph)s::JSONB WHERE workflow.id = %(workflow_id)s::UUID
[2025-06-06 17:38:35,751.751] base.py -> _exec_single_context line:1901 [INFO]: [cached since 136.8s ago] {'draft_graph': '{"nodes": [{"id": "2758da9d-b4ea-4177-b2bb-1cfebd633f0d", "node_type": "start", "title": "\\u5f00\\u59cb\\u8282\\u70b9_nr8xx", "description": "\\u5de ... (2692 characters truncated) ... ", "source": "1d358a83-d48f-4d64-8549-9fe8dbabd79a", "source_type": "tool", "target": "3375ae65-029f-4ae2-8282-281dabb9af57", "target_type": "end"}]}', 'workflow_id': UUID('04a8777b-604c-4567-8444-07482ae82bf9')}
[2025-06-06 17:38:35,752.752] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:38:35,753.753] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:38:35] "POST /workflows/04a8777b-604c-4567-8444-07482ae82bf9/draft-graph HTTP/1.1" 200 -
[2025-06-06 17:40:06,837.837] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:40:06,838.838] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:40:06,838.838] base.py -> _exec_single_context line:1901 [INFO]: [cached since 273.1s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:40:06,840.840] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:40:06,841.841] base.py -> _exec_single_context line:1901 [INFO]: [cached since 273.1s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 17:40:06,842.842] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 17:40:06,842.842] base.py -> _exec_single_context line:1901 [INFO]: [cached since 273.1s ago] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½,AIæ˜¯ä»€ä¹ˆ?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 17:40:06,846.846] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:40:06,891.891] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:40:06,892.892] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:40:06,892.892] base.py -> _exec_single_context line:1901 [INFO]: [cached since 273.1s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 17:40:06,894.894] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 17:40:06,894.894] base.py -> _exec_single_context line:1901 [INFO]: [cached since 273.1s ago] {'conversation_id_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'answer_1': '', 'param_1': 3, 'status_1_1': <MessageStatus.NORMAL: 'normal'>, 'status_1_2': <MessageStatus.STOP: 'stop'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 17:40:06,895.895] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:40:06,895.895] base.py -> _exec_single_context line:1901 [INFO]: [cached since 273s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:40:14,270.270] function_call_agent.py -> _llm_node line:192 [ERROR]: LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\core\agent\agents\function_call_agent.py", line 159, in _llm_node
    for chunk in llm.stream(state["messages"]):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 499, in stream
    for chunk in self._stream(input_messages, stop=stop, **kwargs):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 849, in _stream
    generation_chunk = self._convert_chunk_to_generation_chunk(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 707, in _convert_chunk_to_generation_chunk
    _create_usage_metadata(token_usage) if token_usage else None
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 2808, in _create_usage_metadata
    total_tokens = oai_token_usage.get("total_tokens", input_tokens + output_tokens)
TypeError: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
[2025-06-06 17:40:14,271.271] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:40:14,271.271] base.py -> _exec_single_context line:1901 [INFO]: [cached since 280.1s ago] {'pk_1': UUID('7f90f7e7-1f3a-4c50-bb69-c8a62f4c8979')}
[2025-06-06 17:40:14,272.272] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:40:14] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 17:40:14,277.277] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:40:14,278.278] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:40:14,278.278] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:40:14,279.279] base.py -> _exec_single_context line:1901 [INFO]: [cached since 280.5s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 17:40:14,280.280] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:40:14,280.280] base.py -> _exec_single_context line:1901 [INFO]: [cached since 272.3s ago] {'pk_1': UUID('7f90f7e7-1f3a-4c50-bb69-c8a62f4c8979')}
[2025-06-06 17:40:14,281.281] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET status=%(status)s, error=%(error)s WHERE message.id = %(message_id)s::UUID
[2025-06-06 17:40:14,282.282] base.py -> _exec_single_context line:1901 [INFO]: [cached since 272.3s ago] {'status': <QueueEvent.ERROR: 'error'>, 'error': "LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'", 'message_id': UUID('7f90f7e7-1f3a-4c50-bb69-c8a62f4c8979')}
[2025-06-06 17:40:14,283.283] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:40:58,844.844] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:40:58,844.844] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:40:58,845.845] base.py -> _exec_single_context line:1901 [INFO]: [cached since 325.1s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:40:58,850.850] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:40:58,850.850] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:40:58] "GET /language-models HTTP/1.1" 200 -
[2025-06-06 17:41:30,571.571] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:41:30,571.571] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:41:30,571.571] base.py -> _exec_single_context line:1901 [INFO]: [cached since 356.8s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:41:37,510.510] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:41:37,511.511] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:41:37] "GET /ping HTTP/1.1" 200 -
[2025-06-06 17:50:10,813.813] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:50:10,813.813] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:50:10,814.814] base.py -> _exec_single_context line:1901 [INFO]: [cached since 877s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:50:10,815.815] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: exceptions must derive from BaseException
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 189, in debug_chat
    raise validate_error_json(req.errors)
TypeError: exceptions must derive from BaseException
[2025-06-06 17:50:10,819.819] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:50:10,827.827] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:50:10] "[35m[1mPOST /apps/4e929f64-66bf-4718-9637-fa7f12b4d804/conversations HTTP/1.1[0m" 500 -
[2025-06-06 17:50:28,856.856] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:50:28,856.856] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:50:28,856.856] base.py -> _exec_single_context line:1901 [INFO]: [cached since 895.1s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:50:28,858.858] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: exceptions must derive from BaseException
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 189, in debug_chat
    raise validate_error_json(req.errors)
TypeError: exceptions must derive from BaseException
[2025-06-06 17:50:28,858.858] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:50:28,866.866] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:50:28] "[35m[1mPOST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1[0m" 500 -
[2025-06-06 17:51:08,655.655] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:51:08,655.655] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:51:08,655.655] base.py -> _exec_single_context line:1901 [INFO]: [cached since 934.9s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:51:08,657.657] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:51:08,657.657] base.py -> _exec_single_context line:1901 [INFO]: [cached since 919.3s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:51:08,659.659] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:51:08,659.659] base.py -> _exec_single_context line:1901 [INFO]: [cached since 919.3s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:51:08,661.661] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-06-06 17:51:08,661.661] base.py -> _exec_single_context line:1901 [INFO]: [cached since 919.3s ago] {'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-06-06 17:51:08,663.663] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-06-06 17:51:08,663.663] base.py -> _exec_single_context line:1901 [INFO]: [cached since 919.1s ago] {'id_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-06-06 17:51:08,664.664] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 17:51:08,665.665] base.py -> _exec_single_context line:1901 [INFO]: [cached since 934.9s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 17:51:08,668.668] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:51:08,709.709] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:51:08,709.709] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:51:08,711.711] base.py -> _exec_single_context line:1901 [INFO]: [cached since 934.9s ago] {'pk_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e')}
[2025-06-06 17:51:08,712.712] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 17:51:08,712.712] base.py -> _exec_single_context line:1901 [INFO]: [cached since 934.9s ago] {'conversation_id_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'answer_1': '', 'param_1': 10, 'status_1_1': <MessageStatus.NORMAL: 'normal'>, 'status_1_2': <MessageStatus.STOP: 'stop'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 17:51:14,855.855] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:51:14,856.856] base.py -> _exec_single_context line:1901 [INFO]: [cached since 941s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:51:15,880.880] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:51:15,880.880] base.py -> _exec_single_context line:1901 [INFO]: [cached since 941.7s ago] {'pk_1': UUID('ff099f9a-17ff-4078-8549-f328ac67bf0e')}
[2025-06-06 17:51:15,881.881] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:51:15] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-06-06 17:51:22,262.262] function_call_agent.py -> _llm_node line:192 [ERROR]: LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\core\agent\agents\function_call_agent.py", line 159, in _llm_node
    for chunk in llm.stream(state["messages"]):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\runnables\base.py", line 5607, in stream
    yield from self.bound.stream(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 499, in stream
    for chunk in self._stream(input_messages, stop=stop, **kwargs):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 849, in _stream
    generation_chunk = self._convert_chunk_to_generation_chunk(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 707, in _convert_chunk_to_generation_chunk
    _create_usage_metadata(token_usage) if token_usage else None
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 2808, in _create_usage_metadata
    total_tokens = oai_token_usage.get("total_tokens", input_tokens + output_tokens)
TypeError: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
[2025-06-06 17:51:22,270.270] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:51:22,274.274] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:51:22,274.274] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:51:22,274.274] base.py -> _exec_single_context line:1901 [INFO]: [cached since 948.5s ago] {'pk_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e')}
[2025-06-06 17:51:22,277.277] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:51:22,277.277] base.py -> _exec_single_context line:1901 [INFO]: [cached since 940.3s ago] {'pk_1': UUID('ff099f9a-17ff-4078-8549-f328ac67bf0e')}
[2025-06-06 17:51:22,278.278] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-06-06 17:51:22,279.279] base.py -> _exec_single_context line:1901 [INFO]: [cached since 940.3s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'message_id': UUID('ff099f9a-17ff-4078-8549-f328ac67bf0e'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': 'äººç±»è¯¢é—®AIå¦‚ä½•æ›´å¥½åœ°ä¿æŠ¤åœ°çƒçŽ¯å¢ƒï¼ŒAIæä¾›äº†å¤šç§æŽªæ–½ï¼ŒåŒ…æ‹¬å‡å°‘ç¢³è¶³è¿¹ã€èŠ‚çº¦èµ„æºã€å‡å°‘åºŸç‰©ã€æ”¯æŒå¯æŒç»­å†œä¸šã€ä¿æŠ¤è‡ªç„¶ç”Ÿæ€ã€æé«˜å…¬ä¼—æ„è¯†ä»¥åŠæ”¯æŒæ”¿ç­–å’Œç«‹æ³•ï¼Œå¼ºè°ƒæ¯ä¸ªäººéƒ½å¯ä»¥é€šè¿‡è¿™äº›æ–¹å¼ä¸ºä¿æŠ¤åœ°çƒçŽ¯å¢ƒè´¡çŒ®åŠ›é‡ã€‚æ­¤å¤–ï¼Œäººç±»è¯¢é—®æ·„åšçš„ç¾Žé£Ÿï¼ŒAIåˆ—ä¸¾äº†å¤šç§ç‰¹è‰²ç¾Žé£Ÿï¼ŒåŒ…æ‹¬æ·„åšçƒ§çƒ¤ã€åšå±±è±†è…ã€æ·„åšç…Žé¥¼ã€æ°´ç…ŽåŒ…ã€é²èœã€ç„¦åœˆå’Œç‚¸é¸¡æŸ³ï¼ŒæŒ‡å‡ºè¿™äº›ç¾Žé£Ÿä¸ä»…ç¾Žå‘³ï¼Œè¿˜èƒ½è®©äººæ›´å¥½åœ°ä½“éªŒæ·„åšçš„åœ°æ–¹æ–‡åŒ–ã€‚æœ€è¿‘ï¼Œäººç±»ä¸ŽAIè¿›è¡Œäº†ç®€å•çš„é—®å€™ï¼ŒAIå›žåº”äº†äººç±»çš„é—®å€™å¹¶è¯¢é—®æ˜¯å¦éœ€è¦å¸®åŠ©ã€‚', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-06-06 17:51:22,280.280] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:51:22,281.281] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:51:22,281.281] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:51:22,282.282] base.py -> _exec_single_context line:1901 [INFO]: [cached since 948.1s ago] {'pk_1': UUID('ff099f9a-17ff-4078-8549-f328ac67bf0e')}
[2025-06-06 17:51:22,283.283] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET status=%(status)s, error=%(error)s WHERE message.id = %(message_id)s::UUID
[2025-06-06 17:51:22,283.283] base.py -> _exec_single_context line:1901 [INFO]: [cached since 940.3s ago] {'status': <QueueEvent.ERROR: 'error'>, 'error': "LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'", 'message_id': UUID('ff099f9a-17ff-4078-8549-f328ac67bf0e')}
[2025-06-06 17:51:22,284.284] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:54:43,265.265] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\core\\agent\\agents\\function_call_agent.py', reloading
[2025-06-06 17:54:43,749.749] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 17:55:05,562.562] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-06-06 17:55:05,565.565] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-06-06 17:55:05,852.852] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-06-06 17:55:05,852.852] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 17:55:05,855.855] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-06-06 17:55:05,855.855] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 17:55:05,856.856] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-06-06 17:55:05,856.856] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 17:55:05,857.857] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:55:05,859.859] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:55:05,859.859] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00075s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:55:05,865.865] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:55:05,865.865] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00048s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:55:05,869.869] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:55:05,869.869] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00046s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:55:05,874.874] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-06-06 17:55:05,874.874] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00045s] {'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-06-06 17:55:05,878.878] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-06-06 17:55:05,879.879] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00046s] {'id_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-06-06 17:55:05,882.882] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 17:55:05,883.883] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00114s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 17:55:05,889.889] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:55:05,936.936] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:55:05,938.938] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:55:05,938.938] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00051s] {'pk_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e')}
[2025-06-06 17:55:05,941.941] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 17:55:05,941.941] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00051s] {'conversation_id_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'answer_1': '', 'param_1': 10, 'status_1_1': <MessageStatus.NORMAL: 'normal'>, 'status_1_2': <MessageStatus.STOP: 'stop'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 17:55:06,212.212] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:55:06,212.212] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00043s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:55:06,425.425] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:55:06,426.426] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00064s] {'pk_1': UUID('a6bc3a05-7a48-477a-b138-cec08dad192f')}
[2025-06-06 17:55:06,427.427] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:55:06] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-06-06 17:57:51,784.784] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\core\\agent\\agents\\function_call_agent.py', reloading
[2025-06-06 17:57:52,152.152] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 17:58:13,513.513] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-06-06 17:58:13,515.515] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-06-06 17:59:19,134.134] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\core\\agent\\agents\\function_call_agent.py', reloading
[2025-06-06 17:59:19,493.493] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 17:59:41,394.394] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-06-06 17:59:41,397.397] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-06-06 17:59:41,688.688] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-06-06 17:59:41,688.688] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 17:59:41,689.689] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-06-06 17:59:41,690.690] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 17:59:41,691.691] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-06-06 17:59:41,691.691] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 17:59:41,692.692] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:59:41,694.694] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:59:41,694.694] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00028s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 17:59:41,700.700] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 17:59:41,701.701] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00047s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 17:59:41,705.705] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 17:59:41,705.705] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00037s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 17:59:41,709.709] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-06-06 17:59:41,710.710] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00039s] {'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-06-06 17:59:41,713.713] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-06-06 17:59:41,713.713] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00036s] {'id_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-06-06 17:59:41,717.717] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 17:59:41,718.718] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00048s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 17:59:41,726.726] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:59:41,767.767] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:59:41,769.769] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:59:41,769.769] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00030s] {'pk_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e')}
[2025-06-06 17:59:41,771.771] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 17:59:41,772.772] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00038s] {'conversation_id_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'answer_1': '', 'param_1': 10, 'status_1_1': <MessageStatus.NORMAL: 'normal'>, 'status_1_2': <MessageStatus.STOP: 'stop'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 17:59:42,014.014] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 17:59:42,014.014] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00038s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 17:59:42,343.343] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:59:42,350.350] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00564s] {'pk_1': UUID('a7877cc9-ccc8-4ae9-a72b-1e242a163b8e')}
[2025-06-06 17:59:42,351.351] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 17:59:42] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-06-06 17:59:49,558.558] function_call_agent.py -> _llm_node line:193 [ERROR]: LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\core\agent\agents\function_call_agent.py", line 160, in _llm_node
    for chunk in llm.stream(state["messages"]):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\runnables\base.py", line 5607, in stream
    yield from self.bound.stream(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 499, in stream
    for chunk in self._stream(input_messages, stop=stop, **kwargs):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 849, in _stream
    generation_chunk = self._convert_chunk_to_generation_chunk(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 707, in _convert_chunk_to_generation_chunk
    _create_usage_metadata(token_usage) if token_usage else None
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_openai\chat_models\base.py", line 2808, in _create_usage_metadata
    total_tokens = oai_token_usage.get("total_tokens", input_tokens + output_tokens)
TypeError: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
[2025-06-06 17:59:49,564.564] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 17:59:49,713.713] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:59:49,714.714] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 17:59:49,715.715] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00033s] {'pk_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e')}
[2025-06-06 17:59:49,718.718] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:59:49,718.718] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00035s] {'pk_1': UUID('a7877cc9-ccc8-4ae9-a72b-1e242a163b8e')}
[2025-06-06 17:59:49,722.722] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-06-06 17:59:49,722.722] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00046s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'message_id': UUID('a7877cc9-ccc8-4ae9-a72b-1e242a163b8e'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': 'äººç±»è¯¢é—®AIå¦‚ä½•æ›´å¥½åœ°ä¿æŠ¤åœ°çƒçŽ¯å¢ƒï¼ŒAIæä¾›äº†å¤šç§æŽªæ–½ï¼ŒåŒ…æ‹¬å‡å°‘ç¢³è¶³è¿¹ã€èŠ‚çº¦èµ„æºã€å‡å°‘åºŸç‰©ã€æ”¯æŒå¯æŒç»­å†œä¸šã€ä¿æŠ¤è‡ªç„¶ç”Ÿæ€ã€æé«˜å…¬ä¼—æ„è¯†ä»¥åŠæ”¯æŒæ”¿ç­–å’Œç«‹æ³•ï¼Œå¼ºè°ƒæ¯ä¸ªäººéƒ½å¯ä»¥é€šè¿‡è¿™äº›æ–¹å¼ä¸ºä¿æŠ¤åœ°çƒçŽ¯å¢ƒè´¡çŒ®åŠ›é‡ã€‚æ­¤å¤–ï¼Œäººç±»è¯¢é—®æ·„åšçš„ç¾Žé£Ÿï¼ŒAIåˆ—ä¸¾äº†å¤šç§ç‰¹è‰²ç¾Žé£Ÿï¼ŒåŒ…æ‹¬æ·„åšçƒ§çƒ¤ã€åšå±±è±†è…ã€æ·„åšç…Žé¥¼ã€æ°´ç…ŽåŒ…ã€é²èœã€ç„¦åœˆå’Œç‚¸é¸¡æŸ³ï¼ŒæŒ‡å‡ºè¿™äº›ç¾Žé£Ÿä¸ä»…ç¾Žå‘³ï¼Œè¿˜èƒ½è®©äººæ›´å¥½åœ°ä½“éªŒæ·„åšçš„åœ°æ–¹æ–‡åŒ–ã€‚æœ€è¿‘ï¼Œäººç±»ä¸ŽAIè¿›è¡Œäº†ç®€å•çš„é—®å€™ï¼ŒAIå›žåº”äº†äººç±»çš„é—®å€™å¹¶è¯¢é—®æ˜¯å¦éœ€è¦å¸®åŠ©ã€‚', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-06-06 17:59:49,730.730] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 17:59:49,733.733] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 17:59:49,734.734] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 17:59:49,734.734] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.39s ago] {'pk_1': UUID('a7877cc9-ccc8-4ae9-a72b-1e242a163b8e')}
[2025-06-06 17:59:49,736.736] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET status=%(status)s, error=%(error)s WHERE message.id = %(message_id)s::UUID
[2025-06-06 17:59:49,736.736] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00036s] {'status': <QueueEvent.ERROR: 'error'>, 'error': "LLMèŠ‚ç‚¹å‘ç”Ÿé”™è¯¯, é”™è¯¯ä¿¡æ¯: unsupported operand type(s) for +: 'NoneType' and 'NoneType'", 'message_id': UUID('a7877cc9-ccc8-4ae9-a72b-1e242a163b8e')}
[2025-06-06 17:59:49,738.738] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 18:02:58,451.451] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\core\\agent\\agents\\function_call_agent.py', reloading
[2025-06-06 18:02:58,833.833] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 18:03:19,997.997] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-06-06 18:03:20,000.000] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-06-06 18:03:24,498.498] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-06-06 18:03:24,498.498] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 18:03:24,499.499] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-06-06 18:03:24,499.499] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 18:03:24,500.500] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-06-06 18:03:24,500.500] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 18:03:24,501.501] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 18:03:24,503.503] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 18:03:24,503.503] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00039s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 18:03:24,510.510] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-06-06 18:03:24,510.510] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00050s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-06-06 18:03:24,515.515] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-06-06 18:03:24,515.515] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00036s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-06-06 18:03:24,518.518] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-06-06 18:03:24,518.518] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00047s] {'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-06-06 18:03:24,522.522] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-06-06 18:03:24,523.523] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00050s] {'id_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-06-06 18:03:24,527.527] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 18:03:24,527.527] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00049s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 18:03:24,533.533] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 18:03:24,577.577] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 18:03:24,578.578] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 18:03:24,578.578] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00029s] {'pk_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e')}
[2025-06-06 18:03:24,581.581] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 18:03:24,582.582] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00067s] {'conversation_id_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'answer_1': '', 'param_1': 10, 'status_1_1': <MessageStatus.NORMAL: 'normal'>, 'status_1_2': <MessageStatus.STOP: 'stop'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 18:03:24,806.806] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 18:03:24,807.807] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00051s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 18:03:25,009.009] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 18:03:25,014.014] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00500s] {'pk_1': UUID('0f9c4257-ca2d-4938-8e28-718fc2bee62a')}
[2025-06-06 18:03:25,016.016] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 18:03:25] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-06-06 18:03:34,944.944] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 18:03:35,087.087] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 18:03:35,088.088] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 18:03:35,089.089] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00038s] {'pk_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e')}
[2025-06-06 18:03:35,092.092] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 18:03:35,092.092] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00027s] {'pk_1': UUID('0f9c4257-ca2d-4938-8e28-718fc2bee62a')}
[2025-06-06 18:03:35,096.096] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-06-06 18:03:35,096.096] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00047s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'message_id': UUID('0f9c4257-ca2d-4938-8e28-718fc2bee62a'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': 'äººç±»è¯¢é—®AIå¦‚ä½•æ›´å¥½åœ°ä¿æŠ¤åœ°çƒçŽ¯å¢ƒï¼ŒAIæä¾›äº†å¤šç§æŽªæ–½ï¼ŒåŒ…æ‹¬å‡å°‘ç¢³è¶³è¿¹ã€èŠ‚çº¦èµ„æºã€å‡å°‘åºŸç‰©ã€æ”¯æŒå¯æŒç»­å†œä¸šã€ä¿æŠ¤è‡ªç„¶ç”Ÿæ€ã€æé«˜å…¬ä¼—æ„è¯†ä»¥åŠæ”¯æŒæ”¿ç­–å’Œç«‹æ³•ï¼Œå¼ºè°ƒæ¯ä¸ªäººéƒ½å¯ä»¥é€šè¿‡è¿™äº›æ–¹å¼ä¸ºä¿æŠ¤åœ°çƒçŽ¯å¢ƒè´¡çŒ®åŠ›é‡ã€‚æ­¤å¤–ï¼Œäººç±»è¯¢é—®æ·„åšçš„ç¾Žé£Ÿï¼ŒAIåˆ—ä¸¾äº†å¤šç§ç‰¹è‰²ç¾Žé£Ÿï¼ŒåŒ…æ‹¬æ·„åšçƒ§çƒ¤ã€åšå±±è±†è…ã€æ·„åšç…Žé¥¼ã€æ°´ç…ŽåŒ…ã€é²èœã€ç„¦åœˆå’Œç‚¸é¸¡æŸ³ï¼ŒæŒ‡å‡ºè¿™äº›ç¾Žé£Ÿä¸ä»…ç¾Žå‘³ï¼Œè¿˜èƒ½è®©äººæ›´å¥½åœ°ä½“éªŒæ·„åšçš„åœ°æ–¹æ–‡åŒ–ã€‚æœ€è¿‘ï¼Œäººç±»ä¸ŽAIè¿›è¡Œäº†ç®€å•çš„é—®å€™ï¼ŒAIå›žåº”äº†äººç±»çš„é—®å€™å¹¶è¯¢é—®æ˜¯å¦éœ€è¦å¸®åŠ©ã€‚', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-06-06 18:03:35,102.102] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 18:03:35,104.104] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 18:03:35,104.104] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 18:03:35,105.105] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.53s ago] {'pk_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e')}
[2025-06-06 18:03:35,106.106] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 18:03:35,106.106] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.1s ago] {'pk_1': UUID('0f9c4257-ca2d-4938-8e28-718fc2bee62a')}
[2025-06-06 18:03:35,107.107] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-06-06 18:03:35,108.108] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01209s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e'), 'message_id': UUID('0f9c4257-ca2d-4938-8e28-718fc2bee62a'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 2, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': 'ä½ å¥½ï¼å¾ˆé«˜å…´å†æ¬¡è§åˆ°ä½ ã€‚å¦‚æžœæœ‰ä»€ä¹ˆé—®é¢˜æˆ–éœ€è¦å¸®åŠ©çš„åœ°æ–¹ï¼Œè¯·éšæ—¶å‘Šè¯‰æˆ‘ï¼', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (12229 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "ff6b01b8-9fc0-4812-867a-6fda5fe49f96", "example": false}}]', 'answer': 'ä½ å¥½ï¼å¾ˆé«˜å…´å†æ¬¡è§åˆ°ä½ ã€‚å¦‚æžœæœ‰ä»€ä¹ˆé—®é¢˜æˆ–éœ€è¦å¸®åŠ©çš„åœ°æ–¹ï¼Œè¯·éšæ—¶å‘Šè¯‰æˆ‘ï¼', 'latency': 9.866578199999996}
[2025-06-06 18:03:35,113.113] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 18:03:35,114.114] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 18:03:35,115.115] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 18:03:35,115.115] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.11s ago] {'pk_1': UUID('0f9c4257-ca2d-4938-8e28-718fc2bee62a')}
[2025-06-06 18:03:35,117.117] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s, latency=%(latency)s WHERE message.id = %(message_id)s::UUID
[2025-06-06 18:03:35,117.117] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00045s] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (12229 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "ff6b01b8-9fc0-4812-867a-6fda5fe49f96", "example": false}}]', 'answer': 'ä½ å¥½ï¼å¾ˆé«˜å…´å†æ¬¡è§åˆ°ä½ ã€‚å¦‚æžœæœ‰ä»€ä¹ˆé—®é¢˜æˆ–éœ€è¦å¸®åŠ©çš„åœ°æ–¹ï¼Œè¯·éšæ—¶å‘Šè¯‰æˆ‘ï¼', 'latency': 9.866578199999996, 'message_id': UUID('0f9c4257-ca2d-4938-8e28-718fc2bee62a')}
[2025-06-06 18:03:35,120.120] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 18:03:35,121.121] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 18:03:35,121.121] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 18:03:35,122.122] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.11s ago] {'pk_1': UUID('0f9c4257-ca2d-4938-8e28-718fc2bee62a')}
[2025-06-06 18:03:35,123.123] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 18:03:35,123.123] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.55s ago] {'pk_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e')}
[2025-06-06 18:03:43,593.593] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 18:03:43,593.593] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 18:03:43,593.593] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.09s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 18:03:43,597.597] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 18:03:43,597.597] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 18:03:43] "POST /assistant-agent/chat/889dceb4-d58f-4971-9027-5ac7f12e6faf/stop HTTP/1.1" 200 -
[2025-06-06 18:03:45,443.443] base.py -> _exec_single_context line:1896 [INFO]: UPDATE conversation SET summary=%(summary)s WHERE conversation.id = %(conversation_id)s::UUID
[2025-06-06 18:03:45,444.444] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00061s] {'summary': 'äººç±»è¯¢é—®AIå¦‚ä½•æ›´å¥½åœ°ä¿æŠ¤åœ°çƒçŽ¯å¢ƒï¼ŒAIæä¾›äº†å¤šç§æŽªæ–½ï¼ŒåŒ…æ‹¬å‡å°‘ç¢³è¶³è¿¹ã€èŠ‚çº¦èµ„æºã€å‡å°‘åºŸç‰©ã€æ”¯æŒå¯æŒç»­å†œä¸šã€ä¿æŠ¤è‡ªç„¶ç”Ÿæ€ã€æé«˜å…¬ä¼—æ„è¯†ä»¥åŠæ”¯æŒæ”¿ç­–å’Œç«‹æ³•ï¼Œå¼ºè°ƒæ¯ä¸ªäººéƒ½å¯ä»¥é€šè¿‡è¿™äº›æ–¹å¼ä¸ºä¿æŠ¤åœ°çƒçŽ¯å¢ƒè´¡çŒ®åŠ›é‡ã€‚æ­¤å¤–ï¼Œäººç±»è¯¢é—®æ·„åšçš„ç¾Žé£Ÿï¼ŒAIåˆ—ä¸¾äº†å¤šç§ç‰¹è‰²ç¾Žé£Ÿï¼ŒåŒ…æ‹¬æ·„åšçƒ§çƒ¤ã€åšå±±è±†è…ã€æ·„åšç…Žé¥¼ã€æ°´ç…ŽåŒ…ã€é²èœã€ç„¦åœˆå’Œç‚¸é¸¡æŸ³ï¼ŒæŒ‡å‡ºè¿™äº›ç¾Žé£Ÿä¸ä»…ç¾Žå‘³ï¼Œè¿˜èƒ½è®©äººæ›´å¥½åœ°ä½“éªŒæ·„åšçš„åœ°æ–¹æ–‡åŒ–ã€‚æœ€è¿‘ï¼Œäººç±»ä¸ŽAIè¿›è¡Œäº†ç®€å•çš„é—®å€™ï¼ŒAIå›žåº”äº†äººç±»çš„é—®å€™å¹¶è¯¢é—®æ˜¯å¦éœ€è¦å¸®åŠ©ã€‚AIè¡¨ç¤ºå¾ˆé«˜å…´å†æ¬¡è§åˆ°äººç±»ï¼Œå¹¶é¼“åŠ±äººç±»éšæ—¶æå‡ºé—®é¢˜æˆ–å¯»æ±‚å¸®åŠ©ã€‚', 'conversation_id': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e')}
[2025-06-06 18:03:45,445.445] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 18:03:45,446.446] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 18:03:45,448.448] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 18:03:45,448.448] base.py -> _exec_single_context line:1901 [INFO]: [cached since 20.87s ago] {'pk_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e')}
[2025-06-06 18:03:45,449.449] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(message.id) AS count_1 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID
[2025-06-06 18:03:45,449.449] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00021s] {'conversation_id_1': UUID('c0cd13af-7a28-4c7e-92d6-a4c659c2772e')}
[2025-06-06 18:03:45,451.451] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 18:03:58,612.612] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 18:03:58,612.612] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 18:03:58,612.612] base.py -> _exec_single_context line:1901 [INFO]: [cached since 34.11s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 18:03:58,615.615] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 18:03:58,615.615] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.53s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 18:03:58,616.616] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 18:03:58,617.617] base.py -> _exec_single_context line:1901 [INFO]: [cached since 34.09s ago] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½,AIæ˜¯ä»€ä¹ˆ?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 18:03:58,618.618] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 18:03:58,662.662] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 18:03:58,662.662] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 18:03:58,662.662] base.py -> _exec_single_context line:1901 [INFO]: [cached since 34.08s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 18:03:58,664.664] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 18:03:58,664.664] base.py -> _exec_single_context line:1901 [INFO]: [cached since 34.08s ago] {'conversation_id_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'answer_1': '', 'param_1': 3, 'status_1_1': <MessageStatus.NORMAL: 'normal'>, 'status_1_2': <MessageStatus.STOP: 'stop'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 18:03:58,666.666] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 18:03:58,666.666] base.py -> _exec_single_context line:1901 [INFO]: [cached since 33.86s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 18:04:06,503.503] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 18:04:06,503.503] base.py -> _exec_single_context line:1901 [INFO]: [cached since 41.49s ago] {'pk_1': UUID('88c1e36b-9fa4-4f87-93ec-a49a719c793c')}
[2025-06-06 18:04:06,504.504] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 18:04:06] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 18:04:07,253.253] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 18:04:07,254.254] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 18:04:07,254.254] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 18:04:07,255.255] base.py -> _exec_single_context line:1901 [INFO]: [cached since 32.17s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 18:04:07,256.256] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 18:04:07,256.256] base.py -> _exec_single_context line:1901 [INFO]: [cached since 32.16s ago] {'pk_1': UUID('88c1e36b-9fa4-4f87-93ec-a49a719c793c')}
[2025-06-06 18:04:07,257.257] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-06-06 18:04:07,258.258] base.py -> _exec_single_context line:1901 [INFO]: [cached since 32.16s ago] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'message_id': UUID('88c1e36b-9fa4-4f87-93ec-a49a719c793c'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': 'ä½ å¥½ï¼AIï¼ˆäººå·¥æ™ºèƒ½ï¼‰æ˜¯æŒ‡é€šè¿‡è®¡ç®—æœºç³»ç»Ÿæ¨¡æ‹Ÿäººç±»æ™ºèƒ½çš„èƒ½åŠ›ã€‚å®ƒåŒ…æ‹¬æœºå™¨å­¦ä¹ ã€è‡ªç„¶è¯­è¨€å¤„ç†ã€è®¡ç®—æœºè§†è§‰ç­‰å¤šä¸ªé¢†åŸŸï¼Œæ—¨åœ¨è®©è®¡ç®—æœºèƒ½å¤Ÿæ‰§è¡Œé€šå¸¸éœ€è¦äººç±»æ™ºèƒ½æ‰èƒ½å®Œæˆçš„ä»»åŠ¡ï¼Œå¦‚ç†è§£è¯­è¨€ã€è¯†åˆ«å›¾åƒå’Œè¿›è¡Œå†³ç­–ç­‰ã€‚AIæŠ€æœ¯çš„å¹¿æ³›åº”ç”¨åŒ…æ‹¬è‡ªåŠ¨é©¾é©¶ã€æ™ºèƒ½åŠ©æ‰‹ã€æŽ¨èç³»ç»Ÿç­‰ã€‚', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (2885 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "d5cdab28-047d-46f1-902b-58e5b0275712", "example": false}}]', 'answer': 'ä½ å¥½ï¼AIï¼ˆäººå·¥æ™ºèƒ½ï¼‰æ˜¯æŒ‡é€šè¿‡è®¡ç®—æœºç³»ç»Ÿæ¨¡æ‹Ÿäººç±»æ™ºèƒ½çš„èƒ½åŠ›ã€‚å®ƒåŒ…æ‹¬æœºå™¨å­¦ä¹ ã€è‡ªç„¶è¯­è¨€å¤„ç†ã€è®¡ç®—æœºè§†è§‰ç­‰å¤šä¸ªé¢†åŸŸï¼Œæ—¨åœ¨è®©è®¡ç®—æœºèƒ½å¤Ÿæ‰§è¡Œé€šå¸¸éœ€è¦äººç±»æ™ºèƒ½æ‰èƒ½å®Œæˆçš„ä»»åŠ¡ï¼Œå¦‚ç†è§£è¯­è¨€ã€è¯†åˆ«å›¾åƒå’Œè¿›è¡Œå†³ç­–ç­‰ã€‚AIæŠ€æœ¯çš„å¹¿æ³›åº”ç”¨åŒ…æ‹¬è‡ªåŠ¨é©¾é©¶ã€æ™ºèƒ½åŠ©æ‰‹ã€æŽ¨èç³»ç»Ÿç­‰ã€‚', 'latency': 8.547853800000006}
[2025-06-06 18:04:07,260.260] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 18:04:07,261.261] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 18:04:07,261.261] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 18:04:07,261.261] base.py -> _exec_single_context line:1901 [INFO]: [cached since 42.25s ago] {'pk_1': UUID('88c1e36b-9fa4-4f87-93ec-a49a719c793c')}
[2025-06-06 18:04:07,262.262] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s, latency=%(latency)s WHERE message.id = %(message_id)s::UUID
[2025-06-06 18:04:07,263.263] base.py -> _exec_single_context line:1901 [INFO]: [cached since 32.15s ago] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (2885 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "d5cdab28-047d-46f1-902b-58e5b0275712", "example": false}}]', 'answer': 'ä½ å¥½ï¼AIï¼ˆäººå·¥æ™ºèƒ½ï¼‰æ˜¯æŒ‡é€šè¿‡è®¡ç®—æœºç³»ç»Ÿæ¨¡æ‹Ÿäººç±»æ™ºèƒ½çš„èƒ½åŠ›ã€‚å®ƒåŒ…æ‹¬æœºå™¨å­¦ä¹ ã€è‡ªç„¶è¯­è¨€å¤„ç†ã€è®¡ç®—æœºè§†è§‰ç­‰å¤šä¸ªé¢†åŸŸï¼Œæ—¨åœ¨è®©è®¡ç®—æœºèƒ½å¤Ÿæ‰§è¡Œé€šå¸¸éœ€è¦äººç±»æ™ºèƒ½æ‰èƒ½å®Œæˆçš„ä»»åŠ¡ï¼Œå¦‚ç†è§£è¯­è¨€ã€è¯†åˆ«å›¾åƒå’Œè¿›è¡Œå†³ç­–ç­‰ã€‚AIæŠ€æœ¯çš„å¹¿æ³›åº”ç”¨åŒ…æ‹¬è‡ªåŠ¨é©¾é©¶ã€æ™ºèƒ½åŠ©æ‰‹ã€æŽ¨èç³»ç»Ÿç­‰ã€‚', 'latency': 8.547853800000006, 'message_id': UUID('88c1e36b-9fa4-4f87-93ec-a49a719c793c')}
[2025-06-06 18:04:07,264.264] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 18:04:07,265.265] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 18:04:07,265.265] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 18:04:07,265.265] base.py -> _exec_single_context line:1901 [INFO]: [cached since 42.26s ago] {'pk_1': UUID('88c1e36b-9fa4-4f87-93ec-a49a719c793c')}
[2025-06-06 18:04:07,266.266] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 18:04:07,266.266] base.py -> _exec_single_context line:1901 [INFO]: [cached since 42.69s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 18:04:15,210.210] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 18:04:15,211.211] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 18:04:15,211.211] base.py -> _exec_single_context line:1901 [INFO]: [cached since 50.71s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 18:04:15,214.214] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 18:04:15,215.215] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 18:04:15] "POST /assistant-agent/chat/889dceb4-d58f-4971-9027-5ac7f12e6faf/stop HTTP/1.1" 200 -
[2025-06-06 18:04:15,388.388] base.py -> _exec_single_context line:1896 [INFO]: UPDATE conversation SET summary=%(summary)s WHERE conversation.id = %(conversation_id)s::UUID
[2025-06-06 18:04:15,389.389] base.py -> _exec_single_context line:1901 [INFO]: [cached since 29.95s ago] {'summary': 'äººç±»è¯¢é—®AIæ˜¯ä»€ä¹ˆï¼ŒAIè§£é‡Šé“ï¼ŒAIï¼ˆäººå·¥æ™ºèƒ½ï¼‰æ˜¯æŒ‡é€šè¿‡è®¡ç®—æœºç³»ç»Ÿæ¨¡æ‹Ÿäººç±»æ™ºèƒ½çš„èƒ½åŠ›ï¼Œæ¶µç›–æœºå™¨å­¦ä¹ ã€è‡ªç„¶è¯­è¨€å¤„ç†ã€è®¡ç®—æœºè§†è§‰ç­‰é¢†åŸŸï¼Œæ—¨åœ¨è®©è®¡ç®—æœºæ‰§è¡Œé€šå¸¸éœ€è¦äººç±»æ™ºèƒ½æ‰èƒ½å®Œæˆçš„ä»»åŠ¡ï¼Œå¦‚ç†è§£è¯­è¨€ã€è¯†åˆ«å›¾åƒå’Œè¿›è¡Œå†³ç­–ç­‰ã€‚AIæŠ€æœ¯çš„å¹¿æ³›åº”ç”¨åŒ…æ‹¬è‡ªåŠ¨é©¾é©¶ã€æ™ºèƒ½åŠ©æ‰‹ã€æŽ¨èç³»ç»Ÿç­‰ã€‚', 'conversation_id': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 18:04:15,390.390] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 18:04:15,391.391] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 18:04:15,392.392] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 18:04:15,392.392] base.py -> _exec_single_context line:1901 [INFO]: [cached since 50.81s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 18:04:15,393.393] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(message.id) AS count_1 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID
[2025-06-06 18:04:15,393.393] base.py -> _exec_single_context line:1901 [INFO]: [cached since 29.94s ago] {'conversation_id_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 18:04:15,394.394] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 18:04:23,776.776] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 18:04:23,777.777] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 18:04:23,777.777] base.py -> _exec_single_context line:1901 [INFO]: [cached since 59.27s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 18:04:23,778.778] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 18:04:23,779.779] base.py -> _exec_single_context line:1901 [INFO]: [cached since 48.69s ago] {'pk_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1')}
[2025-06-06 18:04:23,782.782] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.status IN (%(status_1_1)s, %(status_1_2)s) AND message.answer != %(answer_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-06-06 18:04:23,782.782] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00038s] {'conversation_id_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'answer_1': '', 'param_1': 20, 'param_2': 0, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 18:04:23,785.785] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT message.id AS id, message.app_id AS app_id, message.conversation_id AS conversation_id, message.invoke_from AS invoke_from, message.created_by AS created_by, message.query AS query, message.message AS message, message.message_token_count AS message_token_count, message.message_unit_price AS message_unit_price, message.message_price_unit AS message_price_unit, message.answer AS answer, message.answer_token_count AS answer_token_count, message.answer_unit_price AS answer_unit_price, message.answer_price_unit AS answer_price_unit, message.latency AS latency, message.is_deleted AS is_deleted, message.status AS status, message.error AS error, message.total_token_count AS total_token_count, message.total_price AS total_price, message.updated_at AS updated_at, message.created_at AS created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.status IN (%(status_1_1)s, %(status_1_2)s) AND message.answer != %(answer_1)s) AS anon_1
[2025-06-06 18:04:23,786.786] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00071s] {'conversation_id_1': UUID('87b6f56a-0235-4f72-bcbf-afb86459d8f1'), 'answer_1': '', 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 18:04:23,788.788] base.py -> _exec_single_context line:1896 [INFO]: SELECT message_agent_thought.id AS message_agent_thought_id, message_agent_thought.app_id AS message_agent_thought_app_id, message_agent_thought.conversation_id AS message_agent_thought_conversation_id, message_agent_thought.message_id AS message_agent_thought_message_id, message_agent_thought.invoke_from AS message_agent_thought_invoke_from, message_agent_thought.created_by AS message_agent_thought_created_by, message_agent_thought.position AS message_agent_thought_position, message_agent_thought.event AS message_agent_thought_event, message_agent_thought.thought AS message_agent_thought_thought, message_agent_thought.observation AS message_agent_thought_observation, message_agent_thought.tool AS message_agent_thought_tool, message_agent_thought.tool_input AS message_agent_thought_tool_input, message_agent_thought.message AS message_agent_thought_message, message_agent_thought.message_token_count AS message_agent_thought_message_token_count, message_agent_thought.message_unit_price AS message_agent_thought_message_unit_price, message_agent_thought.message_price_unit AS message_agent_thought_message_price_unit, message_agent_thought.answer AS message_agent_thought_answer, message_agent_thought.answer_token_count AS message_agent_thought_answer_token_count, message_agent_thought.answer_unit_price AS message_agent_thought_answer_unit_price, message_agent_thought.answer_price_unit AS message_agent_thought_answer_price_unit, message_agent_thought.total_token_count AS message_agent_thought_total_token_count, message_agent_thought.total_price AS message_agent_thought_total_price, message_agent_thought.latency AS message_agent_thought_latency, message_agent_thought.updated_at AS message_agent_thought_updated_at, message_agent_thought.created_at AS message_agent_thought_created_at 
FROM message_agent_thought 
WHERE message_agent_thought.message_id = %(message_id_1)s::UUID ORDER BY message_agent_thought.position ASC
[2025-06-06 18:04:23,789.789] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00033s] {'message_id_1': UUID('88c1e36b-9fa4-4f87-93ec-a49a719c793c')}
[2025-06-06 18:04:23,792.792] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 18:04:23,792.792] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 18:04:23] "GET /assistant-agent/messages HTTP/1.1" 200 -
[2025-06-06 18:04:33,474.474] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 405 Method Not Allowed: The method is not allowed for the requested URL.
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 844, in dispatch_request
    self.raise_routing_exception(req)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 453, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\werkzeug\routing\map.py", line 624, in match
    raise MethodNotAllowed(valid_methods=list(e.have_match_for)) from None
werkzeug.exceptions.MethodNotAllowed: 405 Method Not Allowed: The method is not allowed for the requested URL.
[2025-06-06 18:04:33,486.486] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 18:04:33] "[35m[1mGET /assistant-agent/delete-conversation HTTP/1.1[0m" 500 -
[2025-06-06 18:07:02,724.724] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 405 Method Not Allowed: The method is not allowed for the requested URL.
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 844, in dispatch_request
    self.raise_routing_exception(req)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 453, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\werkzeug\routing\map.py", line 624, in match
    raise MethodNotAllowed(valid_methods=list(e.have_match_for)) from None
werkzeug.exceptions.MethodNotAllowed: 405 Method Not Allowed: The method is not allowed for the requested URL.
[2025-06-06 18:07:02,733.733] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 18:07:02] "[35m[1mGET /assistant-agent/delete-conversation HTTP/1.1[0m" 500 -
[2025-06-06 18:08:17,493.493] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 405 Method Not Allowed: The method is not allowed for the requested URL.
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 844, in dispatch_request
    self.raise_routing_exception(req)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 453, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\werkzeug\routing\map.py", line 624, in match
    raise MethodNotAllowed(valid_methods=list(e.have_match_for)) from None
werkzeug.exceptions.MethodNotAllowed: 405 Method Not Allowed: The method is not allowed for the requested URL.
[2025-06-06 18:08:17,504.504] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 18:08:17] "[35m[1mGET /assistant-agent/delete-conversation HTTP/1.1[0m" 500 -
[2025-06-06 18:08:18,768.768] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 405 Method Not Allowed: The method is not allowed for the requested URL.
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 844, in dispatch_request
    self.raise_routing_exception(req)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 453, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\werkzeug\routing\map.py", line 624, in match
    raise MethodNotAllowed(valid_methods=list(e.have_match_for)) from None
werkzeug.exceptions.MethodNotAllowed: 405 Method Not Allowed: The method is not allowed for the requested URL.
[2025-06-06 18:08:18,776.776] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 18:08:18] "[35m[1mGET /assistant-agent/delete-conversation HTTP/1.1[0m" 500 -
[2025-06-06 18:08:57,683.683] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 18:08:57,683.683] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 18:08:57,684.684] base.py -> _exec_single_context line:1901 [INFO]: [cached since 333.2s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 18:08:57,686.686] base.py -> _exec_single_context line:1896 [INFO]: UPDATE account SET assistant_agent_conversation_id=%(assistant_agent_conversation_id)s::UUID WHERE account.id = %(account_id)s::UUID
[2025-06-06 18:08:57,686.686] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00045s] {'assistant_agent_conversation_id': None, 'account_id': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 18:08:57,687.687] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 18:08:57,689.689] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 18:08:57] "POST /assistant-agent/delete-conversation HTTP/1.1" 200 -
[2025-06-06 18:09:01,273.273] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 18:09:01,274.274] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 18:09:01,274.274] base.py -> _exec_single_context line:1901 [INFO]: [cached since 336.8s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 18:09:01,276.276] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO conversation (app_id, name, invoke_from, created_by) VALUES (%(app_id)s::UUID, %(name)s, %(invoke_from)s, %(created_by)s::UUID) RETURNING conversation.id, conversation.summary, conversation.is_pinned, conversation.is_deleted, conversation.updated_at, conversation.created_at
[2025-06-06 18:09:01,276.276] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00027s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'name': 'New Conversation', 'invoke_from': <InvokeFrom.ASSISTANT_AGENT: 'assistant_agent'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 18:09:01,278.278] base.py -> _exec_single_context line:1896 [INFO]: UPDATE account SET assistant_agent_conversation_id=%(assistant_agent_conversation_id)s::UUID WHERE account.id = %(account_id)s::UUID
[2025-06-06 18:09:01,279.279] base.py -> _exec_single_context line:1901 [INFO]: [cached since 3.594s ago] {'assistant_agent_conversation_id': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb'), 'account_id': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 18:09:01,279.279] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 18:09:01,282.282] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 18:09:01,282.282] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 18:09:01,282.282] base.py -> _exec_single_context line:1901 [INFO]: [cached since 336.7s ago] {'pk_1': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb')}
[2025-06-06 18:09:01,285.285] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.status IN (%(status_1_1)s, %(status_1_2)s) AND message.answer != %(answer_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
[2025-06-06 18:09:01,285.285] base.py -> _exec_single_context line:1901 [INFO]: [cached since 277.5s ago] {'conversation_id_1': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb'), 'answer_1': '', 'param_1': 20, 'param_2': 0, 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 18:09:01,287.287] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(*) AS count_1 
FROM (SELECT message.id AS id, message.app_id AS app_id, message.conversation_id AS conversation_id, message.invoke_from AS invoke_from, message.created_by AS created_by, message.query AS query, message.message AS message, message.message_token_count AS message_token_count, message.message_unit_price AS message_unit_price, message.message_price_unit AS message_price_unit, message.answer AS answer, message.answer_token_count AS answer_token_count, message.answer_unit_price AS answer_unit_price, message.answer_price_unit AS answer_price_unit, message.latency AS latency, message.is_deleted AS is_deleted, message.status AS status, message.error AS error, message.total_token_count AS total_token_count, message.total_price AS total_price, message.updated_at AS updated_at, message.created_at AS created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.status IN (%(status_1_1)s, %(status_1_2)s) AND message.answer != %(answer_1)s) AS anon_1
[2025-06-06 18:09:01,287.287] base.py -> _exec_single_context line:1901 [INFO]: [cached since 277.5s ago] {'conversation_id_1': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb'), 'answer_1': '', 'status_1_1': <MessageStatus.STOP: 'stop'>, 'status_1_2': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 18:09:01,289.289] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 18:09:01,289.289] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 18:09:01] "GET /assistant-agent/messages HTTP/1.1" 200 -
[2025-06-06 22:43:33,306.306] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-06-06 22:43:33,307.307] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-06-06 22:43:33,308.308] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-06-06 22:43:56,667.667] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-06-06 22:43:56,671.671] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-06-06 22:45:35,612.612] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-06-06 22:45:35,612.612] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 22:45:35,614.614] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-06-06 22:45:35,615.615] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 22:45:35,616.616] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-06-06 22:45:35,616.616] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-06-06 22:45:35,617.617] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 22:45:35,618.618] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 22:45:35,618.618] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00029s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 22:45:35,626.626] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 22:45:35,626.626] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00033s] {'pk_1': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb')}
[2025-06-06 22:45:35,712.712] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 22:45:35,712.712] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00043s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'ä½ å¥½', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 22:45:35,725.725] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 22:45:35,766.766] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 22:45:35,767.767] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 22:45:35,767.767] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00030s] {'pk_1': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb')}
[2025-06-06 22:45:35,770.770] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 22:45:35,770.770] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00031s] {'conversation_id_1': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb'), 'answer_1': '', 'param_1': 3, 'status_1_1': <MessageStatus.NORMAL: 'normal'>, 'status_1_2': <MessageStatus.STOP: 'stop'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 22:45:35,775.775] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 22:45:35,776.776] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00034s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 22:45:36,008.008] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 22:45:36,011.011] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00370s] {'pk_1': UUID('182da1e9-9de3-482d-a092-35801c888a32')}
[2025-06-06 22:45:36,013.013] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 22:45:36] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 22:45:51,731.731] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 22:45:51,835.835] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 22:45:51,835.835] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 22:45:51,835.835] base.py -> _exec_single_context line:1901 [INFO]: [cached since 16.21s ago] {'pk_1': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb')}
[2025-06-06 22:45:51,838.838] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 22:45:51,839.839] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00038s] {'pk_1': UUID('182da1e9-9de3-482d-a092-35801c888a32')}
[2025-06-06 22:45:51,842.842] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-06-06 22:45:51,842.842] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00051s] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb'), 'message_id': UUID('182da1e9-9de3-482d-a092-35801c888a32'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-06-06 22:45:51,849.849] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 22:45:51,851.851] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 22:45:51,852.852] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 22:45:51,852.852] base.py -> _exec_single_context line:1901 [INFO]: [cached since 16.08s ago] {'pk_1': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb')}
[2025-06-06 22:45:51,853.853] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 22:45:51,853.853] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.85s ago] {'pk_1': UUID('182da1e9-9de3-482d-a092-35801c888a32')}
[2025-06-06 22:45:51,854.854] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-06-06 22:45:51,854.854] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.012s ago] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb'), 'message_id': UUID('182da1e9-9de3-482d-a092-35801c888a32'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 2, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': 'ä½ å¥½ï¼æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (2860 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "7fc0106f-d1e8-4eb2-aa55-bb17cbd0244f", "example": false}}]', 'answer': 'ä½ å¥½ï¼æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ', 'latency': 15.716824300000013}
[2025-06-06 22:45:51,866.866] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 22:45:51,867.867] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 22:45:51,868.868] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 22:45:51,868.868] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.86s ago] {'pk_1': UUID('182da1e9-9de3-482d-a092-35801c888a32')}
[2025-06-06 22:45:51,869.869] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s, latency=%(latency)s WHERE message.id = %(message_id)s::UUID
[2025-06-06 22:45:51,870.870] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00030s] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (2860 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "7fc0106f-d1e8-4eb2-aa55-bb17cbd0244f", "example": false}}]', 'answer': 'ä½ å¥½ï¼æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ', 'latency': 15.716824300000013, 'message_id': UUID('182da1e9-9de3-482d-a092-35801c888a32')}
[2025-06-06 22:45:51,871.871] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 22:45:51,872.872] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 22:45:51,872.872] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 22:45:51,872.872] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.87s ago] {'pk_1': UUID('182da1e9-9de3-482d-a092-35801c888a32')}
[2025-06-06 22:45:51,873.873] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 22:45:51,879.879] base.py -> _exec_single_context line:1901 [INFO]: [cached since 16.11s ago] {'pk_1': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb')}
[2025-06-06 22:45:59,400.400] base.py -> _exec_single_context line:1896 [INFO]: UPDATE conversation SET summary=%(summary)s WHERE conversation.id = %(conversation_id)s::UUID
[2025-06-06 22:45:59,401.401] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00032s] {'summary': 'äººç±»å‘AIæ‰“æ‹›å‘¼ï¼ŒAIå›žåº”å¹¶è¯¢é—®æ˜¯å¦éœ€è¦å¸®åŠ©ã€‚', 'conversation_id': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb')}
[2025-06-06 22:45:59,403.403] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 22:45:59,404.404] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 22:45:59,405.405] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 22:45:59,405.405] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.64s ago] {'pk_1': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb')}
[2025-06-06 22:45:59,406.406] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(message.id) AS count_1 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID
[2025-06-06 22:45:59,406.406] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00022s] {'conversation_id_1': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb')}
[2025-06-06 22:45:59,408.408] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 22:45:59,408.408] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.4s ago] {'pk_1': UUID('182da1e9-9de3-482d-a092-35801c888a32')}
[2025-06-06 22:46:08,196.196] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 22:46:08,200.200] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 22:46:08,200.200] base.py -> _exec_single_context line:1901 [INFO]: [cached since 32.58s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-06-06 22:46:08,203.203] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 22:46:08,203.203] base.py -> _exec_single_context line:1901 [INFO]: [cached since 32.58s ago] {'pk_1': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb')}
[2025-06-06 22:46:08,204.204] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, invoke_from, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-06-06 22:46:08,204.204] base.py -> _exec_single_context line:1901 [INFO]: [cached since 32.49s ago] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'å¸®æˆ‘çœ‹ä¸‹LLMOpsé¡¹ç›®çš„æŽ¥å£', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-06-06 22:46:08,205.205] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 22:46:08,248.248] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 22:46:08,249.249] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 22:46:08,249.249] base.py -> _exec_single_context line:1901 [INFO]: [cached since 32.48s ago] {'pk_1': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb')}
[2025-06-06 22:46:08,251.251] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status IN (%(status_1_1)s, %(status_1_2)s, %(status_1_3)s) ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-06-06 22:46:08,251.251] base.py -> _exec_single_context line:1901 [INFO]: [cached since 32.48s ago] {'conversation_id_1': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb'), 'answer_1': '', 'param_1': 3, 'status_1_1': <MessageStatus.NORMAL: 'normal'>, 'status_1_2': <MessageStatus.STOP: 'stop'>, 'status_1_3': <MessageStatus.TIMEOUT: 'timeout'>}
[2025-06-06 22:46:08,487.487] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.assistant_agent_conversation_id AS account_assistant_agent_conversation_id, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-06-06 22:46:08,487.487] base.py -> _exec_single_context line:1901 [INFO]: [cached since 32.71s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-06-06 22:46:08,522.522] base.py -> _exec_single_context line:1896 [INFO]: UPDATE conversation SET name=%(name)s WHERE conversation.id = %(conversation_id)s::UUID
[2025-06-06 22:46:08,524.524] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00116s] {'name': 'ç”¨æˆ·é—®å€™æˆ‘', 'conversation_id': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb')}
[2025-06-06 22:46:08,525.525] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 22:46:15,992.992] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 22:46:15,992.992] base.py -> _exec_single_context line:1901 [INFO]: [cached since 39.98s ago] {'pk_1': UUID('ff2aa338-ae70-4e0f-aba2-1f3d0f010f00')}
[2025-06-06 22:46:15,993.993] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [06/Jun/2025 22:46:15] "POST /assistant-agent/chat HTTP/1.1" 200 -
[2025-06-06 22:46:55,291.291] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-06-06 22:46:55,292.292] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 22:46:55,293.293] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 22:46:55,293.293] base.py -> _exec_single_context line:1901 [INFO]: [cached since 79.67s ago] {'pk_1': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb')}
[2025-06-06 22:46:55,294.294] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 22:46:55,295.295] base.py -> _exec_single_context line:1901 [INFO]: [cached since 63.46s ago] {'pk_1': UUID('ff2aa338-ae70-4e0f-aba2-1f3d0f010f00')}
[2025-06-06 22:46:55,296.296] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-06-06 22:46:55,296.296] base.py -> _exec_single_context line:1901 [INFO]: [cached since 63.45s ago] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb'), 'message_id': UUID('ff2aa338-ae70-4e0f-aba2-1f3d0f010f00'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.AGENT_THOUGHT: 'agent_thought'>, 'thought': '[{"name": "dataset_retrieval", "args": {"query": "LLMOps \\u9879\\u76ee \\u63a5\\u53e3 \\u6587\\u6863"}, "id": "call_rJLFK3aw5RrbOPOSRvWVVEjh", "type": "tool_call"}]', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (3611 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "c39423bd-dee0-42be-8790-f1f02f69cfbb", "example": false}}]', 'answer': '', 'latency': 7.485131599999988}
[2025-06-06 22:46:55,306.306] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 22:46:55,307.307] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 22:46:55,308.308] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 22:46:55,308.308] base.py -> _exec_single_context line:1901 [INFO]: [cached since 79.54s ago] {'pk_1': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb')}
[2025-06-06 22:46:55,309.309] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 22:46:55,309.309] base.py -> _exec_single_context line:1901 [INFO]: [cached since 79.3s ago] {'pk_1': UUID('ff2aa338-ae70-4e0f-aba2-1f3d0f010f00')}
[2025-06-06 22:46:55,310.310] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-06-06 22:46:55,311.311] base.py -> _exec_single_context line:1901 [INFO]: [cached since 63.47s ago] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb'), 'message_id': UUID('ff2aa338-ae70-4e0f-aba2-1f3d0f010f00'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 2, 'event': <QueueEvent.DATASET_RETRIEVAL: 'dataset_retrieval'>, 'thought': '', 'observation': '"LLMOps \\u9879\\u76ee API \\u6587\\u6863\\n\\n\\u5e94\\u7528 API \\u63a5\\u53e3\\u7edf\\u4e00\\u4ee5 JSON \\u683c\\u5f0f\\u8fd4\\u56de\\uff0c\\u5e76 ... (9569 characters truncated) ... cription -> str\\uff1a\\u6a21\\u578b\\u63d0\\u4f9b\\u5546\\u7684\\u63cf\\u8ff0\\u4fe1\\u606f\\uff0c\\u7c7b\\u578b\\u4e3a\\u5b57\\u7b26\\u4e32\\u3002"', 'tool': 'dataset_retrieval', 'tool_input': '{"query": "LLMOps \\u9879\\u76ee \\u63a5\\u53e3 \\u6587\\u6863"}', 'message': '{}', 'answer': '', 'latency': 6.759845899999988}
[2025-06-06 22:46:55,323.323] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 22:46:55,324.324] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 22:46:55,324.324] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 22:46:55,325.325] base.py -> _exec_single_context line:1901 [INFO]: [cached since 79.56s ago] {'pk_1': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb')}
[2025-06-06 22:46:55,326.326] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 22:46:55,326.326] base.py -> _exec_single_context line:1901 [INFO]: [cached since 79.32s ago] {'pk_1': UUID('ff2aa338-ae70-4e0f-aba2-1f3d0f010f00')}
[2025-06-06 22:46:55,327.327] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-06-06 22:46:55,327.327] base.py -> _exec_single_context line:1901 [INFO]: [cached since 63.49s ago] {'app_id': '6774fcef-b594-8008-b30c-a05b8190afe6', 'conversation_id': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb'), 'message_id': UUID('ff2aa338-ae70-4e0f-aba2-1f3d0f010f00'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 3, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': 'LLMOps é¡¹ç›®çš„æŽ¥å£æ–‡æ¡£æä¾›äº†å¤šç§ API æŽ¥å£ï¼Œä¸»è¦ä»¥ JSON æ ¼å¼è¿”å›žæ•°æ®ï¼ŒåŒ…å«äº†ä¸‰ä¸ªå­—æ®µï¼šcodeã€data å’Œ messageã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ä¸»è¦æŽ¥å£çš„ä¿¡æ¯ï¼š\n\n1. **åŸºæœ¬å“åº”æ ¼å¼**ï¼š\n   ```json\n   {\n       "code": "success",\n ... (1154 characters truncated) ... str): æ¨¡åž‹çš„æ ‡ç­¾\n     - `icon` (str): æ¨¡åž‹çš„ icon URL\n     - `description` (str): æ¨¡åž‹çš„æè¿°ä¿¡æ¯\n\nè¿™äº›æŽ¥å£å¯ä»¥æ”¯æŒå„ç§æ“ä½œï¼Œå¦‚æ•°æ®é›†æ–‡æ¡£çš„ç®¡ç†ã€ä¸Žæ™ºèƒ½åŠ©æ‰‹çš„äº¤äº’ä»¥åŠè‡ªå®šä¹‰ API çš„åˆ›å»ºç­‰ã€‚éœ€è¦æ›´å¤šç»†èŠ‚æˆ–ç‰¹å®šæŽ¥å£çš„è¯´æ˜Žå—ï¼Ÿ', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (17149 characters truncated) ... t_retrieval", "id": "6c9832fc-e7cc-45cc-a00f-03e23f095a2e", "tool_call_id": "call_rJLFK3aw5RrbOPOSRvWVVEjh", "artifact": null, "status": "success"}}]', 'answer': 'LLMOps é¡¹ç›®çš„æŽ¥å£æ–‡æ¡£æä¾›äº†å¤šç§ API æŽ¥å£ï¼Œä¸»è¦ä»¥ JSON æ ¼å¼è¿”å›žæ•°æ®ï¼ŒåŒ…å«äº†ä¸‰ä¸ªå­—æ®µï¼šcodeã€data å’Œ messageã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ä¸»è¦æŽ¥å£çš„ä¿¡æ¯ï¼š\n\n1. **åŸºæœ¬å“åº”æ ¼å¼**ï¼š\n   ```json\n   {\n       "code": "success",\n ... (1154 characters truncated) ... str): æ¨¡åž‹çš„æ ‡ç­¾\n     - `icon` (str): æ¨¡åž‹çš„ icon URL\n     - `description` (str): æ¨¡åž‹çš„æè¿°ä¿¡æ¯\n\nè¿™äº›æŽ¥å£å¯ä»¥æ”¯æŒå„ç§æ“ä½œï¼Œå¦‚æ•°æ®é›†æ–‡æ¡£çš„ç®¡ç†ã€ä¸Žæ™ºèƒ½åŠ©æ‰‹çš„äº¤äº’ä»¥åŠè‡ªå®šä¹‰ API çš„åˆ›å»ºç­‰ã€‚éœ€è¦æ›´å¤šç»†èŠ‚æˆ–ç‰¹å®šæŽ¥å£çš„è¯´æ˜Žå—ï¼Ÿ', 'latency': 32.530143100000004}
[2025-06-06 22:46:55,339.339] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 22:46:55,340.340] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 22:46:55,341.341] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 22:46:55,341.341] base.py -> _exec_single_context line:1901 [INFO]: [cached since 79.33s ago] {'pk_1': UUID('ff2aa338-ae70-4e0f-aba2-1f3d0f010f00')}
[2025-06-06 22:46:55,342.342] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s, latency=%(latency)s WHERE message.id = %(message_id)s::UUID
[2025-06-06 22:46:55,342.342] base.py -> _exec_single_context line:1901 [INFO]: [cached since 63.47s ago] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (17149 characters truncated) ... t_retrieval", "id": "6c9832fc-e7cc-45cc-a00f-03e23f095a2e", "tool_call_id": "call_rJLFK3aw5RrbOPOSRvWVVEjh", "artifact": null, "status": "success"}}]', 'answer': 'LLMOps é¡¹ç›®çš„æŽ¥å£æ–‡æ¡£æä¾›äº†å¤šç§ API æŽ¥å£ï¼Œä¸»è¦ä»¥ JSON æ ¼å¼è¿”å›žæ•°æ®ï¼ŒåŒ…å«äº†ä¸‰ä¸ªå­—æ®µï¼šcodeã€data å’Œ messageã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ä¸»è¦æŽ¥å£çš„ä¿¡æ¯ï¼š\n\n1. **åŸºæœ¬å“åº”æ ¼å¼**ï¼š\n   ```json\n   {\n       "code": "success",\n ... (1154 characters truncated) ... str): æ¨¡åž‹çš„æ ‡ç­¾\n     - `icon` (str): æ¨¡åž‹çš„ icon URL\n     - `description` (str): æ¨¡åž‹çš„æè¿°ä¿¡æ¯\n\nè¿™äº›æŽ¥å£å¯ä»¥æ”¯æŒå„ç§æ“ä½œï¼Œå¦‚æ•°æ®é›†æ–‡æ¡£çš„ç®¡ç†ã€ä¸Žæ™ºèƒ½åŠ©æ‰‹çš„äº¤äº’ä»¥åŠè‡ªå®šä¹‰ API çš„åˆ›å»ºç­‰ã€‚éœ€è¦æ›´å¤šç»†èŠ‚æˆ–ç‰¹å®šæŽ¥å£çš„è¯´æ˜Žå—ï¼Ÿ', 'latency': 46.77512059999998, 'message_id': UUID('ff2aa338-ae70-4e0f-aba2-1f3d0f010f00')}
[2025-06-06 22:46:55,356.356] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 22:46:55,357.357] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 22:46:55,357.357] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-06-06 22:46:55,357.357] base.py -> _exec_single_context line:1901 [INFO]: [cached since 79.35s ago] {'pk_1': UUID('ff2aa338-ae70-4e0f-aba2-1f3d0f010f00')}
[2025-06-06 22:46:55,358.358] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 22:46:55,358.358] base.py -> _exec_single_context line:1901 [INFO]: [cached since 79.59s ago] {'pk_1': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb')}
[2025-06-06 22:47:25,060.060] base.py -> _exec_single_context line:1896 [INFO]: UPDATE conversation SET summary=%(summary)s WHERE conversation.id = %(conversation_id)s::UUID
[2025-06-06 22:47:25,061.061] base.py -> _exec_single_context line:1901 [INFO]: [cached since 85.66s ago] {'summary': 'äººç±»å‘AIæ‰“æ‹›å‘¼ï¼ŒAIå›žåº”å¹¶è¯¢é—®æ˜¯å¦éœ€è¦å¸®åŠ©ã€‚äººç±»è¯·æ±‚æŸ¥çœ‹LLMOpsé¡¹ç›®çš„æŽ¥å£ï¼ŒAIæä¾›äº†æŽ¥å£æ–‡æ¡£çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬åŸºæœ¬å“åº”æ ¼å¼ã€æŽ¥å£çŠ¶æ€ç ã€æ·»åŠ æ–°æ–‡æ¡£çš„æŽ¥å£ã€ä¸ŽåŠ©ç†AgentèŠå¤©çš„æŽ¥å£ã€åˆ›å»ºè‡ªå®šä¹‰APIå·¥å…·çš„æŽ¥å£ä»¥åŠèŽ·å–è¯­è¨€æ¨¡åž‹åˆ—è¡¨çš„æŽ¥å£ã€‚è¿™äº›æŽ¥å£æ”¯æŒæ•°æ®é›†æ–‡æ¡£ç®¡ç†ã€ä¸Žæ™ºèƒ½åŠ©æ‰‹çš„äº¤äº’ä»¥åŠè‡ªå®šä¹‰APIçš„åˆ›å»ºã€‚AIè¯¢é—®æ˜¯å¦éœ€è¦æ›´å¤šç»†èŠ‚æˆ–ç‰¹å®šæŽ¥å£çš„è¯´æ˜Žã€‚', 'conversation_id': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb')}
[2025-06-06 22:47:25,061.061] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-06-06 22:47:25,064.064] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-06-06 22:47:25,065.065] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-06-06 22:47:25,065.065] base.py -> _exec_single_context line:1901 [INFO]: [cached since 109.3s ago] {'pk_1': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb')}
[2025-06-06 22:47:25,065.065] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(message.id) AS count_1 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID
[2025-06-06 22:47:25,065.065] base.py -> _exec_single_context line:1901 [INFO]: [cached since 85.66s ago] {'conversation_id_1': UUID('3f19a8bc-d65c-4009-96fb-355891d64ceb')}
[2025-06-06 22:47:25,066.066] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
