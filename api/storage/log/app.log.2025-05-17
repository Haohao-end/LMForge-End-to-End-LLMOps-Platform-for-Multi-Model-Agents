[2025-05-17 10:02:37,080.080] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-05-17 10:02:37,082.082] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-05-17 10:02:37,086.086] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-17 10:02:58,987.987] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-17 10:02:59,000.000] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-17 10:03:13,404.404] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-17 10:03:13,405.405] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 10:03:13,411.411] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-17 10:03:13,411.411] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 10:03:13,413.413] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-17 10:03:13,413.413] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 10:03:13,414.414] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:03:13,422.422] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:03:13,423.423] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00050s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:03:13,446.446] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:03:13,447.447] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00054s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:03:13,456.456] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-17 10:03:13,457.457] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00087s] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:03:13,461.461] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:03:13,462.462] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00065s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:03:13,471.471] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET tools=%(tools)s::JSONB, updated_at=%(updated_at)s WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-17 10:03:13,471.471] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00047s] {'tools': '[{"type": "builtin_tool", "provider_id": "google", "tool_id": "google_serper", "params": {}}]', 'updated_at': datetime.datetime(2025, 5, 17, 10, 3, 13, 466452), 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-17 10:03:13,477.477] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:03:13,485.485] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:03:13] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-17 10:03:25,158.158] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:03:25,159.159] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:03:25,159.159] base.py -> _exec_single_context line:1901 [INFO]: [cached since 11.74s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:03:25,162.162] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:03:25,162.162] base.py -> _exec_single_context line:1901 [INFO]: [cached since 11.72s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:03:25,164.164] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:03:25,164.164] base.py -> _exec_single_context line:1901 [INFO]: [cached since 11.7s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:03:25,169.169] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 10:03:25,169.169] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00078s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:03:25,171.171] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 10:03:25,172.172] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:03:25] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-17 10:06:21,721.721] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:06:21,726.726] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:06:21,727.727] base.py -> _exec_single_context line:1901 [INFO]: [cached since 188.3s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:06:21,770.770] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:06:21,770.770] base.py -> _exec_single_context line:1901 [INFO]: [cached since 188.3s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:06:21,779.779] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:06:21,780.780] base.py -> _exec_single_context line:1901 [INFO]: [cached since 188.3s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:06:21,785.785] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 10:06:21,785.785] base.py -> _exec_single_context line:1901 [INFO]: [cached since 176.6s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:06:21,795.795] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 10:06:21,796.796] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00057s] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 10:06:21,812.812] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 10:06:21,812.812] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00066s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '今天纳斯达克指数怎么样?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 10:06:21,835.835] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:06:21,862.862] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:06:21] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 10:07:01,266.266] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:07:01,267.267] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:07:01,268.268] base.py -> _exec_single_context line:1901 [INFO]: [cached since 227.8s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:07:01,270.270] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:07:01,270.270] base.py -> _exec_single_context line:1901 [INFO]: [cached since 227.8s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:07:01,273.273] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-17 10:07:01,274.274] base.py -> _exec_single_context line:1901 [INFO]: [cached since 227.8s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:07:01,276.276] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:07:01,276.276] base.py -> _exec_single_context line:1901 [INFO]: [cached since 227.8s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:07:01,280.280] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET model_config=%(model_config)s::JSONB, updated_at=%(updated_at)s WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-17 10:07:01,280.280] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00078s] {'model_config': '{"model": "gpt-4o", "provider": "openai", "parameters": {"top_p": 0.9, "max_tokens": 4096, "temperature": 0.7, "presence_penalty": 0.1, "frequency_penalty": 0.1}}', 'updated_at': datetime.datetime(2025, 5, 17, 10, 7, 1, 277109), 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-17 10:07:01,283.283] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:07:01,287.287] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:07:01] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-17 10:07:03,771.771] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 844, in dispatch_request
    self.raise_routing_exception(req)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 453, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\werkzeug\routing\map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
[2025-05-17 10:07:03,795.795] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:07:03] "[35m[1mPOST /apps//publish HTTP/1.1[0m" 500 -
[2025-05-17 10:07:12,479.479] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:07:12,480.480] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:07:12,480.480] base.py -> _exec_single_context line:1901 [INFO]: [cached since 239.1s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:07:12,482.482] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:07:12,482.482] base.py -> _exec_single_context line:1901 [INFO]: [cached since 239s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:07:12,484.484] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:07:12,484.484] base.py -> _exec_single_context line:1901 [INFO]: [cached since 239s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:07:12,486.486] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 10:07:12,486.486] base.py -> _exec_single_context line:1901 [INFO]: [cached since 227.3s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:07:12,487.487] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 'provider_id'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 70, in publish
    self.app_service.publish_draft_app_config(app_id, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 279, in publish_draft_app_config
    tools=[
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 282, in <listcomp>
    "provider_id": tool["provider_id"],
KeyError: 'provider_id'
[2025-05-17 10:07:12,494.494] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 10:07:12,520.520] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:07:12] "[35m[1mPOST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/publish HTTP/1.1[0m" 500 -
[2025-05-17 10:07:19,595.595] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:07:19,596.596] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:07:19,596.596] base.py -> _exec_single_context line:1901 [INFO]: [cached since 246.2s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:07:19,598.598] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:07:19,598.598] base.py -> _exec_single_context line:1901 [INFO]: [cached since 246.2s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:07:19,600.600] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:07:19,600.600] base.py -> _exec_single_context line:1901 [INFO]: [cached since 246.1s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:07:19,602.602] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 10:07:19,603.603] base.py -> _exec_single_context line:1901 [INFO]: [cached since 234.4s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:07:19,604.604] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 'provider_id'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 70, in publish
    self.app_service.publish_draft_app_config(app_id, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 279, in publish_draft_app_config
    tools=[
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 282, in <listcomp>
    "provider_id": tool["provider_id"],
KeyError: 'provider_id'
[2025-05-17 10:07:19,604.604] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 10:07:19,625.625] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:07:19] "[35m[1mPOST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/publish HTTP/1.1[0m" 500 -
[2025-05-17 10:07:22,426.426] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:07:22,426.426] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:07:22,427.427] base.py -> _exec_single_context line:1901 [INFO]: [cached since 249s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:07:22,428.428] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:07:22,429.429] base.py -> _exec_single_context line:1901 [INFO]: [cached since 249s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:07:22,432.432] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:07:22,432.432] base.py -> _exec_single_context line:1901 [INFO]: [cached since 249s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:07:22,434.434] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 10:07:22,435.435] base.py -> _exec_single_context line:1901 [INFO]: [cached since 237.3s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:07:22,436.436] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 10:07:22,437.437] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:07:22] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-17 10:07:56,155.155] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:07:56,156.156] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:07:56,156.156] base.py -> _exec_single_context line:1901 [INFO]: [cached since 282.7s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:07:56,157.157] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:07:56,158.158] base.py -> _exec_single_context line:1901 [INFO]: [cached since 282.7s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:07:56,159.159] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:07:56,159.159] base.py -> _exec_single_context line:1901 [INFO]: [cached since 282.7s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:07:56,160.160] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 10:07:56,160.160] base.py -> _exec_single_context line:1901 [INFO]: [cached since 271s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:07:56,160.160] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 'provider_id'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 70, in publish
    self.app_service.publish_draft_app_config(app_id, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 279, in publish_draft_app_config
    tools=[
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 282, in <listcomp>
    "provider_id": tool["provider_id"],
KeyError: 'provider_id'
[2025-05-17 10:07:56,161.161] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 10:07:56,171.171] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:07:56] "[35m[1mPOST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/publish HTTP/1.1[0m" 500 -
[2025-05-17 10:08:40,074.074] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:08:40,075.075] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:08:40,075.075] base.py -> _exec_single_context line:1901 [INFO]: [cached since 326.7s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:08:40,077.077] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:08:40,077.077] base.py -> _exec_single_context line:1901 [INFO]: [cached since 326.6s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:08:40,079.079] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-17 10:08:40,079.079] base.py -> _exec_single_context line:1901 [INFO]: [cached since 326.6s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:08:40,081.081] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:08:40,081.081] base.py -> _exec_single_context line:1901 [INFO]: [cached since 326.6s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:08:40,084.084] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET updated_at=%(updated_at)s WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-17 10:08:40,084.084] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00055s] {'updated_at': datetime.datetime(2025, 5, 17, 10, 8, 40, 83075), 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-17 10:08:40,085.085] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:08:40,086.086] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:08:40] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-17 10:08:42,153.153] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:08:42,153.153] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:08:42,153.153] base.py -> _exec_single_context line:1901 [INFO]: [cached since 328.7s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:08:42,155.155] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:08:42,156.156] base.py -> _exec_single_context line:1901 [INFO]: [cached since 328.7s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:08:42,157.157] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:08:42,157.157] base.py -> _exec_single_context line:1901 [INFO]: [cached since 328.7s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:08:42,158.158] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 10:08:42,159.159] base.py -> _exec_single_context line:1901 [INFO]: [cached since 317s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:08:42,160.160] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 'provider_id'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 70, in publish
    self.app_service.publish_draft_app_config(app_id, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 279, in publish_draft_app_config
    tools=[
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 282, in <listcomp>
    "provider_id": tool["provider_id"],
KeyError: 'provider_id'
[2025-05-17 10:08:42,161.161] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 10:08:42,183.183] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:08:42] "[35m[1mPOST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/publish HTTP/1.1[0m" 500 -
[2025-05-17 10:09:14,396.396] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:09:14,397.397] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:09:14,397.397] base.py -> _exec_single_context line:1901 [INFO]: [cached since 361s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:09:14,399.399] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:09:14,401.401] base.py -> _exec_single_context line:1901 [INFO]: [cached since 361s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:09:14,403.403] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-17 10:09:14,404.404] base.py -> _exec_single_context line:1901 [INFO]: [cached since 360.9s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:09:14,405.405] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:09:14,405.405] base.py -> _exec_single_context line:1901 [INFO]: [cached since 360.9s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:09:14,407.407] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET updated_at=%(updated_at)s WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-17 10:09:14,407.407] base.py -> _exec_single_context line:1901 [INFO]: [cached since 34.32s ago] {'updated_at': datetime.datetime(2025, 5, 17, 10, 9, 14, 406631), 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-17 10:09:14,408.408] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:09:14,409.409] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:09:14] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-17 10:09:30,584.584] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:09:30,585.585] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:09:30,585.585] base.py -> _exec_single_context line:1901 [INFO]: [cached since 377.2s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:09:30,587.587] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:09:30,587.587] base.py -> _exec_single_context line:1901 [INFO]: [cached since 377.1s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:09:30,589.589] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:09:30,590.590] base.py -> _exec_single_context line:1901 [INFO]: [cached since 377.1s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:09:30,591.591] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 10:09:30,592.592] base.py -> _exec_single_context line:1901 [INFO]: [cached since 365.4s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:09:30,592.592] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 'provider_id'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 70, in publish
    self.app_service.publish_draft_app_config(app_id, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 279, in publish_draft_app_config
    tools=[
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 282, in <listcomp>
    "provider_id": tool["provider_id"],
KeyError: 'provider_id'
[2025-05-17 10:09:30,593.593] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 10:09:30,604.604] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:09:30] "[35m[1mPOST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/publish HTTP/1.1[0m" 500 -
[2025-05-17 10:10:47,317.317] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:10:47,318.318] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:10:47,319.319] base.py -> _exec_single_context line:1901 [INFO]: [cached since 453.9s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:10:47,320.320] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:10:47,321.321] base.py -> _exec_single_context line:1901 [INFO]: [cached since 453.9s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:10:47,322.322] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:10:47,322.322] base.py -> _exec_single_context line:1901 [INFO]: [cached since 453.9s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:10:47,323.323] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 10:10:47,323.323] base.py -> _exec_single_context line:1901 [INFO]: [cached since 442.2s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:10:47,324.324] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 10:10:47,325.325] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:10:47] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-17 10:11:07,551.551] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:11:07,551.551] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:11:07,552.552] base.py -> _exec_single_context line:1901 [INFO]: [cached since 474.1s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:11:07,553.553] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:11:07,553.553] base.py -> _exec_single_context line:1901 [INFO]: [cached since 474.1s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:11:07,554.554] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:11:07,555.555] base.py -> _exec_single_context line:1901 [INFO]: [cached since 474.1s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:11:07,556.556] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 10:11:07,556.556] base.py -> _exec_single_context line:1901 [INFO]: [cached since 462.4s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:11:07,557.557] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 'provider_id'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 70, in publish
    self.app_service.publish_draft_app_config(app_id, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 279, in publish_draft_app_config
    tools=[
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 282, in <listcomp>
    "provider_id": tool["provider_id"],
KeyError: 'provider_id'
[2025-05-17 10:11:07,558.558] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 10:11:07,569.569] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:11:07] "[35m[1mPOST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/publish HTTP/1.1[0m" 500 -
[2025-05-17 10:13:00,821.821] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\app_service.py', reloading
[2025-05-17 10:13:03,814.814] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-17 10:13:39,152.152] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-17 10:13:39,164.164] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-17 10:13:40,242.242] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-17 10:13:40,243.243] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 10:13:40,247.247] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-17 10:13:40,247.247] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 10:13:40,249.249] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-17 10:13:40,249.249] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 10:13:40,251.251] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:13:40,259.259] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:13:40,259.259] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00098s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:13:40,272.272] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:13:40,272.272] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00058s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:13:40,279.279] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:13:40,280.280] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00071s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:13:40,285.285] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 10:13:40,286.286] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00085s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:13:40,290.290] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 10:13:40,291.291] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:13:40] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-17 10:14:42,635.635] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:14:42,636.636] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:14:42,636.636] base.py -> _exec_single_context line:1901 [INFO]: [cached since 62.38s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:14:42,638.638] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:14:42,638.638] base.py -> _exec_single_context line:1901 [INFO]: [cached since 62.37s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:14:42,640.640] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:14:42,640.640] base.py -> _exec_single_context line:1901 [INFO]: [cached since 62.36s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:14:42,642.642] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 10:14:42,642.642] base.py -> _exec_single_context line:1901 [INFO]: [cached since 62.36s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:14:42,649.649] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_config (app_id, model_config, dialog_round, preset_prompt, tools, workflows, retrieval_config, long_term_memory, opening_statement, opening_questions, speech_to_text, text_to_speech, review_config, updated_at, created_at) VALUES (%(app_id)s::UUID, %(model_config)s::JSONB, %(dialog_round)s, %(preset_prompt)s, %(tools)s::JSONB, %(workflows)s::JSONB, %(retrieval_config)s::JSONB, %(long_term_memory)s::JSONB, %(opening_statement)s, %(opening_questions)s::JSONB, %(speech_to_text)s::JSONB, %(text_to_speech)s::JSONB, %(review_config)s::JSONB, %(updated_at)s, %(created_at)s) RETURNING app_config.id, app_config.suggested_after_answer
[2025-05-17 10:14:42,649.649] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00085s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'model_config': '{"model": "gpt-4o", "provider": "openai", "parameters": {"top_p": 0.9, "max_tokens": 4096, "temperature": 0.7, "presence_penalty": 0.1, "frequency_penalty": 0.1}}', 'dialog_round': 10, 'preset_prompt': '你是一个AI助手', 'tools': '[{"type": "builtin_tool", "provider_id": "google", "tool_id": "google_serper", "params": {}}]', 'workflows': '[]', 'retrieval_config': '{"k": 5, "score": 0.7, "retrieval_strategy": "semantic"}', 'long_term_memory': '{"enable": false}', 'opening_statement': '你好，我是AI助手', 'opening_questions': '["\\u6709\\u4ec0\\u4e48\\u53ef\\u4ee5\\u5e2e\\u60a8\\uff1f", "\\u60a8\\u9700\\u8981\\u4ec0\\u4e48\\u5e2e\\u52a9\\uff1f"]', 'speech_to_text': '{"enable": false}', 'text_to_speech': '{"voice": "echo", "enable": false, "auto_play": false}', 'review_config': '{"enable": false, "keywords": ["\\u654f\\u611f\\u8bcd1", "\\u654f\\u611f\\u8bcd2"], "inputs_config": {"enable": false, "preset_response": "\\u9884\\u8bbe\\u54cd\\u5e94"}, "outputs_config": {"enable": false}}', 'updated_at': datetime.datetime(2025, 5, 17, 2, 14, 42, 649102), 'created_at': datetime.datetime(2025, 5, 17, 2, 14, 42, 649102)}
[2025-05-17 10:14:42,667.667] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:14:42,670.670] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:14:42,672.672] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config.id AS app_config_id, app_config.app_id AS app_config_app_id, app_config.model_config AS app_config_model_config, app_config.dialog_round AS app_config_dialog_round, app_config.preset_prompt AS app_config_preset_prompt, app_config.tools AS app_config_tools, app_config.workflows AS app_config_workflows, app_config.retrieval_config AS app_config_retrieval_config, app_config.long_term_memory AS app_config_long_term_memory, app_config.opening_statement AS app_config_opening_statement, app_config.opening_questions AS app_config_opening_questions, app_config.speech_to_text AS app_config_speech_to_text, app_config.text_to_speech AS app_config_text_to_speech, app_config.suggested_after_answer AS app_config_suggested_after_answer, app_config.review_config AS app_config_review_config, app_config.updated_at AS app_config_updated_at, app_config.created_at AS app_config_created_at 
FROM app_config 
WHERE app_config.id = %(pk_1)s::UUID
[2025-05-17 10:14:42,673.673] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00048s] {'pk_1': UUID('6ea10760-44c6-42f6-b0b4-8002d629fe40')}
[2025-05-17 10:14:42,674.674] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:14:42,674.674] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00028s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:14:42,678.678] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app SET app_config_id=%(app_config_id)s::UUID WHERE app.id = %(app_id)s::UUID
[2025-05-17 10:14:42,678.678] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00032s] {'app_config_id': UUID('6ea10760-44c6-42f6-b0b4-8002d629fe40'), 'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:14:42,680.680] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:14:42,682.682] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:14:42,682.682] base.py -> _exec_single_context line:1896 [INFO]: DELETE FROM app_dataset_join WHERE app_dataset_join.app_id = %(app_id_1)s::UUID
[2025-05-17 10:14:42,682.682] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00025s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:14:42,685.685] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:14:42,686.686] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:14:42,687.687] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_dataset_join (app_id, dataset_id) VALUES (%(app_id)s::UUID, %(dataset_id)s::UUID) RETURNING app_dataset_join.id, app_dataset_join.updated_at, app_dataset_join.created_at
[2025-05-17 10:14:42,687.687] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00036s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'dataset_id': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:14:42,690.690] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:14:42,690.690] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:14:42,691.691] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:14:42,691.691] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01672s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:14:42,692.692] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:14:42,692.692] base.py -> _exec_single_context line:1901 [INFO]: [cached since 62.42s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:14:42,695.695] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(max(app_config_version.version), %(coalesce_2)s) AS coalesce_1 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:14:42,695.695] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00026s] {'coalesce_2': 0, 'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.PUBLISHED: 'published'>}
[2025-05-17 10:14:42,703.703] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_config_version (app_id, model_config, dialog_round, preset_prompt, tools, workflows, datasets, retrieval_config, long_term_memory, opening_statement, opening_questions, speech_to_text, text_to_speech, suggested_after_answer, review_config, version, config_type) VALUES (%(app_id)s::UUID, %(model_config)s::JSONB, %(dialog_round)s, %(preset_prompt)s, %(tools)s::JSONB, %(workflows)s::JSONB, %(datasets)s::JSONB, %(retrieval_config)s::JSONB, %(long_term_memory)s::JSONB, %(opening_statement)s, %(opening_questions)s::JSONB, %(speech_to_text)s::JSONB, %(text_to_speech)s::JSONB, %(suggested_after_answer)s::JSONB, %(review_config)s::JSONB, %(version)s, %(config_type)s) RETURNING app_config_version.id, app_config_version.updated_at, app_config_version.created_at
[2025-05-17 10:14:42,704.704] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00097s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'model_config': '{"model": "gpt-4o", "provider": "openai", "parameters": {"top_p": 0.9, "max_tokens": 4096, "temperature": 0.7, "presence_penalty": 0.1, "frequency_penalty": 0.1}}', 'dialog_round': 10, 'preset_prompt': '你是一个AI助手', 'tools': '[{"type": "builtin_tool", "params": {}, "tool_id": "google_serper", "provider_id": "google"}]', 'workflows': '[]', 'datasets': '["9af90c52-28b2-4a47-9c92-148c9f21b512"]', 'retrieval_config': '{"k": 5, "score": 0.7, "retrieval_strategy": "semantic"}', 'long_term_memory': '{"enable": false}', 'opening_statement': '你好，我是AI助手', 'opening_questions': '["\\u6709\\u4ec0\\u4e48\\u53ef\\u4ee5\\u5e2e\\u60a8\\uff1f", "\\u60a8\\u9700\\u8981\\u4ec0\\u4e48\\u5e2e\\u52a9\\uff1f"]', 'speech_to_text': '{"enable": false}', 'text_to_speech': '{"voice": "echo", "enable": false, "auto_play": false}', 'suggested_after_answer': '{"enable": true}', 'review_config': '{"enable": false, "keywords": ["\\u654f\\u611f\\u8bcd1", "\\u654f\\u611f\\u8bcd2"], "inputs_config": {"enable": false, "preset_response": "\\u9884\\u8bbe\\u54cd\\u5e94"}, "outputs_config": {"enable": false}}', 'version': 15, 'config_type': <AppConfigType.PUBLISHED: 'published'>}
[2025-05-17 10:14:42,706.706] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:14:42,708.708] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:14:42] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/publish HTTP/1.1" 200 -
[2025-05-17 10:14:47,532.532] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:14:47,533.533] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:14:47,533.533] base.py -> _exec_single_context line:1901 [INFO]: [cached since 67.28s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:14:47,539.539] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:14:47,539.539] base.py -> _exec_single_context line:1901 [INFO]: [cached since 67.27s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:14:47,541.541] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:14:47,541.541] base.py -> _exec_single_context line:1901 [INFO]: [cached since 67.26s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:14:47,542.542] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 10:14:47,543.543] base.py -> _exec_single_context line:1901 [INFO]: [cached since 67.26s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:14:47,545.545] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 10:14:47,549.549] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00404s] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 10:14:47,554.554] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 10:14:47,554.554] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00062s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '今天纳斯达克指数怎么样?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 10:14:47,560.560] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:14:47,646.646] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:14:47,647.647] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 10:14:47,648.648] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00046s] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 10:14:47,652.652] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 10:14:47,652.652] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00039s] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 10:14:47,661.661] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:14:47,662.662] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00072s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 10:14:53,031.031] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:14:53] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 10:14:56,358.358] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 10:18:21,569.569] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\app_service.py', reloading
[2025-05-17 10:18:23,131.131] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-17 10:18:53,388.388] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-17 10:18:53,402.402] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-17 10:23:06,722.722] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\app_service.py', reloading
[2025-05-17 10:23:08,952.952] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-17 10:23:30,662.662] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-17 10:23:30,670.670] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-17 10:24:17,215.215] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\app_service.py', reloading
[2025-05-17 10:24:18,904.904] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-17 10:24:41,106.106] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-17 10:24:41,117.117] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-17 10:26:23,485.485] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\app_service.py', reloading
[2025-05-17 10:26:25,389.389] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-17 10:26:48,605.605] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-17 10:26:48,617.617] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-17 10:26:49,897.897] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-17 10:26:49,898.898] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 10:26:49,900.900] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-17 10:26:49,900.900] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 10:26:49,902.902] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-17 10:26:49,902.902] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 10:26:49,904.904] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:26:49,909.909] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:26:49,909.909] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00034s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:26:49,920.920] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:26:49,920.920] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00041s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:26:49,924.924] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:26:49,925.925] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00053s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:26:49,929.929] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 10:26:49,929.929] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00052s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:26:49,931.931] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 10:26:49,931.931] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00035s] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 10:26:49,937.937] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 10:26:49,937.937] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00031s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '今天纳斯达克指数怎么样?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 10:26:49,957.957] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:26:50,062.062] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:26:50,063.063] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 10:26:50,063.063] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00048s] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 10:26:50,066.066] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 10:26:50,066.066] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00039s] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 10:26:50,070.070] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:26:50,070.070] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00038s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 10:26:52,559.559] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 10:26:52,564.564] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00570s] {'pk_1': UUID('34d08b64-e232-4088-b850-f527b9351ad2')}
[2025-05-17 10:26:52,566.566] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:26:52] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 10:26:56,203.203] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 10:26:56,203.203] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00058s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'message_id': UUID('34d08b64-e232-4088-b850-f527b9351ad2'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.AGENT_THOUGHT: 'agent_thought'>, 'thought': '[{"name": "google_serper", "args": {"query": "Nasdaq index today"}, "id": "call_lx3hShndY1nHHM7L2fBZ2R3H", "type": "tool_call"}]', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (2924 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "9e3cd1c8-1d58-45a0-9271-415ace19364f", "example": false}}]', 'answer': '', 'latency': 2.1022795999999992}
[2025-05-17 10:26:56,213.213] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:26:56,214.214] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:26:56,214.214] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 10:26:56,215.215] base.py -> _exec_single_context line:1901 [INFO]: [cached since 6.152s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 10:26:56,216.216] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 10:26:56,216.216] base.py -> _exec_single_context line:1901 [INFO]: [cached since 3.657s ago] {'pk_1': UUID('34d08b64-e232-4088-b850-f527b9351ad2')}
[2025-05-17 10:26:56,217.217] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:26:56,217.217] base.py -> _exec_single_context line:1901 [INFO]: [cached since 6.147s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 10:26:56,218.218] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 10:26:56,218.218] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01506s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'message_id': UUID('34d08b64-e232-4088-b850-f527b9351ad2'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 2, 'event': <QueueEvent.AGENT_ACTION: 'agent_action'>, 'thought': '', 'observation': '"19,211.10 +98.78 (0.52%)"', 'tool': 'google_serper', 'tool_input': '{"query": "Nasdaq index today"}', 'message': '{}', 'answer': '', 'latency': 1.446523899999999}
[2025-05-17 10:26:56,219.219] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:26:56,220.220] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:26:56,220.220] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 10:26:56,220.220] base.py -> _exec_single_context line:1901 [INFO]: [cached since 6.158s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 10:26:56,222.222] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 10:26:56,222.222] base.py -> _exec_single_context line:1901 [INFO]: [cached since 3.663s ago] {'pk_1': UUID('34d08b64-e232-4088-b850-f527b9351ad2')}
[2025-05-17 10:26:56,222.222] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:26:56,222.222] base.py -> _exec_single_context line:1901 [INFO]: [cached since 6.153s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 10:26:56,223.223] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 10:26:56,224.224] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02129s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'message_id': UUID('34d08b64-e232-4088-b850-f527b9351ad2'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 3, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': '今天纳斯达克指数为19,211.10，较昨日上涨了98.78点，涨幅为0.52%。', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (4049 characters truncated) ... ogle_serper", "id": "3818a458-755f-4625-9df3-0b6cbc29db3b", "tool_call_id": "call_lx3hShndY1nHHM7L2fBZ2R3H", "artifact": null, "status": "success"}}]', 'answer': '今天纳斯达克指数为19,211.10，较昨日上涨了98.78点，涨幅为0.52%。', 'latency': 2.183195399999999}
[2025-05-17 10:26:56,229.229] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:26:56,230.230] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:26:56,230.230] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 10:26:56,231.231] base.py -> _exec_single_context line:1901 [INFO]: [cached since 3.672s ago] {'pk_1': UUID('34d08b64-e232-4088-b850-f527b9351ad2')}
[2025-05-17 10:26:56,232.232] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s WHERE message.id = %(message_id)s::UUID
[2025-05-17 10:26:56,233.233] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00032s] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (4049 characters truncated) ... ogle_serper", "id": "3818a458-755f-4625-9df3-0b6cbc29db3b", "tool_call_id": "call_lx3hShndY1nHHM7L2fBZ2R3H", "artifact": null, "status": "success"}}]', 'answer': '今天纳斯达克指数为19,211.10，较昨日上涨了98.78点，涨幅为0.52%。', 'message_id': UUID('34d08b64-e232-4088-b850-f527b9351ad2')}
[2025-05-17 10:26:56,239.239] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:42:49,403.403] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-05-17 10:42:49,404.404] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-05-17 10:42:49,411.411] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-17 10:43:21,055.055] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-17 10:43:21,073.073] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-17 10:43:22,623.623] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-17 10:43:22,625.625] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 10:43:22,631.631] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-17 10:43:22,631.631] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 10:43:22,632.632] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-17 10:43:22,633.633] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 10:43:22,634.634] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:43:22,642.642] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:43:22,642.642] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00115s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:43:22,656.656] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:43:22,656.656] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00040s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:43:22,663.663] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-17 10:43:22,663.663] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00058s] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:43:22,667.667] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:43:22,668.668] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00052s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:43:22,677.677] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET review_config=%(review_config)s::JSONB, updated_at=%(updated_at)s WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-17 10:43:22,677.677] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00097s] {'review_config': '{"enable": false, "keywords": ["\\u654f\\u611f\\u8bcd"], "inputs_config": {"enable": false, "preset_response": "\\u4f60\\u7684\\u8f93\\u5165\\u4e0d\\u5408\\u6cd5"}, "outputs_config": {"enable": false}}', 'updated_at': datetime.datetime(2025, 5, 17, 10, 43, 22, 672573), 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-17 10:43:22,681.681] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:43:22,686.686] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:43:22] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-17 10:43:41,593.593] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:43:41,594.594] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:43:41,594.594] base.py -> _exec_single_context line:1901 [INFO]: [cached since 18.95s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:43:41,606.606] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:43:41,606.606] base.py -> _exec_single_context line:1901 [INFO]: [cached since 18.95s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:43:41,608.608] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:43:41,609.609] base.py -> _exec_single_context line:1901 [INFO]: [cached since 18.94s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:43:41,613.613] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 10:43:41,614.614] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00052s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:43:41,618.618] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 10:43:41,619.619] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00090s] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 10:43:41,633.633] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 10:43:41,633.633] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00072s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '敏感词', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 10:43:41,656.656] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:43:41,777.777] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:43:41,779.779] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 10:43:41,779.779] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00076s] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 10:43:41,787.787] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 10:43:41,787.787] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00068s] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 10:43:44,026.026] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 10:43:44,053.053] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:43:44] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 10:44:04,451.451] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:44:04,452.452] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:44:04,452.452] base.py -> _exec_single_context line:1901 [INFO]: [cached since 41.81s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:44:04,454.454] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:44:04,454.454] base.py -> _exec_single_context line:1901 [INFO]: [cached since 41.8s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:44:04,455.455] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:44:04,455.455] base.py -> _exec_single_context line:1901 [INFO]: [cached since 41.79s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:44:04,457.457] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 10:44:04,457.457] base.py -> _exec_single_context line:1901 [INFO]: [cached since 22.84s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:44:04,457.457] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 10:44:04,457.457] base.py -> _exec_single_context line:1901 [INFO]: [cached since 22.84s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 10:44:04,458.458] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 10:44:04,458.458] base.py -> _exec_single_context line:1901 [INFO]: [cached since 22.83s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '敏感词', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 10:44:04,460.460] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:44:04,507.507] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:44:04,507.507] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 10:44:04,507.507] base.py -> _exec_single_context line:1901 [INFO]: [cached since 22.73s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 10:44:04,509.509] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 10:44:04,509.509] base.py -> _exec_single_context line:1901 [INFO]: [cached since 22.72s ago] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 10:44:04,510.510] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 10:44:04,518.518] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:44:04] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 10:44:19,179.179] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:44:19,180.180] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:44:19,181.181] base.py -> _exec_single_context line:1901 [INFO]: [cached since 56.54s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:44:19,182.182] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:44:19,183.183] base.py -> _exec_single_context line:1901 [INFO]: [cached since 56.53s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:44:19,184.184] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-17 10:44:19,184.184] base.py -> _exec_single_context line:1901 [INFO]: [cached since 56.52s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:44:19,185.185] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:44:19,185.185] base.py -> _exec_single_context line:1901 [INFO]: [cached since 56.52s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:44:19,188.188] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET updated_at=%(updated_at)s WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-17 10:44:19,188.188] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00051s] {'updated_at': datetime.datetime(2025, 5, 17, 10, 44, 19, 186867), 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-17 10:44:19,189.189] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:44:19,191.191] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:44:19] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-17 10:45:26,999.999] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:45:27,000.000] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:45:27,000.000] base.py -> _exec_single_context line:1901 [INFO]: [cached since 124.4s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:45:27,001.001] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:45:27,002.002] base.py -> _exec_single_context line:1901 [INFO]: [cached since 124.3s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:45:27,003.003] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:45:27,004.004] base.py -> _exec_single_context line:1901 [INFO]: [cached since 124.3s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:45:27,005.005] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 10:45:27,005.005] base.py -> _exec_single_context line:1901 [INFO]: [cached since 105.4s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:45:27,009.009] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_config (app_id, model_config, dialog_round, preset_prompt, tools, workflows, retrieval_config, long_term_memory, opening_statement, opening_questions, speech_to_text, text_to_speech, review_config, updated_at, created_at) VALUES (%(app_id)s::UUID, %(model_config)s::JSONB, %(dialog_round)s, %(preset_prompt)s, %(tools)s::JSONB, %(workflows)s::JSONB, %(retrieval_config)s::JSONB, %(long_term_memory)s::JSONB, %(opening_statement)s, %(opening_questions)s::JSONB, %(speech_to_text)s::JSONB, %(text_to_speech)s::JSONB, %(review_config)s::JSONB, %(updated_at)s, %(created_at)s) RETURNING app_config.id, app_config.suggested_after_answer
[2025-05-17 10:45:27,009.009] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00066s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'model_config': '{"model": "gpt-4o", "provider": "openai", "parameters": {"top_p": 0.9, "max_tokens": 4096, "temperature": 0.7, "presence_penalty": 0.1, "frequency_penalty": 0.1}}', 'dialog_round': 10, 'preset_prompt': '你是一个AI助手', 'tools': '[{"type": "builtin_tool", "provider_id": "google", "tool_id": "google_serper", "params": {}}]', 'workflows': '[]', 'retrieval_config': '{"k": 5, "score": 0.7, "retrieval_strategy": "semantic"}', 'long_term_memory': '{"enable": false}', 'opening_statement': '你好，我是AI助手', 'opening_questions': '["\\u6709\\u4ec0\\u4e48\\u53ef\\u4ee5\\u5e2e\\u60a8\\uff1f", "\\u60a8\\u9700\\u8981\\u4ec0\\u4e48\\u5e2e\\u52a9\\uff1f"]', 'speech_to_text': '{"enable": false}', 'text_to_speech': '{"voice": "echo", "enable": false, "auto_play": false}', 'review_config': '{"enable": false, "keywords": ["\\u654f\\u611f\\u8bcd"], "inputs_config": {"enable": false, "preset_response": "\\u4f60\\u7684\\u8f93\\u5165\\u4e0d\\u5408\\u6cd5"}, "outputs_config": {"enable": false}}', 'updated_at': datetime.datetime(2025, 5, 17, 2, 45, 27, 8213), 'created_at': datetime.datetime(2025, 5, 17, 2, 45, 27, 8213)}
[2025-05-17 10:45:27,014.014] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:45:27,015.015] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:45:27,016.016] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config.id AS app_config_id, app_config.app_id AS app_config_app_id, app_config.model_config AS app_config_model_config, app_config.dialog_round AS app_config_dialog_round, app_config.preset_prompt AS app_config_preset_prompt, app_config.tools AS app_config_tools, app_config.workflows AS app_config_workflows, app_config.retrieval_config AS app_config_retrieval_config, app_config.long_term_memory AS app_config_long_term_memory, app_config.opening_statement AS app_config_opening_statement, app_config.opening_questions AS app_config_opening_questions, app_config.speech_to_text AS app_config_speech_to_text, app_config.text_to_speech AS app_config_text_to_speech, app_config.suggested_after_answer AS app_config_suggested_after_answer, app_config.review_config AS app_config_review_config, app_config.updated_at AS app_config_updated_at, app_config.created_at AS app_config_created_at 
FROM app_config 
WHERE app_config.id = %(pk_1)s::UUID
[2025-05-17 10:45:27,016.016] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00027s] {'pk_1': UUID('45eafd45-626c-4946-aa70-b95b6d5631aa')}
[2025-05-17 10:45:27,018.018] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:45:27,019.019] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00030s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:45:27,020.020] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app SET app_config_id=%(app_config_id)s::UUID WHERE app.id = %(app_id)s::UUID
[2025-05-17 10:45:27,021.021] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00025s] {'app_config_id': UUID('45eafd45-626c-4946-aa70-b95b6d5631aa'), 'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:45:27,021.021] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:45:27,023.023] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:45:27,024.024] base.py -> _exec_single_context line:1896 [INFO]: DELETE FROM app_dataset_join WHERE app_dataset_join.app_id = %(app_id_1)s::UUID
[2025-05-17 10:45:27,024.024] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00045s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:45:27,026.026] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:45:27,026.026] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:45:27,027.027] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_dataset_join (app_id, dataset_id) VALUES (%(app_id)s::UUID, %(dataset_id)s::UUID) RETURNING app_dataset_join.id, app_dataset_join.updated_at, app_dataset_join.created_at
[2025-05-17 10:45:27,027.027] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00023s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'dataset_id': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:45:27,028.028] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:45:27,030.030] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:45:27,031.031] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:45:27,031.031] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01263s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:45:27,032.032] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:45:27,032.032] base.py -> _exec_single_context line:1901 [INFO]: [cached since 124.4s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:45:27,034.034] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(max(app_config_version.version), %(coalesce_2)s) AS coalesce_1 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:45:27,035.035] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00036s] {'coalesce_2': 0, 'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.PUBLISHED: 'published'>}
[2025-05-17 10:45:27,038.038] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_config_version (app_id, model_config, dialog_round, preset_prompt, tools, workflows, datasets, retrieval_config, long_term_memory, opening_statement, opening_questions, speech_to_text, text_to_speech, suggested_after_answer, review_config, version, config_type) VALUES (%(app_id)s::UUID, %(model_config)s::JSONB, %(dialog_round)s, %(preset_prompt)s, %(tools)s::JSONB, %(workflows)s::JSONB, %(datasets)s::JSONB, %(retrieval_config)s::JSONB, %(long_term_memory)s::JSONB, %(opening_statement)s, %(opening_questions)s::JSONB, %(speech_to_text)s::JSONB, %(text_to_speech)s::JSONB, %(suggested_after_answer)s::JSONB, %(review_config)s::JSONB, %(version)s, %(config_type)s) RETURNING app_config_version.id, app_config_version.updated_at, app_config_version.created_at
[2025-05-17 10:45:27,038.038] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00055s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'model_config': '{"model": "gpt-4o", "provider": "openai", "parameters": {"top_p": 0.9, "max_tokens": 4096, "temperature": 0.7, "presence_penalty": 0.1, "frequency_penalty": 0.1}}', 'dialog_round': 10, 'preset_prompt': '你是一个AI助手', 'tools': '[{"type": "builtin_tool", "params": {}, "tool_id": "google_serper", "provider_id": "google"}]', 'workflows': '[]', 'datasets': '["9af90c52-28b2-4a47-9c92-148c9f21b512"]', 'retrieval_config': '{"k": 5, "score": 0.7, "retrieval_strategy": "semantic"}', 'long_term_memory': '{"enable": false}', 'opening_statement': '你好，我是AI助手', 'opening_questions': '["\\u6709\\u4ec0\\u4e48\\u53ef\\u4ee5\\u5e2e\\u60a8\\uff1f", "\\u60a8\\u9700\\u8981\\u4ec0\\u4e48\\u5e2e\\u52a9\\uff1f"]', 'speech_to_text': '{"enable": false}', 'text_to_speech': '{"voice": "echo", "enable": false, "auto_play": false}', 'suggested_after_answer': '{"enable": true}', 'review_config': '{"enable": false, "keywords": ["\\u654f\\u611f\\u8bcd"], "inputs_config": {"enable": false, "preset_response": "\\u4f60\\u7684\\u8f93\\u5165\\u4e0d\\u5408\\u6cd5"}, "outputs_config": {"enable": false}}', 'version': 16, 'config_type': <AppConfigType.PUBLISHED: 'published'>}
[2025-05-17 10:45:27,041.041] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:45:27,042.042] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:45:27] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/publish HTTP/1.1" 200 -
[2025-05-17 10:45:29,873.873] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:45:29,873.873] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:45:29,874.874] base.py -> _exec_single_context line:1901 [INFO]: [cached since 127.2s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:45:29,876.876] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:45:29,876.876] base.py -> _exec_single_context line:1901 [INFO]: [cached since 127.2s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:45:29,878.878] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:45:29,878.878] base.py -> _exec_single_context line:1901 [INFO]: [cached since 127.2s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:45:29,880.880] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 10:45:29,880.880] base.py -> _exec_single_context line:1901 [INFO]: [cached since 108.3s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:45:29,882.882] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 10:45:29,882.882] base.py -> _exec_single_context line:1901 [INFO]: [cached since 108.3s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 10:45:29,884.884] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 10:45:29,884.884] base.py -> _exec_single_context line:1901 [INFO]: [cached since 108.3s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '敏感词', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 10:45:29,887.887] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:45:29,960.960] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:45:29,961.961] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 10:45:29,961.961] base.py -> _exec_single_context line:1901 [INFO]: [cached since 108.2s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 10:45:29,963.963] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 10:45:29,963.963] base.py -> _exec_single_context line:1901 [INFO]: [cached since 108.2s ago] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 10:45:29,965.965] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 10:45:29,978.978] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:45:29] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 10:46:34,182.182] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:46:34,183.183] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:46:34,183.183] base.py -> _exec_single_context line:1901 [INFO]: [cached since 191.5s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:46:34,185.185] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:46:34,186.186] base.py -> _exec_single_context line:1901 [INFO]: [cached since 191.5s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:46:34,188.188] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:46:34,188.188] base.py -> _exec_single_context line:1901 [INFO]: [cached since 191.5s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:46:34,191.191] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 10:46:34,191.191] base.py -> _exec_single_context line:1901 [INFO]: [cached since 172.6s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:46:34,193.193] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 10:46:34,193.193] base.py -> _exec_single_context line:1901 [INFO]: [cached since 172.6s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 10:46:34,195.195] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 10:46:34,195.195] base.py -> _exec_single_context line:1901 [INFO]: [cached since 172.6s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '今天的纳斯达克指数怎么样?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 10:46:34,206.206] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:46:34,279.279] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:46:34,281.281] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 10:46:34,281.281] base.py -> _exec_single_context line:1901 [INFO]: [cached since 172.5s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 10:46:34,283.283] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 10:46:34,283.283] base.py -> _exec_single_context line:1901 [INFO]: [cached since 172.5s ago] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 10:46:34,284.284] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 10:46:34,293.293] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:46:34] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 10:46:57,660.660] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:46:57,660.660] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:46:57,661.661] base.py -> _exec_single_context line:1901 [INFO]: [cached since 215s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:46:57,662.662] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:46:57,662.662] base.py -> _exec_single_context line:1901 [INFO]: [cached since 215s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:46:57,663.663] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:46:57,663.663] base.py -> _exec_single_context line:1901 [INFO]: [cached since 215s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:46:57,664.664] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 10:46:57,665.665] base.py -> _exec_single_context line:1901 [INFO]: [cached since 196.1s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:46:57,675.675] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 10:46:57,676.676] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:46:57] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-17 10:47:13,604.604] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:47:13,606.606] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:47:13,607.607] base.py -> _exec_single_context line:1901 [INFO]: [cached since 231s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:47:13,610.610] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:47:13,610.610] base.py -> _exec_single_context line:1901 [INFO]: [cached since 231s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:47:13,612.612] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:47:13,613.613] base.py -> _exec_single_context line:1901 [INFO]: [cached since 230.9s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:47:13,614.614] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 10:47:13,614.614] base.py -> _exec_single_context line:1901 [INFO]: [cached since 212s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:47:13,615.615] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 10:47:13,621.621] base.py -> _exec_single_context line:1901 [INFO]: [cached since 212s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 10:47:13,623.623] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 10:47:13,624.624] base.py -> _exec_single_context line:1901 [INFO]: [cached since 212s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '今天的纳斯达克指数怎么样?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 10:47:13,627.627] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:47:13,701.701] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:47:13,701.701] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 10:47:13,702.702] base.py -> _exec_single_context line:1901 [INFO]: [cached since 211.9s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 10:47:13,704.704] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 10:47:13,705.705] base.py -> _exec_single_context line:1901 [INFO]: [cached since 211.9s ago] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 10:47:13,706.706] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 10:47:13,719.719] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:47:13] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 10:47:29,984.984] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:47:29,985.985] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:47:29,985.985] base.py -> _exec_single_context line:1901 [INFO]: [cached since 247.3s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:47:29,986.986] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:47:29,987.987] base.py -> _exec_single_context line:1901 [INFO]: [cached since 247.3s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:47:29,988.988] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:47:29,989.989] base.py -> _exec_single_context line:1901 [INFO]: [cached since 247.3s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:47:29,990.990] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 10:47:29,990.990] base.py -> _exec_single_context line:1901 [INFO]: [cached since 228.4s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:47:29,991.991] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 10:47:29,991.991] base.py -> _exec_single_context line:1901 [INFO]: [cached since 228.4s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 10:47:29,993.993] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 10:47:29,993.993] base.py -> _exec_single_context line:1901 [INFO]: [cached since 228.4s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '今天的纳斯达克指数怎么样?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 10:47:29,996.996] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:47:30,044.044] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:47:30,044.044] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 10:47:30,044.044] base.py -> _exec_single_context line:1901 [INFO]: [cached since 228.3s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 10:47:30,046.046] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 10:47:30,046.046] base.py -> _exec_single_context line:1901 [INFO]: [cached since 228.3s ago] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 10:47:30,047.047] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 10:47:30,057.057] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:47:30] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 10:48:14,285.285] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:48:14,287.287] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:48:14,287.287] base.py -> _exec_single_context line:1901 [INFO]: [cached since 291.7s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:48:14,289.289] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:48:14,290.290] base.py -> _exec_single_context line:1901 [INFO]: [cached since 291.6s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:48:14,291.291] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:48:14,292.292] base.py -> _exec_single_context line:1901 [INFO]: [cached since 291.6s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:48:14,293.293] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 10:48:14,294.294] base.py -> _exec_single_context line:1901 [INFO]: [cached since 272.7s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:48:14,295.295] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 10:48:14,303.303] base.py -> _exec_single_context line:1901 [INFO]: [cached since 272.7s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 10:48:14,303.303] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 10:48:14,304.304] base.py -> _exec_single_context line:1901 [INFO]: [cached since 272.7s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '今天纳斯达克指数怎么样?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 10:48:14,306.306] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:48:14,370.370] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:48:14,371.371] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 10:48:14,372.372] base.py -> _exec_single_context line:1901 [INFO]: [cached since 272.6s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 10:48:14,374.374] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 10:48:14,375.375] base.py -> _exec_single_context line:1901 [INFO]: [cached since 272.6s ago] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 10:48:14,377.377] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 10:48:14,387.387] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:48:14] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 10:48:22,361.361] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:48:22,362.362] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:48:22,362.362] base.py -> _exec_single_context line:1901 [INFO]: [cached since 299.7s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:48:22,363.363] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:48:22,363.363] base.py -> _exec_single_context line:1901 [INFO]: [cached since 299.7s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:48:22,364.364] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:48:22,364.364] base.py -> _exec_single_context line:1901 [INFO]: [cached since 299.7s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:48:22,365.365] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 10:48:22,366.366] base.py -> _exec_single_context line:1901 [INFO]: [cached since 280.8s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:48:22,368.368] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 10:48:22,368.368] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:48:22] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-17 10:49:03,850.850] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:49:03] "GET /builtin-tools/google/icon HTTP/1.1" 200 -
[2025-05-17 10:49:03,903.903] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 844, in dispatch_request
    self.raise_routing_exception(req)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 453, in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\ctx.py", line 362, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\werkzeug\routing\map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
[2025-05-17 10:49:03,939.939] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:49:03] "[35m[1mGET /favicon.ico HTTP/1.1[0m" 500 -
[2025-05-17 10:49:53,566.566] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:49:53,566.566] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:49:53,567.567] base.py -> _exec_single_context line:1901 [INFO]: [cached since 390.9s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:49:53,569.569] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:49:53,570.570] base.py -> _exec_single_context line:1901 [INFO]: [cached since 390.9s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:49:53,572.572] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:49:53,572.572] base.py -> _exec_single_context line:1901 [INFO]: [cached since 390.9s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:49:53,574.574] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 10:49:53,574.574] base.py -> _exec_single_context line:1901 [INFO]: [cached since 372s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:49:53,575.575] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 10:49:53,577.577] base.py -> _exec_single_context line:1901 [INFO]: [cached since 372s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 10:49:53,578.578] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 10:49:53,578.578] base.py -> _exec_single_context line:1901 [INFO]: [cached since 372s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '今天纳斯达克指数怎么样?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 10:49:53,582.582] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:49:53,640.640] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:49:53,640.640] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 10:49:53,640.640] base.py -> _exec_single_context line:1901 [INFO]: [cached since 371.9s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 10:49:53,641.641] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 10:49:53,642.642] base.py -> _exec_single_context line:1901 [INFO]: [cached since 371.9s ago] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 10:49:53,643.643] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 10:49:53,656.656] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:49:53] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 10:50:34,838.838] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-05-17 10:50:34,839.839] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-05-17 10:50:34,843.843] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-17 10:51:02,908.908] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-17 10:51:02,925.925] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-17 10:51:04,421.421] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-17 10:51:04,422.422] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 10:51:04,425.425] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-17 10:51:04,425.425] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 10:51:04,427.427] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-17 10:51:04,427.427] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 10:51:04,428.428] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:51:04,431.431] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 10:51:04,431.431] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00035s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 10:51:04,446.446] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 10:51:04,447.447] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00043s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 10:51:04,452.452] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 10:51:04,452.452] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00053s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 10:51:04,459.459] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 10:51:04,459.459] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00041s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 10:51:04,462.462] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 10:51:04,463.463] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00043s] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 10:51:04,467.467] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 10:51:04,467.467] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00036s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '今天纳斯达克指数怎么样?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 10:51:04,490.490] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 10:51:04,555.555] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 10:51:04,556.556] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 10:51:04,556.556] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00039s] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 10:51:04,559.559] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 10:51:04,559.559] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00051s] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 10:51:05,676.676] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 10:51:05,695.695] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 10:51:05] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 11:00:24,191.191] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\embeddings_service.py', reloading
[2025-05-17 11:00:25,490.490] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-17 11:00:50,874.874] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-17 11:00:50,888.888] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-17 11:00:52,556.556] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-17 11:00:52,561.561] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 11:00:52,566.566] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-17 11:00:52,566.566] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 11:00:52,568.568] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-17 11:00:52,568.568] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 11:00:52,569.569] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:00:52,575.575] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:00:52,575.575] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00104s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:00:52,586.586] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:00:52,586.586] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00042s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:00:52,591.591] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:00:52,592.592] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00057s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:00:52,598.598] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:00:52,598.598] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00042s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:00:52,604.604] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 11:00:52,605.605] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:00:52] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-17 11:02:18,733.733] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:02:18,734.734] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:02:18,735.735] base.py -> _exec_single_context line:1901 [INFO]: [cached since 86.16s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:02:18,742.742] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:02:18,743.743] base.py -> _exec_single_context line:1901 [INFO]: [cached since 86.16s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:02:18,744.744] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:02:18,745.745] base.py -> _exec_single_context line:1901 [INFO]: [cached since 86.16s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:02:18,746.746] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:02:18,747.747] base.py -> _exec_single_context line:1901 [INFO]: [cached since 86.15s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:02:18,749.749] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 11:02:18,750.750] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00031s] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 11:02:18,756.756] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 11:02:18,756.756] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00064s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '今天纳斯达克指数怎么样?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 11:02:18,781.781] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:02:18,852.852] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:02:18,853.853] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:02:18,853.853] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00028s] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:02:18,856.856] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 11:02:18,856.856] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00036s] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 11:02:19,422.422] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 11:02:19,438.438] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:02:19] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 11:03:23,414.414] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\embeddings_service.py', reloading
[2025-05-17 11:03:25,218.218] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-17 11:03:50,154.154] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-17 11:03:50,168.168] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-17 11:03:51,053.053] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-17 11:03:51,054.054] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 11:03:51,057.057] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-17 11:03:51,057.057] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 11:03:51,057.057] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-17 11:03:51,057.057] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 11:03:51,057.057] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:03:51,065.065] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:03:51,065.065] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00075s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:03:51,075.075] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:03:51,076.076] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00057s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:03:51,083.083] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:03:51,084.084] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00085s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:03:51,090.090] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:03:51,090.090] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00060s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:03:51,094.094] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 11:03:51,094.094] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:03:51] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-17 11:05:28,673.673] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:05:28,674.674] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:05:28,674.674] base.py -> _exec_single_context line:1901 [INFO]: [cached since 97.61s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:05:28,679.679] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:05:28,680.680] base.py -> _exec_single_context line:1901 [INFO]: [cached since 97.61s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:05:28,681.681] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:05:28,681.681] base.py -> _exec_single_context line:1901 [INFO]: [cached since 97.6s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:05:28,682.682] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:05:28,683.683] base.py -> _exec_single_context line:1901 [INFO]: [cached since 97.59s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:05:28,686.686] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 11:05:28,687.687] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00079s] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 11:05:28,693.693] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 11:05:28,694.694] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00057s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '今天纳斯达克指数怎么样?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 11:05:28,710.710] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:05:28,782.782] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:05:28,783.783] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:05:28,783.783] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00023s] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:05:28,787.787] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 11:05:28,787.787] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00062s] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 11:05:29,432.432] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 11:05:29,449.449] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:05:29] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 11:06:55,074.074] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-05-17 11:06:55,094.094] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-05-17 11:06:55,115.115] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-17 11:07:27,038.038] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-17 11:07:27,055.055] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-17 11:07:33,304.304] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-17 11:07:33,305.305] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 11:07:33,310.310] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-17 11:07:33,311.311] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 11:07:33,312.312] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-17 11:07:33,313.313] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 11:07:33,314.314] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:07:33,321.321] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:07:33,323.323] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00100s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:07:33,342.342] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:07:33,343.343] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00076s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:07:33,351.351] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:07:33,352.352] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00086s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:07:33,359.359] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:07:33,359.359] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00126s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:07:33,368.368] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 11:07:33,369.369] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00059s] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 11:07:33,379.379] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 11:07:33,379.379] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00082s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '今天纳斯达克指数怎么样?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 11:07:33,395.395] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:07:33,513.513] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:07:33,515.515] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:07:33,516.516] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00053s] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:07:33,520.520] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 11:07:33,521.521] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00100s] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 11:07:34,700.700] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 11:07:34,720.720] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:07:34] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 11:07:52,348.348] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:07:52,348.348] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:07:52,349.349] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.03s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:07:52,352.352] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:07:52,352.352] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19.01s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:07:52,354.354] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:07:52,354.354] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:07:52,356.356] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:07:52,356.356] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:07:52,363.363] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 11:07:52,363.363] base.py -> _exec_single_context line:1901 [INFO]: [cached since 19s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 11:07:52,366.366] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 11:07:52,367.367] base.py -> _exec_single_context line:1901 [INFO]: [cached since 18.99s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '今天纳斯达克怎么样?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 11:07:52,370.370] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:07:52,448.448] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:07:52,449.449] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:07:52,449.449] base.py -> _exec_single_context line:1901 [INFO]: [cached since 18.94s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:07:52,451.451] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 11:07:52,452.452] base.py -> _exec_single_context line:1901 [INFO]: [cached since 18.93s ago] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 11:07:52,453.453] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 11:07:52,470.470] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:07:52] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 11:08:11,340.340] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:08:11,340.340] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:08:11,340.340] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38.02s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:08:11,342.342] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:08:11,343.343] base.py -> _exec_single_context line:1901 [INFO]: [cached since 38s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:08:11,344.344] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:08:11,344.344] base.py -> _exec_single_context line:1901 [INFO]: [cached since 37.99s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:08:11,345.345] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:08:11,346.346] base.py -> _exec_single_context line:1901 [INFO]: [cached since 37.99s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:08:11,348.348] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 11:08:11,349.349] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:08:11] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-17 11:08:21,154.154] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:08:21,155.155] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:08:21,155.155] base.py -> _exec_single_context line:1901 [INFO]: [cached since 47.83s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:08:21,157.157] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:08:21,158.158] base.py -> _exec_single_context line:1901 [INFO]: [cached since 47.82s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:08:21,160.160] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-17 11:08:21,160.160] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00051s] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:08:21,162.162] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:08:21,163.163] base.py -> _exec_single_context line:1901 [INFO]: [cached since 47.81s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:08:21,166.166] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET review_config=%(review_config)s::JSONB, updated_at=%(updated_at)s WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-17 11:08:21,168.168] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00198s] {'review_config': '{"enable": false, "keywords": ["\\u654f\\u611f\\u8bcd1", "\\u654f\\u611f\\u8bcd2"], "inputs_config": {"enable": false, "preset_response": "\\u9884\\u8bbe\\u54cd\\u5e94"}, "outputs_config": {"enable": false}}', 'updated_at': datetime.datetime(2025, 5, 17, 11, 8, 21, 164085), 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-17 11:08:21,170.170] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:08:21,171.171] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:08:21] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-17 11:08:23,426.426] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:08:23,427.427] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:08:23,427.427] base.py -> _exec_single_context line:1901 [INFO]: [cached since 50.11s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:08:23,429.429] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:08:23,429.429] base.py -> _exec_single_context line:1901 [INFO]: [cached since 50.09s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:08:23,431.431] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:08:23,431.431] base.py -> _exec_single_context line:1901 [INFO]: [cached since 50.08s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:08:23,433.433] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:08:23,433.433] base.py -> _exec_single_context line:1901 [INFO]: [cached since 50.08s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:08:23,434.434] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 11:08:23,441.441] base.py -> _exec_single_context line:1901 [INFO]: [cached since 50.07s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 11:08:23,442.442] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 11:08:23,444.444] base.py -> _exec_single_context line:1901 [INFO]: [cached since 50.07s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '今天纳斯达克怎么样?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 11:08:23,446.446] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:08:23,517.517] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:08:23,517.517] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:08:23,517.517] base.py -> _exec_single_context line:1901 [INFO]: [cached since 50s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:08:23,520.520] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 11:08:23,521.521] base.py -> _exec_single_context line:1901 [INFO]: [cached since 50s ago] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 11:08:23,522.522] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 11:08:23,542.542] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:08:23] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 11:08:27,070.070] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:08:27,070.070] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:08:27,071.071] base.py -> _exec_single_context line:1901 [INFO]: [cached since 53.75s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:08:27,073.073] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:08:27,073.073] base.py -> _exec_single_context line:1901 [INFO]: [cached since 53.73s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:08:27,076.076] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:08:27,077.077] base.py -> _exec_single_context line:1901 [INFO]: [cached since 53.73s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:08:27,078.078] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:08:27,078.078] base.py -> _exec_single_context line:1901 [INFO]: [cached since 53.72s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:08:27,079.079] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 11:08:27,079.079] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:08:27] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-17 11:08:49,703.703] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:08:49,704.704] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:08:49,704.704] base.py -> _exec_single_context line:1901 [INFO]: [cached since 76.38s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:08:49,706.706] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:08:49,706.706] base.py -> _exec_single_context line:1901 [INFO]: [cached since 76.36s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:08:49,708.708] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:08:49,708.708] base.py -> _exec_single_context line:1901 [INFO]: [cached since 76.36s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:08:49,710.710] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:08:49,710.710] base.py -> _exec_single_context line:1901 [INFO]: [cached since 76.35s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:08:49,713.713] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_config (app_id, model_config, dialog_round, preset_prompt, tools, workflows, retrieval_config, long_term_memory, opening_statement, opening_questions, speech_to_text, text_to_speech, review_config, updated_at, created_at) VALUES (%(app_id)s::UUID, %(model_config)s::JSONB, %(dialog_round)s, %(preset_prompt)s, %(tools)s::JSONB, %(workflows)s::JSONB, %(retrieval_config)s::JSONB, %(long_term_memory)s::JSONB, %(opening_statement)s, %(opening_questions)s::JSONB, %(speech_to_text)s::JSONB, %(text_to_speech)s::JSONB, %(review_config)s::JSONB, %(updated_at)s, %(created_at)s) RETURNING app_config.id, app_config.suggested_after_answer
[2025-05-17 11:08:49,713.713] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00101s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'model_config': '{"model": "gpt-4o", "provider": "openai", "parameters": {"top_p": 0.9, "max_tokens": 4096, "temperature": 0.7, "presence_penalty": 0.1, "frequency_penalty": 0.1}}', 'dialog_round': 10, 'preset_prompt': '你是一个AI助手', 'tools': '[{"type": "builtin_tool", "provider_id": "google", "tool_id": "google_serper", "params": {}}]', 'workflows': '[]', 'retrieval_config': '{"k": 5, "score": 0.7, "retrieval_strategy": "semantic"}', 'long_term_memory': '{"enable": false}', 'opening_statement': '你好，我是AI助手', 'opening_questions': '["\\u6709\\u4ec0\\u4e48\\u53ef\\u4ee5\\u5e2e\\u60a8\\uff1f", "\\u60a8\\u9700\\u8981\\u4ec0\\u4e48\\u5e2e\\u52a9\\uff1f"]', 'speech_to_text': '{"enable": false}', 'text_to_speech': '{"voice": "echo", "enable": false, "auto_play": false}', 'review_config': '{"enable": false, "keywords": ["\\u654f\\u611f\\u8bcd1", "\\u654f\\u611f\\u8bcd2"], "inputs_config": {"enable": false, "preset_response": "\\u9884\\u8bbe\\u54cd\\u5e94"}, "outputs_config": {"enable": false}}', 'updated_at': datetime.datetime(2025, 5, 17, 3, 8, 49, 713334), 'created_at': datetime.datetime(2025, 5, 17, 3, 8, 49, 713334)}
[2025-05-17 11:08:49,719.719] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:08:49,720.720] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:08:49,722.722] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config.id AS app_config_id, app_config.app_id AS app_config_app_id, app_config.model_config AS app_config_model_config, app_config.dialog_round AS app_config_dialog_round, app_config.preset_prompt AS app_config_preset_prompt, app_config.tools AS app_config_tools, app_config.workflows AS app_config_workflows, app_config.retrieval_config AS app_config_retrieval_config, app_config.long_term_memory AS app_config_long_term_memory, app_config.opening_statement AS app_config_opening_statement, app_config.opening_questions AS app_config_opening_questions, app_config.speech_to_text AS app_config_speech_to_text, app_config.text_to_speech AS app_config_text_to_speech, app_config.suggested_after_answer AS app_config_suggested_after_answer, app_config.review_config AS app_config_review_config, app_config.updated_at AS app_config_updated_at, app_config.created_at AS app_config_created_at 
FROM app_config 
WHERE app_config.id = %(pk_1)s::UUID
[2025-05-17 11:08:49,723.723] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00042s] {'pk_1': UUID('0faccc6e-3b3b-43bc-a60c-795bf77c896b')}
[2025-05-17 11:08:49,726.726] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:08:49,726.726] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00041s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:08:49,728.728] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app SET app_config_id=%(app_config_id)s::UUID WHERE app.id = %(app_id)s::UUID
[2025-05-17 11:08:49,729.729] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00061s] {'app_config_id': UUID('0faccc6e-3b3b-43bc-a60c-795bf77c896b'), 'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:08:49,730.730] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:08:49,731.731] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:08:49,732.732] base.py -> _exec_single_context line:1896 [INFO]: DELETE FROM app_dataset_join WHERE app_dataset_join.app_id = %(app_id_1)s::UUID
[2025-05-17 11:08:49,732.732] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00051s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:08:49,735.735] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:08:49,736.736] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:08:49,738.738] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_dataset_join (app_id, dataset_id) VALUES (%(app_id)s::UUID, %(dataset_id)s::UUID) RETURNING app_dataset_join.id, app_dataset_join.updated_at, app_dataset_join.created_at
[2025-05-17 11:08:49,738.738] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00043s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'dataset_id': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:08:49,740.740] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:08:49,741.741] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:08:49,742.742] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:08:49,742.742] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01688s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:08:49,744.744] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:08:49,744.744] base.py -> _exec_single_context line:1901 [INFO]: [cached since 76.39s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:08:49,748.748] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(max(app_config_version.version), %(coalesce_2)s) AS coalesce_1 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:08:49,748.748] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00072s] {'coalesce_2': 0, 'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.PUBLISHED: 'published'>}
[2025-05-17 11:08:49,753.753] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_config_version (app_id, model_config, dialog_round, preset_prompt, tools, workflows, datasets, retrieval_config, long_term_memory, opening_statement, opening_questions, speech_to_text, text_to_speech, suggested_after_answer, review_config, version, config_type) VALUES (%(app_id)s::UUID, %(model_config)s::JSONB, %(dialog_round)s, %(preset_prompt)s, %(tools)s::JSONB, %(workflows)s::JSONB, %(datasets)s::JSONB, %(retrieval_config)s::JSONB, %(long_term_memory)s::JSONB, %(opening_statement)s, %(opening_questions)s::JSONB, %(speech_to_text)s::JSONB, %(text_to_speech)s::JSONB, %(suggested_after_answer)s::JSONB, %(review_config)s::JSONB, %(version)s, %(config_type)s) RETURNING app_config_version.id, app_config_version.updated_at, app_config_version.created_at
[2025-05-17 11:08:49,754.754] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00093s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'model_config': '{"model": "gpt-4o", "provider": "openai", "parameters": {"top_p": 0.9, "max_tokens": 4096, "temperature": 0.7, "presence_penalty": 0.1, "frequency_penalty": 0.1}}', 'dialog_round': 10, 'preset_prompt': '你是一个AI助手', 'tools': '[{"type": "builtin_tool", "params": {}, "tool_id": "google_serper", "provider_id": "google"}]', 'workflows': '[]', 'datasets': '["9af90c52-28b2-4a47-9c92-148c9f21b512"]', 'retrieval_config': '{"k": 5, "score": 0.7, "retrieval_strategy": "semantic"}', 'long_term_memory': '{"enable": false}', 'opening_statement': '你好，我是AI助手', 'opening_questions': '["\\u6709\\u4ec0\\u4e48\\u53ef\\u4ee5\\u5e2e\\u60a8\\uff1f", "\\u60a8\\u9700\\u8981\\u4ec0\\u4e48\\u5e2e\\u52a9\\uff1f"]', 'speech_to_text': '{"enable": false}', 'text_to_speech': '{"voice": "echo", "enable": false, "auto_play": false}', 'suggested_after_answer': '{"enable": true}', 'review_config': '{"enable": false, "keywords": ["\\u654f\\u611f\\u8bcd1", "\\u654f\\u611f\\u8bcd2"], "inputs_config": {"enable": false, "preset_response": "\\u9884\\u8bbe\\u54cd\\u5e94"}, "outputs_config": {"enable": false}}', 'version': 17, 'config_type': <AppConfigType.PUBLISHED: 'published'>}
[2025-05-17 11:08:49,760.760] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:08:49,763.763] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:08:49] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/publish HTTP/1.1" 200 -
[2025-05-17 11:08:52,138.138] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:08:52,139.139] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:08:52,139.139] base.py -> _exec_single_context line:1901 [INFO]: [cached since 78.82s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:08:52,141.141] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:08:52,141.141] base.py -> _exec_single_context line:1901 [INFO]: [cached since 78.8s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:08:52,142.142] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:08:52,143.143] base.py -> _exec_single_context line:1901 [INFO]: [cached since 78.79s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:08:52,144.144] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:08:52,144.144] base.py -> _exec_single_context line:1901 [INFO]: [cached since 78.79s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:08:52,145.145] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 11:08:52,147.147] base.py -> _exec_single_context line:1901 [INFO]: [cached since 78.78s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 11:08:52,148.148] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 11:08:52,149.149] base.py -> _exec_single_context line:1901 [INFO]: [cached since 78.77s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '今天纳斯达克怎么样?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 11:08:52,151.151] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:08:52,203.203] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:08:52,203.203] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:08:52,203.203] base.py -> _exec_single_context line:1901 [INFO]: [cached since 78.69s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:08:52,206.206] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 11:08:52,206.206] base.py -> _exec_single_context line:1901 [INFO]: [cached since 78.69s ago] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 11:08:52,208.208] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 11:08:52,221.221] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:08:52] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 11:09:15,558.558] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:09:15,559.559] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:09:15,559.559] base.py -> _exec_single_context line:1901 [INFO]: [cached since 102.2s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:09:15,561.561] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:09:15,561.561] base.py -> _exec_single_context line:1901 [INFO]: [cached since 102.2s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:09:15,562.562] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:09:15,562.562] base.py -> _exec_single_context line:1901 [INFO]: [cached since 102.2s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:09:15,563.563] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:09:15,563.563] base.py -> _exec_single_context line:1901 [INFO]: [cached since 102.2s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:09:15,564.564] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 11:09:15,564.564] base.py -> _exec_single_context line:1901 [INFO]: [cached since 102.2s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 11:09:15,565.565] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 11:09:15,565.565] base.py -> _exec_single_context line:1901 [INFO]: [cached since 102.2s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '今天纳斯达克怎么样?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 11:09:15,567.567] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:09:15,611.611] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:09:15,611.611] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:09:15,612.612] base.py -> _exec_single_context line:1901 [INFO]: [cached since 102.1s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:09:15,613.613] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 11:09:15,613.613] base.py -> _exec_single_context line:1901 [INFO]: [cached since 102.1s ago] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 11:09:15,614.614] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 11:09:15,620.620] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:09:15] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 11:09:18,004.004] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:09:18,005.005] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:09:18,005.005] base.py -> _exec_single_context line:1901 [INFO]: [cached since 104.7s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:09:18,006.006] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:09:18,006.006] base.py -> _exec_single_context line:1901 [INFO]: [cached since 104.7s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:09:18,007.007] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:09:18,008.008] base.py -> _exec_single_context line:1901 [INFO]: [cached since 104.7s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:09:18,009.009] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:09:18,009.009] base.py -> _exec_single_context line:1901 [INFO]: [cached since 104.7s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:09:18,010.010] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 11:09:18,011.011] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:09:18] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-17 11:09:27,365.365] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:09:27,366.366] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:09:27,366.366] base.py -> _exec_single_context line:1901 [INFO]: [cached since 114s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:09:27,369.369] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:09:27,369.369] base.py -> _exec_single_context line:1901 [INFO]: [cached since 114s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:09:27,371.371] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:09:27,371.371] base.py -> _exec_single_context line:1901 [INFO]: [cached since 114s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:09:27,373.373] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:09:27,373.373] base.py -> _exec_single_context line:1901 [INFO]: [cached since 114s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:09:27,374.374] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 11:09:27,374.374] base.py -> _exec_single_context line:1901 [INFO]: [cached since 114s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 11:09:27,375.375] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 11:09:27,375.375] base.py -> _exec_single_context line:1901 [INFO]: [cached since 114s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '今天纳斯达克怎么样?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 11:09:27,377.377] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:09:27,423.423] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:09:27,423.423] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:09:27,425.425] base.py -> _exec_single_context line:1901 [INFO]: [cached since 113.9s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:09:27,427.427] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 11:09:27,427.427] base.py -> _exec_single_context line:1901 [INFO]: [cached since 113.9s ago] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 11:09:27,428.428] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 11:09:27,437.437] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:09:27] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 11:13:40,843.843] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:13:40,844.844] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:13:40,844.844] base.py -> _exec_single_context line:1901 [INFO]: [cached since 367.5s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:13:40,847.847] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:13:40,847.847] base.py -> _exec_single_context line:1901 [INFO]: [cached since 367.5s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:13:40,847.847] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:13:40,847.847] base.py -> _exec_single_context line:1901 [INFO]: [cached since 367.5s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:13:40,848.848] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:13:40,848.848] base.py -> _exec_single_context line:1901 [INFO]: [cached since 367.5s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:13:40,849.849] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 11:13:40,849.849] base.py -> _exec_single_context line:1901 [INFO]: [cached since 367.5s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 11:13:40,850.850] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 11:13:40,852.852] base.py -> _exec_single_context line:1901 [INFO]: [cached since 367.5s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '今天纳斯达克怎么样?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 11:13:40,854.854] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:13:40,897.897] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:13:40,897.897] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:13:40,898.898] base.py -> _exec_single_context line:1901 [INFO]: [cached since 367.4s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:13:40,899.899] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 11:13:40,899.899] base.py -> _exec_single_context line:1901 [INFO]: [cached since 367.4s ago] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 11:13:40,901.901] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:13:40,901.901] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00025s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 11:13:43,131.131] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:13:43,132.132] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00129s] {'pk_1': UUID('4811fb57-a7a6-4748-a6b0-5c6e8879029c')}
[2025-05-17 11:13:43,134.134] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:13:43] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 11:13:46,339.339] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 11:13:46,340.340] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00071s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'message_id': UUID('4811fb57-a7a6-4748-a6b0-5c6e8879029c'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.AGENT_THOUGHT: 'agent_thought'>, 'thought': '[{"name": "google_serper", "args": {"query": "Nasdaq index today"}, "id": "call_mtR8M7PGVoNOMn3O5qmPhWvB", "type": "tool_call"}]', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (2910 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "b627f455-cf00-4221-9791-22a3e06aba18", "example": false}}]', 'answer': '', 'latency': 2.1501616999999555}
[2025-05-17 11:13:46,344.344] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:13:46,346.346] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:13:46,346.346] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:13:46,346.346] base.py -> _exec_single_context line:1901 [INFO]: [cached since 372.8s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:13:46,347.347] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:13:46,348.348] base.py -> _exec_single_context line:1901 [INFO]: [cached since 3.217s ago] {'pk_1': UUID('4811fb57-a7a6-4748-a6b0-5c6e8879029c')}
[2025-05-17 11:13:46,354.354] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:13:46,354.354] base.py -> _exec_single_context line:1901 [INFO]: [cached since 5.453s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 11:13:46,356.356] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 11:13:46,356.356] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01623s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'message_id': UUID('4811fb57-a7a6-4748-a6b0-5c6e8879029c'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 2, 'event': <QueueEvent.AGENT_ACTION: 'agent_action'>, 'thought': '', 'observation': '"19,211.10 +98.78 (0.52%)"', 'tool': 'google_serper', 'tool_input': '{"query": "Nasdaq index today"}', 'message': '{}', 'answer': '', 'latency': 1.4833286000000498}
[2025-05-17 11:13:46,358.358] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:13:46,359.359] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:13:46,359.359] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:13:46,359.359] base.py -> _exec_single_context line:1901 [INFO]: [cached since 372.8s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:13:46,359.359] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:13:46,359.359] base.py -> _exec_single_context line:1901 [INFO]: [cached since 3.23s ago] {'pk_1': UUID('4811fb57-a7a6-4748-a6b0-5c6e8879029c')}
[2025-05-17 11:13:46,359.359] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:13:46,359.359] base.py -> _exec_single_context line:1901 [INFO]: [cached since 5.462s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 11:13:46,366.366] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 11:13:46,366.366] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02653s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'message_id': UUID('4811fb57-a7a6-4748-a6b0-5c6e8879029c'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 3, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': '今天纳斯达克指数为19,211.10，上涨了98.78点，涨幅为0.52%。', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (4035 characters truncated) ... ogle_serper", "id": "237a3aca-4fbd-47c2-854e-0c3407c6a350", "tool_call_id": "call_mtR8M7PGVoNOMn3O5qmPhWvB", "artifact": null, "status": "success"}}]', 'answer': '今天纳斯达克指数为19,211.10，上涨了98.78点，涨幅为0.52%。', 'latency': 1.7135537999999997}
[2025-05-17 11:13:46,378.378] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:13:46,379.379] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:13:46,380.380] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:13:46,380.380] base.py -> _exec_single_context line:1901 [INFO]: [cached since 3.249s ago] {'pk_1': UUID('4811fb57-a7a6-4748-a6b0-5c6e8879029c')}
[2025-05-17 11:13:46,382.382] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s WHERE message.id = %(message_id)s::UUID
[2025-05-17 11:13:46,382.382] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00048s] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (4035 characters truncated) ... ogle_serper", "id": "237a3aca-4fbd-47c2-854e-0c3407c6a350", "tool_call_id": "call_mtR8M7PGVoNOMn3O5qmPhWvB", "artifact": null, "status": "success"}}]', 'answer': '今天纳斯达克指数为19,211.10，上涨了98.78点，涨幅为0.52%。', 'message_id': UUID('4811fb57-a7a6-4748-a6b0-5c6e8879029c')}
[2025-05-17 11:13:46,384.384] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:14:28,235.235] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:14:28,235.235] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:14:28,236.236] base.py -> _exec_single_context line:1901 [INFO]: [cached since 414.9s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:14:28,237.237] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:14:28,237.237] base.py -> _exec_single_context line:1901 [INFO]: [cached since 414.9s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:14:28,239.239] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:14:28,239.239] base.py -> _exec_single_context line:1901 [INFO]: [cached since 414.9s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:14:28,240.240] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:14:28,240.240] base.py -> _exec_single_context line:1901 [INFO]: [cached since 414.9s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:14:28,250.250] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 11:14:28,250.250] base.py -> _exec_single_context line:1901 [INFO]: [cached since 414.9s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 11:14:28,251.251] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 11:14:28,252.252] base.py -> _exec_single_context line:1901 [INFO]: [cached since 414.9s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '今天道琼斯怎么样?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 11:14:28,253.253] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:14:28,311.311] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:14:28,312.312] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:14:28,312.312] base.py -> _exec_single_context line:1901 [INFO]: [cached since 414.8s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:14:28,314.314] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 11:14:28,314.314] base.py -> _exec_single_context line:1901 [INFO]: [cached since 414.8s ago] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 11:14:28,315.315] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 11:14:28,327.327] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:14:28] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 11:20:14,477.477] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:20:14,478.478] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:20:14,478.478] base.py -> _exec_single_context line:1901 [INFO]: [cached since 761.2s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:20:14,481.481] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:20:14,481.481] base.py -> _exec_single_context line:1901 [INFO]: [cached since 761.1s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:20:14,481.481] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-17 11:20:14,482.482] base.py -> _exec_single_context line:1901 [INFO]: [cached since 713.3s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:20:14,482.482] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:20:14,483.483] base.py -> _exec_single_context line:1901 [INFO]: [cached since 761.1s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:20:14,484.484] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET model_config=%(model_config)s::JSONB, updated_at=%(updated_at)s WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-17 11:20:14,485.485] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00060s] {'model_config': '{"model": "gpt-4o-mini", "provider": "openai", "parameters": {"top_p": 0.9, "max_tokens": 4096, "temperature": 0.7, "presence_penalty": 0.1, "frequency_penalty": 0.1}}', 'updated_at': datetime.datetime(2025, 5, 17, 11, 20, 14, 483937), 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-17 11:20:14,486.486] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:20:14,488.488] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:20:14] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-17 11:20:17,400.400] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:20:17,401.401] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:20:17,401.401] base.py -> _exec_single_context line:1901 [INFO]: [cached since 764.1s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:20:17,403.403] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:20:17,403.403] base.py -> _exec_single_context line:1901 [INFO]: [cached since 764.1s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:20:17,404.404] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:20:17,404.404] base.py -> _exec_single_context line:1901 [INFO]: [cached since 764.1s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:20:17,406.406] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:20:17,406.406] base.py -> _exec_single_context line:1901 [INFO]: [cached since 764.1s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:20:17,407.407] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 11:20:17,407.407] base.py -> _exec_single_context line:1901 [INFO]: [cached since 764s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 11:20:17,408.408] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 11:20:17,418.418] base.py -> _exec_single_context line:1901 [INFO]: [cached since 764s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '今天道琼斯怎么样?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 11:20:17,421.421] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:20:17,472.472] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:20:17,473.473] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:20:17,474.474] base.py -> _exec_single_context line:1901 [INFO]: [cached since 764s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:20:17,475.475] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 11:20:17,476.476] base.py -> _exec_single_context line:1901 [INFO]: [cached since 764s ago] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 11:20:17,477.477] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 11:20:17,485.485] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:20:17] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 11:20:19,738.738] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:20:19,738.738] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:20:19,739.739] base.py -> _exec_single_context line:1901 [INFO]: [cached since 766.4s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:20:19,741.741] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:20:19,741.741] base.py -> _exec_single_context line:1901 [INFO]: [cached since 766.4s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:20:19,743.743] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:20:19,744.744] base.py -> _exec_single_context line:1901 [INFO]: [cached since 766.4s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:20:19,745.745] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:20:19,745.745] base.py -> _exec_single_context line:1901 [INFO]: [cached since 766.4s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:20:19,749.749] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 11:20:19,749.749] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:20:19] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-17 11:22:29,329.329] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\core\\memory\\token_buffer_memory.py', reloading
[2025-05-17 11:22:30,548.548] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-17 11:22:53,533.533] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-17 11:22:53,545.545] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-17 11:23:01,272.272] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-17 11:23:01,272.272] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 11:23:01,275.275] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-17 11:23:01,275.275] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 11:23:01,276.276] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-17 11:23:01,277.277] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 11:23:01,277.277] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:23:01,280.280] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:23:01,281.281] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00049s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:23:01,288.288] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:23:01,289.289] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00039s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:23:01,295.295] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:23:01,295.295] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00043s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:23:01,300.300] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:23:01,301.301] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00044s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:23:01,304.304] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 11:23:01,304.304] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00048s] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 11:23:01,309.309] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 11:23:01,309.309] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00058s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '今天道琼斯怎么样?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 11:23:01,328.328] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:23:01,393.393] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:23:01] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 11:24:53,783.783] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\core\\memory\\token_buffer_memory.py', reloading
[2025-05-17 11:24:55,334.334] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-17 11:25:24,593.593] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-17 11:25:24,617.617] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-17 11:26:01,693.693] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\core\\memory\\token_buffer_memory.py', reloading
[2025-05-17 11:26:03,440.440] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-17 11:26:34,724.724] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-17 11:26:34,737.737] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-17 11:26:35,685.685] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-17 11:26:35,686.686] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 11:26:35,689.689] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-17 11:26:35,689.689] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 11:26:35,690.690] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-17 11:26:35,690.690] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 11:26:35,691.691] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:26:35,695.695] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:26:35,695.695] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00041s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:26:35,705.705] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:26:35,706.706] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00048s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:26:35,711.711] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:26:35,712.712] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00050s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:26:35,718.718] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:26:35,718.718] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00050s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:26:35,722.722] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 11:26:35,723.723] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:26:35] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-17 11:26:41,410.410] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:26:41,411.411] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:26:41,411.411] base.py -> _exec_single_context line:1901 [INFO]: [cached since 5.716s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:26:41,414.414] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:26:41,415.415] base.py -> _exec_single_context line:1901 [INFO]: [cached since 5.709s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:26:41,416.416] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:26:41,416.416] base.py -> _exec_single_context line:1901 [INFO]: [cached since 5.705s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:26:41,417.417] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:26:41,417.417] base.py -> _exec_single_context line:1901 [INFO]: [cached since 5.7s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:26:41,420.420] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 11:26:41,421.421] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00045s] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 11:26:41,427.427] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 11:26:41,428.428] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00052s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '今天道琼斯怎么样?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 11:26:41,444.444] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:26:41,520.520] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:26:41,521.521] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:26:41,521.521] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00035s] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:26:41,524.524] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 11:26:41,525.525] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00041s] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 11:26:41,529.529] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 11:26:41,544.544] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:26:41] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 11:29:12,566.566] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\core\\memory\\token_buffer_memory.py', reloading
[2025-05-17 11:29:14,024.024] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-17 11:29:48,651.651] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-17 11:29:48,667.667] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-17 11:29:54,227.227] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-17 11:29:54,227.227] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 11:29:54,231.231] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-17 11:29:54,232.232] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 11:29:54,233.233] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-17 11:29:54,234.234] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 11:29:54,235.235] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:29:54,243.243] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:29:54,243.243] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00077s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:29:54,258.258] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:29:54,259.259] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00056s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:29:54,274.274] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:29:54,275.275] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00055s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:29:54,281.281] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:29:54,283.283] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00073s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:29:54,287.287] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 11:29:54,288.288] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00054s] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 11:29:54,296.296] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 11:29:54,296.296] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00054s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '今天道琼斯怎么样?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 11:29:54,315.315] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:29:54,448.448] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:29:54] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 11:30:51,499.499] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:30:51,499.499] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:30:51,499.499] base.py -> _exec_single_context line:1901 [INFO]: [cached since 57.26s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:30:51,501.501] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:30:51,502.502] base.py -> _exec_single_context line:1901 [INFO]: [cached since 57.24s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:30:51,503.503] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:30:51,503.503] base.py -> _exec_single_context line:1901 [INFO]: [cached since 57.23s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:30:51,504.504] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:30:51,504.504] base.py -> _exec_single_context line:1901 [INFO]: [cached since 57.22s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:30:51,505.505] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 11:30:51,505.505] base.py -> _exec_single_context line:1901 [INFO]: [cached since 57.22s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 11:30:51,506.506] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 11:30:51,507.507] base.py -> _exec_single_context line:1901 [INFO]: [cached since 57.21s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '今天道琼斯怎么样?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 11:30:51,509.509] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:30:51,557.557] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:30:51] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 11:34:25,583.583] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-05-17 11:34:25,583.583] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-05-17 11:34:25,586.586] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-17 11:35:15,938.938] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-17 11:35:15,956.956] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-17 11:35:17,439.439] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-17 11:35:17,439.439] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 11:35:17,444.444] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-17 11:35:17,444.444] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 11:35:17,445.445] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-17 11:35:17,446.446] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 11:35:17,447.447] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:35:17,455.455] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:35:17,455.455] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00057s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:35:17,470.470] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:35:17,470.470] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00039s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:35:17,477.477] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:35:17,477.477] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00037s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:35:17,484.484] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:35:17,484.484] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00050s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:35:17,487.487] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 11:35:17,488.488] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00032s] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 11:35:17,494.494] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 11:35:17,495.495] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00048s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '今天道琼斯怎么样?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 11:35:17,515.515] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:35:17,597.597] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:35:17,599.599] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:35:17,599.599] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00030s] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:35:17,602.602] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 11:35:17,602.602] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00037s] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 11:35:18,722.722] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:35:18,722.722] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00041s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 11:35:21,465.465] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:35:21,467.467] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00146s] {'pk_1': UUID('d947f874-ffc8-462c-b195-8bb5d68adb06')}
[2025-05-17 11:35:21,468.468] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:35:21] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 11:35:24,768.768] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 11:35:24,769.769] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00048s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'message_id': UUID('d947f874-ffc8-462c-b195-8bb5d68adb06'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.AGENT_THOUGHT: 'agent_thought'>, 'thought': '[{"name": "google_serper", "args": {"query": "Dow Jones Industrial Average performance today"}, "id": "call_vogGqvaesRzzaJfAeH8oA7Zj", "type": "tool_call"}]', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (3559 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "5d1df10e-59a7-434b-9d83-bcf745226ec1", "example": false}}]', 'answer': '', 'latency': 2.624381399999997}
[2025-05-17 11:35:24,774.774] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:35:24,775.775] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:35:24,775.775] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:35:24,775.775] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.177s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:35:24,776.776] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:35:24,777.777] base.py -> _exec_single_context line:1901 [INFO]: [cached since 3.312s ago] {'pk_1': UUID('d947f874-ffc8-462c-b195-8bb5d68adb06')}
[2025-05-17 11:35:24,778.778] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:35:24,778.778] base.py -> _exec_single_context line:1901 [INFO]: [cached since 6.057s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 11:35:24,780.780] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 11:35:24,781.781] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01282s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'message_id': UUID('d947f874-ffc8-462c-b195-8bb5d68adb06'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 2, 'event': <QueueEvent.AGENT_ACTION: 'agent_action'>, 'thought': '', 'observation': '"42,654.74 +331.99 (0.78%)"', 'tool': 'google_serper', 'tool_input': '{"query": "Dow Jones Industrial Average performance today"}', 'message': '{}', 'answer': '', 'latency': 1.4245937999999967}
[2025-05-17 11:35:24,783.783] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:35:24,784.784] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:35:24,785.785] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:35:24,785.785] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.187s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:35:24,786.786] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:35:24,787.787] base.py -> _exec_single_context line:1901 [INFO]: [cached since 3.322s ago] {'pk_1': UUID('d947f874-ffc8-462c-b195-8bb5d68adb06')}
[2025-05-17 11:35:24,787.787] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:35:24,788.788] base.py -> _exec_single_context line:1901 [INFO]: [cached since 6.066s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 11:35:24,789.789] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 11:35:24,789.789] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.02074s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'message_id': UUID('d947f874-ffc8-462c-b195-8bb5d68adb06'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 3, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': '今天道琼斯工业平均指数为42,654.74，上涨了331.99点，涨幅为0.78%。', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (4746 characters truncated) ... ogle_serper", "id": "258da5e6-2069-4ea0-af37-d8a6a5439e10", "tool_call_id": "call_vogGqvaesRzzaJfAeH8oA7Zj", "artifact": null, "status": "success"}}]', 'answer': '今天道琼斯工业平均指数为42,654.74，上涨了331.99点，涨幅为0.78%。', 'latency': 1.8681349000000012}
[2025-05-17 11:35:24,792.792] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:35:24,793.793] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:35:24,794.794] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:35:24,794.794] base.py -> _exec_single_context line:1901 [INFO]: [cached since 3.329s ago] {'pk_1': UUID('d947f874-ffc8-462c-b195-8bb5d68adb06')}
[2025-05-17 11:35:24,796.796] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s WHERE message.id = %(message_id)s::UUID
[2025-05-17 11:35:24,796.796] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00041s] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (4746 characters truncated) ... ogle_serper", "id": "258da5e6-2069-4ea0-af37-d8a6a5439e10", "tool_call_id": "call_vogGqvaesRzzaJfAeH8oA7Zj", "artifact": null, "status": "success"}}]', 'answer': '今天道琼斯工业平均指数为42,654.74，上涨了331.99点，涨幅为0.78%。', 'message_id': UUID('d947f874-ffc8-462c-b195-8bb5d68adb06')}
[2025-05-17 11:35:24,799.799] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:36:41,958.958] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:36:41,959.959] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:36:41,960.960] base.py -> _exec_single_context line:1901 [INFO]: [cached since 84.51s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:36:41,962.962] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:36:41,962.962] base.py -> _exec_single_context line:1901 [INFO]: [cached since 84.49s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:36:41,964.964] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:36:41,964.964] base.py -> _exec_single_context line:1901 [INFO]: [cached since 84.49s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:36:41,966.966] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:36:41,966.966] base.py -> _exec_single_context line:1901 [INFO]: [cached since 84.48s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:36:41,968.968] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 11:36:41,968.968] base.py -> _exec_single_context line:1901 [INFO]: [cached since 84.48s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 11:36:41,970.970] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 11:36:41,971.971] base.py -> _exec_single_context line:1901 [INFO]: [cached since 84.48s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '今天标普500怎么样?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 11:36:41,974.974] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:36:42,047.047] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:36:42,047.047] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:36:42,048.048] base.py -> _exec_single_context line:1901 [INFO]: [cached since 84.45s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:36:42,049.049] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 11:36:42,050.050] base.py -> _exec_single_context line:1901 [INFO]: [cached since 84.45s ago] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 11:36:42,053.053] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:36:42,053.053] base.py -> _exec_single_context line:1901 [INFO]: [cached since 83.33s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 11:36:44,846.846] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:36:44,848.848] base.py -> _exec_single_context line:1901 [INFO]: [cached since 83.38s ago] {'pk_1': UUID('bd4c36a8-9195-4547-b2d4-5fd4fef24288')}
[2025-05-17 11:36:44,850.850] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:36:44] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 11:36:48,713.713] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 11:36:48,714.714] base.py -> _exec_single_context line:1901 [INFO]: [cached since 83.95s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'message_id': UUID('bd4c36a8-9195-4547-b2d4-5fd4fef24288'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.AGENT_THOUGHT: 'agent_thought'>, 'thought': '[{"name": "google_serper", "args": {"query": "\\u4eca\\u65e5\\u6807\\u666e500\\u6307\\u6570"}, "id": "call_Ns4UANThcRfGLRWvtH3z4uuQ", "type": "tool_call"}]', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (4226 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "04cbdda7-d4b4-47d0-9707-67de0af55522", "example": false}}]', 'answer': '', 'latency': 2.7724726000000146}
[2025-05-17 11:36:48,718.718] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:36:48,719.719] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:36:48,720.720] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:36:48,720.720] base.py -> _exec_single_context line:1901 [INFO]: [cached since 91.12s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:36:48,722.722] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:36:48,722.722] base.py -> _exec_single_context line:1901 [INFO]: [cached since 87.26s ago] {'pk_1': UUID('bd4c36a8-9195-4547-b2d4-5fd4fef24288')}
[2025-05-17 11:36:48,723.723] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:36:48,724.724] base.py -> _exec_single_context line:1901 [INFO]: [cached since 90s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 11:36:48,725.725] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 11:36:48,725.725] base.py -> _exec_single_context line:1901 [INFO]: [cached since 83.96s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'message_id': UUID('bd4c36a8-9195-4547-b2d4-5fd4fef24288'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 2, 'event': <QueueEvent.AGENT_ACTION: 'agent_action'>, 'thought': '', 'observation': '"5,958.38 +41.45 (0.70%)"', 'tool': 'google_serper', 'tool_input': '{"query": "\\u4eca\\u65e5\\u6807\\u666e500\\u6307\\u6570"}', 'message': '{}', 'answer': '', 'latency': 1.774657999999988}
[2025-05-17 11:36:48,728.728] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:36:48,729.729] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:36:48,729.729] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:36:48,730.730] base.py -> _exec_single_context line:1901 [INFO]: [cached since 91.13s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:36:48,731.731] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:36:48,731.731] base.py -> _exec_single_context line:1901 [INFO]: [cached since 87.27s ago] {'pk_1': UUID('bd4c36a8-9195-4547-b2d4-5fd4fef24288')}
[2025-05-17 11:36:48,733.733] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:36:48,733.733] base.py -> _exec_single_context line:1901 [INFO]: [cached since 90.01s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 11:36:48,733.733] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 11:36:48,733.733] base.py -> _exec_single_context line:1901 [INFO]: [cached since 83.97s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'message_id': UUID('bd4c36a8-9195-4547-b2d4-5fd4fef24288'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 3, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': '今天标普500指数为5,958.38，上涨了41.45点，涨幅为0.70%。', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (5247 characters truncated) ... ogle_serper", "id": "461ad93e-c608-40b0-b2ae-42cc23661443", "tool_call_id": "call_Ns4UANThcRfGLRWvtH3z4uuQ", "artifact": null, "status": "success"}}]', 'answer': '今天标普500指数为5,958.38，上涨了41.45点，涨幅为0.70%。', 'latency': 2.084185700000006}
[2025-05-17 11:36:48,739.739] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:36:48,740.740] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:36:48,740.740] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:36:48,741.741] base.py -> _exec_single_context line:1901 [INFO]: [cached since 87.28s ago] {'pk_1': UUID('bd4c36a8-9195-4547-b2d4-5fd4fef24288')}
[2025-05-17 11:36:48,742.742] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s WHERE message.id = %(message_id)s::UUID
[2025-05-17 11:36:48,748.748] base.py -> _exec_single_context line:1901 [INFO]: [cached since 83.95s ago] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (5247 characters truncated) ... ogle_serper", "id": "461ad93e-c608-40b0-b2ae-42cc23661443", "tool_call_id": "call_Ns4UANThcRfGLRWvtH3z4uuQ", "artifact": null, "status": "success"}}]', 'answer': '今天标普500指数为5,958.38，上涨了41.45点，涨幅为0.70%。', 'message_id': UUID('bd4c36a8-9195-4547-b2d4-5fd4fef24288')}
[2025-05-17 11:36:48,751.751] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:43:22,402.402] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:43:22,403.403] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:43:22,403.403] base.py -> _exec_single_context line:1901 [INFO]: [cached since 485s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:43:22,405.405] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:43:22,405.405] base.py -> _exec_single_context line:1901 [INFO]: [cached since 484.9s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:43:22,407.407] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:43:22,408.408] base.py -> _exec_single_context line:1901 [INFO]: [cached since 484.9s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:43:22,410.410] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:43:22,410.410] base.py -> _exec_single_context line:1901 [INFO]: [cached since 484.9s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:43:22,417.417] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 11:43:22,417.417] base.py -> _exec_single_context line:1901 [INFO]: [cached since 484.9s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 11:43:22,419.419] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 11:43:22,419.419] base.py -> _exec_single_context line:1901 [INFO]: [cached since 484.9s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '敏感词1', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 11:43:22,422.422] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:43:22,499.499] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:43:22,499.499] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:43:22,500.500] base.py -> _exec_single_context line:1901 [INFO]: [cached since 484.9s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:43:22,501.501] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 11:43:22,502.502] base.py -> _exec_single_context line:1901 [INFO]: [cached since 484.9s ago] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 11:43:22,504.504] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:43:22,505.505] base.py -> _exec_single_context line:1901 [INFO]: [cached since 483.8s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 11:43:25,035.035] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:43:25,042.042] base.py -> _exec_single_context line:1901 [INFO]: [cached since 483.6s ago] {'pk_1': UUID('64b2c779-f084-4b98-9f85-57d7660bfd21')}
[2025-05-17 11:43:25,043.043] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:43:25] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 11:43:25,068.068] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 11:43:25,069.069] base.py -> _exec_single_context line:1901 [INFO]: [cached since 480.3s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'message_id': UUID('64b2c779-f084-4b98-9f85-57d7660bfd21'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': '请问您具体想了解关于“敏感词1”的哪些信息？我会根据您的需求提供相关内容。', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (4828 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "e6b73d96-bd30-420a-94fd-d99fc5ca9bb9", "example": false}}]', 'answer': '请问您具体想了解关于“敏感词1”的哪些信息？我会根据您的需求提供相关内容。', 'latency': 2.5150520000000824}
[2025-05-17 11:43:25,071.071] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:43:25,073.073] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:43:25,073.073] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:43:25,073.073] base.py -> _exec_single_context line:1901 [INFO]: [cached since 483.6s ago] {'pk_1': UUID('64b2c779-f084-4b98-9f85-57d7660bfd21')}
[2025-05-17 11:43:25,076.076] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s WHERE message.id = %(message_id)s::UUID
[2025-05-17 11:43:25,076.076] base.py -> _exec_single_context line:1901 [INFO]: [cached since 480.3s ago] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (4828 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "e6b73d96-bd30-420a-94fd-d99fc5ca9bb9", "example": false}}]', 'answer': '请问您具体想了解关于“敏感词1”的哪些信息？我会根据您的需求提供相关内容。', 'message_id': UUID('64b2c779-f084-4b98-9f85-57d7660bfd21')}
[2025-05-17 11:43:25,082.082] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:44:50,197.197] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:44:50,198.198] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:44:50,199.199] base.py -> _exec_single_context line:1901 [INFO]: [cached since 572.7s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:44:50,201.201] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:44:50,201.201] base.py -> _exec_single_context line:1901 [INFO]: [cached since 572.7s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:44:50,204.204] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-17 11:44:50,204.204] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00050s] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:44:50,205.205] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 256, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 963, in _validate_draft_app_config
    raise ValidateErrorException("输入审核和输出审核至少需要开启一项")
internal.exception.exception.ValidateErrorException
[2025-05-17 11:44:50,213.213] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 11:44:50,214.214] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:44:50] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-17 11:45:06,668.668] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:45:06,668.668] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:45:06,668.668] base.py -> _exec_single_context line:1901 [INFO]: [cached since 589.2s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:45:06,670.670] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:45:06,670.670] base.py -> _exec_single_context line:1901 [INFO]: [cached since 589.2s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:45:06,671.671] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-17 11:45:06,671.671] base.py -> _exec_single_context line:1901 [INFO]: [cached since 16.47s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:45:06,672.672] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:45:06,672.672] base.py -> _exec_single_context line:1901 [INFO]: [cached since 589.2s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:45:06,675.675] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET review_config=%(review_config)s::JSONB, updated_at=%(updated_at)s WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-17 11:45:06,681.681] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00589s] {'review_config': '{"enable": true, "keywords": ["\\u654f\\u611f\\u8bcd1", "\\u654f\\u611f\\u8bcd2"], "inputs_config": {"enable": true, "preset_response": "\\u9884\\u8bbe\\u54cd\\u5e94"}, "outputs_config": {"enable": false}}', 'updated_at': datetime.datetime(2025, 5, 17, 11, 45, 6, 674237), 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-17 11:45:06,685.685] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:45:06,687.687] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:45:06] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-17 11:45:09,441.441] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:45:09,442.442] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:45:09,442.442] base.py -> _exec_single_context line:1901 [INFO]: [cached since 592s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:45:09,445.445] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:45:09,446.446] base.py -> _exec_single_context line:1901 [INFO]: [cached since 592s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:45:09,447.447] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:45:09,448.448] base.py -> _exec_single_context line:1901 [INFO]: [cached since 592s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:45:09,449.449] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:45:09,449.449] base.py -> _exec_single_context line:1901 [INFO]: [cached since 592s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:45:09,451.451] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 11:45:09,452.452] base.py -> _exec_single_context line:1901 [INFO]: [cached since 592s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 11:45:09,453.453] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 11:45:09,454.454] base.py -> _exec_single_context line:1901 [INFO]: [cached since 592s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '敏感词1', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 11:45:09,457.457] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:45:09,458.458] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:45:09,459.459] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:45:09,459.459] base.py -> _exec_single_context line:1901 [INFO]: [cached since 591.9s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:45:09,461.461] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:45:09,462.462] base.py -> _exec_single_context line:1901 [INFO]: [cached since 588s ago] {'pk_1': UUID('24c8ed54-14bf-48d0-ba55-c3bc7add0f96')}
[2025-05-17 11:45:09,463.463] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:45:09] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 11:45:09,468.468] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET answer=%(answer)s WHERE message.id = %(message_id)s::UUID
[2025-05-17 11:45:09,468.468] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00036s] {'answer': '预设响应', 'message_id': UUID('24c8ed54-14bf-48d0-ba55-c3bc7add0f96')}
[2025-05-17 11:45:09,469.469] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:47:50,232.232] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:47:50,233.233] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:47:50,233.233] base.py -> _exec_single_context line:1901 [INFO]: [cached since 752.8s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:47:50,235.235] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:47:50,235.235] base.py -> _exec_single_context line:1901 [INFO]: [cached since 752.8s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:47:50,237.237] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-17 11:47:50,237.237] base.py -> _exec_single_context line:1901 [INFO]: [cached since 180s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:47:50,238.238] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:47:50,238.238] base.py -> _exec_single_context line:1901 [INFO]: [cached since 752.8s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:47:50,240.240] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET long_term_memory=%(long_term_memory)s::JSONB, review_config=%(review_config)s::JSONB, updated_at=%(updated_at)s WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-17 11:47:50,240.240] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00037s] {'long_term_memory': '{"enable": true}', 'review_config': '{"enable": true, "keywords": ["\\u654f\\u611f\\u8bcd1", "\\u654f\\u611f\\u8bcd2"], "inputs_config": {"enable": true, "preset_response": "\\u60a8\\u8f93\\u5165\\u4e86\\u654f\\u611f\\u8bcd"}, "outputs_config": {"enable": false}}', 'updated_at': datetime.datetime(2025, 5, 17, 11, 47, 50, 239020), 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-17 11:47:50,241.241] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:47:50,252.252] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:47:50] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-17 11:48:43,099.099] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:48:43,100.100] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:48:43,100.100] base.py -> _exec_single_context line:1901 [INFO]: [cached since 805.7s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:48:43,102.102] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:48:43,102.102] base.py -> _exec_single_context line:1901 [INFO]: [cached since 805.6s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:48:43,103.103] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:48:43,104.104] base.py -> _exec_single_context line:1901 [INFO]: [cached since 805.6s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:48:43,105.105] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:48:43,105.105] base.py -> _exec_single_context line:1901 [INFO]: [cached since 805.6s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:48:43,106.106] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 11:48:43,108.108] base.py -> _exec_single_context line:1901 [INFO]: [cached since 805.6s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 11:48:43,109.109] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 11:48:43,110.110] base.py -> _exec_single_context line:1901 [INFO]: [cached since 805.6s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '纳斯达克100和magnificent7的10年内平均增幅分别是多少?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 11:48:43,112.112] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:48:43,168.168] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:48:43,168.168] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:48:43,168.168] base.py -> _exec_single_context line:1901 [INFO]: [cached since 805.6s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:48:43,170.170] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 11:48:43,171.171] base.py -> _exec_single_context line:1901 [INFO]: [cached since 805.6s ago] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 11:48:43,174.174] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:48:43,174.174] base.py -> _exec_single_context line:1901 [INFO]: [cached since 804.5s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 11:48:43,201.201] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:48:43,209.209] base.py -> _exec_single_context line:1901 [INFO]: [cached since 801.7s ago] {'pk_1': UUID('2d9e862a-21f6-4ac0-becd-7cbb2329f6fd')}
[2025-05-17 11:48:43,210.210] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:48:43] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 11:48:47,439.439] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:48:47,439.439] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-17 11:48:47,439.439] base.py -> _exec_single_context line:1901 [INFO]: [cached since 237.2s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:48:47,955.955] base.py -> similarity_search_with_relevance_scores line:575 [WARNING]: No relevant docs were retrieved using the relevance score threshold 0.7
[2025-05-17 11:48:47,957.957] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (NULL) AND (1 != 1)
[2025-05-17 11:48:47,957.957] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00038s] {'hit_count_1': 1}
[2025-05-17 11:48:47,961.961] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:48:47,963.963] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:48:47,963.963] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-17 11:48:47,963.963] base.py -> _exec_single_context line:1901 [INFO]: [cached since 237.8s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:48:48,025.025] base.py -> similarity_search_with_relevance_scores line:575 [WARNING]: No relevant docs were retrieved using the relevance score threshold 0.7
[2025-05-17 11:48:48,027.027] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (NULL) AND (1 != 1)
[2025-05-17 11:48:48,028.028] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.07081s ago] {'hit_count_1': 1}
[2025-05-17 11:48:48,029.029] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:48:50,427.427] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 11:48:50,428.428] base.py -> _exec_single_context line:1901 [INFO]: [cached since 805.7s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'message_id': UUID('2d9e862a-21f6-4ac0-becd-7cbb2329f6fd'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-05-17 11:48:50,431.431] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:48:50,432.432] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:48:50,432.432] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:48:50,433.433] base.py -> _exec_single_context line:1901 [INFO]: [cached since 812.8s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:48:50,434.434] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:48:50,435.435] base.py -> _exec_single_context line:1901 [INFO]: [cached since 809s ago] {'pk_1': UUID('2d9e862a-21f6-4ac0-becd-7cbb2329f6fd')}
[2025-05-17 11:48:50,436.436] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:48:50,437.437] base.py -> _exec_single_context line:1901 [INFO]: [cached since 811.7s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 11:48:50,439.439] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 11:48:50,439.439] base.py -> _exec_single_context line:1901 [INFO]: [cached since 805.7s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'message_id': UUID('2d9e862a-21f6-4ac0-becd-7cbb2329f6fd'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 2, 'event': <QueueEvent.AGENT_THOUGHT: 'agent_thought'>, 'thought': '[{"name": "dataset_retrieval", "args": {"query": "\\u7eb3\\u65af\\u8fbe\\u514b100 10\\u5e74\\u5185\\u5e73\\u5747\\u589e\\u5e45"}, "id": "call_ByNzO19 ... (64 characters truncated) ... ieval", "args": {"query": "Magnificent 7 10\\u5e74\\u5185\\u5e73\\u5747\\u589e\\u5e45"}, "id": "call_wZFD04JgeRPwmyTbnAWFZcYP", "type": "tool_call"}]', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (6148 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "20c59ef8-0ab9-46b4-ac44-73215ecabb1b", "example": false}}]', 'answer': '', 'latency': 4.195412600000054}
[2025-05-17 11:48:50,452.452] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:48:50,453.453] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:48:50,454.454] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:48:50,454.454] base.py -> _exec_single_context line:1901 [INFO]: [cached since 812.9s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:48:50,455.455] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:48:50,455.455] base.py -> _exec_single_context line:1901 [INFO]: [cached since 809s ago] {'pk_1': UUID('2d9e862a-21f6-4ac0-becd-7cbb2329f6fd')}
[2025-05-17 11:48:50,456.456] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:48:50,456.456] base.py -> _exec_single_context line:1901 [INFO]: [cached since 811.7s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 11:48:50,464.464] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 11:48:50,464.464] base.py -> _exec_single_context line:1901 [INFO]: [cached since 805.7s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'message_id': UUID('2d9e862a-21f6-4ac0-becd-7cbb2329f6fd'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 3, 'event': <QueueEvent.DATASET_RETRIEVAL: 'dataset_retrieval'>, 'thought': '', 'observation': '"\\u77e5\\u8bc6\\u5e93\\u5185\\u6ca1\\u6709\\u68c0\\u7d22\\u5230\\u5bf9\\u5e94\\u5185\\u5bb9"', 'tool': 'dataset_retrieval', 'tool_input': '{"query": "\\u7eb3\\u65af\\u8fbe\\u514b100 10\\u5e74\\u5185\\u5e73\\u5747\\u589e\\u5e45"}', 'message': '{}', 'answer': '', 'latency': 0.57279989999995}
[2025-05-17 11:48:50,465.465] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:48:50,466.466] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:48:50,466.466] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:48:50,466.466] base.py -> _exec_single_context line:1901 [INFO]: [cached since 812.9s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:48:50,467.467] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:48:50,467.467] base.py -> _exec_single_context line:1901 [INFO]: [cached since 809s ago] {'pk_1': UUID('2d9e862a-21f6-4ac0-becd-7cbb2329f6fd')}
[2025-05-17 11:48:50,468.468] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:48:50,477.477] base.py -> _exec_single_context line:1901 [INFO]: [cached since 811.8s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 11:48:50,479.479] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 11:48:50,479.479] base.py -> _exec_single_context line:1901 [INFO]: [cached since 805.7s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'message_id': UUID('2d9e862a-21f6-4ac0-becd-7cbb2329f6fd'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 4, 'event': <QueueEvent.DATASET_RETRIEVAL: 'dataset_retrieval'>, 'thought': '', 'observation': '"\\u77e5\\u8bc6\\u5e93\\u5185\\u6ca1\\u6709\\u68c0\\u7d22\\u5230\\u5bf9\\u5e94\\u5185\\u5bb9"', 'tool': 'dataset_retrieval', 'tool_input': '{"query": "Magnificent 7 10\\u5e74\\u5185\\u5e73\\u5747\\u589e\\u5e45"}', 'message': '{}', 'answer': '', 'latency': 0.06801480000001447}
[2025-05-17 11:48:50,481.481] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:48:50,482.482] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:48:50,482.482] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:48:50,483.483] base.py -> _exec_single_context line:1901 [INFO]: [cached since 812.9s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:48:50,484.484] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:48:50,492.492] base.py -> _exec_single_context line:1901 [INFO]: [cached since 809s ago] {'pk_1': UUID('2d9e862a-21f6-4ac0-becd-7cbb2329f6fd')}
[2025-05-17 11:48:50,493.493] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:48:50,493.493] base.py -> _exec_single_context line:1901 [INFO]: [cached since 811.8s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 11:48:50,495.495] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 11:48:50,495.495] base.py -> _exec_single_context line:1901 [INFO]: [cached since 805.7s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'message_id': UUID('2d9e862a-21f6-4ac0-becd-7cbb2329f6fd'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 5, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': '抱歉，我无法找到纳斯达克100和Magnificent 7在过去10年内的平均增幅数据。您可以考虑查看相关的金融网站或投资平台以获取最新的市场信息。', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (8117 characters truncated) ... t_retrieval", "id": "02ca996a-cfc5-4920-950c-e7a2b1936fef", "tool_call_id": "call_wZFD04JgeRPwmyTbnAWFZcYP", "artifact": null, "status": "success"}}]', 'answer': '抱歉，我无法找到纳斯达克100和Magnificent 7在过去10年内的平均增幅数据。您可以考虑查看相关的金融网站或投资平台以获取最新的市场信息。', 'latency': 2.360975200000098}
[2025-05-17 11:48:50,498.498] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:48:50,499.499] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:48:50,499.499] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:48:50,508.508] base.py -> _exec_single_context line:1901 [INFO]: [cached since 809s ago] {'pk_1': UUID('2d9e862a-21f6-4ac0-becd-7cbb2329f6fd')}
[2025-05-17 11:48:50,509.509] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s WHERE message.id = %(message_id)s::UUID
[2025-05-17 11:48:50,511.511] base.py -> _exec_single_context line:1901 [INFO]: [cached since 805.7s ago] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (8117 characters truncated) ... t_retrieval", "id": "02ca996a-cfc5-4920-950c-e7a2b1936fef", "tool_call_id": "call_wZFD04JgeRPwmyTbnAWFZcYP", "artifact": null, "status": "success"}}]', 'answer': '抱歉，我无法找到纳斯达克100和Magnificent 7在过去10年内的平均增幅数据。您可以考虑查看相关的金融网站或投资平台以获取最新的市场信息。', 'message_id': UUID('2d9e862a-21f6-4ac0-becd-7cbb2329f6fd')}
[2025-05-17 11:48:50,512.512] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:48:50,513.513] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:48:50,514.514] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:48:50,514.514] base.py -> _exec_single_context line:1901 [INFO]: [cached since 812.9s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:48:54,209.209] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(message.id) AS count_1 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID
[2025-05-17 11:48:54,211.211] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00058s] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:48:54,222.222] base.py -> _exec_single_context line:1896 [INFO]: UPDATE conversation SET summary=%(summary)s WHERE conversation.id = %(conversation_id)s::UUID
[2025-05-17 11:48:54,222.222] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00032s] {'summary': '人类询问纳斯达克100和Magnificent 7的10年内平均增幅数据，AI表示无法提供具体数据并建议查询金融网站或投资平台获取最新市场信息。', 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:48:54,224.224] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:50:19,139.139] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\conversation_service.py', reloading
[2025-05-17 11:50:20,738.738] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-17 11:51:18,246.246] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-17 11:51:18,264.264] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-17 11:51:20,414.414] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-17 11:51:20,415.415] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 11:51:20,420.420] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-17 11:51:20,420.420] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 11:51:20,422.422] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-17 11:51:20,422.422] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 11:51:20,423.423] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:51:20,431.431] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:51:20,431.431] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00073s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:51:20,448.448] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:51:20,448.448] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00060s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:51:20,455.455] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:51:20,455.455] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00071s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:51:20,462.462] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:51:20,462.462] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00055s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:51:20,466.466] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 11:51:20,467.467] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00055s] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 11:51:20,475.475] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 11:51:20,476.476] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00059s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '纳斯达克100增幅', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 11:51:20,496.496] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:51:20,597.597] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:51:20,598.598] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:51:20,599.599] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00057s] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:51:20,603.603] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 11:51:20,603.603] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00048s] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 11:51:21,606.606] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:51:21,606.606] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00077s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 11:51:21,941.941] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:51:21,942.942] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00085s] {'pk_1': UUID('b62c75f7-4898-4019-a565-76c2cbf17c54')}
[2025-05-17 11:51:21,961.961] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:51:21] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 11:51:28,674.674] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 11:51:28,674.674] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00045s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'message_id': UUID('b62c75f7-4898-4019-a565-76c2cbf17c54'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': '人类询问纳斯达克100和Magnificent 7的10年内平均增幅数据，AI表示无法提供具体数据并建议查询金融网站或投资平台获取最新市场信息。', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-05-17 11:51:28,679.679] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:51:28,680.680] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:51:28,680.680] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:51:28,680.680] base.py -> _exec_single_context line:1901 [INFO]: [cached since 8.082s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:51:28,681.681] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:51:28,681.681] base.py -> _exec_single_context line:1901 [INFO]: [cached since 6.74s ago] {'pk_1': UUID('b62c75f7-4898-4019-a565-76c2cbf17c54')}
[2025-05-17 11:51:28,682.682] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:51:28,682.682] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.077s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 11:51:28,682.682] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 11:51:28,684.684] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.008804s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'message_id': UUID('b62c75f7-4898-4019-a565-76c2cbf17c54'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 2, 'event': <QueueEvent.AGENT_THOUGHT: 'agent_thought'>, 'thought': '[{"name": "google_serper", "args": {"query": "\\u7eb3\\u65af\\u8fbe\\u514b100\\u6700\\u8fd1\\u589e\\u5e45"}, "id": "call_cafXjJPzb0lzijdyVtBBE0g8", "type": "tool_call"}]', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (7427 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "c55a902d-707d-4f1e-99cc-7f6ed98960ea", "example": false}}]', 'answer': '', 'latency': 2.792084199999998}
[2025-05-17 11:51:28,702.702] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:51:28,703.703] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:51:28,703.703] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:51:28,704.704] base.py -> _exec_single_context line:1901 [INFO]: [cached since 8.106s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:51:28,706.706] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:51:28,706.706] base.py -> _exec_single_context line:1901 [INFO]: [cached since 6.766s ago] {'pk_1': UUID('b62c75f7-4898-4019-a565-76c2cbf17c54')}
[2025-05-17 11:51:28,707.707] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:51:28,707.707] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.103s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 11:51:28,708.708] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 11:51:28,711.711] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.03687s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'message_id': UUID('b62c75f7-4898-4019-a565-76c2cbf17c54'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 3, 'event': <QueueEvent.AGENT_ACTION: 'agent_action'>, 'thought': '', 'observation': '"\\u7eb3\\u65af\\u8fbe\\u514b100\\u6307\\u6570\\u5386\\u53f2\\u6570\\u636e ; 5\\u670804, 2025, 19,967.94, 19,928.82 ; 5\\u670801, 2025, 20,102.61, 19 ... (3910 characters truncated) ... \\u6578-\\u9010\\u5b63\\u9810\\u4f30EPS (\\u5e74\\u589e\\u7387,R). 2026-Q4. 14.16 ; NASDAQ 100 (200\\u65e5\\u56de\\u6a94\\u5e45\\u5ea6,L). 2025- ..."', 'tool': 'google_serper', 'tool_input': '{"query": "\\u7eb3\\u65af\\u8fbe\\u514b100\\u6700\\u8fd1\\u589e\\u5e45"}', 'message': '{}', 'answer': '', 'latency': 1.3539743999999985}
[2025-05-17 11:51:28,715.715] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:51:28,716.716] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:51:28,716.716] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:51:28,716.716] base.py -> _exec_single_context line:1901 [INFO]: [cached since 8.118s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:51:28,717.717] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:51:28,718.718] base.py -> _exec_single_context line:1901 [INFO]: [cached since 6.777s ago] {'pk_1': UUID('b62c75f7-4898-4019-a565-76c2cbf17c54')}
[2025-05-17 11:51:28,719.719] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:51:28,719.719] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.114s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 11:51:28,720.720] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 11:51:28,727.727] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.05214s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'message_id': UUID('b62c75f7-4898-4019-a565-76c2cbf17c54'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 4, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': '最近纳斯达克100指数的增幅为7.15%。在过去的一周内，纳斯达克100指数上涨了3.41%。如果需要更详细的历史数据或其他信息，请告知我！', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (13693 characters truncated) ... ogle_serper", "id": "39bb8627-82cd-4537-bdc4-c3a3e3b21181", "tool_call_id": "call_cafXjJPzb0lzijdyVtBBE0g8", "artifact": null, "status": "success"}}]', 'answer': '最近纳斯达克100指数的增幅为7.15%。在过去的一周内，纳斯达克100指数上涨了3.41%。如果需要更详细的历史数据或其他信息，请告知我！', 'latency': 2.552454200000014}
[2025-05-17 11:51:28,731.731] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:51:28,732.732] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:51:28,732.732] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:51:28,732.732] base.py -> _exec_single_context line:1901 [INFO]: [cached since 6.791s ago] {'pk_1': UUID('b62c75f7-4898-4019-a565-76c2cbf17c54')}
[2025-05-17 11:51:28,734.734] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s WHERE message.id = %(message_id)s::UUID
[2025-05-17 11:51:28,735.735] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00038s] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (13693 characters truncated) ... ogle_serper", "id": "39bb8627-82cd-4537-bdc4-c3a3e3b21181", "tool_call_id": "call_cafXjJPzb0lzijdyVtBBE0g8", "artifact": null, "status": "success"}}]', 'answer': '最近纳斯达克100指数的增幅为7.15%。在过去的一周内，纳斯达克100指数上涨了3.41%。如果需要更详细的历史数据或其他信息，请告知我！', 'message_id': UUID('b62c75f7-4898-4019-a565-76c2cbf17c54')}
[2025-05-17 11:51:28,747.747] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:51:28,748.748] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:51:28,748.748] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:51:28,748.748] base.py -> _exec_single_context line:1901 [INFO]: [cached since 8.15s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:51:34,172.172] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(message.id) AS count_1 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID
[2025-05-17 11:51:34,172.172] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00043s] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:51:34,174.174] base.py -> _exec_single_context line:1896 [INFO]: UPDATE conversation SET summary=%(summary)s WHERE conversation.id = %(conversation_id)s::UUID
[2025-05-17 11:51:34,174.174] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00038s] {'summary': '人类询问纳斯达克100和Magnificent 7的10年内平均增幅数据，AI表示无法提供具体数据并建议查询金融网站或投资平台获取最新市场信息。随后人类询问纳斯达克100近期增幅，AI提供了最近纳斯达克100指数7.15%的增幅数据以及过去一周3.41%的上涨情况，并表示可提供更详细的历史数据。', 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:51:34,174.174] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:52:08,355.355] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:52:08,356.356] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:52:08,356.356] base.py -> _exec_single_context line:1901 [INFO]: [cached since 47.93s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:52:08,359.359] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:52:08,359.359] base.py -> _exec_single_context line:1901 [INFO]: [cached since 47.91s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:52:08,361.361] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-17 11:52:08,361.361] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00034s] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:52:08,362.362] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:52:08,362.362] base.py -> _exec_single_context line:1901 [INFO]: [cached since 47.91s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:52:08,363.363] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET updated_at=%(updated_at)s WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-17 11:52:08,363.363] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00028s] {'updated_at': datetime.datetime(2025, 5, 17, 11, 52, 8, 362493), 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-17 11:52:08,365.365] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:52:08,366.366] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:52:08] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-17 11:52:33,557.557] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:52:33,557.557] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:52:33,558.558] base.py -> _exec_single_context line:1901 [INFO]: [cached since 73.13s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:52:33,559.559] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:52:33,560.560] base.py -> _exec_single_context line:1901 [INFO]: [cached since 73.11s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:52:33,561.561] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:52:33,561.561] base.py -> _exec_single_context line:1901 [INFO]: [cached since 73.11s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:52:33,562.562] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:52:33,562.562] base.py -> _exec_single_context line:1901 [INFO]: [cached since 73.1s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:52:33,564.564] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 11:52:33,564.564] base.py -> _exec_single_context line:1901 [INFO]: [cached since 73.1s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 11:52:33,565.565] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 11:52:33,565.565] base.py -> _exec_single_context line:1901 [INFO]: [cached since 73.09s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': 'LLMOPS是什么?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 11:52:33,568.568] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:52:33,617.617] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:52:33,618.618] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:52:33,618.618] base.py -> _exec_single_context line:1901 [INFO]: [cached since 73.02s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:52:33,620.620] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 11:52:33,620.620] base.py -> _exec_single_context line:1901 [INFO]: [cached since 73.02s ago] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 11:52:33,624.624] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:52:33,624.624] base.py -> _exec_single_context line:1901 [INFO]: [cached since 72.02s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 11:52:33,642.642] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:52:33,656.656] base.py -> _exec_single_context line:1901 [INFO]: [cached since 71.72s ago] {'pk_1': UUID('e57f2d91-83b4-4a56-ad1f-96047c30e2fa')}
[2025-05-17 11:52:33,665.665] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:52:33] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 11:52:36,553.553] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:52:36,554.554] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-17 11:52:36,555.555] base.py -> _exec_single_context line:1901 [INFO]: [cached since 28.19s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:52:36,855.855] base.py -> similarity_search_with_relevance_scores line:575 [WARNING]: No relevant docs were retrieved using the relevance score threshold 0.7
[2025-05-17 11:52:36,859.859] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (NULL) AND (1 != 1)
[2025-05-17 11:52:36,859.859] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00078s] {'hit_count_1': 1}
[2025-05-17 11:52:36,862.862] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:52:39,733.733] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 11:52:39,734.734] base.py -> _exec_single_context line:1901 [INFO]: [cached since 71.06s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'message_id': UUID('e57f2d91-83b4-4a56-ad1f-96047c30e2fa'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': '人类询问纳斯达克100和Magnificent 7的10年内平均增幅数据，AI表示无法提供具体数据并建议查询金融网站或投资平台获取最新市场信息。随后人类询问纳斯达克100近期增幅，AI提供了最近纳斯达克100指数7.15%的增幅数据以及过去一周3.41%的上涨情况，并表示可提供更详细的历史数据。', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-05-17 11:52:39,735.735] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:52:39,736.736] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:52:39,737.737] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:52:39,737.737] base.py -> _exec_single_context line:1901 [INFO]: [cached since 79.14s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:52:39,738.738] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:52:39,739.739] base.py -> _exec_single_context line:1901 [INFO]: [cached since 77.8s ago] {'pk_1': UUID('e57f2d91-83b4-4a56-ad1f-96047c30e2fa')}
[2025-05-17 11:52:39,740.740] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:52:39,741.741] base.py -> _exec_single_context line:1901 [INFO]: [cached since 78.14s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 11:52:39,742.742] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 11:52:39,743.743] base.py -> _exec_single_context line:1901 [INFO]: [cached since 71.07s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'message_id': UUID('e57f2d91-83b4-4a56-ad1f-96047c30e2fa'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 2, 'event': <QueueEvent.AGENT_THOUGHT: 'agent_thought'>, 'thought': '[{"name": "dataset_retrieval", "args": {"query": "LLMOPS"}, "id": "call_6rpYWKh3fNwoXt3iQD8v364j", "type": "tool_call"}]', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (8713 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "a058c022-e160-4a2f-bb84-dd0b3114f14d", "example": false}}]', 'answer': '', 'latency': 2.867512699999992}
[2025-05-17 11:52:39,749.749] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:52:39,751.751] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:52:39,751.751] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:52:39,751.751] base.py -> _exec_single_context line:1901 [INFO]: [cached since 79.15s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:52:39,752.752] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:52:39,755.755] base.py -> _exec_single_context line:1901 [INFO]: [cached since 77.81s ago] {'pk_1': UUID('e57f2d91-83b4-4a56-ad1f-96047c30e2fa')}
[2025-05-17 11:52:39,757.757] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:52:39,757.757] base.py -> _exec_single_context line:1901 [INFO]: [cached since 78.15s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 11:52:39,759.759] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 11:52:39,759.759] base.py -> _exec_single_context line:1901 [INFO]: [cached since 71.08s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'message_id': UUID('e57f2d91-83b4-4a56-ad1f-96047c30e2fa'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 3, 'event': <QueueEvent.DATASET_RETRIEVAL: 'dataset_retrieval'>, 'thought': '', 'observation': '"\\u77e5\\u8bc6\\u5e93\\u5185\\u6ca1\\u6709\\u68c0\\u7d22\\u5230\\u5bf9\\u5e94\\u5185\\u5bb9"', 'tool': 'dataset_retrieval', 'tool_input': '{"query": "LLMOPS"}', 'message': '{}', 'answer': '', 'latency': 0.35678249999998}
[2025-05-17 11:52:39,761.761] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:52:39,762.762] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:52:39,763.763] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:52:39,771.771] base.py -> _exec_single_context line:1901 [INFO]: [cached since 79.17s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:52:39,773.773] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:52:39,773.773] base.py -> _exec_single_context line:1901 [INFO]: [cached since 77.83s ago] {'pk_1': UUID('e57f2d91-83b4-4a56-ad1f-96047c30e2fa')}
[2025-05-17 11:52:39,774.774] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:52:39,774.774] base.py -> _exec_single_context line:1901 [INFO]: [cached since 78.17s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 11:52:39,775.775] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 11:52:39,776.776] base.py -> _exec_single_context line:1901 [INFO]: [cached since 71.1s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'message_id': UUID('e57f2d91-83b4-4a56-ad1f-96047c30e2fa'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 4, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': '抱歉，我没有找到关于“LLMOPS”的具体信息。如果您能提供更多上下文或细节，我将更好地帮助您。', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (9762 characters truncated) ... t_retrieval", "id": "481b91e6-4673-4c59-8f5b-7e34ccea84e6", "tool_call_id": "call_6rpYWKh3fNwoXt3iQD8v364j", "artifact": null, "status": "success"}}]', 'answer': '抱歉，我没有找到关于“LLMOPS”的具体信息。如果您能提供更多上下文或细节，我将更好地帮助您。', 'latency': 2.8573874999999873}
[2025-05-17 11:52:39,791.791] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:52:39,793.793] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:52:39,793.793] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:52:39,794.794] base.py -> _exec_single_context line:1901 [INFO]: [cached since 77.85s ago] {'pk_1': UUID('e57f2d91-83b4-4a56-ad1f-96047c30e2fa')}
[2025-05-17 11:52:39,795.795] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s WHERE message.id = %(message_id)s::UUID
[2025-05-17 11:52:39,796.796] base.py -> _exec_single_context line:1901 [INFO]: [cached since 71.06s ago] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (9762 characters truncated) ... t_retrieval", "id": "481b91e6-4673-4c59-8f5b-7e34ccea84e6", "tool_call_id": "call_6rpYWKh3fNwoXt3iQD8v364j", "artifact": null, "status": "success"}}]', 'answer': '抱歉，我没有找到关于“LLMOPS”的具体信息。如果您能提供更多上下文或细节，我将更好地帮助您。', 'message_id': UUID('e57f2d91-83b4-4a56-ad1f-96047c30e2fa')}
[2025-05-17 11:52:39,798.798] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:52:39,799.799] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:52:39,799.799] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:52:39,800.800] base.py -> _exec_single_context line:1901 [INFO]: [cached since 79.2s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:52:44,942.942] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(message.id) AS count_1 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID
[2025-05-17 11:52:44,943.943] base.py -> _exec_single_context line:1901 [INFO]: [cached since 70.77s ago] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:52:44,944.944] base.py -> _exec_single_context line:1896 [INFO]: UPDATE conversation SET summary=%(summary)s WHERE conversation.id = %(conversation_id)s::UUID
[2025-05-17 11:52:44,944.944] base.py -> _exec_single_context line:1901 [INFO]: [cached since 70.77s ago] {'summary': '人类询问纳斯达克100和Magnificent 7的10年内平均增幅数据，AI表示无法提供具体数据并建议查询金融网站或投资平台获取最新市场信息。随后人类询问纳斯达克100近期增幅，AI提供了最近纳斯达克100指数7.15%的增幅数据以及过去一周3.41%的上涨情况，并表示可提供更详细的历史数据。之后人类询问LLMOPS的定义，AI表示未能找到相关信息并请求提供更多上下文以便协助解答。', 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:52:44,945.945] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:54:08,859.859] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:54:08,859.859] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:54:08,859.859] base.py -> _exec_single_context line:1901 [INFO]: [cached since 168.4s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 11:54:08,861.861] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 11:54:08,862.862] base.py -> _exec_single_context line:1901 [INFO]: [cached since 168.4s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 11:54:08,863.863] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 11:54:08,863.863] base.py -> _exec_single_context line:1901 [INFO]: [cached since 168.4s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 11:54:08,864.864] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 11:54:08,864.864] base.py -> _exec_single_context line:1901 [INFO]: [cached since 168.4s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 11:54:08,870.870] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 11:54:08,870.870] base.py -> _exec_single_context line:1901 [INFO]: [cached since 168.4s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 11:54:08,872.872] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 11:54:08,872.872] base.py -> _exec_single_context line:1901 [INFO]: [cached since 168.4s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '纳斯达克100', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 11:54:08,874.874] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:54:08,919.919] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:54:08,919.919] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:54:08,920.920] base.py -> _exec_single_context line:1901 [INFO]: [cached since 168.3s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:54:08,921.921] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 11:54:08,922.922] base.py -> _exec_single_context line:1901 [INFO]: [cached since 168.3s ago] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 11:54:08,927.927] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:54:08,927.927] base.py -> _exec_single_context line:1901 [INFO]: [cached since 167.3s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 11:54:08,947.947] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:54:08,965.965] base.py -> _exec_single_context line:1901 [INFO]: [cached since 167s ago] {'pk_1': UUID('eb364b5b-9988-4216-bc20-ce1eec4d3d60')}
[2025-05-17 11:54:08,967.967] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 11:54:08] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 11:54:17,030.030] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 11:54:17,030.030] base.py -> _exec_single_context line:1901 [INFO]: [cached since 168.4s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'message_id': UUID('eb364b5b-9988-4216-bc20-ce1eec4d3d60'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': '人类询问纳斯达克100和Magnificent 7的10年内平均增幅数据，AI表示无法提供具体数据并建议查询金融网站或投资平台获取最新市场信息。随后人类询问纳斯达克100近期增幅，AI提供了最近纳斯达克100指数7.15%的增幅数据以及过去一周3.41%的上涨情况，并表示可提供更详细的历史数据。之后人类询问LLMOPS的定义，AI表示未能找到相关信息并请求提供更多上下文以便协助解答。', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-05-17 11:54:17,033.033] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:54:17,043.043] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:54:17,043.043] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:54:17,044.044] base.py -> _exec_single_context line:1901 [INFO]: [cached since 176.4s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:54:17,045.045] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:54:17,045.045] base.py -> _exec_single_context line:1901 [INFO]: [cached since 175.1s ago] {'pk_1': UUID('eb364b5b-9988-4216-bc20-ce1eec4d3d60')}
[2025-05-17 11:54:17,046.046] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:54:17,046.046] base.py -> _exec_single_context line:1901 [INFO]: [cached since 175.4s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 11:54:17,047.047] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 11:54:17,047.047] base.py -> _exec_single_context line:1901 [INFO]: [cached since 168.4s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'message_id': UUID('eb364b5b-9988-4216-bc20-ce1eec4d3d60'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 2, 'event': <QueueEvent.AGENT_THOUGHT: 'agent_thought'>, 'thought': '[{"name": "google_serper", "args": {"query": "\\u7eb3\\u65af\\u8fbe\\u514b100\\u4eca\\u65e5\\u589e\\u5e45"}, "id": "call_C03ckD29ciysMQ7aRcd8AG1l", "type": "tool_call"}]', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (9751 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "61d0ce68-9b19-4b94-b7c5-6b90e74269fb", "example": false}}]', 'answer': '', 'latency': 3.426060199999995}
[2025-05-17 11:54:17,050.050] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:54:17,051.051] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:54:17,052.052] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:54:17,052.052] base.py -> _exec_single_context line:1901 [INFO]: [cached since 176.5s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:54:17,053.053] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:54:17,053.053] base.py -> _exec_single_context line:1901 [INFO]: [cached since 175.1s ago] {'pk_1': UUID('eb364b5b-9988-4216-bc20-ce1eec4d3d60')}
[2025-05-17 11:54:17,054.054] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:54:17,054.054] base.py -> _exec_single_context line:1901 [INFO]: [cached since 175.5s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 11:54:17,055.055] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 11:54:17,065.065] base.py -> _exec_single_context line:1901 [INFO]: [cached since 168.4s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'message_id': UUID('eb364b5b-9988-4216-bc20-ce1eec4d3d60'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 3, 'event': <QueueEvent.AGENT_ACTION: 'agent_action'>, 'thought': '', 'observation': '"\\u7eb3\\u65af\\u8fbe\\u514b100\\u4e13\\u9898\\uff0c\\u63d0\\u4f9b\\u7eb3\\u65af\\u8fbe\\u514b100\\u5b9e\\u65f6\\u884c\\u60c5\\uff0c\\u4eca\\u65e5\\ ... (3253 characters truncated) ... u8fbe\\u514b100\\u6307\\u6570\\u4e3b\\u8fde(2506) (NQmain.US)$ \\u4eca\\u5929\\u572821600-21700\\u3002\\u4e0b\\u5468\\u8df3\\u52302.2\\u4e07-2.3 ..."', 'tool': 'google_serper', 'tool_input': '{"query": "\\u7eb3\\u65af\\u8fbe\\u514b100\\u4eca\\u65e5\\u589e\\u5e45"}', 'message': '{}', 'answer': '', 'latency': 1.3454258000000152}
[2025-05-17 11:54:17,068.068] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:54:17,069.069] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:54:17,070.070] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:54:17,070.070] base.py -> _exec_single_context line:1901 [INFO]: [cached since 176.5s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:54:17,072.072] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:54:17,072.072] base.py -> _exec_single_context line:1901 [INFO]: [cached since 175.1s ago] {'pk_1': UUID('eb364b5b-9988-4216-bc20-ce1eec4d3d60')}
[2025-05-17 11:54:17,073.073] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 11:54:17,073.073] base.py -> _exec_single_context line:1901 [INFO]: [cached since 175.5s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 11:54:17,075.075] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 11:54:17,079.079] base.py -> _exec_single_context line:1901 [INFO]: [cached since 168.4s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'message_id': UUID('eb364b5b-9988-4216-bc20-ce1eec4d3d60'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 4, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': '今天纳斯达克100指数为21,335.82，上涨了16.62点，涨幅为0.08%。如果您需要更多关于纳斯达克100的信息，请告诉我！', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (15172 characters truncated) ... ogle_serper", "id": "f1e2b40f-5ef9-4d91-b24a-0d2ffa3c49c0", "tool_call_id": "call_C03ckD29ciysMQ7aRcd8AG1l", "artifact": null, "status": "success"}}]', 'answer': '今天纳斯达克100指数为21,335.82，上涨了16.62点，涨幅为0.08%。如果您需要更多关于纳斯达克100的信息，请告诉我！', 'latency': 3.2797173000000157}
[2025-05-17 11:54:17,083.083] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:54:17,085.085] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:54:17,085.085] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 11:54:17,085.085] base.py -> _exec_single_context line:1901 [INFO]: [cached since 175.1s ago] {'pk_1': UUID('eb364b5b-9988-4216-bc20-ce1eec4d3d60')}
[2025-05-17 11:54:17,087.087] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s WHERE message.id = %(message_id)s::UUID
[2025-05-17 11:54:17,087.087] base.py -> _exec_single_context line:1901 [INFO]: [cached since 168.4s ago] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (15172 characters truncated) ... ogle_serper", "id": "f1e2b40f-5ef9-4d91-b24a-0d2ffa3c49c0", "tool_call_id": "call_C03ckD29ciysMQ7aRcd8AG1l", "artifact": null, "status": "success"}}]', 'answer': '今天纳斯达克100指数为21,335.82，上涨了16.62点，涨幅为0.08%。如果您需要更多关于纳斯达克100的信息，请告诉我！', 'message_id': UUID('eb364b5b-9988-4216-bc20-ce1eec4d3d60')}
[2025-05-17 11:54:17,097.097] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 11:54:17,099.099] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 11:54:17,099.099] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 11:54:17,099.099] base.py -> _exec_single_context line:1901 [INFO]: [cached since 176.5s ago] {'pk_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:54:24,349.349] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(message.id) AS count_1 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID
[2025-05-17 11:54:24,349.349] base.py -> _exec_single_context line:1901 [INFO]: [cached since 170.2s ago] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:54:24,350.350] base.py -> _exec_single_context line:1896 [INFO]: UPDATE conversation SET summary=%(summary)s WHERE conversation.id = %(conversation_id)s::UUID
[2025-05-17 11:54:24,351.351] base.py -> _exec_single_context line:1901 [INFO]: [cached since 170.2s ago] {'summary': '人类询问纳斯达克100和Magnificent 7的10年内平均增幅数据，AI表示无法提供具体数据并建议查询金融网站或投资平台获取最新市场信息。随后人类询问纳斯达克100近期增幅，AI提供了最近纳斯达克100指数7.15%的增幅数据以及过去一周3.41%的上涨情况，并表示可提供更详细的历史数据。之后人类询问LLMOPS的定义，AI表示未能找到相关信息并请求提供更多上下文以便协助解答。最后人类再次询问纳斯达克100，AI提供了当天指数为21,335.82，上涨16.62点（涨幅0.08%）的实时数据，并表示可提供更多相关信息。', 'conversation_id': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca')}
[2025-05-17 11:54:24,351.351] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:04:43,585.585] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:04:43,586.586] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 12:04:43,587.587] base.py -> _exec_single_context line:1901 [INFO]: [cached since 803.2s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 12:04:43,589.589] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 12:04:43,590.590] base.py -> _exec_single_context line:1901 [INFO]: [cached since 803.1s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 12:04:43,593.593] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 12:04:43,593.593] base.py -> _exec_single_context line:1901 [INFO]: [cached since 803.1s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 12:04:43,597.597] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 12:04:43,597.597] base.py -> _exec_single_context line:1901 [INFO]: [cached since 803.1s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 12:04:43,599.599] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 12:04:43,599.599] base.py -> _exec_single_context line:1901 [INFO]: [cached since 803.1s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 12:04:43,602.602] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO conversation (app_id, name, invoke_from, created_by) VALUES (%(app_id)s::UUID, %(name)s, %(invoke_from)s, %(created_by)s::UUID) RETURNING conversation.id, conversation.summary, conversation.is_pinned, conversation.is_deleted, conversation.updated_at, conversation.created_at
[2025-05-17 12:04:43,603.603] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00057s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'name': 'New Conversation', 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 12:04:43,606.606] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app SET debug_conversation_id=%(debug_conversation_id)s::UUID WHERE app.id = %(app_id)s::UUID
[2025-05-17 12:04:43,607.607] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00051s] {'debug_conversation_id': UUID('baff49bc-5d91-42e8-95e0-a277fd632058'), 'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 12:04:43,608.608] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:04:43,610.610] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:04:43,610.610] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 12:04:43,610.610] base.py -> _exec_single_context line:1901 [INFO]: [cached since 803s ago] {'pk_1': UUID('baff49bc-5d91-42e8-95e0-a277fd632058')}
[2025-05-17 12:04:43,612.612] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 12:04:43,613.613] base.py -> _exec_single_context line:1901 [INFO]: [cached since 802s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 12:04:43,614.614] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 12:04:43,615.615] base.py -> _exec_single_context line:1901 [INFO]: [cached since 803.1s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('baff49bc-5d91-42e8-95e0-a277fd632058'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '今天纳斯达克100怎么样?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 12:04:43,617.617] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:04:43,689.689] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:04:43,690.690] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 12:04:43,690.690] base.py -> _exec_single_context line:1901 [INFO]: [cached since 803.1s ago] {'pk_1': UUID('baff49bc-5d91-42e8-95e0-a277fd632058')}
[2025-05-17 12:04:43,692.692] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 12:04:43,692.692] base.py -> _exec_single_context line:1901 [INFO]: [cached since 803.1s ago] {'conversation_id_1': UUID('baff49bc-5d91-42e8-95e0-a277fd632058'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 12:04:43,693.693] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 12:04:43,694.694] base.py -> _exec_single_context line:1901 [INFO]: [cached since 802.1s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 12:04:43,720.720] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 12:04:43,720.720] base.py -> _exec_single_context line:1901 [INFO]: [cached since 801.8s ago] {'pk_1': UUID('c833235f-f15f-4adf-9e17-af511b19bf73')}
[2025-05-17 12:04:43,722.722] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 12:04:43] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 12:04:49,685.685] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 12:04:49,686.686] base.py -> _exec_single_context line:1901 [INFO]: [cached since 801s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('baff49bc-5d91-42e8-95e0-a277fd632058'), 'message_id': UUID('c833235f-f15f-4adf-9e17-af511b19bf73'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-05-17 12:04:49,688.688] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:04:49,692.692] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:04:49,694.694] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 12:04:49,694.694] base.py -> _exec_single_context line:1901 [INFO]: [cached since 809.1s ago] {'pk_1': UUID('baff49bc-5d91-42e8-95e0-a277fd632058')}
[2025-05-17 12:04:49,695.695] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 12:04:49,695.695] base.py -> _exec_single_context line:1901 [INFO]: [cached since 807.8s ago] {'pk_1': UUID('c833235f-f15f-4adf-9e17-af511b19bf73')}
[2025-05-17 12:04:49,696.696] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 12:04:49,697.697] base.py -> _exec_single_context line:1901 [INFO]: [cached since 808.1s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 12:04:49,698.698] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 12:04:49,698.698] base.py -> _exec_single_context line:1901 [INFO]: [cached since 801s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('baff49bc-5d91-42e8-95e0-a277fd632058'), 'message_id': UUID('c833235f-f15f-4adf-9e17-af511b19bf73'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 2, 'event': <QueueEvent.AGENT_THOUGHT: 'agent_thought'>, 'thought': '[{"name": "google_serper", "args": {"query": "\\u4eca\\u5929\\u7eb3\\u65af\\u8fbe\\u514b100\\u6307\\u6570\\u8868\\u73b0"}, "id": "call_Rj7NOM5CiRW4emJG4PM5479w", "type": "tool_call"}]', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (2913 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "66aa447f-aa16-4d7e-8cb6-29ebe414b770", "example": false}}]', 'answer': '', 'latency': 2.548180200000047}
[2025-05-17 12:04:49,711.711] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:04:49,712.712] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:04:49,713.713] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 12:04:49,713.713] base.py -> _exec_single_context line:1901 [INFO]: [cached since 809.1s ago] {'pk_1': UUID('baff49bc-5d91-42e8-95e0-a277fd632058')}
[2025-05-17 12:04:49,714.714] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 12:04:49,714.714] base.py -> _exec_single_context line:1901 [INFO]: [cached since 807.8s ago] {'pk_1': UUID('c833235f-f15f-4adf-9e17-af511b19bf73')}
[2025-05-17 12:04:49,716.716] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 12:04:49,716.716] base.py -> _exec_single_context line:1901 [INFO]: [cached since 808.1s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 12:04:49,718.718] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 12:04:49,725.725] base.py -> _exec_single_context line:1901 [INFO]: [cached since 801.1s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('baff49bc-5d91-42e8-95e0-a277fd632058'), 'message_id': UUID('c833235f-f15f-4adf-9e17-af511b19bf73'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 3, 'event': <QueueEvent.AGENT_ACTION: 'agent_action'>, 'thought': '', 'observation': '"21,427.94 +92.11 (0.43%)"', 'tool': 'google_serper', 'tool_input': '{"query": "\\u4eca\\u5929\\u7eb3\\u65af\\u8fbe\\u514b100\\u6307\\u6570\\u8868\\u73b0"}', 'message': '{}', 'answer': '', 'latency': 1.4948622999999088}
[2025-05-17 12:04:49,730.730] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:04:49,732.732] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:04:49,732.732] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 12:04:49,733.733] base.py -> _exec_single_context line:1901 [INFO]: [cached since 809.1s ago] {'pk_1': UUID('baff49bc-5d91-42e8-95e0-a277fd632058')}
[2025-05-17 12:04:49,735.735] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 12:04:49,736.736] base.py -> _exec_single_context line:1901 [INFO]: [cached since 807.8s ago] {'pk_1': UUID('c833235f-f15f-4adf-9e17-af511b19bf73')}
[2025-05-17 12:04:49,738.738] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 12:04:49,738.738] base.py -> _exec_single_context line:1901 [INFO]: [cached since 808.1s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 12:04:49,740.740] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 12:04:49,740.740] base.py -> _exec_single_context line:1901 [INFO]: [cached since 801.1s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('baff49bc-5d91-42e8-95e0-a277fd632058'), 'message_id': UUID('c833235f-f15f-4adf-9e17-af511b19bf73'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 4, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': '今天纳斯达克100指数表现为21,427.94，上涨了92.11点，涨幅为0.43%。', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (3991 characters truncated) ... ogle_serper", "id": "bf110c96-530d-4a91-bf7b-54ad88102315", "tool_call_id": "call_Rj7NOM5CiRW4emJG4PM5479w", "artifact": null, "status": "success"}}]', 'answer': '今天纳斯达克100指数表现为21,427.94，上涨了92.11点，涨幅为0.43%。', 'latency': 1.8992504999999937}
[2025-05-17 12:04:49,743.743] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:04:49,745.745] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:04:49,745.745] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 12:04:49,746.746] base.py -> _exec_single_context line:1901 [INFO]: [cached since 807.8s ago] {'pk_1': UUID('c833235f-f15f-4adf-9e17-af511b19bf73')}
[2025-05-17 12:04:49,754.754] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s WHERE message.id = %(message_id)s::UUID
[2025-05-17 12:04:49,755.755] base.py -> _exec_single_context line:1901 [INFO]: [cached since 801s ago] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (3991 characters truncated) ... ogle_serper", "id": "bf110c96-530d-4a91-bf7b-54ad88102315", "tool_call_id": "call_Rj7NOM5CiRW4emJG4PM5479w", "artifact": null, "status": "success"}}]', 'answer': '今天纳斯达克100指数表现为21,427.94，上涨了92.11点，涨幅为0.43%。', 'message_id': UUID('c833235f-f15f-4adf-9e17-af511b19bf73')}
[2025-05-17 12:04:49,756.756] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:04:49,757.757] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:04:49,757.757] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 12:04:49,758.758] base.py -> _exec_single_context line:1901 [INFO]: [cached since 809.2s ago] {'pk_1': UUID('baff49bc-5d91-42e8-95e0-a277fd632058')}
[2025-05-17 12:04:52,761.761] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(message.id) AS count_1 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID
[2025-05-17 12:04:52,762.762] base.py -> _exec_single_context line:1901 [INFO]: [cached since 798.6s ago] {'conversation_id_1': UUID('baff49bc-5d91-42e8-95e0-a277fd632058')}
[2025-05-17 12:04:55,751.751] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 12:06:10,768.768] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:06:10,769.769] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 12:06:10,769.769] base.py -> _exec_single_context line:1901 [INFO]: [cached since 890.3s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 12:06:10,772.772] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 12:06:10,773.773] base.py -> _exec_single_context line:1901 [INFO]: [cached since 890.3s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 12:06:10,774.774] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 12:06:10,775.775] base.py -> _exec_single_context line:1901 [INFO]: [cached since 890.3s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 12:06:10,776.776] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 12:06:10,776.776] base.py -> _exec_single_context line:1901 [INFO]: [cached since 890.3s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 12:06:10,778.778] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 12:06:10,778.778] base.py -> _exec_single_context line:1901 [INFO]: [cached since 890.3s ago] {'id_1': UUID('baff49bc-5d91-42e8-95e0-a277fd632058'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 12:06:10,780.780] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 12:06:10,786.786] base.py -> _exec_single_context line:1901 [INFO]: [cached since 890.3s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('baff49bc-5d91-42e8-95e0-a277fd632058'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '今天纳斯达克100最近一周涨幅', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 12:06:10,789.789] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:06:10,867.867] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:06:10,869.869] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 12:06:10,869.869] base.py -> _exec_single_context line:1901 [INFO]: [cached since 890.3s ago] {'pk_1': UUID('baff49bc-5d91-42e8-95e0-a277fd632058')}
[2025-05-17 12:06:10,871.871] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 12:06:10,871.871] base.py -> _exec_single_context line:1901 [INFO]: [cached since 890.3s ago] {'conversation_id_1': UUID('baff49bc-5d91-42e8-95e0-a277fd632058'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 12:06:10,874.874] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 12:06:10,874.874] base.py -> _exec_single_context line:1901 [INFO]: [cached since 889.3s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 12:06:10,903.903] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 12:06:10,903.903] base.py -> _exec_single_context line:1901 [INFO]: [cached since 889s ago] {'pk_1': UUID('fe7f7cfc-673f-4196-a228-8af5361c6184')}
[2025-05-17 12:06:10,906.906] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 12:06:10] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 12:06:17,652.652] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 12:06:17,652.652] base.py -> _exec_single_context line:1901 [INFO]: [cached since 889s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('baff49bc-5d91-42e8-95e0-a277fd632058'), 'message_id': UUID('fe7f7cfc-673f-4196-a228-8af5361c6184'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-05-17 12:06:17,654.654] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:06:17,654.654] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:06:17,655.655] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 12:06:17,655.655] base.py -> _exec_single_context line:1901 [INFO]: [cached since 897.1s ago] {'pk_1': UUID('baff49bc-5d91-42e8-95e0-a277fd632058')}
[2025-05-17 12:06:17,656.656] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 12:06:17,656.656] base.py -> _exec_single_context line:1901 [INFO]: [cached since 895.7s ago] {'pk_1': UUID('fe7f7cfc-673f-4196-a228-8af5361c6184')}
[2025-05-17 12:06:17,657.657] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 12:06:17,657.657] base.py -> _exec_single_context line:1901 [INFO]: [cached since 896.1s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 12:06:17,658.658] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 12:06:17,658.658] base.py -> _exec_single_context line:1901 [INFO]: [cached since 889s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('baff49bc-5d91-42e8-95e0-a277fd632058'), 'message_id': UUID('fe7f7cfc-673f-4196-a228-8af5361c6184'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 2, 'event': <QueueEvent.AGENT_THOUGHT: 'agent_thought'>, 'thought': '[{"name": "google_serper", "args": {"query": "Nasdaq 100 weekly performance October 2023"}, "id": "call_5JqcsGaFVa5QGQnd2wzvCv1W", "type": "tool_call"}]', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (3609 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "0cd2847d-e835-4741-b695-a80df5ff815b", "example": false}}]', 'answer': '', 'latency': 2.6583274999999276}
[2025-05-17 12:06:17,659.659] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:06:17,660.660] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:06:17,660.660] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 12:06:17,660.660] base.py -> _exec_single_context line:1901 [INFO]: [cached since 897.1s ago] {'pk_1': UUID('baff49bc-5d91-42e8-95e0-a277fd632058')}
[2025-05-17 12:06:17,662.662] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 12:06:17,662.662] base.py -> _exec_single_context line:1901 [INFO]: [cached since 895.7s ago] {'pk_1': UUID('fe7f7cfc-673f-4196-a228-8af5361c6184')}
[2025-05-17 12:06:17,663.663] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 12:06:17,663.663] base.py -> _exec_single_context line:1901 [INFO]: [cached since 896.1s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 12:06:17,664.664] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 12:06:17,664.664] base.py -> _exec_single_context line:1901 [INFO]: [cached since 889s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('baff49bc-5d91-42e8-95e0-a277fd632058'), 'message_id': UUID('fe7f7cfc-673f-4196-a228-8af5361c6184'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 3, 'event': <QueueEvent.AGENT_ACTION: 'agent_action'>, 'thought': '', 'observation': '"In October 2023, the Nasdaq Featured Indexes had losses almost across the board with an average loss of -4.6%. The biggest underperformer was ... Di ... (1159 characters truncated) ... declined for the third straight month, with the Dow Jones Industrial Average falling 1.3%, the S&P 500 slipping 2.1%, and the NASDAQ giving up 2.8%."', 'tool': 'google_serper', 'tool_input': '{"query": "Nasdaq 100 weekly performance October 2023"}', 'message': '{}', 'answer': '', 'latency': 1.6606815999999753}
[2025-05-17 12:06:17,666.666] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:06:17,666.666] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:06:17,666.666] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 12:06:17,667.667] base.py -> _exec_single_context line:1901 [INFO]: [cached since 897.1s ago] {'pk_1': UUID('baff49bc-5d91-42e8-95e0-a277fd632058')}
[2025-05-17 12:06:17,667.667] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 12:06:17,667.667] base.py -> _exec_single_context line:1901 [INFO]: [cached since 895.7s ago] {'pk_1': UUID('fe7f7cfc-673f-4196-a228-8af5361c6184')}
[2025-05-17 12:06:17,667.667] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 12:06:17,668.668] base.py -> _exec_single_context line:1901 [INFO]: [cached since 896.1s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 12:06:17,668.668] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 12:06:17,669.669] base.py -> _exec_single_context line:1901 [INFO]: [cached since 889s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('baff49bc-5d91-42e8-95e0-a277fd632058'), 'message_id': UUID('fe7f7cfc-673f-4196-a228-8af5361c6184'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 4, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': '在最近一周内，纳斯达克100指数整体表现较差，平均下跌幅度为约4.6%。具体来看，纳斯达克100在10月的表现也不理想，总体下跌了约2.04%。', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (6056 characters truncated) ... ogle_serper", "id": "59461e75-aaa2-4831-aab2-c620792f1d6b", "tool_call_id": "call_5JqcsGaFVa5QGQnd2wzvCv1W", "artifact": null, "status": "success"}}]', 'answer': '在最近一周内，纳斯达克100指数整体表现较差，平均下跌幅度为约4.6%。具体来看，纳斯达克100在10月的表现也不理想，总体下跌了约2.04%。', 'latency': 2.430041699999947}
[2025-05-17 12:06:17,673.673] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:06:17,674.674] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:06:17,675.675] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 12:06:17,675.675] base.py -> _exec_single_context line:1901 [INFO]: [cached since 895.7s ago] {'pk_1': UUID('fe7f7cfc-673f-4196-a228-8af5361c6184')}
[2025-05-17 12:06:17,676.676] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s WHERE message.id = %(message_id)s::UUID
[2025-05-17 12:06:17,676.676] base.py -> _exec_single_context line:1901 [INFO]: [cached since 888.9s ago] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (6056 characters truncated) ... ogle_serper", "id": "59461e75-aaa2-4831-aab2-c620792f1d6b", "tool_call_id": "call_5JqcsGaFVa5QGQnd2wzvCv1W", "artifact": null, "status": "success"}}]', 'answer': '在最近一周内，纳斯达克100指数整体表现较差，平均下跌幅度为约4.6%。具体来看，纳斯达克100在10月的表现也不理想，总体下跌了约2.04%。', 'message_id': UUID('fe7f7cfc-673f-4196-a228-8af5361c6184')}
[2025-05-17 12:06:17,677.677] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:06:17,678.678] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:06:17,678.678] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 12:06:17,678.678] base.py -> _exec_single_context line:1901 [INFO]: [cached since 897.1s ago] {'pk_1': UUID('baff49bc-5d91-42e8-95e0-a277fd632058')}
[2025-05-17 12:06:21,016.016] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(message.id) AS count_1 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID
[2025-05-17 12:06:21,017.017] base.py -> _exec_single_context line:1901 [INFO]: [cached since 886.8s ago] {'conversation_id_1': UUID('baff49bc-5d91-42e8-95e0-a277fd632058')}
[2025-05-17 12:06:21,018.018] base.py -> _exec_single_context line:1896 [INFO]: UPDATE conversation SET summary=%(summary)s WHERE conversation.id = %(conversation_id)s::UUID
[2025-05-17 12:06:21,018.018] base.py -> _exec_single_context line:1901 [INFO]: [cached since 886.8s ago] {'summary': '人类询问纳斯达克100最近一周涨幅，AI回复称最近一周纳斯达克100指数表现较差，平均下跌约4.6%，并补充说明10月总体表现也不理想，下跌约2.04%。', 'conversation_id': UUID('baff49bc-5d91-42e8-95e0-a277fd632058')}
[2025-05-17 12:06:21,019.019] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:25:02,311.311] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\conversation_service.py', reloading
[2025-05-17 12:25:04,064.064] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-17 12:25:47,542.542] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-17 12:25:47,556.556] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-17 12:27:05,831.831] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\model\\conversation.py', reloading
[2025-05-17 12:27:08,346.346] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-17 12:27:49,832.832] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-17 12:27:49,851.851] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-17 12:28:08,128.128] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\app_service.py', reloading
[2025-05-17 12:28:10,439.439] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-17 12:28:47,947.947] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-17 12:28:47,959.959] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-17 12:30:01,825.825] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-17 12:30:01,826.826] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 12:30:01,831.831] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-17 12:30:01,831.831] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 12:30:01,832.832] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-17 12:30:01,832.832] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 12:30:01,834.834] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:30:01,845.845] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 12:30:01,846.846] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00073s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 12:30:01,869.869] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 12:30:01,869.869] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00042s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 12:30:01,876.876] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 12:30:01,877.877] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00087s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 12:30:01,886.886] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 12:30:01,887.887] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00086s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 12:30:01,890.890] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 12:30:01,891.891] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00028s] {'id_1': UUID('baff49bc-5d91-42e8-95e0-a277fd632058'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 12:30:01,896.896] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO conversation (app_id, name, invoke_from, created_by) VALUES (%(app_id)s::UUID, %(name)s, %(invoke_from)s, %(created_by)s::UUID) RETURNING conversation.id, conversation.summary, conversation.is_pinned, conversation.is_deleted, conversation.updated_at, conversation.created_at
[2025-05-17 12:30:01,896.896] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00037s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'name': 'New Conversation', 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 12:30:01,914.914] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app SET debug_conversation_id=%(debug_conversation_id)s::UUID WHERE app.id = %(app_id)s::UUID
[2025-05-17 12:30:01,914.914] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00042s] {'debug_conversation_id': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14'), 'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 12:30:01,915.915] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:30:01,918.918] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:30:01,919.919] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 12:30:01,920.920] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00096s] {'pk_1': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14')}
[2025-05-17 12:30:01,922.922] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 12:30:01,923.923] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00042s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 12:30:01,925.925] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 12:30:01,925.925] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00032s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '纳斯达克100', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 12:30:01,930.930] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:30:02,018.018] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:30:02,019.019] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 12:30:02,019.019] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.09957s ago] {'pk_1': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14')}
[2025-05-17 12:30:02,022.022] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 12:30:02,023.023] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00053s] {'conversation_id_1': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 12:30:02,028.028] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 12:30:02,029.029] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.1065s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 12:30:03,286.286] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 12:30:03,287.287] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00078s] {'pk_1': UUID('d08fe125-5d84-4fb6-9ed8-f5b95e9fabef')}
[2025-05-17 12:30:03,289.289] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 12:30:03] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 12:30:09,366.366] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 12:30:09,367.367] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00048s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14'), 'message_id': UUID('d08fe125-5d84-4fb6-9ed8-f5b95e9fabef'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-05-17 12:30:09,370.370] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:30:09,370.370] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:30:09,372.372] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 12:30:09,372.372] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.452s ago] {'pk_1': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14')}
[2025-05-17 12:30:09,373.373] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 12:30:09,374.374] base.py -> _exec_single_context line:1901 [INFO]: [cached since 6.087s ago] {'pk_1': UUID('d08fe125-5d84-4fb6-9ed8-f5b95e9fabef')}
[2025-05-17 12:30:09,374.374] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 12:30:09,375.375] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.452s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 12:30:09,376.376] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 12:30:09,376.376] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.009874s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14'), 'message_id': UUID('d08fe125-5d84-4fb6-9ed8-f5b95e9fabef'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 2, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': '纳斯达克100（Nasdaq-100）是一个以纳斯达克证券交易所上市的100家最大的非金融公司为基础的股票指数。该指数包括了一些全球知名的科技公司，如苹果、微软、亚马逊、谷歌母公司Alphabet等。\n\n纳斯达克100的特点包括：\n\n1. **成分股**：指数中的公司代表了多种行业，主要集 ... (71 characters truncated) ... 金融公司**：纳斯达克100不包括任何金融类公司，因此与其他指数（如标普500）有明显区别。\n4. **投资工具**：许多投资基金和交易所交易基金（ETF）都跟踪纳斯达克100指数，为投资者提供了一种便利的投资方式。\n\n如果你需要更具体的信息或数据，比如最新的指数值、成分股变化等，请告诉我！', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (2877 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "e614b624-df12-4624-be0d-5ac0c8de8eb6", "example": false}}]', 'answer': '纳斯达克100（Nasdaq-100）是一个以纳斯达克证券交易所上市的100家最大的非金融公司为基础的股票指数。该指数包括了一些全球知名的科技公司，如苹果、微软、亚马逊、谷歌母公司Alphabet等。\n\n纳斯达克100的特点包括：\n\n1. **成分股**：指数中的公司代表了多种行业，主要集 ... (71 characters truncated) ... 金融公司**：纳斯达克100不包括任何金融类公司，因此与其他指数（如标普500）有明显区别。\n4. **投资工具**：许多投资基金和交易所交易基金（ETF）都跟踪纳斯达克100指数，为投资者提供了一种便利的投资方式。\n\n如果你需要更具体的信息或数据，比如最新的指数值、成分股变化等，请告诉我！', 'latency': 6.072139700000008}
[2025-05-17 12:30:09,381.381] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:30:09,382.382] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:30:09,383.383] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 12:30:09,383.383] base.py -> _exec_single_context line:1901 [INFO]: [cached since 6.097s ago] {'pk_1': UUID('d08fe125-5d84-4fb6-9ed8-f5b95e9fabef')}
[2025-05-17 12:30:09,385.385] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s WHERE message.id = %(message_id)s::UUID
[2025-05-17 12:30:09,385.385] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00036s] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (2877 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "e614b624-df12-4624-be0d-5ac0c8de8eb6", "example": false}}]', 'answer': '纳斯达克100（Nasdaq-100）是一个以纳斯达克证券交易所上市的100家最大的非金融公司为基础的股票指数。该指数包括了一些全球知名的科技公司，如苹果、微软、亚马逊、谷歌母公司Alphabet等。\n\n纳斯达克100的特点包括：\n\n1. **成分股**：指数中的公司代表了多种行业，主要集 ... (71 characters truncated) ... 金融公司**：纳斯达克100不包括任何金融类公司，因此与其他指数（如标普500）有明显区别。\n4. **投资工具**：许多投资基金和交易所交易基金（ETF）都跟踪纳斯达克100指数，为投资者提供了一种便利的投资方式。\n\n如果你需要更具体的信息或数据，比如最新的指数值、成分股变化等，请告诉我！', 'message_id': UUID('d08fe125-5d84-4fb6-9ed8-f5b95e9fabef')}
[2025-05-17 12:30:09,389.389] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:30:09,389.389] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:30:09,389.389] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 12:30:09,389.389] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.471s ago] {'pk_1': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14')}
[2025-05-17 12:30:15,699.699] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(message.id) AS count_1 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID
[2025-05-17 12:30:15,700.700] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00037s] {'conversation_id_1': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14')}
[2025-05-17 12:30:15,702.702] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 12:30:15,702.702] base.py -> _exec_single_context line:1901 [INFO]: [cached since 12.42s ago] {'pk_1': UUID('d08fe125-5d84-4fb6-9ed8-f5b95e9fabef')}
[2025-05-17 12:30:19,703.703] base.py -> _exec_single_context line:1896 [INFO]: UPDATE conversation SET name=%(name)s WHERE conversation.id = %(conversation_id)s::UUID
[2025-05-17 12:30:19,703.703] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00043s] {'name': '纳斯达克100指数', 'conversation_id': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14')}
[2025-05-17 12:30:19,704.704] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:30:19,705.705] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:30:19,706.706] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 12:30:19,706.706] base.py -> _exec_single_context line:1901 [INFO]: [cached since 17.79s ago] {'pk_1': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14')}
[2025-05-17 12:30:19,707.707] base.py -> _exec_single_context line:1896 [INFO]: UPDATE conversation SET summary=%(summary)s WHERE conversation.id = %(conversation_id)s::UUID
[2025-05-17 12:30:19,707.707] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00021s] {'summary': '人类询问关于纳斯达克100的信息。AI解释了纳斯达克100是一个基于纳斯达克证券交易所上市的100家最大非金融公司的股票指数，并详细介绍了其特点：\n1. 成分股主要来自科技、消费品和生物科技等行业\n2. 采用市值加权计算方法\n3. 不包括金融类公司\n4. 是许多投资基金和ETF的跟踪标的\nAI还表示可以提供更具体的指数数据和成分股信息。', 'conversation_id': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14')}
[2025-05-17 12:30:19,707.707] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:34:45,069.069] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-05-17 12:34:45,070.070] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-05-17 12:34:45,077.077] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-17 12:35:21,567.567] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-17 12:35:21,587.587] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-17 12:35:23,976.976] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-17 12:35:23,977.977] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 12:35:23,983.983] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-17 12:35:23,983.983] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 12:35:23,986.986] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-17 12:35:23,986.986] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 12:35:23,987.987] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:35:23,994.994] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 12:35:23,994.994] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00069s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 12:35:24,012.012] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 12:35:24,013.013] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00048s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 12:35:24,019.019] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 12:35:24,020.020] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00076s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 12:35:24,027.027] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 12:35:24,027.027] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00081s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 12:35:24,032.032] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 12:35:24,033.033] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00046s] {'id_1': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 12:35:24,041.041] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 12:35:24,041.041] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00050s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '你好我是好儿', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 12:35:24,065.065] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:35:24,153.153] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:35:24,154.154] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 12:35:24,154.154] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00032s] {'pk_1': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14')}
[2025-05-17 12:35:24,158.158] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 12:35:24,158.158] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00053s] {'conversation_id_1': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 12:35:25,651.651] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 12:35:25,652.652] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00042s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 12:35:25,767.767] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 12:35:25,767.767] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00046s] {'pk_1': UUID('852e72ec-a46b-453b-b4ce-9dc68baff82d')}
[2025-05-17 12:35:25,768.768] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 12:35:25] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 12:35:28,553.553] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 12:35:28,553.553] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00047s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14'), 'message_id': UUID('852e72ec-a46b-453b-b4ce-9dc68baff82d'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': '人类询问关于纳斯达克100的信息。AI解释了纳斯达克100是一个基于纳斯达克证券交易所上市的100家最大非金融公司的股票指数，并详细介绍了其特点：\n1. 成分股主要来自科技、消费品和生物科技等行业\n2. 采用市值加权计算方法\n3. 不包括金融类公司\n4. 是许多投资基金和ETF的跟踪标的\nAI还表示可以提供更具体的指数数据和成分股信息。', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-05-17 12:35:28,561.561] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:35:28,562.562] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:35:28,562.562] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 12:35:28,563.563] base.py -> _exec_single_context line:1901 [INFO]: [cached since 4.408s ago] {'pk_1': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14')}
[2025-05-17 12:35:28,564.564] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 12:35:28,564.564] base.py -> _exec_single_context line:1901 [INFO]: [cached since 2.797s ago] {'pk_1': UUID('852e72ec-a46b-453b-b4ce-9dc68baff82d')}
[2025-05-17 12:35:28,565.565] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 12:35:28,570.570] base.py -> _exec_single_context line:1901 [INFO]: [cached since 2.919s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 12:35:28,572.572] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 12:35:28,572.572] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01874s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14'), 'message_id': UUID('852e72ec-a46b-453b-b4ce-9dc68baff82d'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 2, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': '你好，好儿！很高兴见到你！有什么我可以帮助你的吗？', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (6436 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "8065c008-44da-4645-a37b-b3a5104ef7fb", "example": false}}]', 'answer': '你好，好儿！很高兴见到你！有什么我可以帮助你的吗？', 'latency': 2.748350600000002}
[2025-05-17 12:35:28,575.575] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:35:28,576.576] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:35:28,576.576] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 12:35:28,577.577] base.py -> _exec_single_context line:1901 [INFO]: [cached since 2.81s ago] {'pk_1': UUID('852e72ec-a46b-453b-b4ce-9dc68baff82d')}
[2025-05-17 12:35:28,578.578] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s WHERE message.id = %(message_id)s::UUID
[2025-05-17 12:35:28,584.584] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00535s] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (6436 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "8065c008-44da-4645-a37b-b3a5104ef7fb", "example": false}}]', 'answer': '你好，好儿！很高兴见到你！有什么我可以帮助你的吗？', 'message_id': UUID('852e72ec-a46b-453b-b4ce-9dc68baff82d')}
[2025-05-17 12:35:28,588.588] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:35:28,589.589] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:35:28,589.589] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 12:35:28,590.590] base.py -> _exec_single_context line:1901 [INFO]: [cached since 4.435s ago] {'pk_1': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14')}
[2025-05-17 12:35:34,576.576] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(message.id) AS count_1 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID
[2025-05-17 12:35:34,577.577] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00039s] {'conversation_id_1': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14')}
[2025-05-17 12:35:34,578.578] base.py -> _exec_single_context line:1896 [INFO]: UPDATE conversation SET summary=%(summary)s WHERE conversation.id = %(conversation_id)s::UUID
[2025-05-17 12:35:34,578.578] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00024s] {'summary': '人类询问关于纳斯达克100的信息。AI解释了纳斯达克100是一个基于纳斯达克证券交易所上市的100家最大非金融公司的股票指数，并详细介绍了其特点：\n1. 成分股主要来自科技、消费品和生物科技等行业\n2. 采用市值加权计算方法\n3. 不包括金融类公司\n4. 是许多投资基金和ETF的跟踪标的\nAI还表示可以提供更具体的指数数据和成分股信息。随后，用户"好儿"向AI打招呼，AI友好回应并表示愿意提供帮助。', 'conversation_id': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14')}
[2025-05-17 12:35:34,579.579] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:35:54,334.334] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:35:54,335.335] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 12:35:54,335.335] base.py -> _exec_single_context line:1901 [INFO]: [cached since 30.34s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 12:35:54,337.337] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 12:35:54,337.337] base.py -> _exec_single_context line:1901 [INFO]: [cached since 30.33s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 12:35:54,339.339] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 12:35:54,339.339] base.py -> _exec_single_context line:1901 [INFO]: [cached since 30.32s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 12:35:54,340.340] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 12:35:54,341.341] base.py -> _exec_single_context line:1901 [INFO]: [cached since 30.31s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 12:35:54,344.344] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 12:35:54,344.344] base.py -> _exec_single_context line:1901 [INFO]: [cached since 30.31s ago] {'id_1': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 12:35:54,345.345] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 12:35:54,346.346] base.py -> _exec_single_context line:1901 [INFO]: [cached since 30.3s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '你知道我是谁吗?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 12:35:54,347.347] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:35:54,392.392] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:35:54,392.392] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 12:35:54,392.392] base.py -> _exec_single_context line:1901 [INFO]: [cached since 30.24s ago] {'pk_1': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14')}
[2025-05-17 12:35:54,394.394] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 12:35:54,394.394] base.py -> _exec_single_context line:1901 [INFO]: [cached since 30.24s ago] {'conversation_id_1': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 12:35:54,396.396] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 12:35:54,397.397] base.py -> _exec_single_context line:1901 [INFO]: [cached since 28.75s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 12:35:54,418.418] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 12:35:54,426.426] base.py -> _exec_single_context line:1901 [INFO]: [cached since 28.66s ago] {'pk_1': UUID('5751e5b3-61fd-4046-8e01-8142b14cb9cb')}
[2025-05-17 12:35:54,427.427] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 12:35:54] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 12:35:56,946.946] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 12:35:56,946.946] base.py -> _exec_single_context line:1901 [INFO]: [cached since 28.39s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14'), 'message_id': UUID('5751e5b3-61fd-4046-8e01-8142b14cb9cb'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': '人类询问关于纳斯达克100的信息。AI解释了纳斯达克100是一个基于纳斯达克证券交易所上市的100家最大非金融公司的股票指数，并详细介绍了其特点：\n1. 成分股主要来自科技、消费品和生物科技等行业\n2. 采用市值加权计算方法\n3. 不包括金融类公司\n4. 是许多投资基金和ETF的跟踪标的\nAI还表示可以提供更具体的指数数据和成分股信息。随后，用户"好儿"向AI打招呼，AI友好回应并表示愿意提供帮助。', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-05-17 12:35:56,948.948] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:35:56,949.949] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:35:56,949.949] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 12:35:56,949.949] base.py -> _exec_single_context line:1901 [INFO]: [cached since 32.79s ago] {'pk_1': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14')}
[2025-05-17 12:35:56,950.950] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 12:35:56,950.950] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.18s ago] {'pk_1': UUID('5751e5b3-61fd-4046-8e01-8142b14cb9cb')}
[2025-05-17 12:35:56,951.951] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 12:35:56,951.951] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.3s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 12:35:56,952.952] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 12:35:56,952.952] base.py -> _exec_single_context line:1901 [INFO]: [cached since 28.4s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14'), 'message_id': UUID('5751e5b3-61fd-4046-8e01-8142b14cb9cb'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 2, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': '根据我们的历史对话记录，你是好儿。如果你希望我了解更多关于你的信息或者有其他需求，请告诉我！', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (7293 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "ec610bcb-9b41-4dd9-9080-cfd1f372f9f5", "example": false}}]', 'answer': '根据我们的历史对话记录，你是好儿。如果你希望我了解更多关于你的信息或者有其他需求，请告诉我！', 'latency': 2.5079629999999895}
[2025-05-17 12:35:56,957.957] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:35:56,958.958] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:35:56,966.966] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 12:35:56,966.966] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.2s ago] {'pk_1': UUID('5751e5b3-61fd-4046-8e01-8142b14cb9cb')}
[2025-05-17 12:35:56,967.967] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s WHERE message.id = %(message_id)s::UUID
[2025-05-17 12:35:56,967.967] base.py -> _exec_single_context line:1901 [INFO]: [cached since 28.39s ago] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (7293 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "ec610bcb-9b41-4dd9-9080-cfd1f372f9f5", "example": false}}]', 'answer': '根据我们的历史对话记录，你是好儿。如果你希望我了解更多关于你的信息或者有其他需求，请告诉我！', 'message_id': UUID('5751e5b3-61fd-4046-8e01-8142b14cb9cb')}
[2025-05-17 12:35:56,968.968] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 12:35:56,969.969] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 12:35:56,970.970] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 12:35:56,970.970] base.py -> _exec_single_context line:1901 [INFO]: [cached since 32.82s ago] {'pk_1': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14')}
[2025-05-17 12:36:02,944.944] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(message.id) AS count_1 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID
[2025-05-17 12:36:02,944.944] base.py -> _exec_single_context line:1901 [INFO]: [cached since 28.37s ago] {'conversation_id_1': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14')}
[2025-05-17 12:36:02,945.945] base.py -> _exec_single_context line:1896 [INFO]: UPDATE conversation SET summary=%(summary)s WHERE conversation.id = %(conversation_id)s::UUID
[2025-05-17 12:36:02,945.945] base.py -> _exec_single_context line:1901 [INFO]: [cached since 28.37s ago] {'summary': '人类询问关于纳斯达克100的信息。AI解释了纳斯达克100是一个基于纳斯达克证券交易所上市的100家最大非金融公司的股票指数，并详细介绍了其特点：\n1. 成分股主要来自科技、消费品和生物科技等行业\n2. 采用市值加权计算方法\n3. 不包括金融类公司\n4. 是许多投资基金和ETF的跟踪标的\nAI还表示可以提供更具体的指数数据和成分股信息。随后，用户"好儿"向AI打招呼，AI友好回应并表示愿意提供帮助。当用户询问AI是否认识自己时，AI确认对方是"好儿"并表示可以根据历史对话记录识别用户，同时表示愿意了解更多用户信息或提供其他帮助。', 'conversation_id': UUID('3aae6fa6-139b-44cc-ac11-d00266e04b14')}
[2025-05-17 12:36:02,945.945] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 13:59:50,870.870] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-05-17 13:59:50,870.870] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-05-17 13:59:50,876.876] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-17 14:00:18,226.226] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-17 14:00:18,244.244] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-17 14:03:30,428.428] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-17 14:03:30,428.428] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 14:03:30,431.431] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-17 14:03:30,431.431] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 14:03:30,432.432] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-17 14:03:30,433.433] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-17 14:03:30,433.433] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 14:03:30,438.438] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 14:03:30,439.439] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00058s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 14:03:30,447.447] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 14:03:30,447.447] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00052s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 14:03:30,452.452] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app SET debug_conversation_id=%(debug_conversation_id)s::UUID WHERE app.id = %(app_id)s::UUID
[2025-05-17 14:03:30,454.454] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00127s] {'debug_conversation_id': None, 'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 14:03:30,456.456] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 14:03:30,459.459] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 14:03:30] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations/delete-debug-conversation HTTP/1.1" 200 -
[2025-05-17 14:03:33,900.900] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 14:03:33,900.900] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 14:03:33,901.901] base.py -> _exec_single_context line:1901 [INFO]: [cached since 3.463s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 14:03:33,904.904] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 14:03:33,904.904] base.py -> _exec_single_context line:1901 [INFO]: [cached since 3.458s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 14:03:33,908.908] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 14:03:33,908.908] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00074s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 14:03:33,912.912] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 14:03:33,914.914] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00056s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 14:03:33,919.919] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO conversation (app_id, name, invoke_from, created_by) VALUES (%(app_id)s::UUID, %(name)s, %(invoke_from)s, %(created_by)s::UUID) RETURNING conversation.id, conversation.summary, conversation.is_pinned, conversation.is_deleted, conversation.updated_at, conversation.created_at
[2025-05-17 14:03:33,919.919] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00052s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'name': 'New Conversation', 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 14:03:33,929.929] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app SET debug_conversation_id=%(debug_conversation_id)s::UUID WHERE app.id = %(app_id)s::UUID
[2025-05-17 14:03:33,930.930] base.py -> _exec_single_context line:1901 [INFO]: [cached since 3.477s ago] {'debug_conversation_id': UUID('75a1aaeb-c82a-481c-a54c-fcbe0c6906bc'), 'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 14:03:33,930.930] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 14:03:33,931.931] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 14:03:33,932.932] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 14:03:33,933.933] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00025s] {'pk_1': UUID('75a1aaeb-c82a-481c-a54c-fcbe0c6906bc')}
[2025-05-17 14:03:33,934.934] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 14:03:33,935.935] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00032s] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 14:03:33,937.937] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 14:03:33,937.937] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00038s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('75a1aaeb-c82a-481c-a54c-fcbe0c6906bc'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '你知道我是谁吗?', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 14:03:33,942.942] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 14:03:33,999.999] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 14:03:34,000.000] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 14:03:34,001.001] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.06851s ago] {'pk_1': UUID('75a1aaeb-c82a-481c-a54c-fcbe0c6906bc')}
[2025-05-17 14:03:34,004.004] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 14:03:34,004.004] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00039s] {'conversation_id_1': UUID('75a1aaeb-c82a-481c-a54c-fcbe0c6906bc'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 10}
[2025-05-17 14:03:34,007.007] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 14:03:34,008.008] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.07362s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 14:03:34,471.471] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 14:03:34,472.472] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00062s] {'pk_1': UUID('e08ba4c2-f396-4459-b962-c24c3fcef7cb')}
[2025-05-17 14:03:34,484.484] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 14:03:34] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 14:03:38,316.316] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 14:03:38,316.316] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00054s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('75a1aaeb-c82a-481c-a54c-fcbe0c6906bc'), 'message_id': UUID('e08ba4c2-f396-4459-b962-c24c3fcef7cb'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-05-17 14:03:38,319.319] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 14:03:38,320.320] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 14:03:38,321.321] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 14:03:38,321.321] base.py -> _exec_single_context line:1901 [INFO]: [cached since 4.389s ago] {'pk_1': UUID('75a1aaeb-c82a-481c-a54c-fcbe0c6906bc')}
[2025-05-17 14:03:38,322.322] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 14:03:38,322.322] base.py -> _exec_single_context line:1901 [INFO]: [cached since 3.851s ago] {'pk_1': UUID('e08ba4c2-f396-4459-b962-c24c3fcef7cb')}
[2025-05-17 14:03:38,323.323] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 14:03:38,323.323] base.py -> _exec_single_context line:1901 [INFO]: [cached since 4.389s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 14:03:38,324.324] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 14:03:38,324.324] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.008643s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('75a1aaeb-c82a-481c-a54c-fcbe0c6906bc'), 'message_id': UUID('e08ba4c2-f396-4459-b962-c24c3fcef7cb'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 2, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': '我没有具体的用户识别信息，因此无法直接知道您是谁。不过，我可以根据我们的对话内容和您的需求提供帮助。如果您愿意，可以分享一些关于您的信息，我将更好地为您服务。', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (2896 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "afecfb83-cef6-4c65-8f78-65c140cd1d88", "example": false}}]', 'answer': '我没有具体的用户识别信息，因此无法直接知道您是谁。不过，我可以根据我们的对话内容和您的需求提供帮助。如果您愿意，可以分享一些关于您的信息，我将更好地为您服务。', 'latency': 3.812992600000001}
[2025-05-17 14:03:38,340.340] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 14:03:38,340.340] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 14:03:38,341.341] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 14:03:38,341.341] base.py -> _exec_single_context line:1901 [INFO]: [cached since 3.87s ago] {'pk_1': UUID('e08ba4c2-f396-4459-b962-c24c3fcef7cb')}
[2025-05-17 14:03:38,342.342] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s WHERE message.id = %(message_id)s::UUID
[2025-05-17 14:03:38,342.342] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00028s] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (2896 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "afecfb83-cef6-4c65-8f78-65c140cd1d88", "example": false}}]', 'answer': '我没有具体的用户识别信息，因此无法直接知道您是谁。不过，我可以根据我们的对话内容和您的需求提供帮助。如果您愿意，可以分享一些关于您的信息，我将更好地为您服务。', 'message_id': UUID('e08ba4c2-f396-4459-b962-c24c3fcef7cb')}
[2025-05-17 14:03:38,344.344] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 14:03:38,345.345] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 14:03:38,345.345] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 14:03:38,349.349] base.py -> _exec_single_context line:1901 [INFO]: [cached since 4.417s ago] {'pk_1': UUID('75a1aaeb-c82a-481c-a54c-fcbe0c6906bc')}
[2025-05-17 14:03:41,664.664] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(message.id) AS count_1 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID
[2025-05-17 14:03:41,664.664] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00039s] {'conversation_id_1': UUID('75a1aaeb-c82a-481c-a54c-fcbe0c6906bc')}
[2025-05-17 14:03:41,665.665] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 14:03:41,666.666] base.py -> _exec_single_context line:1901 [INFO]: [cached since 7.195s ago] {'pk_1': UUID('e08ba4c2-f396-4459-b962-c24c3fcef7cb')}
[2025-05-17 14:03:44,401.401] base.py -> _exec_single_context line:1896 [INFO]: UPDATE conversation SET name=%(name)s WHERE conversation.id = %(conversation_id)s::UUID
[2025-05-17 14:03:44,403.403] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00109s] {'name': '询问对方的身份', 'conversation_id': UUID('75a1aaeb-c82a-481c-a54c-fcbe0c6906bc')}
[2025-05-17 14:03:44,404.404] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 14:03:44,405.405] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 14:03:44,405.405] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 14:03:44,405.405] base.py -> _exec_single_context line:1901 [INFO]: [cached since 10.47s ago] {'pk_1': UUID('75a1aaeb-c82a-481c-a54c-fcbe0c6906bc')}
[2025-05-17 14:03:44,406.406] base.py -> _exec_single_context line:1896 [INFO]: UPDATE conversation SET summary=%(summary)s WHERE conversation.id = %(conversation_id)s::UUID
[2025-05-17 14:03:44,406.406] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00023s] {'summary': '人类询问AI是否知道自己的身份，AI回应无法直接识别用户身份，但可以根据对话内容和需求提供帮助，并表示如果用户愿意分享信息，可以提供更个性化的服务。', 'conversation_id': UUID('75a1aaeb-c82a-481c-a54c-fcbe0c6906bc')}
[2025-05-17 14:03:44,407.407] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 18:21:08,359.359] base.py -> get_connection line:843 [INFO]: Connection <connection object at 0x0000016C0075A370; dsn: 'user=postgres password=xxx dbname=llmops host=127.0.0.1 port=5432 client_encoding=utf8', closed: 0> exceeded timeout; recycling
[2025-05-17 18:21:08,401.401] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 18:21:08,402.402] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 18:21:08,403.403] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.546e+04s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 18:21:08,406.406] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 18:21:08,407.407] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.546e+04s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 18:21:08,409.409] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app SET debug_conversation_id=%(debug_conversation_id)s::UUID WHERE app.id = %(app_id)s::UUID
[2025-05-17 18:21:08,409.409] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.546e+04s ago] {'debug_conversation_id': None, 'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 18:21:08,411.411] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 18:21:08,413.413] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 18:21:08] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations/delete-debug-conversation HTTP/1.1" 200 -
[2025-05-17 18:21:11,190.190] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 18:21:11,190.190] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 18:21:11,191.191] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.546e+04s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 18:21:11,195.195] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 18:21:11,196.196] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.546e+04s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 18:21:11,200.200] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 18:21:11,201.201] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.546e+04s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 18:21:11,206.206] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 18:21:11,207.207] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.546e+04s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 18:21:11,210.210] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO conversation (app_id, name, invoke_from, created_by) VALUES (%(app_id)s::UUID, %(name)s, %(invoke_from)s, %(created_by)s::UUID) RETURNING conversation.id, conversation.summary, conversation.is_pinned, conversation.is_deleted, conversation.updated_at, conversation.created_at
[2025-05-17 18:21:11,211.211] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.546e+04s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'name': 'New Conversation', 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 18:21:11,219.219] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app SET debug_conversation_id=%(debug_conversation_id)s::UUID WHERE app.id = %(app_id)s::UUID
[2025-05-17 18:21:11,219.219] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.546e+04s ago] {'debug_conversation_id': UUID('d91f1a0e-f941-45a3-b3ae-32e2bd4e4694'), 'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 18:21:11,220.220] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 18:21:11,221.221] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 18:21:11,222.222] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 18:21:11,222.222] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.546e+04s ago] {'pk_1': UUID('d91f1a0e-f941-45a3-b3ae-32e2bd4e4694')}
[2025-05-17 18:21:11,224.224] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 18:21:11,225.225] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.546e+04s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 18:21:11,227.227] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 18:21:11,227.227] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.546e+04s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('d91f1a0e-f941-45a3-b3ae-32e2bd4e4694'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '敏感词1', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 18:21:11,231.231] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 18:21:11,232.232] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 18:21:11,233.233] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 18:21:11,233.233] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.546e+04s ago] {'pk_1': UUID('d91f1a0e-f941-45a3-b3ae-32e2bd4e4694')}
[2025-05-17 18:21:11,235.235] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 18:21:11,235.235] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.546e+04s ago] {'pk_1': UUID('76868bff-aaad-4321-a9f1-209b9ed82c89')}
[2025-05-17 18:21:11,238.238] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 18:21:11] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 18:21:11,240.240] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET answer=%(answer)s WHERE message.id = %(message_id)s::UUID
[2025-05-17 18:21:11,240.240] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00046s] {'answer': '您输入了敏感词', 'message_id': UUID('76868bff-aaad-4321-a9f1-209b9ed82c89')}
[2025-05-17 18:21:11,242.242] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 18:21:18,732.732] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 18:21:18,732.732] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 18:21:18,732.732] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.547e+04s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 18:21:18,734.734] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 18:21:18,735.735] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.547e+04s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 18:21:18,737.737] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-17 18:21:18,738.738] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00091s] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 18:21:18,750.750] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 18:21:18,750.750] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.546e+04s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 18:21:18,755.755] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET dialog_round=%(dialog_round)s, review_config=%(review_config)s::JSONB, updated_at=%(updated_at)s WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-17 18:21:18,755.755] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00073s] {'dialog_round': 3, 'review_config': '{"enable": true, "keywords": ["\\u654f\\u611f\\u8bcd1", "\\u654f\\u611f\\u8bcd2"], "inputs_config": {"enable": false, "preset_response": "\\u60a8\\u8f93\\u5165\\u4e86\\u654f\\u611f\\u8bcd"}, "outputs_config": {"enable": true}}', 'updated_at': datetime.datetime(2025, 5, 17, 18, 21, 18, 752475), 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-17 18:21:18,758.758] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 18:21:18,759.759] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 18:21:18] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-17 18:21:23,814.814] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 18:21:23,815.815] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 18:21:23,815.815] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.547e+04s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 18:21:23,817.817] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 18:21:23,818.818] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.547e+04s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 18:21:23,819.819] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 18:21:23,820.820] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.547e+04s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 18:21:23,821.821] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 18:21:23,822.822] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.547e+04s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 18:21:23,825.825] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-17 18:21:23,825.825] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00056s] {'id_1': UUID('d91f1a0e-f941-45a3-b3ae-32e2bd4e4694'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-17 18:21:23,827.827] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message (app_id, conversation_id, created_by, query, status) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(created_by)s::UUID, %(query)s, %(status)s) RETURNING message.id, message.invoke_from, message.message, message.message_token_count, message.message_unit_price, message.message_price_unit, message.answer, message.answer_token_count, message.answer_unit_price, message.answer_price_unit, message.latency, message.is_deleted, message.error, message.total_token_count, message.total_price, message.updated_at, message.created_at
[2025-05-17 18:21:23,832.832] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.547e+04s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('d91f1a0e-f941-45a3-b3ae-32e2bd4e4694'), 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'query': '敏感词1', 'status': <MessageStatus.NORMAL: 'normal'>}
[2025-05-17 18:21:23,834.834] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 18:21:23,916.916] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 18:21:23,917.917] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 18:21:23,917.917] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.547e+04s ago] {'pk_1': UUID('d91f1a0e-f941-45a3-b3ae-32e2bd4e4694')}
[2025-05-17 18:21:23,920.920] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-17 18:21:23,920.920] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.547e+04s ago] {'conversation_id_1': UUID('d91f1a0e-f941-45a3-b3ae-32e2bd4e4694'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 3}
[2025-05-17 18:21:24,108.108] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 18:21:24,108.108] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.547e+04s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 18:21:24,143.143] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 18:21:24,153.153] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.547e+04s ago] {'pk_1': UUID('5c8cac25-3305-4cfc-9c5e-f0fecb9d1bfa')}
[2025-05-17 18:21:24,155.155] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 18:21:24] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-17 18:21:26,386.386] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 18:21:26,387.387] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.547e+04s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('d91f1a0e-f941-45a3-b3ae-32e2bd4e4694'), 'message_id': UUID('5c8cac25-3305-4cfc-9c5e-f0fecb9d1bfa'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 1, 'event': <QueueEvent.LONG_TERM_MEMORY_RECALL: 'long_term_memory_recall'>, 'thought': '', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '{}', 'answer': '', 'latency': 0}
[2025-05-17 18:21:26,389.389] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 18:21:26,390.390] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 18:21:26,390.390] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 18:21:26,391.391] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.547e+04s ago] {'pk_1': UUID('d91f1a0e-f941-45a3-b3ae-32e2bd4e4694')}
[2025-05-17 18:21:26,391.391] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 18:21:26,392.392] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.547e+04s ago] {'pk_1': UUID('5c8cac25-3305-4cfc-9c5e-f0fecb9d1bfa')}
[2025-05-17 18:21:26,392.392] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 18:21:26,393.393] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.547e+04s ago] {'pk_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-17 18:21:26,394.394] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO message_agent_thought (app_id, conversation_id, message_id, invoke_from, created_by, position, event, thought, observation, tool, tool_input, message, answer, latency) VALUES (%(app_id)s::UUID, %(conversation_id)s::UUID, %(message_id)s::UUID, %(invoke_from)s, %(created_by)s::UUID, %(position)s, %(event)s, %(thought)s, %(observation)s, %(tool)s, %(tool_input)s::JSONB, %(message)s::JSONB, %(answer)s, %(latency)s) RETURNING message_agent_thought.id, message_agent_thought.message_token_count, message_agent_thought.message_unit_price, message_agent_thought.message_price_unit, message_agent_thought.answer_token_count, message_agent_thought.answer_unit_price, message_agent_thought.answer_price_unit, message_agent_thought.total_token_count, message_agent_thought.total_price, message_agent_thought.updated_at, message_agent_thought.created_at
[2025-05-17 18:21:26,394.394] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.547e+04s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'conversation_id': UUID('d91f1a0e-f941-45a3-b3ae-32e2bd4e4694'), 'message_id': UUID('5c8cac25-3305-4cfc-9c5e-f0fecb9d1bfa'), 'invoke_from': <InvokeFrom.DEBUGGER: 'debugger'>, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'position': 2, 'event': <QueueEvent.AGENT_MESSAGE: 'agent_message'>, 'thought': '您输入了敏感词1。如果您有其他问题或需要帮助，请告诉我！', 'observation': '', 'tool': '', 'tool_input': '{}', 'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (3379 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "b9d25b1d-ab2c-4023-8b4e-b862b7f7cb08", "example": false}}]', 'answer': '您输入了敏感词1。如果您有其他问题或需要帮助，请告诉我！', 'latency': 2.228099599999041}
[2025-05-17 18:21:26,408.408] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 18:21:26,409.409] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 18:21:26,409.409] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.id = %(pk_1)s::UUID
[2025-05-17 18:21:26,410.410] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.547e+04s ago] {'pk_1': UUID('5c8cac25-3305-4cfc-9c5e-f0fecb9d1bfa')}
[2025-05-17 18:21:26,411.411] base.py -> _exec_single_context line:1896 [INFO]: UPDATE message SET message=%(message)s::JSONB, answer=%(answer)s WHERE message.id = %(message_id)s::UUID
[2025-05-17 18:21:26,411.411] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.547e+04s ago] {'message': '[{"type": "system", "data": {"content": "\\u4f60\\u662f\\u4e00\\u4e2a\\u9ad8\\u5ea6\\u5b9a\\u5236\\u7684\\u667a\\u80fd\\u4f53\\u5e94\\u7528\\uff0c\\u ... (3379 characters truncated) ... ", "additional_kwargs": {}, "response_metadata": {}, "type": "human", "name": null, "id": "b9d25b1d-ab2c-4023-8b4e-b862b7f7cb08", "example": false}}]', 'answer': '您输入了敏感词1。如果您有其他问题或需要帮助，请告诉我！', 'message_id': UUID('5c8cac25-3305-4cfc-9c5e-f0fecb9d1bfa')}
[2025-05-17 18:21:26,412.412] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 18:21:26,413.413] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 18:21:26,413.413] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(pk_1)s::UUID
[2025-05-17 18:21:26,413.413] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.547e+04s ago] {'pk_1': UUID('d91f1a0e-f941-45a3-b3ae-32e2bd4e4694')}
[2025-05-17 18:21:29,479.479] base.py -> _exec_single_context line:1896 [INFO]: SELECT count(message.id) AS count_1 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID
[2025-05-17 18:21:29,479.479] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.547e+04s ago] {'conversation_id_1': UUID('d91f1a0e-f941-45a3-b3ae-32e2bd4e4694')}
[2025-05-17 18:21:29,481.481] base.py -> _exec_single_context line:1896 [INFO]: UPDATE conversation SET summary=%(summary)s WHERE conversation.id = %(conversation_id)s::UUID
[2025-05-17 18:21:29,481.481] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.547e+04s ago] {'summary': '用户输入了敏感词1，AI检测到后提示用户输入了敏感内容，并表示愿意提供其他帮助。', 'conversation_id': UUID('d91f1a0e-f941-45a3-b3ae-32e2bd4e4694')}
[2025-05-17 18:21:29,482.482] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-17 18:21:46,286.286] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-17 18:21:46,286.286] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-17 18:21:46,287.287] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.55e+04s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-17 18:21:46,288.288] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-17 18:21:46,288.288] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.55e+04s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-17 18:21:46,289.289] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-17 18:21:46,289.289] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.549e+04s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-17 18:21:46,290.290] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-17 18:21:46,290.290] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1.549e+04s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-17 18:21:46,291.291] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-17 18:21:46,292.292] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [17/May/2025 18:21:46] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-17 19:27:51,393.393] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\app_service.py', reloading
[2025-05-17 19:27:53,131.131] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-17 19:28:22,229.229] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-17 19:28:22,260.260] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
