[2025-05-16 10:59:29,668.668] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-05-16 10:59:29,670.670] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-05-16 10:59:29,676.676] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-16 10:59:55,479.479] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-16 10:59:55,489.489] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-16 11:00:49,102.102] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-16 11:00:49,103.103] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 11:00:49,107.107] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-16 11:00:49,107.107] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 11:00:49,109.109] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-16 11:00:49,109.109] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 11:00:49,110.110] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 11:00:49,115.115] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 11:00:49,115.115] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00051s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 11:00:49,216.216] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-16 11:00:49,218.218] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00112s] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '2ac819a6-484a-4f18-b251-7cb713955c21'}
[2025-05-16 11:00:49,225.225] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 149, in ping
    content = dataset_retrival.invoke({"query": "æ¿€æ´»å‡½æ•°"})
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\tools\base.py", line 508, in invoke
    return self.run(tool_input, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\tools\base.py", line 763, in run
    raise error_to_raise
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\tools\base.py", line 732, in run
    response = context.run(self._run, *tool_args, **tool_kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\tools\structured.py", line 89, in _run
    return self.func(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\retrieval_service.py", line 122, in dataset_retrieval
    documents = self.search_in_datasets(
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\retrieval_service.py", line 45, in search_in_datasets
    raise NotFoundException("å½“å‰æ— çŸ¥è¯†åº“å¯æ‰§è¡Œæ£€ç´¢")
internal.exception.exception.NotFoundException
[2025-05-16 11:00:49,231.231] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 11:00:49,232.232] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 11:00:49] "GET /ping HTTP/1.1" 200 -
[2025-05-16 11:02:46,168.168] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\handler\\app_handler.py', reloading
[2025-05-16 11:02:47,724.724] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-16 11:03:10,623.623] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-16 11:03:10,631.631] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-16 11:03:11,329.329] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-16 11:03:11,329.329] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 11:03:11,332.332] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-16 11:03:11,333.333] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 11:03:11,334.334] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-16 11:03:11,334.334] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 11:03:11,335.335] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 11:03:11,339.339] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 11:03:11,339.339] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00033s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 11:03:11,428.428] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-16 11:03:11,429.429] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00053s] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-05-16 11:03:11,819.819] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO dataset_query (dataset_id, query, source, source_app_id, created_by) VALUES (%(dataset_id)s::UUID, %(query)s, %(source)s, %(source_app_id)s::UUID, %(created_by)s::UUID) RETURNING dataset_query.id, dataset_query.updated_at, dataset_query.created_at
[2025-05-16 11:03:11,820.820] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00042s] {'dataset_id': '059c1cbc-5230-4056-a44a-4537779922cd', 'query': 'æ¿€æ´»å‡½æ•°', 'source': <RetrievalSource.DEBUGGER: 'debugger'>, 'source_app_id': None, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-16 11:03:11,833.833] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 11:03:11,837.837] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 11:03:11,838.838] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (%(id_1_1)s::UUID, %(id_1_2)s::UUID, %(id_1_3)s::UUID, %(id_1_4)s::UUID, %(id_1_5)s::UUID, %(id_1_6)s::UUID, %(id_1_7)s::UUID, %(id_1_8)s::UUID, %(id_1_9)s::UUID, %(id_1_10)s::UUID)
[2025-05-16 11:03:11,839.839] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00041s] {'hit_count_1': 1, 'id_1_1': UUID('cac62fe4-3d56-45b4-acee-f92c865c0523'), 'id_1_2': UUID('af18d062-2f20-4bd1-a8cd-278f9aed8f51'), 'id_1_3': UUID('2ced08ab-0ded-4a1e-b5ef-592b45146385'), 'id_1_4': UUID('f46f3cbc-82f4-4481-b9cc-c07a946ca482'), 'id_1_5': UUID('be06d558-043c-4626-b75c-b21f586ffc0a'), 'id_1_6': UUID('ba845069-2d50-44e2-83e1-d4710428293a'), 'id_1_7': UUID('3e500d00-555b-440a-8c19-7c19293a1e9b'), 'id_1_8': UUID('b92f1ab7-97b2-4f81-bfa2-f8eace52aa69'), 'id_1_9': UUID('b074585d-8b7c-49a1-84f4-d8109b726cdb'), 'id_1_10': UUID('ff63c8af-698c-4ea2-84ce-2a5f366ef253')}
[2025-05-16 11:03:11,847.847] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 11:03:11,850.850] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 11:03:11] "GET /ping HTTP/1.1" 200 -
[2025-05-16 15:53:57,980.980] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-05-16 15:53:57,981.981] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-05-16 15:53:57,986.986] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-16 15:54:24,892.892] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-16 15:54:24,916.916] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-16 15:54:26,013.013] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-16 15:54:26,014.014] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 15:54:26,016.016] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-16 15:54:26,018.018] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 15:54:26,019.019] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-16 15:54:26,019.019] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 15:54:26,020.020] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 15:54:26,026.026] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 15:54:26,027.027] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00110s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 15:54:26,041.041] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 15:54:26,042.042] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00073s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 15:54:26,052.052] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 15:54:26,053.053] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00127s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 15:54:26,066.066] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 15:54:26,066.066] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00092s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-16 15:54:26,070.070] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-16 15:54:26,070.070] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00078s] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-16 15:54:26,075.075] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 15:54:26,095.095] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 15:54:26] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-16 15:56:03,888.888] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\app_service.py', reloading
[2025-05-16 15:56:05,156.156] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-16 15:56:33,251.251] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-16 15:56:33,262.262] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-16 15:56:43,746.746] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\app_service.py', reloading
[2025-05-16 15:56:45,419.419] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-16 15:57:10,212.212] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-16 15:57:10,225.225] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-16 15:57:11,281.281] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-16 15:57:11,281.281] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 15:57:11,285.285] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-16 15:57:11,285.285] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 15:57:11,287.287] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-16 15:57:11,287.287] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 15:57:11,288.288] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 15:57:11,294.294] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 15:57:11,294.294] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00080s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 15:57:11,308.308] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 15:57:11,309.309] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00059s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 15:57:11,315.315] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 15:57:11,316.316] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00053s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 15:57:11,322.322] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 15:57:11,322.322] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00094s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-16 15:57:11,326.326] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-16 15:57:11,327.327] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00052s] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-16 15:57:11,330.330] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 15:57:11,348.348] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 15:57:11] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-16 16:09:04,274.274] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:09:04,275.275] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:09:04,276.276] base.py -> _exec_single_context line:1901 [INFO]: [cached since 713s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:09:04,277.277] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:09:04,278.278] base.py -> _exec_single_context line:1901 [INFO]: [cached since 713s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:09:04,279.279] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 558, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 16:09:04,286.286] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:09:04,287.287] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:09:04] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:10:50,483.483] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:10:50,483.483] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:10:50,484.484] base.py -> _exec_single_context line:1901 [INFO]: [cached since 819.2s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:10:50,486.486] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:10:50,486.486] base.py -> _exec_single_context line:1901 [INFO]: [cached since 819.2s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:10:50,488.488] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 558, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 16:10:50,489.489] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:10:50,491.491] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:10:50] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:11:27,950.950] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:11:27,950.950] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:11:27,951.951] base.py -> _exec_single_context line:1901 [INFO]: [cached since 856.7s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:11:27,953.953] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:11:27,953.953] base.py -> _exec_single_context line:1901 [INFO]: [cached since 856.6s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:11:27,954.954] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 558, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 16:11:27,955.955] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:11:27,956.956] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:11:27] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:11:29,486.486] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:11:29,487.487] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:11:29,487.487] base.py -> _exec_single_context line:1901 [INFO]: [cached since 858.2s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:11:29,488.488] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:11:29,489.489] base.py -> _exec_single_context line:1901 [INFO]: [cached since 858.2s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:11:29,490.490] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 558, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 16:11:29,491.491] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:11:29,491.491] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:11:29] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:12:23,794.794] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\app_service.py', reloading
[2025-05-16 16:12:25,173.173] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-16 16:12:49,290.290] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-16 16:12:49,310.310] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-16 16:13:52,388.388] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-16 16:13:52,389.389] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 16:13:52,391.391] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-16 16:13:52,391.391] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 16:13:52,392.392] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-16 16:13:52,393.393] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 16:13:52,393.393] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:13:52,397.397] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:13:52,398.398] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00039s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:13:52,405.405] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:13:52,405.405] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00035s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:13:52,409.409] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 16:13:52,410.410] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00039s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 16:13:52,415.415] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET model_config=%(model_config)s::JSONB, dialog_round=%(dialog_round)s, preset_prompt=%(preset_prompt)s, updated_at=%(updated_at)s WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-16 16:13:52,415.415] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00048s] {'model_config': '{"provider": "openai", "model": "gpt-4-turbo"}', 'dialog_round': 5, 'preset_prompt': 'ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šã€å‹å¥½çš„AIåŠ©æ‰‹', 'updated_at': datetime.datetime(2025, 5, 16, 16, 13, 52, 412941), 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-16 16:13:52,419.419] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 16:13:52,423.423] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:13:52] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:13:56,683.683] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:13:56,684.684] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:13:56,684.684] base.py -> _exec_single_context line:1901 [INFO]: [cached since 4.286s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:13:56,689.689] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:13:56,689.689] base.py -> _exec_single_context line:1901 [INFO]: [cached since 4.284s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:13:56,691.691] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 16:13:56,691.691] base.py -> _exec_single_context line:1901 [INFO]: [cached since 4.281s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 16:13:56,693.693] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 16:13:56,693.693] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00038s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-16 16:13:56,697.697] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-16 16:13:56,697.697] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00032s] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-16 16:13:56,698.698] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:13:56,708.708] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:13:56] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-16 16:14:01,722.722] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:14:01,723.723] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:14:01,723.723] base.py -> _exec_single_context line:1901 [INFO]: [cached since 9.325s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:14:01,725.725] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:14:01,725.725] base.py -> _exec_single_context line:1901 [INFO]: [cached since 9.32s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:14:01,726.726] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 16:14:01,726.726] base.py -> _exec_single_context line:1901 [INFO]: [cached since 9.317s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 16:14:01,728.728] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 16:14:01,728.728] base.py -> _exec_single_context line:1901 [INFO]: [cached since 5.035s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-16 16:14:01,728.728] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-16 16:14:01,733.733] base.py -> _exec_single_context line:1901 [INFO]: [cached since 5.037s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-16 16:14:01,735.735] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:14:01,741.741] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:14:01] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-16 16:14:59,030.030] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:14:59,031.031] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:14:59,031.031] base.py -> _exec_single_context line:1901 [INFO]: [cached since 66.63s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:14:59,034.034] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:14:59,035.035] base.py -> _exec_single_context line:1901 [INFO]: [cached since 66.63s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:14:59,037.037] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 556, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 16:14:59,042.042] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:14:59,043.043] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:14:59] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:17:00,810.810] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:17:00,811.811] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:17:00,811.811] base.py -> _exec_single_context line:1901 [INFO]: [cached since 188.4s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:17:00,814.814] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:17:00,814.814] base.py -> _exec_single_context line:1901 [INFO]: [cached since 188.4s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:17:00,815.815] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 556, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 16:17:00,815.815] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:17:00,816.816] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:17:00] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:19:42,209.209] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:19:42,210.210] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:19:42,210.210] base.py -> _exec_single_context line:1901 [INFO]: [cached since 349.8s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:19:42,212.212] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:19:42,212.212] base.py -> _exec_single_context line:1901 [INFO]: [cached since 349.8s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:19:42,213.213] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 556, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 16:19:42,214.214] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:19:42,215.215] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:19:42] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:19:43,425.425] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:19:43,426.426] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:19:43,426.426] base.py -> _exec_single_context line:1901 [INFO]: [cached since 351s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:19:43,427.427] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:19:43,429.429] base.py -> _exec_single_context line:1901 [INFO]: [cached since 351s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:19:43,430.430] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 556, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 16:19:43,431.431] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:19:43,431.431] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:19:43] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:19:57,051.051] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:19:57,052.052] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:19:57,052.052] base.py -> _exec_single_context line:1901 [INFO]: [cached since 364.7s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:19:57,054.054] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:19:57,055.055] base.py -> _exec_single_context line:1901 [INFO]: [cached since 364.7s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:19:57,057.057] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 16:19:57,057.057] base.py -> _exec_single_context line:1901 [INFO]: [cached since 364.6s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 16:19:57,059.059] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET updated_at=%(updated_at)s WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-16 16:19:57,059.059] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00032s] {'updated_at': datetime.datetime(2025, 5, 16, 16, 19, 57, 58688), 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-16 16:19:57,060.060] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 16:19:57,062.062] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:19:57] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:20:13,097.097] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:20:13,098.098] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:20:13,098.098] base.py -> _exec_single_context line:1901 [INFO]: [cached since 380.7s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:20:13,101.101] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:20:13,101.101] base.py -> _exec_single_context line:1901 [INFO]: [cached since 380.7s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:20:13,103.103] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 556, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 16:20:13,104.104] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:20:13,104.104] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:20:13] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:20:17,480.480] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:20:17,480.480] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:20:17,480.480] base.py -> _exec_single_context line:1901 [INFO]: [cached since 385.1s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:20:17,482.482] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:20:17,482.482] base.py -> _exec_single_context line:1901 [INFO]: [cached since 385.1s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:20:17,483.483] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 16:20:17,483.483] base.py -> _exec_single_context line:1901 [INFO]: [cached since 385.1s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 16:20:17,484.484] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET updated_at=%(updated_at)s WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-16 16:20:17,484.484] base.py -> _exec_single_context line:1901 [INFO]: [cached since 20.43s ago] {'updated_at': datetime.datetime(2025, 5, 16, 16, 20, 17, 484329), 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-16 16:20:17,485.485] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 16:20:17,486.486] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:20:17] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:20:24,350.350] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:20:24,351.351] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:20:24,351.351] base.py -> _exec_single_context line:1901 [INFO]: [cached since 392s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:20:24,353.353] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:20:24,353.353] base.py -> _exec_single_context line:1901 [INFO]: [cached since 391.9s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:20:24,354.354] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 556, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 16:20:24,354.354] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:20:24,355.355] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:20:24] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:20:31,453.453] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:20:31,454.454] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:20:31,454.454] base.py -> _exec_single_context line:1901 [INFO]: [cached since 399.1s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:20:31,455.455] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:20:31,455.455] base.py -> _exec_single_context line:1901 [INFO]: [cached since 399.1s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:20:31,456.456] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 556, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 16:20:31,457.457] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:20:31,457.457] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:20:31] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:20:36,143.143] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:20:36,143.143] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:20:36,144.144] base.py -> _exec_single_context line:1901 [INFO]: [cached since 403.7s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:20:36,146.146] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:20:36,146.146] base.py -> _exec_single_context line:1901 [INFO]: [cached since 403.7s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:20:36,147.147] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 556, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 16:20:36,148.148] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:20:36,149.149] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:20:36] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:20:42,948.948] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:20:42,948.948] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:20:42,949.949] base.py -> _exec_single_context line:1901 [INFO]: [cached since 410.6s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:20:42,950.950] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:20:42,950.950] base.py -> _exec_single_context line:1901 [INFO]: [cached since 410.5s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:20:42,953.953] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 556, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 16:20:42,954.954] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:20:42,955.955] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:20:42] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:20:50,429.429] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:20:50,430.430] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:20:50,430.430] base.py -> _exec_single_context line:1901 [INFO]: [cached since 418s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:20:50,431.431] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:20:50,431.431] base.py -> _exec_single_context line:1901 [INFO]: [cached since 418s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:20:50,432.432] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 556, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 16:20:50,433.433] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:20:50,433.433] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:20:50] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:20:57,826.826] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:20:57,826.826] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:20:57,827.827] base.py -> _exec_single_context line:1901 [INFO]: [cached since 425.4s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:20:57,829.829] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:20:57,829.829] base.py -> _exec_single_context line:1901 [INFO]: [cached since 425.4s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:20:57,830.830] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 16:20:57,831.831] base.py -> _exec_single_context line:1901 [INFO]: [cached since 425.4s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 16:20:57,832.832] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET updated_at=%(updated_at)s WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-16 16:20:57,833.833] base.py -> _exec_single_context line:1901 [INFO]: [cached since 60.77s ago] {'updated_at': datetime.datetime(2025, 5, 16, 16, 20, 57, 832913), 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-16 16:20:57,844.844] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 16:20:57,846.846] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:20:57] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:21:01,688.688] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:21:01,689.689] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:21:01,689.689] base.py -> _exec_single_context line:1901 [INFO]: [cached since 429.3s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:21:01,691.691] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:21:01,691.691] base.py -> _exec_single_context line:1901 [INFO]: [cached since 429.3s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:21:01,693.693] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 16:21:01,693.693] base.py -> _exec_single_context line:1901 [INFO]: [cached since 429.3s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 16:21:01,694.694] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET updated_at=%(updated_at)s WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-16 16:21:01,695.695] base.py -> _exec_single_context line:1901 [INFO]: [cached since 64.64s ago] {'updated_at': datetime.datetime(2025, 5, 16, 16, 21, 1, 694853), 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-16 16:21:01,695.695] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 16:21:01,696.696] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:21:01] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:21:08,534.534] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:21:08,534.534] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:21:08,535.535] base.py -> _exec_single_context line:1901 [INFO]: [cached since 436.1s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:21:08,537.537] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:21:08,537.537] base.py -> _exec_single_context line:1901 [INFO]: [cached since 436.1s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:21:08,538.538] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 556, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 16:21:08,539.539] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:21:08,540.540] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:21:08] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:21:14,002.002] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:21:14,003.003] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:21:14,003.003] base.py -> _exec_single_context line:1901 [INFO]: [cached since 441.6s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:21:14,005.005] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:21:14,005.005] base.py -> _exec_single_context line:1901 [INFO]: [cached since 441.6s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:21:14,006.006] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 556, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 16:21:14,008.008] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:21:14,008.008] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:21:14] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:21:45,496.496] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\app_service.py', reloading
[2025-05-16 16:21:47,008.008] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-16 16:22:13,544.544] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-16 16:22:13,560.560] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-16 16:22:14,834.834] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-16 16:22:14,835.835] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 16:22:14,843.843] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-16 16:22:14,843.843] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 16:22:14,847.847] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-16 16:22:14,849.849] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 16:22:14,852.852] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:22:14,884.884] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:22:14,885.885] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00212s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:22:14,907.907] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:22:14,907.907] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00070s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:22:14,912.912] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 556, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 16:22:14,926.926] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:22:14,928.928] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:22:14] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:22:40,885.885] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\app_service.py', reloading
[2025-05-16 16:22:42,531.531] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-16 16:23:16,619.619] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-16 16:23:16,631.631] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-16 16:23:17,644.644] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-16 16:23:17,645.645] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 16:23:17,654.654] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-16 16:23:17,656.656] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 16:23:17,659.659] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-16 16:23:17,659.659] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 16:23:17,660.660] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:23:17,666.666] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:23:17,667.667] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00056s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:23:17,678.678] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:23:17,679.679] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00059s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:23:17,687.687] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 16:23:17,687.687] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00041s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 16:23:17,698.698] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET updated_at=%(updated_at)s WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-16 16:23:17,698.698] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00054s] {'updated_at': datetime.datetime(2025, 5, 16, 16, 23, 17, 695572), 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-16 16:23:17,701.701] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 16:23:17,705.705] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:23:17] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:24:11,295.295] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:24:11,297.297] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:24:11,298.298] base.py -> _exec_single_context line:1901 [INFO]: [cached since 53.63s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:24:11,300.300] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:24:11,301.301] base.py -> _exec_single_context line:1901 [INFO]: [cached since 53.62s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:24:11,302.302] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 556, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 16:24:11,308.308] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:24:11,309.309] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:24:11] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:26:15,861.861] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:26:15,863.863] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:26:15,863.863] base.py -> _exec_single_context line:1901 [INFO]: [cached since 178.2s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:26:15,865.865] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:26:15,865.865] base.py -> _exec_single_context line:1901 [INFO]: [cached since 178.2s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:26:15,866.866] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 556, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 16:26:15,867.867] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:26:15,867.867] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:26:15] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:26:25,169.169] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:26:25,170.170] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:26:25,170.170] base.py -> _exec_single_context line:1901 [INFO]: [cached since 187.5s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:26:25,172.172] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:26:25,172.172] base.py -> _exec_single_context line:1901 [INFO]: [cached since 187.5s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:26:25,173.173] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 556, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 16:26:25,174.174] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:26:25,176.176] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:26:25] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:26:28,206.206] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:26:28,207.207] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:26:28,207.207] base.py -> _exec_single_context line:1901 [INFO]: [cached since 190.5s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:26:28,209.209] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:26:28,209.209] base.py -> _exec_single_context line:1901 [INFO]: [cached since 190.5s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:26:28,211.211] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 16:26:28,212.212] base.py -> _exec_single_context line:1901 [INFO]: [cached since 190.5s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 16:26:28,213.213] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET updated_at=%(updated_at)s WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-16 16:26:28,213.213] base.py -> _exec_single_context line:1901 [INFO]: [cached since 190.5s ago] {'updated_at': datetime.datetime(2025, 5, 16, 16, 26, 28, 213749), 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-16 16:26:28,215.215] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 16:26:28,216.216] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:26:28] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:26:34,295.295] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:26:34,296.296] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:26:34,296.296] base.py -> _exec_single_context line:1901 [INFO]: [cached since 196.6s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:26:34,298.298] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:26:34,298.298] base.py -> _exec_single_context line:1901 [INFO]: [cached since 196.6s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:26:34,298.298] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 556, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 16:26:34,299.299] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:26:34,300.300] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:26:34] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:26:46,920.920] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:26:46,921.921] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:26:46,921.921] base.py -> _exec_single_context line:1901 [INFO]: [cached since 209.3s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:26:46,922.922] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:26:46,922.922] base.py -> _exec_single_context line:1901 [INFO]: [cached since 209.2s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:26:46,924.924] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 556, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 16:26:46,924.924] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:26:46,925.925] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:26:46] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:26:53,441.441] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:26:53,441.441] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:26:53,442.442] base.py -> _exec_single_context line:1901 [INFO]: [cached since 215.8s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:26:53,443.443] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:26:53,443.443] base.py -> _exec_single_context line:1901 [INFO]: [cached since 215.8s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:26:53,444.444] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 556, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 16:26:53,445.445] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:26:53,445.445] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:26:53] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:26:56,957.957] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:26:56,958.958] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:26:56,958.958] base.py -> _exec_single_context line:1901 [INFO]: [cached since 219.3s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:26:56,959.959] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:26:56,959.959] base.py -> _exec_single_context line:1901 [INFO]: [cached since 219.3s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:26:56,960.960] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 556, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 16:26:56,961.961] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:26:56,961.961] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:26:56] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:27:00,265.265] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:27:00,265.265] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:27:00,265.265] base.py -> _exec_single_context line:1901 [INFO]: [cached since 222.6s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:27:00,267.267] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:27:00,268.268] base.py -> _exec_single_context line:1901 [INFO]: [cached since 222.6s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:27:00,269.269] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 556, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 16:27:00,269.269] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:27:00,270.270] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:27:00] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:27:03,260.260] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:27:03,260.260] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:27:03,260.260] base.py -> _exec_single_context line:1901 [INFO]: [cached since 225.6s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:27:03,262.262] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:27:03,262.262] base.py -> _exec_single_context line:1901 [INFO]: [cached since 225.6s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:27:03,263.263] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 556, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 16:27:03,263.263] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:27:03,264.264] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:27:03] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:27:05,489.489] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:27:05,489.489] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:27:05,490.490] base.py -> _exec_single_context line:1901 [INFO]: [cached since 227.8s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:27:05,492.492] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:27:05,492.492] base.py -> _exec_single_context line:1901 [INFO]: [cached since 227.8s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:27:05,494.494] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 556, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 16:27:05,495.495] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:27:05,496.496] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:27:05] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:27:07,861.861] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:27:07,861.861] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:27:07,861.861] base.py -> _exec_single_context line:1901 [INFO]: [cached since 230.2s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:27:07,863.863] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:27:07,864.864] base.py -> _exec_single_context line:1901 [INFO]: [cached since 230.2s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:27:07,864.864] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 556, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 16:27:07,865.865] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:27:07,865.865] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:27:07] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:27:11,267.267] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:27:11,267.267] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:27:11,268.268] base.py -> _exec_single_context line:1901 [INFO]: [cached since 233.6s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:27:11,269.269] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:27:11,270.270] base.py -> _exec_single_context line:1901 [INFO]: [cached since 233.6s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:27:11,271.271] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 16:27:11,271.271] base.py -> _exec_single_context line:1901 [INFO]: [cached since 233.6s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 16:27:11,273.273] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET model_config=%(model_config)s::JSONB, updated_at=%(updated_at)s WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-16 16:27:11,273.273] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00057s] {'model_config': '{"provider": "openai", "model": "gpt-4-turbo", "parameters": {"temperature": 0.7, "top_p": 0.9, "frequency_penalty": 0.1, "presence_penalty": 0.1, "max_tokens": 4096}}', 'updated_at': datetime.datetime(2025, 5, 16, 16, 27, 11, 272530), 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-16 16:27:11,276.276] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 16:27:11,277.277] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:27:11] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 16:27:25,762.762] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:27:25,763.763] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:27:25,763.763] base.py -> _exec_single_context line:1901 [INFO]: [cached since 248.1s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:27:25,768.768] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:27:25,768.768] base.py -> _exec_single_context line:1901 [INFO]: [cached since 248.1s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:27:25,769.769] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 16:27:25,769.769] base.py -> _exec_single_context line:1901 [INFO]: [cached since 248.1s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 16:27:25,771.771] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 16:27:25,772.772] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00042s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-16 16:27:25,776.776] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-16 16:27:25,777.777] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00042s] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-16 16:27:25,831.831] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-16 16:27:25,831.831] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00040s] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 5}
[2025-05-16 16:27:25,836.836] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 16:27:25,844.844] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:27:25] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-16 16:29:43,902.902] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\app_service.py', reloading
[2025-05-16 16:29:45,357.357] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-16 16:30:10,885.885] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-16 16:30:10,899.899] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-16 16:30:11,887.887] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-16 16:30:11,888.888] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 16:30:11,892.892] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-16 16:30:11,892.892] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 16:30:11,893.893] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-16 16:30:11,894.894] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 16:30:11,895.895] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:30:11,902.902] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:30:11,904.904] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00054s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:30:11,919.919] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:30:11,920.920] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00051s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:30:11,926.926] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 16:30:11,927.927] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00080s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 16:30:11,933.933] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 16:30:11,933.933] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00065s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-16 16:30:11,937.937] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-16 16:30:11,938.938] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00103s] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-16 16:30:12,035.035] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-16 16:30:12,035.035] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00068s] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 5}
[2025-05-16 16:30:12,279.279] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:30:12] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-16 16:37:10,845.845] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:37:10,848.848] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:37:10,848.848] base.py -> _exec_single_context line:1901 [INFO]: [cached since 418.9s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:37:10,853.853] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:37:10,854.854] base.py -> _exec_single_context line:1901 [INFO]: [cached since 418.9s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:37:10,857.857] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 16:37:10,857.857] base.py -> _exec_single_context line:1901 [INFO]: [cached since 418.9s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 16:37:10,860.860] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 16:37:10,860.860] base.py -> _exec_single_context line:1901 [INFO]: [cached since 418.9s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-16 16:37:10,881.881] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_config (app_id, model_config, dialog_round, preset_prompt, tools, workflows, retrieval_config, long_term_memory, opening_statement, opening_questions, speech_to_text, text_to_speech, review_config, updated_at, created_at) VALUES (%(app_id)s::UUID, %(model_config)s::JSONB, %(dialog_round)s, %(preset_prompt)s, %(tools)s::JSONB, %(workflows)s::JSONB, %(retrieval_config)s::JSONB, %(long_term_memory)s::JSONB, %(opening_statement)s, %(opening_questions)s::JSONB, %(speech_to_text)s::JSONB, %(text_to_speech)s::JSONB, %(review_config)s::JSONB, %(updated_at)s, %(created_at)s) RETURNING app_config.id, app_config.suggested_after_answer
[2025-05-16 16:37:10,882.882] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00157s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'model_config': '{"model": "gpt-4-turbo", "provider": "openai", "parameters": {"top_p": 0.9, "max_tokens": 4096, "temperature": 0.7, "presence_penalty": 0.1, "frequency_penalty": 0.1}}', 'dialog_round': 5, 'preset_prompt': 'ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šã€å‹å¥½çš„AIåŠ©æ‰‹', 'tools': '[]', 'workflows': '[]', 'retrieval_config': '{"k": 5, "score": 0.7, "retrieval_strategy": "semantic"}', 'long_term_memory': '{"enable": true}', 'opening_statement': 'ä½ å¥½ï¼Œæˆ‘æ˜¯AIåŠ©æ‰‹', 'opening_questions': '["\\u6709\\u4ec0\\u4e48\\u53ef\\u4ee5\\u5e2e\\u60a8\\uff1f", "\\u60a8\\u9700\\u8981\\u4ec0\\u4e48\\u5e2e\\u52a9\\uff1f"]', 'speech_to_text': '{"enable": false}', 'text_to_speech': '{"voice": "echo", "enable": false, "auto_play": false}', 'review_config': '{"enable": false, "keywords": ["\\u654f\\u611f\\u8bcd1", "\\u654f\\u611f\\u8bcd2"], "inputs_config": {"enable": false, "preset_response": "\\u9884\\u8bbe\\u54cd\\u5e94"}, "outputs_config": {"enable": false}}', 'updated_at': datetime.datetime(2025, 5, 16, 8, 37, 10, 881170), 'created_at': datetime.datetime(2025, 5, 16, 8, 37, 10, 881170)}
[2025-05-16 16:37:10,894.894] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 16:37:10,897.897] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:37:10,899.899] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config.id AS app_config_id, app_config.app_id AS app_config_app_id, app_config.model_config AS app_config_model_config, app_config.dialog_round AS app_config_dialog_round, app_config.preset_prompt AS app_config_preset_prompt, app_config.tools AS app_config_tools, app_config.workflows AS app_config_workflows, app_config.retrieval_config AS app_config_retrieval_config, app_config.long_term_memory AS app_config_long_term_memory, app_config.opening_statement AS app_config_opening_statement, app_config.opening_questions AS app_config_opening_questions, app_config.speech_to_text AS app_config_speech_to_text, app_config.text_to_speech AS app_config_text_to_speech, app_config.suggested_after_answer AS app_config_suggested_after_answer, app_config.review_config AS app_config_review_config, app_config.updated_at AS app_config_updated_at, app_config.created_at AS app_config_created_at 
FROM app_config 
WHERE app_config.id = %(pk_1)s::UUID
[2025-05-16 16:37:10,900.900] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00040s] {'pk_1': UUID('c07ce40b-2d1a-4226-99cf-3b497900a441')}
[2025-05-16 16:37:10,902.902] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:37:10,902.902] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00061s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:37:10,906.906] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app SET app_config_id=%(app_config_id)s::UUID WHERE app.id = %(app_id)s::UUID
[2025-05-16 16:37:10,906.906] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00035s] {'app_config_id': UUID('c07ce40b-2d1a-4226-99cf-3b497900a441'), 'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:37:10,907.907] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 16:37:10,910.910] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:37:10,911.911] base.py -> _exec_single_context line:1896 [INFO]: DELETE FROM app_dataset_join WHERE app_dataset_join.app_id = %(app_id_1)s::UUID
[2025-05-16 16:37:10,912.912] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00027s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:37:10,914.914] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 16:37:10,915.915] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:37:10,916.916] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_dataset_join (app_id, dataset_id) VALUES (%(app_id)s::UUID, %(dataset_id)s::UUID) RETURNING app_dataset_join.id, app_dataset_join.updated_at, app_dataset_join.created_at
[2025-05-16 16:37:10,916.916] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00031s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'dataset_id': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-16 16:37:10,918.918] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 16:37:10,919.919] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:37:10,919.919] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:37:10,919.919] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0178s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:37:10,920.920] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 16:37:10,920.920] base.py -> _exec_single_context line:1901 [INFO]: [cached since 419s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 16:37:10,925.925] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(max(app_config_version.version), %(coalesce_2)s) AS coalesce_1 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 16:37:10,925.925] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00051s] {'coalesce_2': 0, 'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.PUBLISHED: 'published'>}
[2025-05-16 16:37:10,938.938] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_config_version (app_id, model_config, dialog_round, preset_prompt, tools, workflows, datasets, retrieval_config, long_term_memory, opening_statement, opening_questions, speech_to_text, text_to_speech, suggested_after_answer, review_config, version, config_type) VALUES (%(app_id)s::UUID, %(model_config)s::JSONB, %(dialog_round)s, %(preset_prompt)s, %(tools)s::JSONB, %(workflows)s::JSONB, %(datasets)s::JSONB, %(retrieval_config)s::JSONB, %(long_term_memory)s::JSONB, %(opening_statement)s, %(opening_questions)s::JSONB, %(speech_to_text)s::JSONB, %(text_to_speech)s::JSONB, %(suggested_after_answer)s::JSONB, %(review_config)s::JSONB, %(version)s, %(config_type)s) RETURNING app_config_version.id, app_config_version.updated_at, app_config_version.created_at
[2025-05-16 16:37:10,938.938] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00609s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'model_config': '{"model": "gpt-4-turbo", "provider": "openai", "parameters": {"top_p": 0.9, "max_tokens": 4096, "temperature": 0.7, "presence_penalty": 0.1, "frequency_penalty": 0.1}}', 'dialog_round': 5, 'preset_prompt': 'ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šã€å‹å¥½çš„AIåŠ©æ‰‹', 'tools': '[]', 'workflows': '[]', 'datasets': '["9af90c52-28b2-4a47-9c92-148c9f21b512"]', 'retrieval_config': '{"k": 5, "score": 0.7, "retrieval_strategy": "semantic"}', 'long_term_memory': '{"enable": true}', 'opening_statement': 'ä½ å¥½ï¼Œæˆ‘æ˜¯AIåŠ©æ‰‹', 'opening_questions': '["\\u6709\\u4ec0\\u4e48\\u53ef\\u4ee5\\u5e2e\\u60a8\\uff1f", "\\u60a8\\u9700\\u8981\\u4ec0\\u4e48\\u5e2e\\u52a9\\uff1f"]', 'speech_to_text': '{"enable": false}', 'text_to_speech': '{"voice": "echo", "enable": false, "auto_play": false}', 'suggested_after_answer': '{"enable": true}', 'review_config': '{"enable": false, "keywords": ["\\u654f\\u611f\\u8bcd1", "\\u654f\\u611f\\u8bcd2"], "inputs_config": {"enable": false, "preset_response": "\\u9884\\u8bbe\\u54cd\\u5e94"}, "outputs_config": {"enable": false}}', 'version': 7, 'config_type': <AppConfigType.PUBLISHED: 'published'>}
[2025-05-16 16:37:10,941.941] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 16:37:10,946.946] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:37:10] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/publish HTTP/1.1" 200 -
[2025-05-16 16:37:26,430.430] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:37:26,430.430] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:37:26,430.430] base.py -> _exec_single_context line:1901 [INFO]: [cached since 434.5s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:37:26,433.433] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:37:26,433.433] base.py -> _exec_single_context line:1901 [INFO]: [cached since 434.5s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:37:26,435.435] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 16:37:26,435.435] base.py -> _exec_single_context line:1901 [INFO]: [cached since 434.5s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 16:37:26,436.436] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 16:37:26,436.436] base.py -> _exec_single_context line:1901 [INFO]: [cached since 434.5s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-16 16:37:26,437.437] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-16 16:37:26,438.438] base.py -> _exec_single_context line:1901 [INFO]: [cached since 434.5s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-16 16:37:26,514.514] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-16 16:37:26,516.516] base.py -> _exec_single_context line:1901 [INFO]: [cached since 434.5s ago] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 5}
[2025-05-16 16:37:26,548.548] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:37:26] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-16 16:56:44,309.309] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:56:44,312.312] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:56:44,312.312] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1592s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:56:44,318.318] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:56:44,318.318] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1592s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:56:44,323.323] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 16:56:44,323.323] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1592s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 16:56:44,327.327] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 16:56:44,328.328] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1592s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-16 16:56:44,330.330] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-16 16:56:44,331.331] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1592s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-16 16:56:44,420.420] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-16 16:56:44,421.421] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1592s ago] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 5}
[2025-05-16 16:56:44,468.468] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:56:44] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-16 16:59:04,206.206] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 16:59:04,207.207] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 16:59:04,207.207] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1732s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 16:59:04,210.210] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 16:59:04,210.210] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1732s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 16:59:04,212.212] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 16:59:04,212.212] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1732s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 16:59:04,214.214] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 16:59:04,214.214] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1732s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-16 16:59:04,215.215] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-16 16:59:04,216.216] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1732s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-16 16:59:04,302.302] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-16 16:59:04,303.303] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1732s ago] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 5}
[2025-05-16 16:59:04,328.328] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 16:59:04] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-16 17:00:09,037.037] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-05-16 17:00:09,038.038] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-05-16 17:00:09,043.043] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-16 17:00:36,280.280] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-16 17:00:36,301.301] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-16 17:00:51,677.677] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-16 17:00:51,677.677] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 17:00:51,680.680] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-16 17:00:51,680.680] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 17:00:51,681.681] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-16 17:00:51,681.681] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 17:00:51,682.682] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 17:00:51,684.684] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 17:00:51,685.685] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00035s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 17:00:51,689.689] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 17:00:51,690.690] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00026s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 17:00:51,694.694] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 17:00:51,695.695] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00045s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 17:00:51,699.699] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 17:00:51,699.699] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00043s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-16 17:00:51,702.702] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_config (app_id, model_config, dialog_round, preset_prompt, tools, workflows, retrieval_config, long_term_memory, opening_statement, opening_questions, speech_to_text, text_to_speech, review_config, updated_at, created_at) VALUES (%(app_id)s::UUID, %(model_config)s::JSONB, %(dialog_round)s, %(preset_prompt)s, %(tools)s::JSONB, %(workflows)s::JSONB, %(retrieval_config)s::JSONB, %(long_term_memory)s::JSONB, %(opening_statement)s, %(opening_questions)s::JSONB, %(speech_to_text)s::JSONB, %(text_to_speech)s::JSONB, %(review_config)s::JSONB, %(updated_at)s, %(created_at)s) RETURNING app_config.id, app_config.suggested_after_answer
[2025-05-16 17:00:51,703.703] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00032s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'model_config': '{"model": "gpt-4o", "provider": "openai", "parameters": {"top_p": 0.9, "max_tokens": 4096, "temperature": 0.7, "presence_penalty": 0.1, "frequency_penalty": 0.1}}', 'dialog_round': 5, 'preset_prompt': 'ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šã€å‹å¥½çš„AIåŠ©æ‰‹', 'tools': '[]', 'workflows': '[]', 'retrieval_config': '{"k": 5, "score": 0.7, "retrieval_strategy": "semantic"}', 'long_term_memory': '{"enable": true}', 'opening_statement': 'ä½ å¥½ï¼Œæˆ‘æ˜¯AIåŠ©æ‰‹', 'opening_questions': '["\\u6709\\u4ec0\\u4e48\\u53ef\\u4ee5\\u5e2e\\u60a8\\uff1f", "\\u60a8\\u9700\\u8981\\u4ec0\\u4e48\\u5e2e\\u52a9\\uff1f"]', 'speech_to_text': '{"enable": false}', 'text_to_speech': '{"voice": "echo", "enable": false, "auto_play": false}', 'review_config': '{"enable": false, "keywords": ["\\u654f\\u611f\\u8bcd1", "\\u654f\\u611f\\u8bcd2"], "inputs_config": {"enable": false, "preset_response": "\\u9884\\u8bbe\\u54cd\\u5e94"}, "outputs_config": {"enable": false}}', 'updated_at': datetime.datetime(2025, 5, 16, 9, 0, 51, 702410), 'created_at': datetime.datetime(2025, 5, 16, 9, 0, 51, 702410)}
[2025-05-16 17:00:51,720.720] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 17:00:51,723.723] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 17:00:51,724.724] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config.id AS app_config_id, app_config.app_id AS app_config_app_id, app_config.model_config AS app_config_model_config, app_config.dialog_round AS app_config_dialog_round, app_config.preset_prompt AS app_config_preset_prompt, app_config.tools AS app_config_tools, app_config.workflows AS app_config_workflows, app_config.retrieval_config AS app_config_retrieval_config, app_config.long_term_memory AS app_config_long_term_memory, app_config.opening_statement AS app_config_opening_statement, app_config.opening_questions AS app_config_opening_questions, app_config.speech_to_text AS app_config_speech_to_text, app_config.text_to_speech AS app_config_text_to_speech, app_config.suggested_after_answer AS app_config_suggested_after_answer, app_config.review_config AS app_config_review_config, app_config.updated_at AS app_config_updated_at, app_config.created_at AS app_config_created_at 
FROM app_config 
WHERE app_config.id = %(pk_1)s::UUID
[2025-05-16 17:00:51,724.724] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00034s] {'pk_1': UUID('58b4b265-89a6-44d9-919e-e3b8e4231290')}
[2025-05-16 17:00:51,727.727] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 17:00:51,727.727] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00039s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 17:00:51,729.729] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app SET app_config_id=%(app_config_id)s::UUID WHERE app.id = %(app_id)s::UUID
[2025-05-16 17:00:51,729.729] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00025s] {'app_config_id': UUID('58b4b265-89a6-44d9-919e-e3b8e4231290'), 'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 17:00:51,730.730] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 17:00:51,731.731] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 17:00:51,732.732] base.py -> _exec_single_context line:1896 [INFO]: DELETE FROM app_dataset_join WHERE app_dataset_join.app_id = %(app_id_1)s::UUID
[2025-05-16 17:00:51,732.732] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00021s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 17:00:51,734.734] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 17:00:51,735.735] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 17:00:51,735.735] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_dataset_join (app_id, dataset_id) VALUES (%(app_id)s::UUID, %(dataset_id)s::UUID) RETURNING app_dataset_join.id, app_dataset_join.updated_at, app_dataset_join.created_at
[2025-05-16 17:00:51,736.736] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00026s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'dataset_id': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-16 17:00:51,737.737] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 17:00:51,738.738] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 17:00:51,738.738] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 17:00:51,738.738] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01118s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 17:00:51,739.739] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 17:00:51,740.740] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.04513s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 17:00:51,742.742] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(max(app_config_version.version), %(coalesce_2)s) AS coalesce_1 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 17:00:51,742.742] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00028s] {'coalesce_2': 0, 'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.PUBLISHED: 'published'>}
[2025-05-16 17:00:51,744.744] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_config_version (app_id, model_config, dialog_round, preset_prompt, tools, workflows, datasets, retrieval_config, long_term_memory, opening_statement, opening_questions, speech_to_text, text_to_speech, suggested_after_answer, review_config, version, config_type) VALUES (%(app_id)s::UUID, %(model_config)s::JSONB, %(dialog_round)s, %(preset_prompt)s, %(tools)s::JSONB, %(workflows)s::JSONB, %(datasets)s::JSONB, %(retrieval_config)s::JSONB, %(long_term_memory)s::JSONB, %(opening_statement)s, %(opening_questions)s::JSONB, %(speech_to_text)s::JSONB, %(text_to_speech)s::JSONB, %(suggested_after_answer)s::JSONB, %(review_config)s::JSONB, %(version)s, %(config_type)s) RETURNING app_config_version.id, app_config_version.updated_at, app_config_version.created_at
[2025-05-16 17:00:51,745.745] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00039s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'model_config': '{"model": "gpt-4o", "provider": "openai", "parameters": {"top_p": 0.9, "max_tokens": 4096, "temperature": 0.7, "presence_penalty": 0.1, "frequency_penalty": 0.1}}', 'dialog_round': 5, 'preset_prompt': 'ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šã€å‹å¥½çš„AIåŠ©æ‰‹', 'tools': '[]', 'workflows': '[]', 'datasets': '["9af90c52-28b2-4a47-9c92-148c9f21b512"]', 'retrieval_config': '{"k": 5, "score": 0.7, "retrieval_strategy": "semantic"}', 'long_term_memory': '{"enable": true}', 'opening_statement': 'ä½ å¥½ï¼Œæˆ‘æ˜¯AIåŠ©æ‰‹', 'opening_questions': '["\\u6709\\u4ec0\\u4e48\\u53ef\\u4ee5\\u5e2e\\u60a8\\uff1f", "\\u60a8\\u9700\\u8981\\u4ec0\\u4e48\\u5e2e\\u52a9\\uff1f"]', 'speech_to_text': '{"enable": false}', 'text_to_speech': '{"voice": "echo", "enable": false, "auto_play": false}', 'suggested_after_answer': '{"enable": true}', 'review_config': '{"enable": false, "keywords": ["\\u654f\\u611f\\u8bcd1", "\\u654f\\u611f\\u8bcd2"], "inputs_config": {"enable": false, "preset_response": "\\u9884\\u8bbe\\u54cd\\u5e94"}, "outputs_config": {"enable": false}}', 'version': 8, 'config_type': <AppConfigType.PUBLISHED: 'published'>}
[2025-05-16 17:00:51,756.756] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 17:00:51,757.757] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 17:00:51] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/publish HTTP/1.1" 200 -
[2025-05-16 17:01:07,413.413] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 17:01:07,413.413] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 17:01:07,414.414] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.73s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 17:01:07,418.418] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 17:01:07,418.418] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.73s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 17:01:07,419.419] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 17:01:07,420.420] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.73s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 17:01:07,421.421] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 17:01:07,421.421] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.72s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-16 17:01:07,423.423] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-16 17:01:07,423.423] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00067s] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-16 17:01:07,478.478] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-16 17:01:07,479.479] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00046s] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 5}
[2025-05-16 17:01:07,590.590] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 17:01:07] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-16 17:08:39,650.650] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 17:08:39,651.651] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 17:08:39,651.651] base.py -> _exec_single_context line:1901 [INFO]: [cached since 468s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 17:08:39,655.655] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 17:08:39,655.655] base.py -> _exec_single_context line:1901 [INFO]: [cached since 468s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 17:08:39,656.656] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 17:08:39,657.657] base.py -> _exec_single_context line:1901 [INFO]: [cached since 468s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 17:08:39,660.660] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 17:08:39,660.660] base.py -> _exec_single_context line:1901 [INFO]: [cached since 468s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-16 17:08:39,661.661] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-16 17:08:39,662.662] base.py -> _exec_single_context line:1901 [INFO]: [cached since 452.2s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-16 17:08:39,717.717] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-16 17:08:39,717.717] base.py -> _exec_single_context line:1901 [INFO]: [cached since 452.2s ago] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 5}
[2025-05-16 17:08:39,734.734] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 17:08:39] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-16 17:10:01,056.056] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-05-16 17:10:01,057.057] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-05-16 17:10:01,060.060] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-16 17:10:29,909.909] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-16 17:10:29,924.924] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-16 17:26:58,204.204] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-16 17:26:58,204.204] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 17:26:58,206.206] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-16 17:26:58,207.207] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 17:26:58,208.208] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-16 17:26:58,208.208] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 17:26:58,209.209] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 17:26:58,211.211] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 17:26:58,212.212] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00028s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 17:26:58,219.219] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 17:26:58,219.219] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00043s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 17:26:58,224.224] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 17:26:58,224.224] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00043s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 17:26:58,228.228] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 17:26:58,229.229] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00040s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-16 17:26:58,231.231] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-16 17:26:58,231.231] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00027s] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-16 17:26:58,282.282] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-16 17:26:58,282.282] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00056s] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 5}
[2025-05-16 17:26:58,374.374] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 17:26:58] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-16 17:27:07,883.883] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 17:27:07,884.884] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-16 17:27:07,884.884] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00032s] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-16 17:27:08,128.128] base.py -> similarity_search_with_relevance_scores line:575 [WARNING]: No relevant docs were retrieved using the relevance score threshold 0.7
[2025-05-16 17:27:08,130.130] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (NULL) AND (1 != 1)
[2025-05-16 17:27:08,131.131] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00036s] {'hit_count_1': 1}
[2025-05-16 17:27:08,134.134] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 17:27:12,134.134] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 17:35:49,418.418] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 17:35:49,419.419] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 17:35:49,419.419] base.py -> _exec_single_context line:1901 [INFO]: [cached since 531.2s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 17:35:49,423.423] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 17:35:49,423.423] base.py -> _exec_single_context line:1901 [INFO]: [cached since 531.2s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 17:35:49,426.426] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 17:35:49,427.427] base.py -> _exec_single_context line:1901 [INFO]: [cached since 531.2s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 17:35:49,429.429] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 17:35:49,430.430] base.py -> _exec_single_context line:1901 [INFO]: [cached since 531.2s ago] {'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-05-16 17:35:49,434.434] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-16 17:35:49,434.434] base.py -> _exec_single_context line:1901 [INFO]: [cached since 531.2s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-16 17:35:49,501.501] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-16 17:35:49,502.502] base.py -> _exec_single_context line:1901 [INFO]: [cached since 531.2s ago] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 5}
[2025-05-16 17:35:49,533.533] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 17:35:49] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-16 17:36:03,148.148] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 17:38:16,071.071] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 17:38:16,072.072] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 17:38:16,072.072] base.py -> _exec_single_context line:1901 [INFO]: [cached since 677.9s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 17:38:16,074.074] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 17:38:16,074.074] base.py -> _exec_single_context line:1901 [INFO]: [cached since 677.9s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 17:38:16,076.076] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 17:38:16,077.077] base.py -> _exec_single_context line:1901 [INFO]: [cached since 677.9s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 17:38:16,078.078] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 17:38:16,078.078] base.py -> _exec_single_context line:1901 [INFO]: [cached since 677.8s ago] {'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-05-16 17:38:16,078.078] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-16 17:38:16,080.080] base.py -> _exec_single_context line:1901 [INFO]: [cached since 677.8s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-16 17:38:16,144.144] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-16 17:38:16,144.144] base.py -> _exec_single_context line:1901 [INFO]: [cached since 677.9s ago] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 5}
[2025-05-16 17:38:16,169.169] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 17:38:16] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-16 17:38:25,366.366] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 17:38:25,367.367] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-16 17:38:25,367.367] base.py -> _exec_single_context line:1901 [INFO]: [cached since 677.5s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-05-16 17:38:25,430.430] base.py -> similarity_search_with_relevance_scores line:575 [WARNING]: No relevant docs were retrieved using the relevance score threshold 0.7
[2025-05-16 17:38:25,434.434] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (NULL) AND (1 != 1)
[2025-05-16 17:38:25,435.435] base.py -> _exec_single_context line:1901 [INFO]: [cached since 677.3s ago] {'hit_count_1': 1}
[2025-05-16 17:38:25,436.436] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 17:38:29,966.966] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 17:46:10,793.793] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 17:46:10,794.794] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 17:46:10,794.794] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1153s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 17:46:10,796.796] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: DEBUGGER
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 156, in ping
    retrival_source=RetrievalSource.DEBUGGER,
  File "C:\Users\Lenovo\.pyenv\pyenv-win\versions\3.9.12\lib\enum.py", line 429, in __getattr__
    raise AttributeError(name) from None
AttributeError: DEBUGGER
[2025-05-16 17:46:10,814.814] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 17:46:10,825.825] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 17:46:10] "[35m[1mGET /ping HTTP/1.1[0m" 500 -
[2025-05-16 17:46:30,100.100] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\handler\\app_handler.py', reloading
[2025-05-16 17:46:31,637.637] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-16 17:47:03,232.232] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-16 17:47:03,254.254] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-16 17:47:04,926.926] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-16 17:47:04,928.928] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 17:47:04,933.933] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-16 17:47:04,933.933] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 17:47:04,935.935] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-16 17:47:04,935.935] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 17:47:04,938.938] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 17:47:04,950.950] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 17:47:04,950.950] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00096s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 17:47:04,956.956] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: create_langchain_tool_from_search() got an unexpected keyword argument 'account'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 150, in ping
    dataset_retrival = self.retrieval_service.create_langchain_tool_from_search(
TypeError: create_langchain_tool_from_search() got an unexpected keyword argument 'account'
[2025-05-16 17:47:04,965.965] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 17:47:04,994.994] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 17:47:04] "[35m[1mGET /ping HTTP/1.1[0m" 500 -
[2025-05-16 17:54:53,596.596] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\handler\\app_handler.py', reloading
[2025-05-16 17:54:55,846.846] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-16 17:55:23,055.055] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-16 17:55:23,064.064] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-16 17:55:24,520.520] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-16 17:55:24,522.522] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 17:55:24,526.526] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-16 17:55:24,526.526] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 17:55:24,528.528] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-16 17:55:24,528.528] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 17:55:24,529.529] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 17:55:24,535.535] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 17:55:24,535.535] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00056s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 17:55:24,542.542] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: create_langchain_tool_from_search() missing 1 required positional argument: 'flask_app'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 150, in ping
    dataset_retrival = self.retrieval_service.create_langchain_tool_from_search(
TypeError: create_langchain_tool_from_search() missing 1 required positional argument: 'flask_app'
[2025-05-16 17:55:24,548.548] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 17:55:24,565.565] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 17:55:24] "[35m[1mGET /ping HTTP/1.1[0m" 500 -
[2025-05-16 17:57:09,296.296] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\handler\\app_handler.py', reloading
[2025-05-16 17:57:10,957.957] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-16 17:57:33,074.074] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-16 17:57:33,088.088] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-16 17:57:34,299.299] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-16 17:57:34,299.299] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 17:57:34,305.305] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-16 17:57:34,306.306] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 17:57:34,307.307] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-16 17:57:34,307.307] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 17:57:34,309.309] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 17:57:34,316.316] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 17:57:34,317.317] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00090s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 17:57:34,503.503] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 17:57:34,503.503] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 17:57:34,504.504] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.1874s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 17:57:34,507.507] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 17:57:34,540.540] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: SQL expression element or literal value expected, got <Account 46db30d1-3199-4e79-a0cd-abf12fa6858f>.
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 803, in _literal_coercion
    return expr._bind_param(operator, element, type_=bindparam_type)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 4617, in _bind_param
    return BindParameter(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 2043, in __init__
    self.type = _compared_to_type.coerce_compared_value(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\sqltypes.py", line 3636, in coerce_compared_value
    return super().coerce_compared_value(op, value)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\type_api.py", line 1059, in coerce_compared_value
    _coerced_type = _resolve_value_to_type(value)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\sqltypes.py", line 3825, in _resolve_value_to_type
    raise exc.ArgumentError(
sqlalchemy.exc.ArgumentError: Object <Account 46db30d1-3199-4e79-a0cd-abf12fa6858f> is not legal as a SQL literal value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 163, in ping
    content = dataset_retrival.invoke({"query": "æ¿€æ´»å‡½æ•°"})
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\tools\base.py", line 508, in invoke
    return self.run(tool_input, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\tools\base.py", line 763, in run
    raise error_to_raise
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\tools\base.py", line 732, in run
    response = context.run(self._run, *tool_args, **tool_kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\tools\structured.py", line 89, in _run
    return self.func(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\retrieval_service.py", line 126, in dataset_retrieval
    documents = self.search_in_datasets(
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\retrieval_service.py", line 44, in search_in_datasets
    Dataset.account_id == account_id,
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\operators.py", line 584, in __eq__
    return self.operate(eq, other)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\orm\attributes.py", line 453, in operate
    return op(self.comparator, *other, **kwargs)  # type: ignore[no-any-return]  # noqa: E501
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\operators.py", line 584, in __eq__
    return self.operate(eq, other)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\orm\properties.py", line 477, in operate
    return op(self.__clause_element__(), *other, **kwargs)  # type: ignore[no-any-return]  # noqa: E501
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\annotation.py", line 371, in __eq__
    return self.__element.__class__.__eq__(self, other)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\operators.py", line 584, in __eq__
    return self.operate(eq, other)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 1523, in operate
    return op(self.comparator, *other, **kwargs)  # type: ignore[no-any-return]  # noqa: E501
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\operators.py", line 584, in __eq__
    return self.operate(eq, other)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\type_api.py", line 212, in operate
    return op_fn(self.expr, op, *other, **addtl_kw)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\default_comparator.py", line 121, in _boolean_compare
    obj = coercions.expect(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 395, in expect
    resolved = impl._literal_coercion(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 805, in _literal_coercion
    self._raise_for_expected(element, err=err)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 784, in _raise_for_expected
    return super()._raise_for_expected(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 518, in _raise_for_expected
    raise exc.ArgumentError(msg, code=code) from err
sqlalchemy.exc.ArgumentError: SQL expression element or literal value expected, got <Account 46db30d1-3199-4e79-a0cd-abf12fa6858f>.
[2025-05-16 17:57:34,559.559] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 17:57:34,620.620] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 17:57:34] "[35m[1mGET /ping HTTP/1.1[0m" 500 -
[2025-05-16 18:24:36,065.065] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 18:24:36,072.072] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 18:24:36,073.073] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1622s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 18:24:36,143.143] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 18:24:36,146.146] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 18:24:36,146.146] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1622s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 18:24:36,152.152] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 18:24:36,158.158] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: SQL expression element or literal value expected, got <Account 46db30d1-3199-4e79-a0cd-abf12fa6858f>.
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 803, in _literal_coercion
    return expr._bind_param(operator, element, type_=bindparam_type)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 4617, in _bind_param
    return BindParameter(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 2043, in __init__
    self.type = _compared_to_type.coerce_compared_value(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\sqltypes.py", line 3636, in coerce_compared_value
    return super().coerce_compared_value(op, value)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\type_api.py", line 1059, in coerce_compared_value
    _coerced_type = _resolve_value_to_type(value)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\sqltypes.py", line 3825, in _resolve_value_to_type
    raise exc.ArgumentError(
sqlalchemy.exc.ArgumentError: Object <Account 46db30d1-3199-4e79-a0cd-abf12fa6858f> is not legal as a SQL literal value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 163, in ping
    content = dataset_retrival.invoke({"query": "æ¿€æ´»å‡½æ•°"})
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\tools\base.py", line 508, in invoke
    return self.run(tool_input, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\tools\base.py", line 763, in run
    raise error_to_raise
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\tools\base.py", line 732, in run
    response = context.run(self._run, *tool_args, **tool_kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\langchain_core\tools\structured.py", line 89, in _run
    return self.func(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\retrieval_service.py", line 126, in dataset_retrieval
    documents = self.search_in_datasets(
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\retrieval_service.py", line 44, in search_in_datasets
    Dataset.account_id == account_id,
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\operators.py", line 584, in __eq__
    return self.operate(eq, other)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\orm\attributes.py", line 453, in operate
    return op(self.comparator, *other, **kwargs)  # type: ignore[no-any-return]  # noqa: E501
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\operators.py", line 584, in __eq__
    return self.operate(eq, other)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\orm\properties.py", line 477, in operate
    return op(self.__clause_element__(), *other, **kwargs)  # type: ignore[no-any-return]  # noqa: E501
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\annotation.py", line 371, in __eq__
    return self.__element.__class__.__eq__(self, other)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\operators.py", line 584, in __eq__
    return self.operate(eq, other)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 1523, in operate
    return op(self.comparator, *other, **kwargs)  # type: ignore[no-any-return]  # noqa: E501
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\operators.py", line 584, in __eq__
    return self.operate(eq, other)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\type_api.py", line 212, in operate
    return op_fn(self.expr, op, *other, **addtl_kw)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\default_comparator.py", line 121, in _boolean_compare
    obj = coercions.expect(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 395, in expect
    resolved = impl._literal_coercion(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 805, in _literal_coercion
    self._raise_for_expected(element, err=err)
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 784, in _raise_for_expected
    return super()._raise_for_expected(
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\sqlalchemy\sql\coercions.py", line 518, in _raise_for_expected
    raise exc.ArgumentError(msg, code=code) from err
sqlalchemy.exc.ArgumentError: SQL expression element or literal value expected, got <Account 46db30d1-3199-4e79-a0cd-abf12fa6858f>.
[2025-05-16 18:24:36,166.166] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 18:24:36,195.195] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 18:24:36] "[35m[1mGET /ping HTTP/1.1[0m" 500 -
[2025-05-16 18:29:02,741.741] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\handler\\app_handler.py', reloading
[2025-05-16 18:29:05,562.562] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-16 18:29:55,412.412] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-16 18:29:55,445.445] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-16 18:29:57,988.988] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-16 18:29:57,988.988] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 18:29:57,994.994] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-16 18:29:57,994.994] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 18:29:57,996.996] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-16 18:29:57,997.997] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 18:29:57,998.998] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 18:29:58,011.011] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 18:29:58,012.012] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00225s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 18:29:58,019.019] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 'Account' object has no attribute 'account_id'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 153, in ping
    account_id=current_user.account_id,
AttributeError: 'Account' object has no attribute 'account_id'
[2025-05-16 18:29:58,029.029] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 18:29:58,057.057] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 18:29:58] "[35m[1mGET /ping HTTP/1.1[0m" 500 -
[2025-05-16 18:30:55,470.470] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\handler\\app_handler.py', reloading
[2025-05-16 18:30:57,720.720] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-16 18:31:28,884.884] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-16 18:31:28,902.902] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-16 18:31:30,022.022] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-16 18:31:30,023.023] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 18:31:30,027.027] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-16 18:31:30,027.027] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 18:31:30,029.029] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-16 18:31:30,029.029] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 18:31:30,031.031] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 18:31:30,039.039] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 18:31:30,040.040] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00073s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 18:31:30,219.219] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 18:31:30,221.221] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-16 18:31:30,221.221] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00064s] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-05-16 18:31:33,464.464] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO dataset_query (dataset_id, query, source, source_app_id, created_by) VALUES (%(dataset_id)s::UUID, %(query)s, %(source)s, %(source_app_id)s::UUID, %(created_by)s::UUID) RETURNING dataset_query.id, dataset_query.updated_at, dataset_query.created_at
[2025-05-16 18:31:33,468.468] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00626s] {'dataset_id': '059c1cbc-5230-4056-a44a-4537779922cd', 'query': 'æ¿€æ´»å‡½æ•°', 'source': <RetrievalSource.APP: 'app'>, 'source_app_id': None, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-16 18:31:33,504.504] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 18:31:33,515.515] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 18:31:33,520.520] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (%(id_1_1)s::UUID, %(id_1_2)s::UUID, %(id_1_3)s::UUID, %(id_1_4)s::UUID, %(id_1_5)s::UUID, %(id_1_6)s::UUID, %(id_1_7)s::UUID, %(id_1_8)s::UUID, %(id_1_9)s::UUID, %(id_1_10)s::UUID)
[2025-05-16 18:31:33,521.521] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00219s] {'hit_count_1': 1, 'id_1_1': UUID('2ced08ab-0ded-4a1e-b5ef-592b45146385'), 'id_1_2': UUID('cac62fe4-3d56-45b4-acee-f92c865c0523'), 'id_1_3': UUID('3e500d00-555b-440a-8c19-7c19293a1e9b'), 'id_1_4': UUID('be06d558-043c-4626-b75c-b21f586ffc0a'), 'id_1_5': UUID('af18d062-2f20-4bd1-a8cd-278f9aed8f51'), 'id_1_6': UUID('ba845069-2d50-44e2-83e1-d4710428293a'), 'id_1_7': UUID('f46f3cbc-82f4-4481-b9cc-c07a946ca482'), 'id_1_8': UUID('50c76efa-c3dd-4f9a-85d4-a5a798bc7213'), 'id_1_9': UUID('5e775a17-bd4b-4d34-8b0c-873fe4640ad8'), 'id_1_10': UUID('ff63c8af-698c-4ea2-84ce-2a5f366ef253')}
[2025-05-16 18:31:33,535.535] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 18:31:33,545.545] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 18:31:33,547.547] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 18:31:33] "GET /ping HTTP/1.1" 200 -
[2025-05-16 18:33:26,052.052] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 18:33:26,054.054] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 18:33:26,054.054] base.py -> _exec_single_context line:1901 [INFO]: [cached since 116s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 18:33:26,086.086] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 18:33:26,087.087] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00057s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 18:33:26,093.093] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 18:33:26,094.094] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00073s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 18:33:26,101.101] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 18:33:26,102.102] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00040s] {'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-05-16 18:33:26,105.105] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-16 18:33:26,105.105] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00033s] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-16 18:33:26,199.199] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-16 18:33:26,200.200] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00070s] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 5}
[2025-05-16 18:33:26,262.262] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 18:33:26] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-16 18:33:35,534.534] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 18:33:35,534.534] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-16 18:33:35,535.535] base.py -> _exec_single_context line:1901 [INFO]: [cached since 125.3s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-05-16 18:33:35,824.824] base.py -> similarity_search_with_relevance_scores line:575 [WARNING]: No relevant docs were retrieved using the relevance score threshold 0.7
[2025-05-16 18:33:35,825.825] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (NULL) AND (1 != 1)
[2025-05-16 18:33:35,826.826] base.py -> _exec_single_context line:1901 [INFO]: [cached since 122.3s ago] {'hit_count_1': 1}
[2025-05-16 18:33:35,829.829] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 18:33:37,763.763] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 18:49:46,240.240] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 18:49:46,253.253] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 18:49:46,254.254] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1096s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 18:49:46,290.290] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 18:49:46,291.291] base.py -> _exec_single_context line:1901 [INFO]: [cached since 980.2s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 18:49:46,305.305] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 18:49:46,306.306] base.py -> _exec_single_context line:1901 [INFO]: [cached since 980.2s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 18:49:46,319.319] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 18:49:46,320.320] base.py -> _exec_single_context line:1901 [INFO]: [cached since 980.2s ago] {'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-05-16 18:49:46,325.325] base.py -> _exec_single_context line:1896 [INFO]: SELECT conversation.id AS conversation_id, conversation.app_id AS conversation_app_id, conversation.name AS conversation_name, conversation.summary AS conversation_summary, conversation.is_pinned AS conversation_is_pinned, conversation.is_deleted AS conversation_is_deleted, conversation.invoke_from AS conversation_invoke_from, conversation.created_by AS conversation_created_by, conversation.updated_at AS conversation_updated_at, conversation.created_at AS conversation_created_at 
FROM conversation 
WHERE conversation.id = %(id_1)s::UUID AND conversation.invoke_from = %(invoke_from_1)s
[2025-05-16 18:49:46,326.326] base.py -> _exec_single_context line:1901 [INFO]: [cached since 980.2s ago] {'id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'invoke_from_1': <InvokeFrom.DEBUGGER: 'debugger'>}
[2025-05-16 18:49:46,498.498] base.py -> _exec_single_context line:1896 [INFO]: SELECT message.id AS message_id, message.app_id AS message_app_id, message.conversation_id AS message_conversation_id, message.invoke_from AS message_invoke_from, message.created_by AS message_created_by, message.query AS message_query, message.message AS message_message, message.message_token_count AS message_message_token_count, message.message_unit_price AS message_message_unit_price, message.message_price_unit AS message_message_price_unit, message.answer AS message_answer, message.answer_token_count AS message_answer_token_count, message.answer_unit_price AS message_answer_unit_price, message.answer_price_unit AS message_answer_price_unit, message.latency AS message_latency, message.is_deleted AS message_is_deleted, message.status AS message_status, message.error AS message_error, message.total_token_count AS message_total_token_count, message.total_price AS message_total_price, message.updated_at AS message_updated_at, message.created_at AS message_created_at 
FROM message 
WHERE message.conversation_id = %(conversation_id_1)s::UUID AND message.answer != %(answer_1)s AND message.is_deleted = false AND message.status = %(status_1)s ORDER BY message.created_at DESC 
 LIMIT %(param_1)s
[2025-05-16 18:49:46,498.498] base.py -> _exec_single_context line:1901 [INFO]: [cached since 980.3s ago] {'conversation_id_1': UUID('3ad3cb37-902d-4c6c-83a0-f991f4d592ca'), 'answer_1': '', 'status_1': <MessageStatus.NORMAL: 'normal'>, 'param_1': 5}
[2025-05-16 18:49:46,594.594] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 18:49:46] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/conversations HTTP/1.1" 200 -
[2025-05-16 18:49:55,635.635] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 18:49:55,635.635] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-16 18:49:55,635.635] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1105s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-05-16 18:49:56,685.685] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO dataset_query (dataset_id, query, source, source_app_id, created_by) VALUES (%(dataset_id)s::UUID, %(query)s, %(source)s, %(source_app_id)s::UUID, %(created_by)s::UUID) RETURNING dataset_query.id, dataset_query.updated_at, dataset_query.created_at
[2025-05-16 18:49:56,685.685] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1103s ago] {'dataset_id': '059c1cbc-5230-4056-a44a-4537779922cd', 'query': 'AdapterDrop ç‰¹ç‚¹', 'source': <RetrievalSource.APP: 'app'>, 'source_app_id': None, 'created_by': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f')}
[2025-05-16 18:49:56,710.710] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 18:49:56,715.715] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 18:49:56,716.716] base.py -> _exec_single_context line:1896 [INFO]: UPDATE segment SET hit_count=(segment.hit_count + %(hit_count_1)s) WHERE segment.id IN (%(id_1_1)s::UUID, %(id_1_2)s::UUID, %(id_1_3)s::UUID, %(id_1_4)s::UUID, %(id_1_5)s::UUID)
[2025-05-16 18:49:56,716.716] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1103s ago] {'hit_count_1': 1, 'id_1_1': UUID('cac62fe4-3d56-45b4-acee-f92c865c0523'), 'id_1_2': UUID('be06d558-043c-4626-b75c-b21f586ffc0a'), 'id_1_3': UUID('af18d062-2f20-4bd1-a8cd-278f9aed8f51'), 'id_1_4': UUID('ba845069-2d50-44e2-83e1-d4710428293a'), 'id_1_5': UUID('3e500d00-555b-440a-8c19-7c19293a1e9b')}
[2025-05-16 18:49:56,718.718] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 18:49:59,933.933] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 19:12:54,032.032] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-05-16 19:12:54,032.032] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-05-16 19:12:54,036.036] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-16 19:13:20,446.446] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-16 19:13:20,461.461] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-16 19:15:20,506.506] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-16 19:15:20,507.507] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 19:15:20,511.511] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-16 19:15:20,511.511] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 19:15:20,512.512] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-16 19:15:20,513.513] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 19:15:20,514.514] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:15:20,519.519] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 19:15:20,519.519] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00092s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 19:15:20,528.528] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:15:20,528.528] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00041s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:15:20,530.530] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 556, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 19:15:20,539.539] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 19:15:20,540.540] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 19:15:20] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 19:18:31,507.507] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:18:31,508.508] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 19:18:31,508.508] base.py -> _exec_single_context line:1901 [INFO]: [cached since 191s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 19:18:31,510.510] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:18:31,510.510] base.py -> _exec_single_context line:1901 [INFO]: [cached since 190.9s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:18:31,510.510] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 590, in _validate_draft_app_config
    raise ValidateErrorException("ç»‘å®šæ’ä»¶å·¥å…·å‚æ•°å‡ºé”™")
internal.exception.exception.ValidateErrorException
[2025-05-16 19:18:31,512.512] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 19:18:31,512.512] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 19:18:31] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 19:18:56,650.650] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:18:56,650.650] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 19:18:56,650.650] base.py -> _exec_single_context line:1901 [INFO]: [cached since 216.1s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 19:18:56,652.652] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:18:56,652.652] base.py -> _exec_single_context line:1901 [INFO]: [cached since 216.1s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:18:56,653.653] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 590, in _validate_draft_app_config
    raise ValidateErrorException("ç»‘å®šæ’ä»¶å·¥å…·å‚æ•°å‡ºé”™")
internal.exception.exception.ValidateErrorException
[2025-05-16 19:18:56,654.654] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 19:18:56,654.654] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 19:18:56] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 19:22:42,312.312] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:22:42,313.313] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 19:22:42,313.313] base.py -> _exec_single_context line:1901 [INFO]: [cached since 441.7s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 19:22:42,315.315] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:22:42,315.315] base.py -> _exec_single_context line:1901 [INFO]: [cached since 441.7s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:22:42,322.322] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 19:22:42,322.322] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00036s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 19:22:42,333.333] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET tools=%(tools)s::JSONB, updated_at=%(updated_at)s WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-16 19:22:42,333.333] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00075s] {'tools': '[{"type": "builtin_tool", "provider_id": "google", "tool_id": "google_serper", "params": {}}]', 'updated_at': datetime.datetime(2025, 5, 16, 19, 22, 42, 328167), 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-16 19:22:42,339.339] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 19:22:42,341.341] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 19:22:42] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 19:23:50,682.682] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:23:50,683.683] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 19:23:50,683.683] base.py -> _exec_single_context line:1901 [INFO]: [cached since 510.1s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 19:23:50,684.684] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:23:50,685.685] base.py -> _exec_single_context line:1901 [INFO]: [cached since 510.1s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:23:50,685.685] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 19:23:50,686.686] base.py -> _exec_single_context line:1901 [INFO]: [cached since 68.36s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 19:23:50,689.689] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET tools=%(tools)s::JSONB WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-16 19:23:50,689.689] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00041s] {'tools': '[]', 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-16 19:23:50,690.690] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 19:23:50,692.692] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:23:50,693.693] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.id = %(pk_1)s::UUID
[2025-05-16 19:23:50,694.694] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00038s] {'pk_1': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-16 19:23:50,696.696] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 19:23:50,696.696] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00054s] {'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-05-16 19:23:50,699.699] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 19:23:50,699.699] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 19:23:50] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 19:24:14,502.502] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:24:14,502.502] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 19:24:14,502.502] base.py -> _exec_single_context line:1901 [INFO]: [cached since 533.9s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 19:24:14,503.503] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:24:14,504.504] base.py -> _exec_single_context line:1901 [INFO]: [cached since 533.9s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:24:14,505.505] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 19:24:14,505.505] base.py -> _exec_single_context line:1901 [INFO]: [cached since 92.17s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 19:24:14,507.507] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 19:24:14,507.507] base.py -> _exec_single_context line:1901 [INFO]: [cached since 23.81s ago] {'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-05-16 19:24:14,513.513] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_config (app_id, model_config, dialog_round, preset_prompt, tools, workflows, retrieval_config, long_term_memory, opening_statement, opening_questions, speech_to_text, text_to_speech, review_config, updated_at, created_at) VALUES (%(app_id)s::UUID, %(model_config)s::JSONB, %(dialog_round)s, %(preset_prompt)s, %(tools)s::JSONB, %(workflows)s::JSONB, %(retrieval_config)s::JSONB, %(long_term_memory)s::JSONB, %(opening_statement)s, %(opening_questions)s::JSONB, %(speech_to_text)s::JSONB, %(text_to_speech)s::JSONB, %(review_config)s::JSONB, %(updated_at)s, %(created_at)s) RETURNING app_config.id, app_config.suggested_after_answer
[2025-05-16 19:24:14,516.516] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00362s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'model_config': '{"model": "gpt-4o", "provider": "openai", "parameters": {"top_p": 0.9, "max_tokens": 4096, "temperature": 0.7, "presence_penalty": 0.1, "frequency_penalty": 0.1}}', 'dialog_round': 5, 'preset_prompt': 'ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šã€å‹å¥½çš„AIåŠ©æ‰‹', 'tools': '[]', 'workflows': '[]', 'retrieval_config': '{"k": 5, "score": 0.7, "retrieval_strategy": "semantic"}', 'long_term_memory': '{"enable": true}', 'opening_statement': 'ä½ å¥½ï¼Œæˆ‘æ˜¯AIåŠ©æ‰‹', 'opening_questions': '["\\u6709\\u4ec0\\u4e48\\u53ef\\u4ee5\\u5e2e\\u60a8\\uff1f", "\\u60a8\\u9700\\u8981\\u4ec0\\u4e48\\u5e2e\\u52a9\\uff1f"]', 'speech_to_text': '{"enable": false}', 'text_to_speech': '{"voice": "echo", "enable": false, "auto_play": false}', 'review_config': '{"enable": false, "keywords": ["\\u654f\\u611f\\u8bcd1", "\\u654f\\u611f\\u8bcd2"], "inputs_config": {"enable": false, "preset_response": "\\u9884\\u8bbe\\u54cd\\u5e94"}, "outputs_config": {"enable": false}}', 'updated_at': datetime.datetime(2025, 5, 16, 11, 24, 14, 513368), 'created_at': datetime.datetime(2025, 5, 16, 11, 24, 14, 513368)}
[2025-05-16 19:24:14,527.527] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 19:24:14,529.529] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:24:14,533.533] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config.id AS app_config_id, app_config.app_id AS app_config_app_id, app_config.model_config AS app_config_model_config, app_config.dialog_round AS app_config_dialog_round, app_config.preset_prompt AS app_config_preset_prompt, app_config.tools AS app_config_tools, app_config.workflows AS app_config_workflows, app_config.retrieval_config AS app_config_retrieval_config, app_config.long_term_memory AS app_config_long_term_memory, app_config.opening_statement AS app_config_opening_statement, app_config.opening_questions AS app_config_opening_questions, app_config.speech_to_text AS app_config_speech_to_text, app_config.text_to_speech AS app_config_text_to_speech, app_config.suggested_after_answer AS app_config_suggested_after_answer, app_config.review_config AS app_config_review_config, app_config.updated_at AS app_config_updated_at, app_config.created_at AS app_config_created_at 
FROM app_config 
WHERE app_config.id = %(pk_1)s::UUID
[2025-05-16 19:24:14,534.534] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00084s] {'pk_1': UUID('30c005ea-23f8-40bf-a923-b6b434da6196')}
[2025-05-16 19:24:14,537.537] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:24:14,537.537] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00038s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:24:14,539.539] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app SET app_config_id=%(app_config_id)s::UUID WHERE app.id = %(app_id)s::UUID
[2025-05-16 19:24:14,539.539] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00037s] {'app_config_id': UUID('30c005ea-23f8-40bf-a923-b6b434da6196'), 'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:24:14,540.540] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 19:24:14,542.542] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:24:14,543.543] base.py -> _exec_single_context line:1896 [INFO]: DELETE FROM app_dataset_join WHERE app_dataset_join.app_id = %(app_id_1)s::UUID
[2025-05-16 19:24:14,544.544] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00033s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:24:14,545.545] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 19:24:14,546.546] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:24:14,547.547] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_dataset_join (app_id, dataset_id) VALUES (%(app_id)s::UUID, %(dataset_id)s::UUID) RETURNING app_dataset_join.id, app_dataset_join.updated_at, app_dataset_join.created_at
[2025-05-16 19:24:14,547.547] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00022s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'dataset_id': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-05-16 19:24:14,549.549] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 19:24:14,549.549] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:24:14,550.550] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:24:14,550.550] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.0136s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:24:14,551.551] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 19:24:14,551.551] base.py -> _exec_single_context line:1901 [INFO]: [cached since 92.22s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 19:24:14,555.555] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(max(app_config_version.version), %(coalesce_2)s) AS coalesce_1 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 19:24:14,555.555] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00030s] {'coalesce_2': 0, 'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.PUBLISHED: 'published'>}
[2025-05-16 19:24:14,557.557] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_config_version (app_id, model_config, dialog_round, preset_prompt, tools, workflows, datasets, retrieval_config, long_term_memory, opening_statement, opening_questions, speech_to_text, text_to_speech, suggested_after_answer, review_config, version, config_type) VALUES (%(app_id)s::UUID, %(model_config)s::JSONB, %(dialog_round)s, %(preset_prompt)s, %(tools)s::JSONB, %(workflows)s::JSONB, %(datasets)s::JSONB, %(retrieval_config)s::JSONB, %(long_term_memory)s::JSONB, %(opening_statement)s, %(opening_questions)s::JSONB, %(speech_to_text)s::JSONB, %(text_to_speech)s::JSONB, %(suggested_after_answer)s::JSONB, %(review_config)s::JSONB, %(version)s, %(config_type)s) RETURNING app_config_version.id, app_config_version.updated_at, app_config_version.created_at
[2025-05-16 19:24:14,563.563] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00546s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'model_config': '{"model": "gpt-4o", "provider": "openai", "parameters": {"top_p": 0.9, "max_tokens": 4096, "temperature": 0.7, "presence_penalty": 0.1, "frequency_penalty": 0.1}}', 'dialog_round': 5, 'preset_prompt': 'ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šã€å‹å¥½çš„AIåŠ©æ‰‹', 'tools': '[]', 'workflows': '[]', 'datasets': '["059c1cbc-5230-4056-a44a-4537779922cd"]', 'retrieval_config': '{"k": 5, "score": 0.7, "retrieval_strategy": "semantic"}', 'long_term_memory': '{"enable": true}', 'opening_statement': 'ä½ å¥½ï¼Œæˆ‘æ˜¯AIåŠ©æ‰‹', 'opening_questions': '["\\u6709\\u4ec0\\u4e48\\u53ef\\u4ee5\\u5e2e\\u60a8\\uff1f", "\\u60a8\\u9700\\u8981\\u4ec0\\u4e48\\u5e2e\\u52a9\\uff1f"]', 'speech_to_text': '{"enable": false}', 'text_to_speech': '{"voice": "echo", "enable": false, "auto_play": false}', 'suggested_after_answer': '{"enable": true}', 'review_config': '{"enable": false, "keywords": ["\\u654f\\u611f\\u8bcd1", "\\u654f\\u611f\\u8bcd2"], "inputs_config": {"enable": false, "preset_response": "\\u9884\\u8bbe\\u54cd\\u5e94"}, "outputs_config": {"enable": false}}', 'version': 9, 'config_type': <AppConfigType.PUBLISHED: 'published'>}
[2025-05-16 19:24:14,566.566] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 19:24:14,568.568] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 19:24:14] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/publish HTTP/1.1" 200 -
[2025-05-16 19:24:16,683.683] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:24:16,683.683] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 19:24:16,683.683] base.py -> _exec_single_context line:1901 [INFO]: [cached since 536.1s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 19:24:16,686.686] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:24:16,686.686] base.py -> _exec_single_context line:1901 [INFO]: [cached since 536.1s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:24:16,687.687] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 19:24:16,687.687] base.py -> _exec_single_context line:1901 [INFO]: [cached since 94.35s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 19:24:16,689.689] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 19:24:16,689.689] base.py -> _exec_single_context line:1901 [INFO]: [cached since 25.99s ago] {'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-05-16 19:24:16,690.690] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 19:24:16,691.691] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 19:24:16] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 19:24:50,546.546] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:24:50,547.547] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 19:24:50,547.547] base.py -> _exec_single_context line:1901 [INFO]: [cached since 569.9s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 19:24:50,548.548] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:24:50,548.548] base.py -> _exec_single_context line:1901 [INFO]: [cached since 569.9s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:24:50,549.549] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 19:24:50,549.549] base.py -> _exec_single_context line:1901 [INFO]: [cached since 128.2s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 19:24:50,550.550] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET tools=%(tools)s::JSONB, updated_at=%(updated_at)s WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-16 19:24:50,550.550] base.py -> _exec_single_context line:1901 [INFO]: [cached since 128.2s ago] {'tools': '[{"type": "builtin_tool", "provider_id": "google", "tool_id": "google_serper", "params": {}}]', 'updated_at': datetime.datetime(2025, 5, 16, 19, 24, 50, 550188), 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-16 19:24:50,551.551] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 19:24:50,560.560] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 19:24:50] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 19:25:11,539.539] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:25:11,539.539] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 19:25:11,539.539] base.py -> _exec_single_context line:1901 [INFO]: [cached since 590.9s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 19:25:11,541.541] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:25:11,541.541] base.py -> _exec_single_context line:1901 [INFO]: [cached since 590.9s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:25:11,542.542] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 590, in _validate_draft_app_config
    raise ValidateErrorException("ç»‘å®šæ’ä»¶å·¥å…·å‚æ•°å‡ºé”™")
internal.exception.exception.ValidateErrorException
[2025-05-16 19:25:11,545.545] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 19:25:11,546.546] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 19:25:11] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 19:26:46,526.526] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:26:46,527.527] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 19:26:46,527.527] base.py -> _exec_single_context line:1901 [INFO]: [cached since 685.9s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 19:26:46,528.528] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:26:46,529.529] base.py -> _exec_single_context line:1901 [INFO]: [cached since 685.9s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:26:46,530.530] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 19:26:46,530.530] base.py -> _exec_single_context line:1901 [INFO]: [cached since 244.2s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 19:26:46,531.531] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET tools=%(tools)s::JSONB WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-16 19:26:46,531.531] base.py -> _exec_single_context line:1901 [INFO]: [cached since 175.8s ago] {'tools': '[]', 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-16 19:26:46,532.532] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 19:26:46,533.533] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:26:46,533.533] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.id = %(pk_1)s::UUID
[2025-05-16 19:26:46,534.534] base.py -> _exec_single_context line:1901 [INFO]: [cached since 175.8s ago] {'pk_1': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-16 19:26:46,535.535] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 19:26:46,535.535] base.py -> _exec_single_context line:1901 [INFO]: [cached since 175.8s ago] {'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-05-16 19:26:46,536.536] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_config (app_id, model_config, dialog_round, preset_prompt, tools, workflows, retrieval_config, long_term_memory, opening_statement, opening_questions, speech_to_text, text_to_speech, review_config, updated_at, created_at) VALUES (%(app_id)s::UUID, %(model_config)s::JSONB, %(dialog_round)s, %(preset_prompt)s, %(tools)s::JSONB, %(workflows)s::JSONB, %(retrieval_config)s::JSONB, %(long_term_memory)s::JSONB, %(opening_statement)s, %(opening_questions)s::JSONB, %(speech_to_text)s::JSONB, %(text_to_speech)s::JSONB, %(review_config)s::JSONB, %(updated_at)s, %(created_at)s) RETURNING app_config.id, app_config.suggested_after_answer
[2025-05-16 19:26:46,537.537] base.py -> _exec_single_context line:1901 [INFO]: [cached since 152s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'model_config': '{"model": "gpt-4o", "provider": "openai", "parameters": {"top_p": 0.9, "max_tokens": 4096, "temperature": 0.7, "presence_penalty": 0.1, "frequency_penalty": 0.1}}', 'dialog_round': 5, 'preset_prompt': 'ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šã€å‹å¥½çš„AIåŠ©æ‰‹', 'tools': '[]', 'workflows': '[]', 'retrieval_config': '{"k": 5, "score": 0.7, "retrieval_strategy": "semantic"}', 'long_term_memory': '{"enable": true}', 'opening_statement': 'ä½ å¥½ï¼Œæˆ‘æ˜¯AIåŠ©æ‰‹', 'opening_questions': '["\\u6709\\u4ec0\\u4e48\\u53ef\\u4ee5\\u5e2e\\u60a8\\uff1f", "\\u60a8\\u9700\\u8981\\u4ec0\\u4e48\\u5e2e\\u52a9\\uff1f"]', 'speech_to_text': '{"enable": false}', 'text_to_speech': '{"voice": "echo", "enable": false, "auto_play": false}', 'review_config': '{"enable": false, "keywords": ["\\u654f\\u611f\\u8bcd1", "\\u654f\\u611f\\u8bcd2"], "inputs_config": {"enable": false, "preset_response": "\\u9884\\u8bbe\\u54cd\\u5e94"}, "outputs_config": {"enable": false}}', 'updated_at': datetime.datetime(2025, 5, 16, 11, 26, 46, 536588), 'created_at': datetime.datetime(2025, 5, 16, 11, 26, 46, 536588)}
[2025-05-16 19:26:46,538.538] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 19:26:46,540.540] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:26:46,540.540] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config.id AS app_config_id, app_config.app_id AS app_config_app_id, app_config.model_config AS app_config_model_config, app_config.dialog_round AS app_config_dialog_round, app_config.preset_prompt AS app_config_preset_prompt, app_config.tools AS app_config_tools, app_config.workflows AS app_config_workflows, app_config.retrieval_config AS app_config_retrieval_config, app_config.long_term_memory AS app_config_long_term_memory, app_config.opening_statement AS app_config_opening_statement, app_config.opening_questions AS app_config_opening_questions, app_config.speech_to_text AS app_config_speech_to_text, app_config.text_to_speech AS app_config_text_to_speech, app_config.suggested_after_answer AS app_config_suggested_after_answer, app_config.review_config AS app_config_review_config, app_config.updated_at AS app_config_updated_at, app_config.created_at AS app_config_created_at 
FROM app_config 
WHERE app_config.id = %(pk_1)s::UUID
[2025-05-16 19:26:46,540.540] base.py -> _exec_single_context line:1901 [INFO]: [cached since 152s ago] {'pk_1': UUID('e2b16c76-0ea1-4ee4-9b21-a02e2c6a80da')}
[2025-05-16 19:26:46,541.541] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:26:46,541.541] base.py -> _exec_single_context line:1901 [INFO]: [cached since 152s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:26:46,542.542] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app SET app_config_id=%(app_config_id)s::UUID WHERE app.id = %(app_id)s::UUID
[2025-05-16 19:26:46,543.543] base.py -> _exec_single_context line:1901 [INFO]: [cached since 152s ago] {'app_config_id': UUID('e2b16c76-0ea1-4ee4-9b21-a02e2c6a80da'), 'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:26:46,543.543] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 19:26:46,544.544] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:26:46,544.544] base.py -> _exec_single_context line:1896 [INFO]: DELETE FROM app_dataset_join WHERE app_dataset_join.app_id = %(app_id_1)s::UUID
[2025-05-16 19:26:46,545.545] base.py -> _exec_single_context line:1901 [INFO]: [cached since 152s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:26:46,545.545] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 19:26:46,546.546] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:26:46,547.547] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_dataset_join (app_id, dataset_id) VALUES (%(app_id)s::UUID, %(dataset_id)s::UUID) RETURNING app_dataset_join.id, app_dataset_join.updated_at, app_dataset_join.created_at
[2025-05-16 19:26:46,547.547] base.py -> _exec_single_context line:1901 [INFO]: [cached since 152s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'dataset_id': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-05-16 19:26:46,549.549] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 19:26:46,549.549] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:26:46,550.550] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:26:46,550.550] base.py -> _exec_single_context line:1901 [INFO]: [cached since 152s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:26:46,551.551] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 19:26:46,551.551] base.py -> _exec_single_context line:1901 [INFO]: [cached since 244.2s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 19:26:46,552.552] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(max(app_config_version.version), %(coalesce_2)s) AS coalesce_1 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 19:26:46,552.552] base.py -> _exec_single_context line:1901 [INFO]: [cached since 152s ago] {'coalesce_2': 0, 'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.PUBLISHED: 'published'>}
[2025-05-16 19:26:46,553.553] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_config_version (app_id, model_config, dialog_round, preset_prompt, tools, workflows, datasets, retrieval_config, long_term_memory, opening_statement, opening_questions, speech_to_text, text_to_speech, suggested_after_answer, review_config, version, config_type) VALUES (%(app_id)s::UUID, %(model_config)s::JSONB, %(dialog_round)s, %(preset_prompt)s, %(tools)s::JSONB, %(workflows)s::JSONB, %(datasets)s::JSONB, %(retrieval_config)s::JSONB, %(long_term_memory)s::JSONB, %(opening_statement)s, %(opening_questions)s::JSONB, %(speech_to_text)s::JSONB, %(text_to_speech)s::JSONB, %(suggested_after_answer)s::JSONB, %(review_config)s::JSONB, %(version)s, %(config_type)s) RETURNING app_config_version.id, app_config_version.updated_at, app_config_version.created_at
[2025-05-16 19:26:46,554.554] base.py -> _exec_single_context line:1901 [INFO]: [cached since 152s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'model_config': '{"model": "gpt-4o", "provider": "openai", "parameters": {"top_p": 0.9, "max_tokens": 4096, "temperature": 0.7, "presence_penalty": 0.1, "frequency_penalty": 0.1}}', 'dialog_round': 5, 'preset_prompt': 'ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šã€å‹å¥½çš„AIåŠ©æ‰‹', 'tools': '[]', 'workflows': '[]', 'datasets': '["059c1cbc-5230-4056-a44a-4537779922cd"]', 'retrieval_config': '{"k": 5, "score": 0.7, "retrieval_strategy": "semantic"}', 'long_term_memory': '{"enable": true}', 'opening_statement': 'ä½ å¥½ï¼Œæˆ‘æ˜¯AIåŠ©æ‰‹', 'opening_questions': '["\\u6709\\u4ec0\\u4e48\\u53ef\\u4ee5\\u5e2e\\u60a8\\uff1f", "\\u60a8\\u9700\\u8981\\u4ec0\\u4e48\\u5e2e\\u52a9\\uff1f"]', 'speech_to_text': '{"enable": false}', 'text_to_speech': '{"voice": "echo", "enable": false, "auto_play": false}', 'suggested_after_answer': '{"enable": true}', 'review_config': '{"enable": false, "keywords": ["\\u654f\\u611f\\u8bcd1", "\\u654f\\u611f\\u8bcd2"], "inputs_config": {"enable": false, "preset_response": "\\u9884\\u8bbe\\u54cd\\u5e94"}, "outputs_config": {"enable": false}}', 'version': 10, 'config_type': <AppConfigType.PUBLISHED: 'published'>}
[2025-05-16 19:26:46,555.555] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 19:26:46,556.556] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 19:26:46] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/publish HTTP/1.1" 200 -
[2025-05-16 19:26:56,404.404] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:26:56,404.404] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 19:26:56,405.405] base.py -> _exec_single_context line:1901 [INFO]: [cached since 695.8s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 19:26:56,406.406] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:26:56,406.406] base.py -> _exec_single_context line:1901 [INFO]: [cached since 695.8s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:26:56,407.407] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 19:26:56,407.407] base.py -> _exec_single_context line:1901 [INFO]: [cached since 254.1s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 19:26:56,408.408] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: string indices must be integers
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 70, in publish
    self.app_service.publish_draft_app_config(app_id, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 253, in publish_draft_app_config
    draft_app_config = self.get_draft_app_config(app_id, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 100, in get_draft_app_config
    if draft_tool["type"] == "builtin_tools":
TypeError: string indices must be integers
[2025-05-16 19:26:56,409.409] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 19:26:56,423.423] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 19:26:56] "[35m[1mPOST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/publish HTTP/1.1[0m" 500 -
[2025-05-16 19:28:26,568.568] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:28:26,568.568] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 19:28:26,569.569] base.py -> _exec_single_context line:1901 [INFO]: [cached since 785.9s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 19:28:26,570.570] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:28:26,570.570] base.py -> _exec_single_context line:1901 [INFO]: [cached since 785.9s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:28:26,571.571] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 19:28:26,572.572] base.py -> _exec_single_context line:1901 [INFO]: [cached since 344.2s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 19:28:26,572.572] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: string indices must be integers
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 70, in publish
    self.app_service.publish_draft_app_config(app_id, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 253, in publish_draft_app_config
    draft_app_config = self.get_draft_app_config(app_id, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 100, in get_draft_app_config
    if draft_tool["type"] == "builtin_tools":
TypeError: string indices must be integers
[2025-05-16 19:28:26,574.574] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 19:28:26,584.584] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 19:28:26] "[35m[1mPOST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/publish HTTP/1.1[0m" 500 -
[2025-05-16 19:30:37,973.973] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:30:37,973.973] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 19:30:37,973.973] base.py -> _exec_single_context line:1901 [INFO]: [cached since 917.3s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 19:30:37,975.975] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:30:37,975.975] base.py -> _exec_single_context line:1901 [INFO]: [cached since 917.3s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:30:37,976.976] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 19:30:37,976.976] base.py -> _exec_single_context line:1901 [INFO]: [cached since 475.6s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 19:30:37,977.977] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: string indices must be integers
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 70, in publish
    self.app_service.publish_draft_app_config(app_id, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 253, in publish_draft_app_config
    draft_app_config = self.get_draft_app_config(app_id, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 100, in get_draft_app_config
    if draft_tool["type"] == "builtin_tools":
TypeError: string indices must be integers
[2025-05-16 19:30:37,978.978] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 19:30:37,987.987] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 19:30:37] "[35m[1mPOST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/publish HTTP/1.1[0m" 500 -
[2025-05-16 19:33:27,371.371] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:33:27,371.371] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 19:33:27,372.372] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1087s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 19:33:27,373.373] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:33:27,373.373] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1087s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:33:27,375.375] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 19:33:27,375.375] base.py -> _exec_single_context line:1901 [INFO]: [cached since 645s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 19:33:27,376.376] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET tools=%(tools)s::JSONB WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-16 19:33:27,377.377] base.py -> _exec_single_context line:1901 [INFO]: [cached since 576.6s ago] {'tools': '[]', 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-16 19:33:27,377.377] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 19:33:27,378.378] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:33:27,378.378] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.id = %(pk_1)s::UUID
[2025-05-16 19:33:27,378.378] base.py -> _exec_single_context line:1901 [INFO]: [cached since 576.6s ago] {'pk_1': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-16 19:33:27,380.380] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 19:33:27,381.381] base.py -> _exec_single_context line:1901 [INFO]: [cached since 576.6s ago] {'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-05-16 19:33:27,382.382] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_config (app_id, model_config, dialog_round, preset_prompt, tools, workflows, retrieval_config, long_term_memory, opening_statement, opening_questions, speech_to_text, text_to_speech, review_config, updated_at, created_at) VALUES (%(app_id)s::UUID, %(model_config)s::JSONB, %(dialog_round)s, %(preset_prompt)s, %(tools)s::JSONB, %(workflows)s::JSONB, %(retrieval_config)s::JSONB, %(long_term_memory)s::JSONB, %(opening_statement)s, %(opening_questions)s::JSONB, %(speech_to_text)s::JSONB, %(text_to_speech)s::JSONB, %(review_config)s::JSONB, %(updated_at)s, %(created_at)s) RETURNING app_config.id, app_config.suggested_after_answer
[2025-05-16 19:33:27,382.382] base.py -> _exec_single_context line:1901 [INFO]: [cached since 552.8s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'model_config': '{"model": "gpt-4o", "provider": "openai", "parameters": {"top_p": 0.9, "max_tokens": 4096, "temperature": 0.7, "presence_penalty": 0.1, "frequency_penalty": 0.1}}', 'dialog_round': 5, 'preset_prompt': 'ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šã€å‹å¥½çš„AIåŠ©æ‰‹', 'tools': '[]', 'workflows': '[]', 'retrieval_config': '{"k": 5, "score": 0.7, "retrieval_strategy": "semantic"}', 'long_term_memory': '{"enable": true}', 'opening_statement': 'ä½ å¥½ï¼Œæˆ‘æ˜¯AIåŠ©æ‰‹', 'opening_questions': '["\\u6709\\u4ec0\\u4e48\\u53ef\\u4ee5\\u5e2e\\u60a8\\uff1f", "\\u60a8\\u9700\\u8981\\u4ec0\\u4e48\\u5e2e\\u52a9\\uff1f"]', 'speech_to_text': '{"enable": false}', 'text_to_speech': '{"voice": "echo", "enable": false, "auto_play": false}', 'review_config': '{"enable": false, "keywords": ["\\u654f\\u611f\\u8bcd1", "\\u654f\\u611f\\u8bcd2"], "inputs_config": {"enable": false, "preset_response": "\\u9884\\u8bbe\\u54cd\\u5e94"}, "outputs_config": {"enable": false}}', 'updated_at': datetime.datetime(2025, 5, 16, 11, 33, 27, 381562), 'created_at': datetime.datetime(2025, 5, 16, 11, 33, 27, 381562)}
[2025-05-16 19:33:27,383.383] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 19:33:27,383.383] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:33:27,385.385] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config.id AS app_config_id, app_config.app_id AS app_config_app_id, app_config.model_config AS app_config_model_config, app_config.dialog_round AS app_config_dialog_round, app_config.preset_prompt AS app_config_preset_prompt, app_config.tools AS app_config_tools, app_config.workflows AS app_config_workflows, app_config.retrieval_config AS app_config_retrieval_config, app_config.long_term_memory AS app_config_long_term_memory, app_config.opening_statement AS app_config_opening_statement, app_config.opening_questions AS app_config_opening_questions, app_config.speech_to_text AS app_config_speech_to_text, app_config.text_to_speech AS app_config_text_to_speech, app_config.suggested_after_answer AS app_config_suggested_after_answer, app_config.review_config AS app_config_review_config, app_config.updated_at AS app_config_updated_at, app_config.created_at AS app_config_created_at 
FROM app_config 
WHERE app_config.id = %(pk_1)s::UUID
[2025-05-16 19:33:27,385.385] base.py -> _exec_single_context line:1901 [INFO]: [cached since 552.8s ago] {'pk_1': UUID('e38c7bfd-c74f-427e-ad5f-cc57e8303174')}
[2025-05-16 19:33:27,386.386] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:33:27,386.386] base.py -> _exec_single_context line:1901 [INFO]: [cached since 552.8s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:33:27,387.387] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app SET app_config_id=%(app_config_id)s::UUID WHERE app.id = %(app_id)s::UUID
[2025-05-16 19:33:27,387.387] base.py -> _exec_single_context line:1901 [INFO]: [cached since 552.8s ago] {'app_config_id': UUID('e38c7bfd-c74f-427e-ad5f-cc57e8303174'), 'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:33:27,388.388] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 19:33:27,388.388] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:33:27,389.389] base.py -> _exec_single_context line:1896 [INFO]: DELETE FROM app_dataset_join WHERE app_dataset_join.app_id = %(app_id_1)s::UUID
[2025-05-16 19:33:27,389.389] base.py -> _exec_single_context line:1901 [INFO]: [cached since 552.8s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:33:27,389.389] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 19:33:27,390.390] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:33:27,390.390] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_dataset_join (app_id, dataset_id) VALUES (%(app_id)s::UUID, %(dataset_id)s::UUID) RETURNING app_dataset_join.id, app_dataset_join.updated_at, app_dataset_join.created_at
[2025-05-16 19:33:27,391.391] base.py -> _exec_single_context line:1901 [INFO]: [cached since 552.8s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'dataset_id': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-05-16 19:33:27,392.392] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 19:33:27,393.393] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:33:27,393.393] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:33:27,393.393] base.py -> _exec_single_context line:1901 [INFO]: [cached since 552.8s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:33:27,394.394] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 19:33:27,394.394] base.py -> _exec_single_context line:1901 [INFO]: [cached since 645s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 19:33:27,395.395] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(max(app_config_version.version), %(coalesce_2)s) AS coalesce_1 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 19:33:27,396.396] base.py -> _exec_single_context line:1901 [INFO]: [cached since 552.8s ago] {'coalesce_2': 0, 'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.PUBLISHED: 'published'>}
[2025-05-16 19:33:27,396.396] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_config_version (app_id, model_config, dialog_round, preset_prompt, tools, workflows, datasets, retrieval_config, long_term_memory, opening_statement, opening_questions, speech_to_text, text_to_speech, suggested_after_answer, review_config, version, config_type) VALUES (%(app_id)s::UUID, %(model_config)s::JSONB, %(dialog_round)s, %(preset_prompt)s, %(tools)s::JSONB, %(workflows)s::JSONB, %(datasets)s::JSONB, %(retrieval_config)s::JSONB, %(long_term_memory)s::JSONB, %(opening_statement)s, %(opening_questions)s::JSONB, %(speech_to_text)s::JSONB, %(text_to_speech)s::JSONB, %(suggested_after_answer)s::JSONB, %(review_config)s::JSONB, %(version)s, %(config_type)s) RETURNING app_config_version.id, app_config_version.updated_at, app_config_version.created_at
[2025-05-16 19:33:27,398.398] base.py -> _exec_single_context line:1901 [INFO]: [cached since 552.8s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'model_config': '{"model": "gpt-4o", "provider": "openai", "parameters": {"top_p": 0.9, "max_tokens": 4096, "temperature": 0.7, "presence_penalty": 0.1, "frequency_penalty": 0.1}}', 'dialog_round': 5, 'preset_prompt': 'ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šã€å‹å¥½çš„AIåŠ©æ‰‹', 'tools': '[]', 'workflows': '[]', 'datasets': '["059c1cbc-5230-4056-a44a-4537779922cd"]', 'retrieval_config': '{"k": 5, "score": 0.7, "retrieval_strategy": "semantic"}', 'long_term_memory': '{"enable": true}', 'opening_statement': 'ä½ å¥½ï¼Œæˆ‘æ˜¯AIåŠ©æ‰‹', 'opening_questions': '["\\u6709\\u4ec0\\u4e48\\u53ef\\u4ee5\\u5e2e\\u60a8\\uff1f", "\\u60a8\\u9700\\u8981\\u4ec0\\u4e48\\u5e2e\\u52a9\\uff1f"]', 'speech_to_text': '{"enable": false}', 'text_to_speech': '{"voice": "echo", "enable": false, "auto_play": false}', 'suggested_after_answer': '{"enable": true}', 'review_config': '{"enable": false, "keywords": ["\\u654f\\u611f\\u8bcd1", "\\u654f\\u611f\\u8bcd2"], "inputs_config": {"enable": false, "preset_response": "\\u9884\\u8bbe\\u54cd\\u5e94"}, "outputs_config": {"enable": false}}', 'version': 11, 'config_type': <AppConfigType.PUBLISHED: 'published'>}
[2025-05-16 19:33:27,399.399] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 19:33:27,400.400] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 19:33:27] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/publish HTTP/1.1" 200 -
[2025-05-16 19:33:30,341.341] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:33:30,342.342] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 19:33:30,342.342] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1090s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 19:33:30,343.343] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:33:30,343.343] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1090s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:33:30,344.344] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 19:33:30,345.345] base.py -> _exec_single_context line:1901 [INFO]: [cached since 647.9s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 19:33:30,346.346] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 19:33:30,346.346] base.py -> _exec_single_context line:1901 [INFO]: [cached since 579.6s ago] {'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-05-16 19:33:30,348.348] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 19:33:30,348.348] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 19:33:30] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 19:36:33,556.556] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:36:33,556.556] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 19:36:33,557.557] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1273s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 19:36:33,558.558] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:36:33,559.559] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1273s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:36:33,560.560] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 19:36:33,560.560] base.py -> _exec_single_context line:1901 [INFO]: [cached since 831.1s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 19:36:33,561.561] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET tools=%(tools)s::JSONB WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-16 19:36:33,562.562] base.py -> _exec_single_context line:1901 [INFO]: [cached since 762.8s ago] {'tools': '[]', 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-16 19:36:33,562.562] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 19:36:33,563.563] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:36:33,564.564] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.id = %(pk_1)s::UUID
[2025-05-16 19:36:33,565.565] base.py -> _exec_single_context line:1901 [INFO]: [cached since 762.8s ago] {'pk_1': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-16 19:36:33,566.566] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 19:36:33,567.567] base.py -> _exec_single_context line:1901 [INFO]: [cached since 762.8s ago] {'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-05-16 19:36:33,568.568] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_config (app_id, model_config, dialog_round, preset_prompt, tools, workflows, retrieval_config, long_term_memory, opening_statement, opening_questions, speech_to_text, text_to_speech, review_config, updated_at, created_at) VALUES (%(app_id)s::UUID, %(model_config)s::JSONB, %(dialog_round)s, %(preset_prompt)s, %(tools)s::JSONB, %(workflows)s::JSONB, %(retrieval_config)s::JSONB, %(long_term_memory)s::JSONB, %(opening_statement)s, %(opening_questions)s::JSONB, %(speech_to_text)s::JSONB, %(text_to_speech)s::JSONB, %(review_config)s::JSONB, %(updated_at)s, %(created_at)s) RETURNING app_config.id, app_config.suggested_after_answer
[2025-05-16 19:36:33,568.568] base.py -> _exec_single_context line:1901 [INFO]: [cached since 739s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'model_config': '{"model": "gpt-4o", "provider": "openai", "parameters": {"top_p": 0.9, "max_tokens": 4096, "temperature": 0.7, "presence_penalty": 0.1, "frequency_penalty": 0.1}}', 'dialog_round': 5, 'preset_prompt': 'ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šã€å‹å¥½çš„AIåŠ©æ‰‹', 'tools': '[]', 'workflows': '[]', 'retrieval_config': '{"k": 5, "score": 0.7, "retrieval_strategy": "semantic"}', 'long_term_memory': '{"enable": true}', 'opening_statement': 'ä½ å¥½ï¼Œæˆ‘æ˜¯AIåŠ©æ‰‹', 'opening_questions': '["\\u6709\\u4ec0\\u4e48\\u53ef\\u4ee5\\u5e2e\\u60a8\\uff1f", "\\u60a8\\u9700\\u8981\\u4ec0\\u4e48\\u5e2e\\u52a9\\uff1f"]', 'speech_to_text': '{"enable": false}', 'text_to_speech': '{"voice": "echo", "enable": false, "auto_play": false}', 'review_config': '{"enable": false, "keywords": ["\\u654f\\u611f\\u8bcd1", "\\u654f\\u611f\\u8bcd2"], "inputs_config": {"enable": false, "preset_response": "\\u9884\\u8bbe\\u54cd\\u5e94"}, "outputs_config": {"enable": false}}', 'updated_at': datetime.datetime(2025, 5, 16, 11, 36, 33, 568014), 'created_at': datetime.datetime(2025, 5, 16, 11, 36, 33, 568014)}
[2025-05-16 19:36:33,571.571] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 19:36:33,572.572] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:36:33,572.572] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config.id AS app_config_id, app_config.app_id AS app_config_app_id, app_config.model_config AS app_config_model_config, app_config.dialog_round AS app_config_dialog_round, app_config.preset_prompt AS app_config_preset_prompt, app_config.tools AS app_config_tools, app_config.workflows AS app_config_workflows, app_config.retrieval_config AS app_config_retrieval_config, app_config.long_term_memory AS app_config_long_term_memory, app_config.opening_statement AS app_config_opening_statement, app_config.opening_questions AS app_config_opening_questions, app_config.speech_to_text AS app_config_speech_to_text, app_config.text_to_speech AS app_config_text_to_speech, app_config.suggested_after_answer AS app_config_suggested_after_answer, app_config.review_config AS app_config_review_config, app_config.updated_at AS app_config_updated_at, app_config.created_at AS app_config_created_at 
FROM app_config 
WHERE app_config.id = %(pk_1)s::UUID
[2025-05-16 19:36:33,572.572] base.py -> _exec_single_context line:1901 [INFO]: [cached since 738.9s ago] {'pk_1': UUID('5fd6f5a0-5325-41df-a253-4a444e617095')}
[2025-05-16 19:36:33,573.573] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:36:33,574.574] base.py -> _exec_single_context line:1901 [INFO]: [cached since 738.9s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:36:33,575.575] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app SET app_config_id=%(app_config_id)s::UUID WHERE app.id = %(app_id)s::UUID
[2025-05-16 19:36:33,575.575] base.py -> _exec_single_context line:1901 [INFO]: [cached since 738.9s ago] {'app_config_id': UUID('5fd6f5a0-5325-41df-a253-4a444e617095'), 'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:36:33,575.575] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 19:36:33,577.577] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:36:33,577.577] base.py -> _exec_single_context line:1896 [INFO]: DELETE FROM app_dataset_join WHERE app_dataset_join.app_id = %(app_id_1)s::UUID
[2025-05-16 19:36:33,577.577] base.py -> _exec_single_context line:1901 [INFO]: [cached since 738.9s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:36:33,578.578] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 19:36:33,578.578] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:36:33,578.578] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_dataset_join (app_id, dataset_id) VALUES (%(app_id)s::UUID, %(dataset_id)s::UUID) RETURNING app_dataset_join.id, app_dataset_join.updated_at, app_dataset_join.created_at
[2025-05-16 19:36:33,579.579] base.py -> _exec_single_context line:1901 [INFO]: [cached since 738.9s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'dataset_id': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-05-16 19:36:33,580.580] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 19:36:33,581.581] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:36:33,581.581] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:36:33,581.581] base.py -> _exec_single_context line:1901 [INFO]: [cached since 738.9s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:36:33,582.582] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 19:36:33,583.583] base.py -> _exec_single_context line:1901 [INFO]: [cached since 831.2s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 19:36:33,584.584] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(max(app_config_version.version), %(coalesce_2)s) AS coalesce_1 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 19:36:33,584.584] base.py -> _exec_single_context line:1901 [INFO]: [cached since 738.9s ago] {'coalesce_2': 0, 'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.PUBLISHED: 'published'>}
[2025-05-16 19:36:33,585.585] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_config_version (app_id, model_config, dialog_round, preset_prompt, tools, workflows, datasets, retrieval_config, long_term_memory, opening_statement, opening_questions, speech_to_text, text_to_speech, suggested_after_answer, review_config, version, config_type) VALUES (%(app_id)s::UUID, %(model_config)s::JSONB, %(dialog_round)s, %(preset_prompt)s, %(tools)s::JSONB, %(workflows)s::JSONB, %(datasets)s::JSONB, %(retrieval_config)s::JSONB, %(long_term_memory)s::JSONB, %(opening_statement)s, %(opening_questions)s::JSONB, %(speech_to_text)s::JSONB, %(text_to_speech)s::JSONB, %(suggested_after_answer)s::JSONB, %(review_config)s::JSONB, %(version)s, %(config_type)s) RETURNING app_config_version.id, app_config_version.updated_at, app_config_version.created_at
[2025-05-16 19:36:33,585.585] base.py -> _exec_single_context line:1901 [INFO]: [cached since 738.9s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'model_config': '{"model": "gpt-4o", "provider": "openai", "parameters": {"top_p": 0.9, "max_tokens": 4096, "temperature": 0.7, "presence_penalty": 0.1, "frequency_penalty": 0.1}}', 'dialog_round': 5, 'preset_prompt': 'ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šã€å‹å¥½çš„AIåŠ©æ‰‹', 'tools': '[]', 'workflows': '[]', 'datasets': '["059c1cbc-5230-4056-a44a-4537779922cd"]', 'retrieval_config': '{"k": 5, "score": 0.7, "retrieval_strategy": "semantic"}', 'long_term_memory': '{"enable": true}', 'opening_statement': 'ä½ å¥½ï¼Œæˆ‘æ˜¯AIåŠ©æ‰‹', 'opening_questions': '["\\u6709\\u4ec0\\u4e48\\u53ef\\u4ee5\\u5e2e\\u60a8\\uff1f", "\\u60a8\\u9700\\u8981\\u4ec0\\u4e48\\u5e2e\\u52a9\\uff1f"]', 'speech_to_text': '{"enable": false}', 'text_to_speech': '{"voice": "echo", "enable": false, "auto_play": false}', 'suggested_after_answer': '{"enable": true}', 'review_config': '{"enable": false, "keywords": ["\\u654f\\u611f\\u8bcd1", "\\u654f\\u611f\\u8bcd2"], "inputs_config": {"enable": false, "preset_response": "\\u9884\\u8bbe\\u54cd\\u5e94"}, "outputs_config": {"enable": false}}', 'version': 12, 'config_type': <AppConfigType.PUBLISHED: 'published'>}
[2025-05-16 19:36:33,586.586] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 19:36:33,586.586] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 19:36:33] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/publish HTTP/1.1" 200 -
[2025-05-16 19:36:35,298.298] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:36:35,299.299] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 19:36:35,299.299] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1275s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 19:36:35,300.300] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:36:35,301.301] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1275s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:36:35,302.302] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 19:36:35,302.302] base.py -> _exec_single_context line:1901 [INFO]: [cached since 832.9s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 19:36:35,302.302] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 19:36:35,303.303] base.py -> _exec_single_context line:1901 [INFO]: [cached since 764.5s ago] {'id_1_1': '059c1cbc-5230-4056-a44a-4537779922cd'}
[2025-05-16 19:36:35,304.304] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 19:36:35,304.304] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 19:36:35] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 19:37:02,176.176] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:37:02,177.177] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 19:37:02,177.177] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1301s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 19:37:02,179.179] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:37:02,179.179] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1301s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:37:02,179.179] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 556, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 19:37:02,180.180] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 19:37:02,181.181] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 19:37:02] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 19:37:13,122.122] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:37:13,124.124] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 19:37:13,124.124] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1312s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 19:37:13,126.126] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:37:13,126.126] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1312s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:37:13,128.128] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 590, in _validate_draft_app_config
    raise ValidateErrorException("ç»‘å®šæ’ä»¶å·¥å…·å‚æ•°å‡ºé”™")
internal.exception.exception.ValidateErrorException
[2025-05-16 19:37:13,129.129] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 19:37:13,130.130] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 19:37:13] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 19:37:24,519.519] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:37:24,519.519] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 19:37:24,520.520] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1324s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 19:37:24,521.521] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:37:24,522.522] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1324s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:37:24,523.523] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 556, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 19:37:24,524.524] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 19:37:24,525.525] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 19:37:24] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 19:37:50,367.367] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:37:50,368.368] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 19:37:50,368.368] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1350s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 19:37:50,370.370] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:37:50,370.370] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1350s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:37:50,370.370] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 556, in _validate_draft_app_config
    raise ValidateErrorException("è‰ç¨¿é…ç½®å­—æ®µå‡ºé”™ï¼Œè¯·æ ¸å®žåŽé‡è¯•")
internal.exception.exception.ValidateErrorException
[2025-05-16 19:37:50,372.372] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 19:37:50,372.372] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 19:37:50] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 19:38:16,762.762] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:38:16,763.763] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 19:38:16,763.763] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1376s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 19:38:16,765.765] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:38:16,765.765] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1376s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:38:16,766.766] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 590, in _validate_draft_app_config
    raise ValidateErrorException("ç»‘å®šæ’ä»¶å·¥å…·å‚æ•°å‡ºé”™")
internal.exception.exception.ValidateErrorException
[2025-05-16 19:38:16,767.767] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 19:38:16,767.767] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 19:38:16] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 19:38:37,232.232] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:38:37,233.233] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 19:38:37,234.234] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1397s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 19:38:37,236.236] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:38:37,236.236] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1397s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:38:37,238.238] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 590, in _validate_draft_app_config
    raise ValidateErrorException("ç»‘å®šæ’ä»¶å·¥å…·å‚æ•°å‡ºé”™")
internal.exception.exception.ValidateErrorException
[2025-05-16 19:38:37,239.239] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 19:38:37,239.239] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 19:38:37] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 19:38:41,659.659] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:38:41,660.660] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 19:38:41,660.660] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1401s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 19:38:41,662.662] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:38:41,662.662] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1401s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:38:41,662.662] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 590, in _validate_draft_app_config
    raise ValidateErrorException("ç»‘å®šæ’ä»¶å·¥å…·å‚æ•°å‡ºé”™")
internal.exception.exception.ValidateErrorException
[2025-05-16 19:38:41,663.663] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 19:38:41,663.663] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 19:38:41] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 19:41:47,409.409] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:41:47,410.410] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 19:41:47,410.410] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1587s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 19:41:47,412.412] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:41:47,413.413] base.py -> _exec_single_context line:1901 [INFO]: [cached since 1587s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:41:47,413.413] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 590, in _validate_draft_app_config
    raise ValidateErrorException("ç»‘å®šæ’ä»¶å·¥å…·å‚æ•°å‡ºé”™")
internal.exception.exception.ValidateErrorException
[2025-05-16 19:41:47,414.414] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 19:41:47,415.415] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 19:41:47] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 19:42:18,314.314] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\app_service.py', reloading
[2025-05-16 19:42:20,591.591] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-16 19:42:48,336.336] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-16 19:42:48,355.355] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-16 19:42:50,583.583] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-16 19:42:50,584.584] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 19:42:50,591.591] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-16 19:42:50,591.591] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 19:42:50,593.593] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-16 19:42:50,593.593] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 19:42:50,595.595] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:42:50,602.602] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 19:42:50,603.603] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00130s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 19:42:50,616.616] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:42:50,616.616] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00055s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:42:50,620.620] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 590, in _validate_draft_app_config
    raise ValidateErrorException("ç»‘å®šæ’ä»¶å·¥å…·å‚æ•°å‡ºé”™")
internal.exception.exception.ValidateErrorException
[2025-05-16 19:42:50,631.631] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 19:42:50,633.633] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 19:42:50] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 19:43:11,164.164] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\app_service.py', reloading
[2025-05-16 19:43:12,821.821] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-16 19:43:46,859.859] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-16 19:43:46,881.881] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-16 19:43:49,269.269] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-16 19:43:49,270.270] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 19:43:49,276.276] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-16 19:43:49,276.276] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 19:43:49,278.278] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-16 19:43:49,279.279] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 19:43:49,281.281] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:43:49,295.295] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 19:43:49,295.295] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00072s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 19:43:49,313.313] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:43:49,314.314] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00075s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:43:49,319.319] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 'provider_id'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 596, in _validate_draft_app_config
    not tool["provider_id"]
KeyError: 'provider_id'
[2025-05-16 19:43:49,329.329] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 19:43:49,366.366] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 19:43:49] "[35m[1mPOST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1[0m" 500 -
[2025-05-16 19:44:21,237.237] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:44:21,237.237] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 19:44:21,238.238] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.94s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 19:44:21,240.240] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:44:21,241.241] base.py -> _exec_single_context line:1901 [INFO]: [cached since 31.92s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:44:21,242.242] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 'provider_id'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 596, in _validate_draft_app_config
    not tool["provider_id"]
KeyError: 'provider_id'
[2025-05-16 19:44:21,243.243] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 19:44:21,270.270] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 19:44:21] "[35m[1mPOST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1[0m" 500 -
[2025-05-16 19:44:57,676.676] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\app_service.py', reloading
[2025-05-16 19:45:01,692.692] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-16 19:45:57,807.807] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-16 19:45:57,826.826] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-16 19:46:00,117.117] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-16 19:46:00,118.118] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 19:46:00,126.126] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-16 19:46:00,126.126] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 19:46:00,129.129] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-16 19:46:00,129.129] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 19:46:00,131.131] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 19:46:00,138.138] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 19:46:00,140.140] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00103s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 19:46:00,156.156] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 19:46:00,157.157] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00068s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 19:46:00,160.160] http.py -> _register_error_handler line:63 [ERROR]: An error occurred: 'params'
Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 870, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask\app.py", line 855, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "C:\Users\Lenovo\Desktop\llmops-api\venv\lib\site-packages\flask_login\utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\handler\app_handler.py", line 63, in update_draft_app_config
    self.app_service.udate_draft_app_config(app_id, draft_app_config, current_user)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 237, in udate_draft_app_config
    draft_app_config = self._validate_draft_app_config(draft_app_config, account)
  File "C:\Users\Lenovo\Desktop\llmops-api\internal\service\app_service.py", line 603, in _validate_draft_app_config
    if not isinstance(tool["params"], dict):
KeyError: 'params'
[2025-05-16 19:46:00,172.172] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 19:46:00,202.202] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 19:46:00] "[35m[1mPOST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1[0m" 500 -
[2025-05-16 19:47:26,471.471] _internal.py -> _log line:97 [INFO]:  * Detected change in 'C:\\Users\\Lenovo\\Desktop\\llmops-api\\internal\\service\\app_service.py', reloading
[2025-05-16 19:47:27,858.858] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-16 22:48:04,427.427] _internal.py -> _log line:97 [INFO]: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
[2025-05-16 22:48:04,428.428] _internal.py -> _log line:97 [INFO]: [33mPress CTRL+C to quit[0m
[2025-05-16 22:48:04,437.437] _internal.py -> _log line:97 [INFO]:  * Restarting with stat
[2025-05-16 22:48:39,109.109] _internal.py -> _log line:97 [WARNING]:  * Debugger is active!
[2025-05-16 22:48:39,127.127] _internal.py -> _log line:97 [INFO]:  * Debugger PIN: 674-688-502
[2025-05-16 22:50:09,733.733] base.py -> _exec_single_context line:1896 [INFO]: select pg_catalog.version()
[2025-05-16 22:50:09,734.734] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 22:50:09,741.741] base.py -> _exec_single_context line:1896 [INFO]: select current_schema()
[2025-05-16 22:50:09,742.742] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 22:50:09,743.743] base.py -> _exec_single_context line:1896 [INFO]: show standard_conforming_strings
[2025-05-16 22:50:09,744.744] base.py -> _exec_single_context line:1901 [INFO]: [raw sql] {}
[2025-05-16 22:50:09,745.745] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 22:50:09,754.754] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 22:50:09,755.755] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00097s] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 22:50:09,770.770] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 22:50:09,771.771] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00092s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 22:50:09,780.780] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-16 22:50:09,781.781] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00115s] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-16 22:50:09,786.786] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 22:50:09,787.787] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00076s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 22:50:09,797.797] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET model_config=%(model_config)s::JSONB, dialog_round=%(dialog_round)s, preset_prompt=%(preset_prompt)s, tools=%(tools)s::JSONB, datasets=%(datasets)s::JSONB, long_term_memory=%(long_term_memory)s::JSONB, updated_at=%(updated_at)s WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-16 22:50:09,797.797] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00053s] {'model_config': '{}', 'dialog_round': 10, 'preset_prompt': 'ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹', 'tools': '[{"type": "builtin_tool", "provider_id": "google", "tool_id": "google_serper", "params": {}}]', 'datasets': '["9af90c52-28b2-4a47-9c92-148c9f21b512"]', 'long_term_memory': '{"enable": false}', 'updated_at': datetime.datetime(2025, 5, 16, 22, 50, 9, 793064), 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-16 22:50:09,801.801] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 22:50:09,807.807] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 22:50:09] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 22:50:21,835.835] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 22:50:21,835.835] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 22:50:21,836.836] base.py -> _exec_single_context line:1901 [INFO]: [cached since 12.08s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 22:50:21,837.837] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 22:50:21,838.838] base.py -> _exec_single_context line:1901 [INFO]: [cached since 12.07s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 22:50:21,848.848] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 22:50:21,848.848] base.py -> _exec_single_context line:1901 [INFO]: [cached since 12.06s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 22:50:21,850.850] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 22:50:21,851.851] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 22:50:21] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b HTTP/1.1" 200 -
[2025-05-16 22:50:40,560.560] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 22:50:40,561.561] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 22:50:40,561.561] base.py -> _exec_single_context line:1901 [INFO]: [cached since 30.81s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 22:50:40,563.563] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 22:50:40,565.565] base.py -> _exec_single_context line:1901 [INFO]: [cached since 30.79s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 22:50:40,566.566] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 22:50:40,566.566] base.py -> _exec_single_context line:1901 [INFO]: [cached since 30.78s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 22:50:40,569.569] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET tools=%(tools)s::JSONB WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-16 22:50:40,569.569] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00031s] {'tools': '[]', 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-16 22:50:40,570.570] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 22:50:40,571.571] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 22:50:40,572.572] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.id = %(pk_1)s::UUID
[2025-05-16 22:50:40,572.572] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00053s] {'pk_1': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-16 22:50:40,574.574] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 22:50:40,574.574] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00029s] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-16 22:50:40,575.575] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 22:50:40,575.575] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 22:50:40] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 22:51:21,486.486] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 22:51:21,487.487] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 22:51:21,487.487] base.py -> _exec_single_context line:1901 [INFO]: [cached since 71.73s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 22:51:21,488.488] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 22:51:21,489.489] base.py -> _exec_single_context line:1901 [INFO]: [cached since 71.72s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 22:51:21,490.490] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-16 22:51:21,490.490] base.py -> _exec_single_context line:1901 [INFO]: [cached since 71.71s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-16 22:51:21,491.491] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 22:51:21,491.491] base.py -> _exec_single_context line:1901 [INFO]: [cached since 71.7s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 22:51:21,492.492] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET tools=%(tools)s::JSONB, updated_at=%(updated_at)s WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-16 22:51:21,492.492] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00025s] {'tools': '[{"type": "builtin_tool", "provider_id": "google", "tool_id": "google_serper", "params": {}}]', 'updated_at': datetime.datetime(2025, 5, 16, 22, 51, 21, 492701), 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-16 22:51:21,493.493] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 22:51:21,494.494] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 22:51:21] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 22:51:29,506.506] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 22:51:29,507.507] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 22:51:29,507.507] base.py -> _exec_single_context line:1901 [INFO]: [cached since 79.75s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 22:51:29,508.508] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 22:51:29,509.509] base.py -> _exec_single_context line:1901 [INFO]: [cached since 79.74s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 22:51:29,509.509] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 22:51:29,510.510] base.py -> _exec_single_context line:1901 [INFO]: [cached since 79.72s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 22:51:29,511.511] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET tools=%(tools)s::JSONB WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-16 22:51:29,511.511] base.py -> _exec_single_context line:1901 [INFO]: [cached since 48.94s ago] {'tools': '[]', 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-16 22:51:29,512.512] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 22:51:29,513.513] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 22:51:29,513.513] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.id = %(pk_1)s::UUID
[2025-05-16 22:51:29,513.513] base.py -> _exec_single_context line:1901 [INFO]: [cached since 48.94s ago] {'pk_1': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-16 22:51:29,514.514] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 22:51:29,515.515] base.py -> _exec_single_context line:1901 [INFO]: [cached since 48.94s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-16 22:51:29,516.516] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 22:51:29,516.516] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 22:51:29] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 22:51:35,148.148] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 22:51:35,149.149] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 22:51:35,149.149] base.py -> _exec_single_context line:1901 [INFO]: [cached since 85.39s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 22:51:35,151.151] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 22:51:35,151.151] base.py -> _exec_single_context line:1901 [INFO]: [cached since 85.38s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 22:51:35,152.152] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-16 22:51:35,153.153] base.py -> _exec_single_context line:1901 [INFO]: [cached since 85.37s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-16 22:51:35,154.154] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 22:51:35,154.154] base.py -> _exec_single_context line:1901 [INFO]: [cached since 85.37s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 22:51:35,155.155] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET tools=%(tools)s::JSONB, updated_at=%(updated_at)s WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-16 22:51:35,155.155] base.py -> _exec_single_context line:1901 [INFO]: [cached since 13.66s ago] {'tools': '[{"type": "builtin_tool", "provider_id": "google", "tool_id": "google_serper", "params": {}}]', 'updated_at': datetime.datetime(2025, 5, 16, 22, 51, 35, 155118), 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-16 22:51:35,156.156] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 22:51:35,157.157] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 22:51:35] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 22:51:44,709.709] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 22:51:44,709.709] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 22:51:44,710.710] base.py -> _exec_single_context line:1901 [INFO]: [cached since 94.96s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 22:51:44,711.711] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 22:51:44,711.711] base.py -> _exec_single_context line:1901 [INFO]: [cached since 94.94s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 22:51:44,712.712] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 22:51:44,712.712] base.py -> _exec_single_context line:1901 [INFO]: [cached since 94.93s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 22:51:44,713.713] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET tools=%(tools)s::JSONB WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-16 22:51:44,714.714] base.py -> _exec_single_context line:1901 [INFO]: [cached since 64.14s ago] {'tools': '[]', 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-16 22:51:44,714.714] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 22:51:44,715.715] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 22:51:44,715.715] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.id = %(pk_1)s::UUID
[2025-05-16 22:51:44,727.727] base.py -> _exec_single_context line:1901 [INFO]: [cached since 64.16s ago] {'pk_1': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-16 22:51:44,729.729] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 22:51:44,729.729] base.py -> _exec_single_context line:1901 [INFO]: [cached since 64.15s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-16 22:51:44,736.736] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_config (app_id, model_config, dialog_round, preset_prompt, tools, workflows, retrieval_config, long_term_memory, opening_statement, opening_questions, speech_to_text, text_to_speech, review_config, updated_at, created_at) VALUES (%(app_id)s::UUID, %(model_config)s::JSONB, %(dialog_round)s, %(preset_prompt)s, %(tools)s::JSONB, %(workflows)s::JSONB, %(retrieval_config)s::JSONB, %(long_term_memory)s::JSONB, %(opening_statement)s, %(opening_questions)s::JSONB, %(speech_to_text)s::JSONB, %(text_to_speech)s::JSONB, %(review_config)s::JSONB, %(updated_at)s, %(created_at)s) RETURNING app_config.id, app_config.suggested_after_answer
[2025-05-16 22:51:44,736.736] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00071s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'model_config': '{}', 'dialog_round': 10, 'preset_prompt': 'ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹', 'tools': '[]', 'workflows': '[]', 'retrieval_config': '{"k": 5, "score": 0.7, "retrieval_strategy": "semantic"}', 'long_term_memory': '{"enable": false}', 'opening_statement': 'ä½ å¥½ï¼Œæˆ‘æ˜¯AIåŠ©æ‰‹', 'opening_questions': '["\\u6709\\u4ec0\\u4e48\\u53ef\\u4ee5\\u5e2e\\u60a8\\uff1f", "\\u60a8\\u9700\\u8981\\u4ec0\\u4e48\\u5e2e\\u52a9\\uff1f"]', 'speech_to_text': '{"enable": false}', 'text_to_speech': '{"voice": "echo", "enable": false, "auto_play": false}', 'review_config': '{"enable": false, "keywords": ["\\u654f\\u611f\\u8bcd1", "\\u654f\\u611f\\u8bcd2"], "inputs_config": {"enable": false, "preset_response": "\\u9884\\u8bbe\\u54cd\\u5e94"}, "outputs_config": {"enable": false}}', 'updated_at': datetime.datetime(2025, 5, 16, 14, 51, 44, 736056), 'created_at': datetime.datetime(2025, 5, 16, 14, 51, 44, 736056)}
[2025-05-16 22:51:44,748.748] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 22:51:44,749.749] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 22:51:44,750.750] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config.id AS app_config_id, app_config.app_id AS app_config_app_id, app_config.model_config AS app_config_model_config, app_config.dialog_round AS app_config_dialog_round, app_config.preset_prompt AS app_config_preset_prompt, app_config.tools AS app_config_tools, app_config.workflows AS app_config_workflows, app_config.retrieval_config AS app_config_retrieval_config, app_config.long_term_memory AS app_config_long_term_memory, app_config.opening_statement AS app_config_opening_statement, app_config.opening_questions AS app_config_opening_questions, app_config.speech_to_text AS app_config_speech_to_text, app_config.text_to_speech AS app_config_text_to_speech, app_config.suggested_after_answer AS app_config_suggested_after_answer, app_config.review_config AS app_config_review_config, app_config.updated_at AS app_config_updated_at, app_config.created_at AS app_config_created_at 
FROM app_config 
WHERE app_config.id = %(pk_1)s::UUID
[2025-05-16 22:51:44,751.751] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00030s] {'pk_1': UUID('abc74ac7-ebc7-42c4-926d-4be8805fa84c')}
[2025-05-16 22:51:44,753.753] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 22:51:44,753.753] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00026s] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 22:51:44,755.755] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app SET app_config_id=%(app_config_id)s::UUID WHERE app.id = %(app_id)s::UUID
[2025-05-16 22:51:44,755.755] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00024s] {'app_config_id': UUID('abc74ac7-ebc7-42c4-926d-4be8805fa84c'), 'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 22:51:44,755.755] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 22:51:44,759.759] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 22:51:44,760.760] base.py -> _exec_single_context line:1896 [INFO]: DELETE FROM app_dataset_join WHERE app_dataset_join.app_id = %(app_id_1)s::UUID
[2025-05-16 22:51:44,760.760] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00026s] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 22:51:44,761.761] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 22:51:44,762.762] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 22:51:44,763.763] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_dataset_join (app_id, dataset_id) VALUES (%(app_id)s::UUID, %(dataset_id)s::UUID) RETURNING app_dataset_join.id, app_dataset_join.updated_at, app_dataset_join.created_at
[2025-05-16 22:51:44,763.763] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00024s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'dataset_id': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-16 22:51:44,765.765] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 22:51:44,765.765] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 22:51:44,766.766] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 22:51:44,766.766] base.py -> _exec_single_context line:1901 [INFO]: [cached since 0.01323s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 22:51:44,766.766] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 22:51:44,767.767] base.py -> _exec_single_context line:1901 [INFO]: [cached since 94.98s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 22:51:44,772.772] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(max(app_config_version.version), %(coalesce_2)s) AS coalesce_1 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 22:51:44,773.773] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00033s] {'coalesce_2': 0, 'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.PUBLISHED: 'published'>}
[2025-05-16 22:51:44,776.776] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_config_version (app_id, model_config, dialog_round, preset_prompt, tools, workflows, datasets, retrieval_config, long_term_memory, opening_statement, opening_questions, speech_to_text, text_to_speech, suggested_after_answer, review_config, version, config_type) VALUES (%(app_id)s::UUID, %(model_config)s::JSONB, %(dialog_round)s, %(preset_prompt)s, %(tools)s::JSONB, %(workflows)s::JSONB, %(datasets)s::JSONB, %(retrieval_config)s::JSONB, %(long_term_memory)s::JSONB, %(opening_statement)s, %(opening_questions)s::JSONB, %(speech_to_text)s::JSONB, %(text_to_speech)s::JSONB, %(suggested_after_answer)s::JSONB, %(review_config)s::JSONB, %(version)s, %(config_type)s) RETURNING app_config_version.id, app_config_version.updated_at, app_config_version.created_at
[2025-05-16 22:51:44,777.777] base.py -> _exec_single_context line:1901 [INFO]: [generated in 0.00081s] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'model_config': '{}', 'dialog_round': 10, 'preset_prompt': 'ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹', 'tools': '[]', 'workflows': '[]', 'datasets': '["9af90c52-28b2-4a47-9c92-148c9f21b512"]', 'retrieval_config': '{"k": 5, "score": 0.7, "retrieval_strategy": "semantic"}', 'long_term_memory': '{"enable": false}', 'opening_statement': 'ä½ å¥½ï¼Œæˆ‘æ˜¯AIåŠ©æ‰‹', 'opening_questions': '["\\u6709\\u4ec0\\u4e48\\u53ef\\u4ee5\\u5e2e\\u60a8\\uff1f", "\\u60a8\\u9700\\u8981\\u4ec0\\u4e48\\u5e2e\\u52a9\\uff1f"]', 'speech_to_text': '{"enable": false}', 'text_to_speech': '{"voice": "echo", "enable": false, "auto_play": false}', 'suggested_after_answer': '{"enable": true}', 'review_config': '{"enable": false, "keywords": ["\\u654f\\u611f\\u8bcd1", "\\u654f\\u611f\\u8bcd2"], "inputs_config": {"enable": false, "preset_response": "\\u9884\\u8bbe\\u54cd\\u5e94"}, "outputs_config": {"enable": false}}', 'version': 13, 'config_type': <AppConfigType.PUBLISHED: 'published'>}
[2025-05-16 22:51:44,779.779] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 22:51:44,779.779] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 22:51:44] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/publish HTTP/1.1" 200 -
[2025-05-16 22:51:53,577.577] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 22:51:53,577.577] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 22:51:53,578.578] base.py -> _exec_single_context line:1901 [INFO]: [cached since 103.8s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 22:51:53,579.579] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 22:51:53,579.579] base.py -> _exec_single_context line:1901 [INFO]: [cached since 103.8s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 22:51:53,580.580] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID) AND dataset.account_id = %(account_id_1)s::UUID
[2025-05-16 22:51:53,581.581] base.py -> _exec_single_context line:1901 [INFO]: [cached since 103.8s ago] {'account_id_1': UUID('46db30d1-3199-4e79-a0cd-abf12fa6858f'), 'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-16 22:51:53,581.581] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 22:51:53,582.582] base.py -> _exec_single_context line:1901 [INFO]: [cached since 103.8s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 22:51:53,583.583] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET tools=%(tools)s::JSONB, updated_at=%(updated_at)s WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-16 22:51:53,583.583] base.py -> _exec_single_context line:1901 [INFO]: [cached since 32.09s ago] {'tools': '[{"type": "builtin_tool", "provider_id": "google", "tool_id": "google_serper", "params": {}}]', 'updated_at': datetime.datetime(2025, 5, 16, 22, 51, 53, 582881), 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-16 22:51:53,592.592] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 22:51:53,594.594] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 22:51:53] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
[2025-05-16 22:52:00,106.106] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 22:52:00,107.107] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 22:52:00,107.107] base.py -> _exec_single_context line:1901 [INFO]: [cached since 110.4s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 22:52:00,109.109] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 22:52:00,110.110] base.py -> _exec_single_context line:1901 [INFO]: [cached since 110.3s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 22:52:00,111.111] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 22:52:00,112.112] base.py -> _exec_single_context line:1901 [INFO]: [cached since 110.3s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 22:52:00,113.113] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app_config_version SET tools=%(tools)s::JSONB WHERE app_config_version.id = %(app_config_version_id)s::UUID
[2025-05-16 22:52:00,113.113] base.py -> _exec_single_context line:1901 [INFO]: [cached since 79.54s ago] {'tools': '[]', 'app_config_version_id': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-16 22:52:00,114.114] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 22:52:00,115.115] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 22:52:00,115.115] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.id = %(pk_1)s::UUID
[2025-05-16 22:52:00,122.122] base.py -> _exec_single_context line:1901 [INFO]: [cached since 79.55s ago] {'pk_1': UUID('8338bcb2-ae18-40fc-bdf3-5f8cb8315ac5')}
[2025-05-16 22:52:00,124.124] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 22:52:00,124.124] base.py -> _exec_single_context line:1901 [INFO]: [cached since 79.55s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-16 22:52:00,125.125] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_config (app_id, model_config, dialog_round, preset_prompt, tools, workflows, retrieval_config, long_term_memory, opening_statement, opening_questions, speech_to_text, text_to_speech, review_config, updated_at, created_at) VALUES (%(app_id)s::UUID, %(model_config)s::JSONB, %(dialog_round)s, %(preset_prompt)s, %(tools)s::JSONB, %(workflows)s::JSONB, %(retrieval_config)s::JSONB, %(long_term_memory)s::JSONB, %(opening_statement)s, %(opening_questions)s::JSONB, %(speech_to_text)s::JSONB, %(text_to_speech)s::JSONB, %(review_config)s::JSONB, %(updated_at)s, %(created_at)s) RETURNING app_config.id, app_config.suggested_after_answer
[2025-05-16 22:52:00,125.125] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.39s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'model_config': '{}', 'dialog_round': 10, 'preset_prompt': 'ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹', 'tools': '[]', 'workflows': '[]', 'retrieval_config': '{"k": 5, "score": 0.7, "retrieval_strategy": "semantic"}', 'long_term_memory': '{"enable": false}', 'opening_statement': 'ä½ å¥½ï¼Œæˆ‘æ˜¯AIåŠ©æ‰‹', 'opening_questions': '["\\u6709\\u4ec0\\u4e48\\u53ef\\u4ee5\\u5e2e\\u60a8\\uff1f", "\\u60a8\\u9700\\u8981\\u4ec0\\u4e48\\u5e2e\\u52a9\\uff1f"]', 'speech_to_text': '{"enable": false}', 'text_to_speech': '{"voice": "echo", "enable": false, "auto_play": false}', 'review_config': '{"enable": false, "keywords": ["\\u654f\\u611f\\u8bcd1", "\\u654f\\u611f\\u8bcd2"], "inputs_config": {"enable": false, "preset_response": "\\u9884\\u8bbe\\u54cd\\u5e94"}, "outputs_config": {"enable": false}}', 'updated_at': datetime.datetime(2025, 5, 16, 14, 52, 0, 125091), 'created_at': datetime.datetime(2025, 5, 16, 14, 52, 0, 125091)}
[2025-05-16 22:52:00,127.127] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 22:52:00,128.128] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 22:52:00,137.137] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config.id AS app_config_id, app_config.app_id AS app_config_app_id, app_config.model_config AS app_config_model_config, app_config.dialog_round AS app_config_dialog_round, app_config.preset_prompt AS app_config_preset_prompt, app_config.tools AS app_config_tools, app_config.workflows AS app_config_workflows, app_config.retrieval_config AS app_config_retrieval_config, app_config.long_term_memory AS app_config_long_term_memory, app_config.opening_statement AS app_config_opening_statement, app_config.opening_questions AS app_config_opening_questions, app_config.speech_to_text AS app_config_speech_to_text, app_config.text_to_speech AS app_config_text_to_speech, app_config.suggested_after_answer AS app_config_suggested_after_answer, app_config.review_config AS app_config_review_config, app_config.updated_at AS app_config_updated_at, app_config.created_at AS app_config_created_at 
FROM app_config 
WHERE app_config.id = %(pk_1)s::UUID
[2025-05-16 22:52:00,137.137] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.39s ago] {'pk_1': UUID('d9e546e7-517b-4602-92bd-b1c297b188dd')}
[2025-05-16 22:52:00,139.139] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 22:52:00,139.139] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.39s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 22:52:00,140.140] base.py -> _exec_single_context line:1896 [INFO]: UPDATE app SET app_config_id=%(app_config_id)s::UUID WHERE app.id = %(app_id)s::UUID
[2025-05-16 22:52:00,140.140] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.39s ago] {'app_config_id': UUID('d9e546e7-517b-4602-92bd-b1c297b188dd'), 'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 22:52:00,141.141] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 22:52:00,142.142] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 22:52:00,142.142] base.py -> _exec_single_context line:1896 [INFO]: DELETE FROM app_dataset_join WHERE app_dataset_join.app_id = %(app_id_1)s::UUID
[2025-05-16 22:52:00,143.143] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.38s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 22:52:00,143.143] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 22:52:00,144.144] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 22:52:00,145.145] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_dataset_join (app_id, dataset_id) VALUES (%(app_id)s::UUID, %(dataset_id)s::UUID) RETURNING app_dataset_join.id, app_dataset_join.updated_at, app_dataset_join.created_at
[2025-05-16 22:52:00,145.145] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.38s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'dataset_id': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-16 22:52:00,147.147] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 22:52:00,148.148] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 22:52:00,148.148] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 22:52:00,149.149] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.4s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 22:52:00,154.154] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 22:52:00,154.154] base.py -> _exec_single_context line:1901 [INFO]: [cached since 110.4s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 22:52:00,156.156] base.py -> _exec_single_context line:1896 [INFO]: SELECT coalesce(max(app_config_version.version), %(coalesce_2)s) AS coalesce_1 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 22:52:00,156.156] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.38s ago] {'coalesce_2': 0, 'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.PUBLISHED: 'published'>}
[2025-05-16 22:52:00,158.158] base.py -> _exec_single_context line:1896 [INFO]: INSERT INTO app_config_version (app_id, model_config, dialog_round, preset_prompt, tools, workflows, datasets, retrieval_config, long_term_memory, opening_statement, opening_questions, speech_to_text, text_to_speech, suggested_after_answer, review_config, version, config_type) VALUES (%(app_id)s::UUID, %(model_config)s::JSONB, %(dialog_round)s, %(preset_prompt)s, %(tools)s::JSONB, %(workflows)s::JSONB, %(datasets)s::JSONB, %(retrieval_config)s::JSONB, %(long_term_memory)s::JSONB, %(opening_statement)s, %(opening_questions)s::JSONB, %(speech_to_text)s::JSONB, %(text_to_speech)s::JSONB, %(suggested_after_answer)s::JSONB, %(review_config)s::JSONB, %(version)s, %(config_type)s) RETURNING app_config_version.id, app_config_version.updated_at, app_config_version.created_at
[2025-05-16 22:52:00,158.158] base.py -> _exec_single_context line:1901 [INFO]: [cached since 15.38s ago] {'app_id': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'model_config': '{}', 'dialog_round': 10, 'preset_prompt': 'ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹', 'tools': '[]', 'workflows': '[]', 'datasets': '["9af90c52-28b2-4a47-9c92-148c9f21b512"]', 'retrieval_config': '{"k": 5, "score": 0.7, "retrieval_strategy": "semantic"}', 'long_term_memory': '{"enable": false}', 'opening_statement': 'ä½ å¥½ï¼Œæˆ‘æ˜¯AIåŠ©æ‰‹', 'opening_questions': '["\\u6709\\u4ec0\\u4e48\\u53ef\\u4ee5\\u5e2e\\u60a8\\uff1f", "\\u60a8\\u9700\\u8981\\u4ec0\\u4e48\\u5e2e\\u52a9\\uff1f"]', 'speech_to_text': '{"enable": false}', 'text_to_speech': '{"voice": "echo", "enable": false, "auto_play": false}', 'suggested_after_answer': '{"enable": true}', 'review_config': '{"enable": false, "keywords": ["\\u654f\\u611f\\u8bcd1", "\\u654f\\u611f\\u8bcd2"], "inputs_config": {"enable": false, "preset_response": "\\u9884\\u8bbe\\u54cd\\u5e94"}, "outputs_config": {"enable": false}}', 'version': 14, 'config_type': <AppConfigType.PUBLISHED: 'published'>}
[2025-05-16 22:52:00,171.171] base.py -> _commit_impl line:1140 [INFO]: COMMIT
[2025-05-16 22:52:00,172.172] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 22:52:00] "POST /apps/83040ed9-0795-43db-99da-b6eb2321a71b/publish HTTP/1.1" 200 -
[2025-05-16 22:52:07,502.502] base.py -> _begin_impl line:1097 [INFO]: BEGIN (implicit)
[2025-05-16 22:52:07,503.503] base.py -> _exec_single_context line:1896 [INFO]: SELECT account.id AS account_id, account.name AS account_name, account.email AS account_email, account.avatar AS account_avatar, account.password AS account_password, account.password_salt AS account_password_salt, account.last_login_at AS account_last_login_at, account.last_login_ip AS account_last_login_ip, account.updated_at AS account_updated_at, account.created_at AS account_created_at 
FROM account 
WHERE account.id = %(pk_1)s::UUID
[2025-05-16 22:52:07,503.503] base.py -> _exec_single_context line:1901 [INFO]: [cached since 117.7s ago] {'pk_1': '46db30d1-3199-4e79-a0cd-abf12fa6858f'}
[2025-05-16 22:52:07,505.505] base.py -> _exec_single_context line:1896 [INFO]: SELECT app.id AS app_id, app.account_id AS app_account_id, app.app_config_id AS app_app_config_id, app.draft_app_config_id AS app_draft_app_config_id, app.debug_conversation_id AS app_debug_conversation_id, app.name AS app_name, app.icon AS app_icon, app.description AS app_description, app.status AS app_status, app.updated_at AS app_updated_at, app.created_at AS app_created_at 
FROM app 
WHERE app.id = %(pk_1)s::UUID
[2025-05-16 22:52:07,505.505] base.py -> _exec_single_context line:1901 [INFO]: [cached since 117.7s ago] {'pk_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b')}
[2025-05-16 22:52:07,507.507] base.py -> _exec_single_context line:1896 [INFO]: SELECT app_config_version.id AS app_config_version_id, app_config_version.app_id AS app_config_version_app_id, app_config_version.model_config AS app_config_version_model_config, app_config_version.dialog_round AS app_config_version_dialog_round, app_config_version.preset_prompt AS app_config_version_preset_prompt, app_config_version.tools AS app_config_version_tools, app_config_version.workflows AS app_config_version_workflows, app_config_version.datasets AS app_config_version_datasets, app_config_version.retrieval_config AS app_config_version_retrieval_config, app_config_version.long_term_memory AS app_config_version_long_term_memory, app_config_version.opening_statement AS app_config_version_opening_statement, app_config_version.opening_questions AS app_config_version_opening_questions, app_config_version.speech_to_text AS app_config_version_speech_to_text, app_config_version.text_to_speech AS app_config_version_text_to_speech, app_config_version.suggested_after_answer AS app_config_version_suggested_after_answer, app_config_version.review_config AS app_config_version_review_config, app_config_version.version AS app_config_version_version, app_config_version.config_type AS app_config_version_config_type, app_config_version.updated_at AS app_config_version_updated_at, app_config_version.created_at AS app_config_version_created_at 
FROM app_config_version 
WHERE app_config_version.app_id = %(app_id_1)s::UUID AND app_config_version.config_type = %(config_type_1)s
[2025-05-16 22:52:07,507.507] base.py -> _exec_single_context line:1901 [INFO]: [cached since 117.7s ago] {'app_id_1': UUID('83040ed9-0795-43db-99da-b6eb2321a71b'), 'config_type_1': <AppConfigType.DRAFT: 'draft'>}
[2025-05-16 22:52:07,508.508] base.py -> _exec_single_context line:1896 [INFO]: SELECT dataset.id AS dataset_id, dataset.account_id AS dataset_account_id, dataset.name AS dataset_name, dataset.icon AS dataset_icon, dataset.description AS dataset_description, dataset.updated_at AS dataset_updated_at, dataset.created_at AS dataset_created_at 
FROM dataset 
WHERE dataset.id IN (%(id_1_1)s::UUID)
[2025-05-16 22:52:07,509.509] base.py -> _exec_single_context line:1901 [INFO]: [cached since 86.93s ago] {'id_1_1': '9af90c52-28b2-4a47-9c92-148c9f21b512'}
[2025-05-16 22:52:07,510.510] base.py -> _rollback_impl line:1123 [INFO]: ROLLBACK
[2025-05-16 22:52:07,511.511] _internal.py -> _log line:97 [INFO]: 127.0.0.1 - - [16/May/2025 22:52:07] "GET /apps/83040ed9-0795-43db-99da-b6eb2321a71b/draft-app-config HTTP/1.1" 200 -
